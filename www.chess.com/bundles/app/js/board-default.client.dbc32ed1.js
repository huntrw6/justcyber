window.chesscom=window.chesscom||{},window.chesscom.routes=window.chesscom.routes||{},Object.assign(window.chesscom.routes,{web_article_callback_list_authors:{tokens:[["text","/callback/articles/authors"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_article_callback_lock_coments:{tokens:[["variable","/","[^/]++","id"],["text","/callback/articles/lock-comments"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_blog_callback_lock_coments:{tokens:[["variable","/","[^/]++","id"],["text","/callback/blog/lock-comments"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_news_callback_lock_coments:{tokens:[["variable","/","[^/]++","id"],["text","/callback/news/lock-comments"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_video_callback_lock_coments:{tokens:[["variable","/","[^/]++","id"],["text","/callback/video/lock-comments"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_content_callback_feature_article:{tokens:[["variable","/","[^/]++","id"],["text","/callback/content/feature/article"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_content_callback_feature_blog:{tokens:[["variable","/","[^/]++","id"],["text","/callback/content/feature/blog"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_content_callback_feature_lesson_course:{tokens:[["variable","/","[^/]++","id"],["text","/callback/content/feature/lesson_course"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_content_callback_feature_news:{tokens:[["variable","/","[^/]++","id"],["text","/callback/content/feature/news"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_content_callback_feature_chess_video:{tokens:[["variable","/","[^/]++","id"],["text","/callback/content/feature/chess_video"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_callback_set_content_language:{tokens:[["text","/callback/user/content-language/set"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_article_view:{tokens:[["variable","/","[^/]++","url"],["text","/article/view"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},i18n_web_article_view:{tokens:[["variable","/","[^/]++","url"],["text","/article/view"],["variable","/","es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--","_locale"]],defaults:{subdomain:"www",_locale:""},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_security_login_and_go:{tokens:[["text","/login_and_go"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},i18n_web_security_login_and_go:{tokens:[["text","/login_and_go"],["variable","/","es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--","_locale"]],defaults:{subdomain:"www",_locale:""},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_survey_callback_vote:{tokens:[["variable","/","\\d+","optionId"],["text","/vote"],["variable","/","\\d+","id"],["text","/callback/survey"]],defaults:{subdomain:"www"},requirements:{id:"\\d+",optionId:"\\d+",subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_team_match_view:{tokens:[["variable","/","\\d+","match"],["text","/club/matches"]],defaults:{subdomain:"www"},requirements:{match:"\\d+",subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},i18n_web_team_match_view:{tokens:[["variable","/","\\d+","match"],["text","/club/matches"],["variable","/","es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--","_locale"]],defaults:{subdomain:"www",_locale:""},requirements:{match:"\\d+",subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_tournament_view:{tokens:[["variable","/","[^/]++","url"],["text","/tournament"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},i18n_web_tournament_view:{tokens:[["variable","/","[^/]++","url"],["text","/tournament"],["variable","/","es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--","_locale"]],defaults:{subdomain:"www",_locale:""},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_member_view:{tokens:[["variable","/","[^/]++","username"],["text","/member"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},i18n_web_member_view:{tokens:[["variable","/","[^/]++","username"],["text","/member"],["variable","/","es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--","_locale"]],defaults:{subdomain:"www",_locale:""},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_user_callback_get_board_settings:{tokens:[["text","/callback/board-settings"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_user_game_settings_email_callback_animation_type:{tokens:[["text","/callback/settings/user/email/animationType"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_board_color:{tokens:[["text","/callback/settings/user/email/boardColor"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_coordinates:{tokens:[["text","/callback/settings/user/email/coordinates"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_callback_dark_mode_toggle:{tokens:[["text","/callback/settings/user/darkModeToggle"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_show_legal_moves_toggle:{tokens:[["text","/callback/settings/user/email/showLegalMovesToggle"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_highlight_last_move_toggle:{tokens:[["text","/callback/settings/user/email/highlightLastMoveToggle"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_is_white_on_bottom_toggle:{tokens:[["text","/callback/settings/user/email/isWhiteOnBottom"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_move_list_display_type:{tokens:[["text","/callback/settings/user/email/moveListDisplayType"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_move_method:{tokens:[["text","/callback/settings/user/email/moveMethod"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_piece:{tokens:[["text","/callback/settings/user/email/pieceStyle"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_sound_toggle:{tokens:[["text","/callback/settings/user/email/soundToggle"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_show_timestamps:{tokens:[["text","/callback/settings/user/email/showTimestamps"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_user_game_settings_email_callback_sound_theme:{tokens:[["text","/callback/settings/user/email/soundTheme"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["POST"],schemes:["https"]},web_themes_data_callback:{tokens:[["text","/callback/themes/data"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"af_ZA|ar_AR|az_AZ|be_BY|bg_BG|bn_BD|bs_BA|ca|cs_CZ|da_DK|de_DE|el_GR|en_US|es_ES|et_EE|eu_ES|fa_IR|fi_FI|fil_PH|fr_FR|gl_ES|he_IL|hi_IN|hr_HR|hu_HU|hy_AM|id_ID|is_IS|it_IT|ja_JP|ka_GE|ko_KR|lt_LT|lv_LV|nl_BE|ms_MY|nl_NL|no_NO|pl_PL|pt_BR|pt_PT|ro_RO|ru_RU|sk_SK|sl_SI|sq_AL|sr_RS|sv_SE|tk_TM|tr_TR|uk_UA|ur_PK|vi_VN|zh_CN|zh_HK|zh_TW"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:["GET"],schemes:["https"]}}),function(){var Th={12117:function(lt,nn,Fe){"use strict";Fe.d(nn,{$:function(){return St},A:function(){return ln},B:function(){return pr},C:function(){return hi},D:function(){return Ta},E:function(){return ai},F:function(){return rs},G:function(){return ct},H:function(){return du},I:function(){return Xo},J:function(){return Ba},K:function(){return at},L:function(){return Uc},M:function(){return rv},N:function(){return Jp},O:function(){return X6},P:function(){return Ji},Q:function(){return Q6},R:function(){return Ni},S:function(){return Y6},T:function(){return Ne},U:function(){return $s},V:function(){return B8},W:function(){return $6},X:function(){return W6},Y:function(){return Li},Z:function(){return y},_:function(){return Pn},a:function(){return or},a$:function(){return Mg},a0:function(){return Mn},a1:function(){return V6},a2:function(){return G6},a3:function(){return go},a4:function(){return Pi},a5:function(){return Fc},a6:function(){return Na},a7:function(){return eu},a8:function(){return ma},a9:function(){return Zs},aA:function(){return gr},aB:function(){return Nc},aC:function(){return iv},aD:function(){return wh},aE:function(){return Ws},aF:function(){return ov},aG:function(){return j8},aH:function(){return nu},aI:function(){return Ir},aJ:function(){return ym},aK:function(){return K8},aL:function(){return nh},aM:function(){return js},aN:function(){return V8},aO:function(){return Gm},aP:function(){return tu},aQ:function(){return Qo},aR:function(){return su},aS:function(){return r5},aT:function(){return rb},aU:function(){return bh},aV:function(){return Mm},aW:function(){return F8},aX:function(){return it},aY:function(){return kg},aZ:function(){return Pg},a_:function(){return Tg},aa:function(){return ql},ab:function(){return n5},ac:function(){return uh},ad:function(){return W8},ae:function(){return H8},af:function(){return G8},ag:function(){return Am},ah:function(){return Ua},ai:function(){return Di},aj:function(){return ko},ak:function(){return eo},al:function(){return z8},am:function(){return Po},an:function(){return Ha},ao:function(){return ms},ap:function(){return Fa},aq:function(){return g8},ar:function(){return km},as:function(){return eb},at:function(){return Tm},au:function(){return tb},av:function(){return Q8},aw:function(){return J8},ax:function(){return bm},ay:function(){return To},az:function(){return Ii},b:function(){return cr},b3:function(){return Yi},b6:function(){return H6},b7:function(){return bc},b8:function(){return dr},b9:function(){return Q},bA:function(){return Cp},bC:function(){return kp},bD:function(){return v},bM:function(){return up},bP:function(){return X},bR:function(){return Su},bS:function(){return di},bX:function(){return pi},ba:function(){return w6},bh:function(){return Vl},bq:function(){return Nl},br:function(){return Fs},bs:function(){return Bs},bu:function(){return vt},bv:function(){return mp},c:function(){return Pc},c6:function(){return Ps},c7:function(){return pu},cA:function(){return fe},cB:function(){return er},cC:function(){return Ht},cD:function(){return H0},cb:function(){return Tt},cc:function(){return fn},cd:function(){return ie},ce:function(){return z},cf:function(){return fo},ch:function(){return wo},cm:function(){return Er},cn:function(){return yu},co:function(){return vr},cp:function(){return un},cq:function(){return Mr},cr:function(){return ar},cs:function(){return Z6},ct:function(){return K6},cu:function(){return b},cv:function(){return kt},cw:function(){return Lu},cx:function(){return Bn},cy:function(){return Ue},cz:function(){return Wn},d:function(){return Kt},e:function(){return Nn},f:function(){return z6},g:function(){return oe},h:function(){return Ar},i:function(){return ts},j:function(){return yn},k:function(){return It},l:function(){return ls},m:function(){return kn},n:function(){return dl},o:function(){return Io},p:function(){return j6},q:function(){return q6},r:function(){return Sg},s:function(){return Te},t:function(){return Cg},u:function(){return Vr},v:function(){return _e},w:function(){return M},x:function(){return J1},y:function(){return Up},z:function(){return cs}});var w=Fe(95653),ne=Object.defineProperty,q=Object.defineProperties,te=Object.getOwnPropertyDescriptors,He=Object.getOwnPropertySymbols,Ge=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable,Me=(e,t,n)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ge=(e,t)=>{for(var n in t||(t={}))Ge.call(t,n)&&Me(e,n,t[n]);if(He)for(var n of He(t))Le.call(t,n)&&Me(e,n,t[n]);return e},Ce=(e,t)=>q(e,te(t)),Be=(e,t)=>{var n={};for(var r in e)Ge.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&He)for(var r of He(e))t.indexOf(r)<0&&Le.call(e,r)&&(n[r]=e[r]);return n},De;(function(e){e.DefaultRightClickModifierKey="a",function(t){t.Name="accessibility"}(e.Plugin||(e.Plugin={}))})(De||(De={}));var M;(function(e){(function(t){t.Event="Event",t.State="State"})(e.LogCodes||(e.LogCodes={})),function(t){t.DraggingPiece="draggingPiece",t.HideHoverSquare="hideHoverSquare",t.MachineState="machineState",t.PromotionMove="promotionMove",t.SoundPlayed="soundPlayed",t.SelectedPiece="selectedPiece"}(e.State||(e.State={})),function(t){t.AddMove="AddMove",t.BlinkHighlight="BlinkHighlight",t.ClearMarkings="ClearMarkings",t.CreateContinuation="CreateContinuation",t.CreateGame="CreateGame",t.DeletePosition="DeletePosition",t.DrawAgreed="DrawAgreed",t.DrawClaimed="DrawClaimed",t.GameResigned="GameResigned",t.IllegalMove="IllegalMove",t.LineCommentUpdated="LineCommentUpdated",t.LineUpdated="LineUpdated",t.Load="Load",t.Mark="Mark",t.Move="Move",t.MoveBackward="MoveBackward",t.MoveForward="MoveForward",t.MoveVariation="MoveVariation",t.NodeUpdated="NodeUpdated",t.OutOfTime="OutOfTime",t.PromoteVariation="PromoteVariation",t.Reload="Reload",t.ResetGame="ResetGame",t.ResetToMainLine="ResetToMainLine",t.SelectLineEnd="SelectLineEnd",t.SelectNode="SelectNode",t.SelectLineStart="SelectLineStart",t.SetBoardPosition="SetBoardPosition",t.SetPlayingAs="SetPlayingAs",t.TurnSet="TurnSet",t.Undo="Undo",t.Unmark="Unmark",t.UpdatePGNHeaders="UpdatePGNHeaders"}(e.APIEvents||(e.APIEvents={})),function(t){t.PromotionAreaClosePointerdown="PromotionAreaClosePointerdown",t.PromotionPiecePointerdown="PromotionPiecePointerdown"}(e.BoardEvents||(e.BoardEvents={})),function(t){t.Create="Create",t.Destroy="Destroy",t.ModeChanged="ModeChanged",t.RendererSet="RendererSet",t.RendererSetFailed="RendererSetFailed",t.WebGLAssetsInitialized="WebGLAssetsInitialized",t.StylesSetFailed="StylesSetFailed"}(e.InstanceEvents||(e.InstanceEvents={})),function(t){t.Update="UpdateOptions",t.UpdateMode="UpdateModeOptions"}(e.OptionsEvents||(e.OptionsEvents={})),function(t){t.Play="PlaySound"}(e.SoundEvents||(e.SoundEvents={})),function(t){t.Resize="Resize"}(e.UIEvents||(e.UIEvents={})),function(t){t.MousedownLeft="MousedownLeft",t.MousedownRight="MousedownRight",t.PointerdownLeft="PointerdownLeft",t.PointerdownRight="PointerdownRight",t.Pointermove="Pointermove",t.Pointerup="Pointerup",t.Wheel="Wheel"}(e.UserEvents||(e.UserEvents={}))})(M||(M={}));function Je(e){return function(n){return e===n.type}}function zt(e=De.DefaultRightClickModifierKey){return{beforeState:[{condition:Je(M.UserEvents.PointerdownLeft),handler:t}],name:De.Plugin.Name,requires:["keys"]};function t(n,r){const{api:i,queue:o,run:s}=r;return i.keys.isPressed(e)?(o.add(s,Ce(ge({},n),{type:M.UserEvents.PointerdownRight})),!1):!0}}var cn;(function(e){(function(t){t.Name="analysis-overlay"})(e.Plugin||(e.Plugin={}))})(cn||(cn={}));function xt(e){const t=new Set(Array.isArray(e)?e:Object.values(e));return function(r){return t.has(r.type)}}function yr(){let e;return{destroy:t,match:[{condition:xt([M.APIEvents.Load,M.OptionsEvents.Update,M.InstanceEvents.ModeChanged,M.InstanceEvents.RendererSet]),handler:n}],name:cn.Plugin.Name};function t(){e?.removeAnalysisOverlay()}function n(r,i){const{options:o,renderer:s}=i;!e&&s&&(e=s),o.overlayInAnalysisMode?e?.addAnalysisOverlay():e?.removeAnalysisOverlay()}}var Kn;(function(e){(function(t){t.Name="cheatDetection"})(e.Plugin||(e.Plugin={})),function(t){t.CheatDetectionError="CheatDetectionError"}(e.Events||(e.Events={}))})(Kn||(Kn={}));var ht;(function(e){(function(t){t.Milliseconds="Milliseconds",t.Deciseconds="Deciseconds",t.Seconds="Seconds"})(e.Units||(e.Units={}))})(ht||(ht={}));var bt;(function(e){(function(t){t.Name="highlights"})(e.Plugin||(e.Plugin={}))})(bt||(bt={}));const er="highlight";var dr;(function(e){(function(t){t.Name="arrowKeys"})(e.Plugin||(e.Plugin={})),function(t){t.Left="arrowleft",t.Up="arrowup",t.Right="arrowright",t.Down="arrowdown"}(e.Arrow||(e.Arrow={}))})(dr||(dr={}));var Jr;(function(e){(function(t){t.Name="arrows"})(e.Plugin||(e.Plugin={}))})(Jr||(Jr={}));const Qe="arrow";var pn;(function(e){(function(t){t.Name="assets"})(e.Plugin||(e.Plugin={}))})(pn||(pn={}));var dt;(function(e){(function(t){t.Name="blinking-highlight"})(e.Plugin||(e.Plugin={}))})(dt||(dt={}));var We;(function(e){(function(t){t.Name="blinking-highlight"})(e.Plugin||(e.Plugin={}))})(We||(We={}));var ot;(function(e){(function(t){t.Name="board-size"})(e.Plugin||(e.Plugin={}))})(ot||(ot={}));var xe;(function(e){e.DefaultKeyToOpenWindow="e",function(t){t.Name="boardImages"}(e.Plugin||(e.Plugin={}))})(xe||(xe={}));var gn;(function(e){(function(t){t.Name="bughouse-api"})(e.Plugin||(e.Plugin={}))})(gn||(gn={}));var Jt;(function(e){(function(t){t.Name="bughouse-sibling-board"})(e.Plugin||(e.Plugin={}))})(Jt||(Jt={}));var jn;(function(e){(function(t){t.Name="clocks"})(e.Plugin||(e.Plugin={})),function(t){t.Blitz="blitz",t.Bullet="bullet",t.Rapid="rapid"}(e.TimeControlTypes||(e.TimeControlTypes={}))})(jn||(jn={}));var nr;(function(e){(function(t){t.Name="coordinates"})(e.Plugin||(e.Plugin={}))})(nr||(nr={}));var Tr;(function(e){(function(t){t.Name="custom-items"})(e.Plugin||(e.Plugin={})),function(t){t.Root="custom-item"}(e.Classes||(e.Classes={}))})(Tr||(Tr={}));const mn="customItem";var Pn;(function(e){(function(t){t.Arrows="arrows",t.Effects="effects",t.Pieces="pieces"})(e.Targets||(e.Targets={})),function(t){t.Above="above",t.Below="below"}(e.Positions||(e.Positions={}))})(Pn||(Pn={}));var Pt;(function(e){e.Image="Image",e.Star="Star",e.TextBox="TextBox"})(Pt||(Pt={}));var ft;(function(e){(function(t){t.Name="debug"})(e.Plugin||(e.Plugin={}))})(ft||(ft={}));var Dt;(function(e){e.Name="eco",function(t){t.Update="UpdateECO"}(e.Events||(e.Events={})),function(t){(function(n){n.StartingPosition="A00"})(t.Codes||(t.Codes={})),t.InitialFen="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"}(e.Config||(e.Config={}))})(Dt||(Dt={}));var Dn;(function(e){(function(t){t.Name="effects"})(e.Plugin||(e.Plugin={}))})(Dn||(Dn={}));const Bn="effect";var ie;(function(e){e.Alternative="Alternative",e.BestMove="BestMove",e.Blunder="Blunder",e.Book="Book",e.Brilliant="Brilliant",e.CheckmateBlack="CheckmateBlack",e.CheckmateWhite="CheckmateWhite",e.Correct="Correct",e.Critical="Critical",e.DrawBlack="DrawBlack",e.DrawWhite="DrawWhite",e.Excellent="Excellent",e.FastWin="FastWin",e.Forced="Forced",e.FreePiece="FreePiece",e.Gamechanger="Gamechanger",e.Good="Good",e.GreatFind="GreatFind",e.Inaccuracy="Inaccuracy",e.Incorrect="Incorrect",e.Mate="Mate",e.Miss="Miss",e.MissedWin="MissedWin",e.Mistake="Mistake",e.ResignBlack="ResignBlack",e.ResignWhite="ResignWhite",e.Sharp="Sharp",e.Takeback="Takeback",e.Threat="Threat",e.TimeoutBlack="TimeoutBlack",e.TimeoutWhite="TimeoutWhite",e.Undo="Undo",e.Winner="Winner",e.WinnerWhite="WinnerWhite",e.Interesting="Interesting",e.Warning="Warning",e.Equal="Equal"})(ie||(ie={}));var E;(function(e){(function(t){t.Name="fade-setup"})(e.Plugin||(e.Plugin={}))})(E||(E={}));var Y;(function(e){(function(t){t.Name="handPieces"})(e.Plugin||(e.Plugin={})),function(t){t.SetHand="SetHand"}(e.Events||(e.Events={}))})(Y||(Y={}));var R;(function(e){(function(t){t.Name="hml"})(e.Plugin||(e.Plugin={}))})(R||(R={}));var de;(function(e){(function(t){t.Name="hover-square"})(e.Plugin||(e.Plugin={}))})(de||(de={}));var Ae;(function(e){(function(t){t.Name="move-hints"})(e.Plugin||(e.Plugin={}))})(Ae||(Ae={}));var me;(function(e){(function(t){t.Name="performanceMetrics"})(e.Plugin||(e.Plugin={}))})(me||(me={}));var on;(function(e){(function(t){t.Name="pieces"})(e.Plugin||(e.Plugin={}))})(on||(on={}));var L;(function(e){(function(t){t.Name="pregame"})(e.Plugin||(e.Plugin={}))})(L||(L={}));var pe;(function(e){(function(t){t.Premove="Premove"})(e.Events||(e.Events={})),function(t){t.Name="premoves"}(e.Plugin||(e.Plugin={}))})(pe||(pe={}));var ye;(function(e){(function(t){t.Name="reporting"})(e.Plugin||(e.Plugin={}))})(ye||(ye={}));var ke;(function(e){(function(t){t.Name="scroll-through-moves"})(e.Plugin||(e.Plugin={}))})(ke||(ke={}));var Q;(function(e){(function(t){t.Name="sounds"})(e.Plugin||(e.Plugin={})),function(t){t.GameStart="game-start",t.GameEnd="game-end",t.Capture="capture",t.Castle="castle",t.Premove="premove",t.MoveSelf="move-self",t.MoveCheck="move-check",t.MoveOpponent="move-opponent",t.Promote="promote",t.Notify="notify",t.TenSeconds="tenseconds",t.Illegal="illegal"}(e.BoardSounds||(e.BoardSounds={}))})(Q||(Q={}));var Ke;(function(e){(function(t){t.Updated="ThreatsUpdated"})(e.Events||(e.Events={})),function(t){t.Name="threats"}(e.Plugin||(e.Plugin={}))})(Ke||(Ke={}));var yt;(function(e){(function(t){t.Name="timeControl"})(e.Plugin||(e.Plugin={})),function(t){t.Blitz="blitz",t.Bullet="bullet",t.Rapid="rapid"}(e.Types||(e.Types={})),function(t){t.Null="-",t.Separator="+",t.TimePerMove="/",t.Unset="?"}(e.Header||(e.Header={}))})(yt||(yt={}));var In;(function(e){(function(t){t.Reset="Reset",t.Start="Start",t.Stop="Stop",t.Tick="Tick"})(e.Actions||(e.Actions={})),function(t){t.End="End",t.Reset="Reset",t.Start="Start",t.Stop="Stop",t.Tick="Tick",t.TimeAdded="TimeAdded"}(e.Events||(e.Events={})),function(t){t.Ended="Ended",t.Going="Going",t.Initial="Initial",t.Stopped="Stopped"}(e.States||(e.States={}))})(In||(In={}));var Tn;(function(e){(function(n){n.Name="validate"})(e.Plugin||(e.Plugin={}));let t;(function(n){n.InvalidPosition="InvalidPosition"})(t=e.ErrorCodes||(e.ErrorCodes={})),e.ErrorMessages={[t.InvalidPosition]:"Board position does not match the FEN from JCE"}})(Tn||(Tn={}));var Fr;(function(e){(function(t){t.Ready="Ready",t.Updated="Updated"})(e.Events||(e.Events={})),function(t){t.Name="vml"}(e.Plugin||(e.Plugin={}))})(Fr||(Fr={}));var vt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get CheatDetection(){return Kn},get CustomTimestamps(){return ht},get Highlights(){return bt},get AnalysisOverlay(){return cn},get ArrowKeys(){return dr},get Arrows(){return Jr},get Assets(){return pn},get BlinkingHighlight(){return dt},get BlinkingSquare(){return We},get BoardSize(){return ot},get BoardImages(){return xe},get BughouseAPI(){return gn},get BughouseSiblingBoard(){return Jt},get Clocks(){return jn},get Coordinates(){return nr},get CustomItems(){return Tr},get Debug(){return ft},get ECO(){return Dt},get Effects(){return Dn},get FadeSetup(){return E},get HandPieces(){return Y},get HML(){return R},get HoverSquare(){return de},get MoveHints(){return Ae},get PerformanceMetrics(){return me},get Pieces(){return on},get Pregame(){return L},get Premoves(){return pe},get Reporting(){return ye},get ScrollThroughMoves(){return ke},get Sounds(){return Q},get Threats(){return Ke},get TimeControl(){return yt},get Timer(){return In},get Validate(){return Tn},get VML(){return Fr}});function _i(e){let t;return{api:()=>({setKeys:i,resetKeys:o}),create:n,destroy:r,name:dr.Plugin.Name};function n(l){t=l,i(e)}function r(){t.api.keys.removeOverrides([{key:dr.Arrow.Up},{key:dr.Arrow.Down},{key:dr.Arrow.Left},{key:dr.Arrow.Right}])}function i(l){const d=s(l);t.api.keys.setOverrides(d)}function o(){const l=s();t.api.keys.setOverrides(l)}function s(l={}){return[{key:dr.Arrow.Up,callback:d=>{var f;return(f=l[dr.Arrow.Up])!=null?f:d.selectLineStart}},{key:dr.Arrow.Down,callback:d=>{var f;return(f=l[dr.Arrow.Down])!=null?f:d.selectLineEnd}},{key:dr.Arrow.Left,callback:d=>{var f;return(f=l[dr.Arrow.Left])!=null?f:d.moveBackward}},{key:dr.Arrow.Right,callback:d=>{var f;return(f=l[dr.Arrow.Right])!=null?f:d.moveForward}}]}}var _r;(function(e){e.Alt="alt",e.Ctrl="ctrl",e.None="none",e.Shift="shift"})(_r||(_r={}));function Ei({options:e,rawArrow:t}){var n,r;const{data:{color:i,keyPressed:o,from:s,opacity:l,to:d},key:f,type:h}=t;return{data:{color:(r=(n=Jo(o,e))!=null?n:i)!=null?r:e.arrowColors.default,from:s,opacity:l??e.analysisHighlightOpacity,to:d},key:f,type:h}}function Jo(e,t){const{arrowColors:n}=t;switch(e){case _r.Alt:return n.alt;case _r.Ctrl:return n.ctrl;case _r.Shift:return n.shift;case _r.None:return n.default;default:return}}function Ur(e){return function(n){var r,i;return Je(M.APIEvents.Mark)(n)&&((i=(r=n.data).find)==null?void 0:i.call(r,o=>o.type===e))}}function Gt(e){return function(n){return n.type===e}}function Ut(e){return function(n){var r,i;return Je(M.APIEvents.Unmark)(n)&&((i=(r=n.data).find)==null?void 0:i.call(r,o=>o.type===e))}}function Dr(e){const{api:t,options:n,renderer:r}=e;if(!t.markings)return;const i=t.markings,s=(n.allowMarkings?i.getAllWhere({types:[Qe]}):[]).map(l=>Ei({rawArrow:l,options:n}));r?.addArrows(s,e)}function rr(){return[{condition:Ur(Qe),handler:t},{condition:Ut(Qe),handler:n},{condition:Je(M.InstanceEvents.RendererSet),handler:e}];function e(r,i){Dr(i)}function t(r,i){const{options:o,renderer:s}=i,{data:l}=r,d=l.filter(Gt(Qe)).map(f=>Ei({rawArrow:f,options:o}));s?.addArrows(d,i)}function n(r,i){const{options:o,renderer:s}=i,{data:l}=r,d=l.filter(Gt(Qe)).map(f=>Ei({rawArrow:f,options:o}));s?.removeArrows(d,i)}}function wi(){return{match:rr(),name:Jr.Plugin.Name,create:Dr,destroy:e};function e(t){const{api:n,renderer:r,options:i}=t;if(!n.markings)return;const l=n.markings.getAllWhere({types:[Qe]}).map(d=>Ei({rawArrow:d,options:i}));r?.removeArrows(l,t)}}var pr;(function(e){class t extends Error{}e.StylesSetFailed=t,function(n){(function(r){r.Arcade="arcade",r.Default="default",r.Fast="fast",r.Natural="natural",r.None="none",r.Slow="slow"})(n.Types||(n.Types={})),function(r){r[r.Default=180]="Default",r[r.Fast=100]="Fast",r[r.Slow=500]="Slow"}(n.Speeds||(n.Speeds={}))}(e.Animation||(e.Animation={})),function(n){n.Selected="#ffff00",n.Blue="#52b0dc",n.Green="#acce59",n.Orange="#ffaa00",n.Red="#eb6150"}(e.HighlightColors||(e.HighlightColors={})),function(n){n.Analysis="analysis",n.Move="move",n.Selected="selected"}(e.HighlightTypes||(e.HighlightTypes={})),function(n){n.Blue="rgba(72, 193, 249, 0.8)",n.Green="rgba(159, 207, 63, 0.8)",n.Orange="rgba(255, 170, 0, 0.8)",n.Red="rgba(248, 85, 63, 0.8)"}(e.HighlightedArrowColors||(e.HighlightedArrowColors={})),function(n){n.Inside="inside",n.Off="off",n.Outside="outside"}(e.CoordinatesPositions||(e.CoordinatesPositions={})),function(n){n.Click="click",n.Drag="drag",n.DragOnly="drag-only"}(e.MoveMethods||(e.MoveMethods={})),function(n){n.Figurine="figurine",n.Text="text"}(e.MoveListDisplayTypes||(e.MoveListDisplayTypes={})),function(n){n.HoverSquareOutline="hoverSquareOutline"}(e.BooleanOptions||(e.BooleanOptions={})),function(n){n.AnimationType="animationType",n.BoardStyle="boardStyle",n.Coordinates="coordinates",n.DarkMode="darkMode",n.EvaluationBarType="evaluationBarType",n.HighlightLegalMoves="highlightLegalMoves",n.HighlightMoves="highlightMoves",n.MoveListDisplayType="moveListDisplayType",n.PieceStyle="pieceStyle",n.SoundTheme="soundTheme",n.PlaySounds="playSounds"}(e.SaveableOptions||(e.SaveableOptions={}))})(pr||(pr={}));function Vr(e,t){return{data:t||{},type:e}}function Mo(){return"https://www.chess.com"}function go(e,t=150){return`${Mo()}/chess-themes/pieces/${e}/${t}`}var Pi={wp:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA8UExURUxpcUFBQUNDQ0REREREREVFRUVFRUVFRf////j4+O/v7+Li4tPT08TExK+vr5SUlICAgGtra1VVVUZGRh1ZfCsAAAAIdFJOUwAgPF19qsrhYMPqTAAAA+1JREFUeNrtm9vSqyAMhSv1FAmKrPd/132BWs+2u0g6/7Bu25l+k4QQFvTxSEpKSkpKSkpKSkpKSkpKSkpKSvpVZUoplf0UkspLDCpz9SNhyissVOU/QJVjq+opnT4fKWdbo7XWprVDLkWr7AkA6A3VNQ1q2h4AoIQT6Ez9giIiotYBwFOUqqM1FVHTC3IpAGjrLRVR04nlMasOqYh0B6CSqPvihIqILYBCZhHaQyrS3IuksQTQHFIRcSsRLjWk8IiKNFsAWfzKcs05lgEQe3sE0J1RUcPcA1X8HPIpFjF30bOYA6BTKmI20Vt9AfTnwSLN7GIXVwnYcypi5j52iyiB7i2sMipW9RaWFcE6pWokolUC9hxLS9RWAfTXWNFXYg7gMofx+5YCYK6CFb/LPwB0F8ES2BP9BHHaHUQmCAWgPU0hW4nxtAScPqMyIsP8E4A9ziALzfKP8iCNjacSOvk8MuxyaU8ldk70vki7C8WdoDsyeBCv9I1QLOlB+OP+VPeNntRDLIWjD2h3mqqPFiTMSlUO5tZu4+qcjCfoQ9U19cGWaCQCNoXq2Bnh+AEbQkXHR7KGOXbA/AJ0XNdnhg0zcxszYM8pVCdYvoUZG6+tKgCmrqmuqT4fbYZ2Hw+L6UJjv2+jDc7Z1Rz/GiN8tOKdXe0F1nx3jHWCLQDo96jaiB1C4SJcExX3Mc9kxeKazvBK7eLjeCOqWvzumorN4uOIu888XG6DxXOqmJt1lg8qgX6L5YBy/IbIMFgBVm+weplDz8qK2HDZ+ObDnnGz5hKwajaDl6YNVyt5J+xP1v2qgY41L1hc2eucqNfFBdkcMu1wyWaxGnO44XKxre/V9NzSLpcVfKBRAW5/cGADsXDlANr6gMtKVVeGVbDmszIbJ2SOlAA2DkSz6PSFTAp3rhSbxWCaS6xC1+w9r1kMg5FXo8LhHXqzmJ2jcqnq5HVGM1+NMbkUhmcQNf0Q13Oiqi/O1DGt3fyKatZYbaxTRla+qGp6j+t+h8sbgeaK6pXIDvcn0ofK6WuqF5i3BIvs5lqfjMArrBHMe6iVujWBbkjgG1TTfUt350PU3F9afEI1kpn7OsVzemb6CdR4HXRXZ1WzFfghlX9RfI97U81iRf+j7o45On/10P+jIrLhG34GoKdvoIgaFzyNxTBefUHlyysPHSz7LRVRH9gDyMdgfUVFoZ8oVf7h5JdURGE9gMsHzJ80iSxoDpsAVKSDZrEE+hBUREH9OFw/53y/pVYh24MJQkUhrxefAHQYLBNwjrh8NilT8zng6kBcAfefYm6Rfr8U/z6W6wIpLFZI/XWsKqh+4a+xSUlJSUlJSX9R/wAgFdSXQxyROwAAAABJRU5ErkJggg==",wn:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABCUExURUxpcUVFRfj4+EZGRkRERENDQ0VFRUVFRUREREFBQdPT0////5OTk+7u7uHh4V1dXU9PT6SkpG5ubre3t8jIyIKCgji/HX0AAAAKdFJOUwC1//+RRfHebR4QloLCAAAF2ElEQVR42u2c3bacIAyFK/6gKIio7/+qFVBHHcWMhBnbZS66zkV75jvZmxACp3/+PPHEE0888cQTTzxRpHl6P6goHiK/GVWaxfH9uIqR6mZcWsFetDfjSjVVWZY340riWPIBi9yLK7LJKsm9uAbDNxbrTlzaWl15O658AOET1n24BsfX5YxluZI8LX6MRUfHj1iWa4iMJnnxUw3bJdbMpYMm6c8MX5Ml1cBVywVZ9gOygs7r8IU1hOiaXs1wNP8BVfVOZYKLrprQsuSLNjMNjSIHWIaMNSNZlnzTV04qC9ZVtQXLv7YG4564oKzPGGssWFR8iaoqT6lMxkaw8AkzCjYQKg3GGKvkNxJGZyoCiSFhnTLFoggtYQWnsglrdMKykNU1ey/uAK62DttgvHZCAg82CZkHdFa9puqalgO4WB+Qq4hfjbL9QK2ObCBcleYK469k6kinVI1b34+5Bg3VgopPvYLkAN8brqwIU0rbBVY/N1cdoH5Zf9EwB1bywhKvno8REJdej0mIotUvklXNVApWvlhXB7DXfDIcP6meqThsGxrqagB7bTRkseyrXqm+A1dVa/skqIZNQz4Kky5jrxR741lqyMmHwSYZadiNh1xJV4+brnxTtD4PsxiZ3hkoarKWhr8SbHZ9irkdQlsaxl0qMsR0mcM9kEow4VIRM126hWcwquHDhVNF7a4ITcIKaCwtlRPLLMYCS0ICTtYh1miuFqdRNdcVQAltRtxYuqdFUDHa9sqnNdNZuazpC4xCqoBU9oPFCRaGilpCKYB1VICwMFSkH+w6bWc+lbvrvFmLmX9t6IFUXaxgWI2vuUxt4MBFONTJxuH4F1bnaa5iKu8QX+kuunZY64WlzZUg1AbIIrS9fePAmi2vm1TqWRsIrLqPJw7lsNYLS1eub9QGoyDV68NhrReWl+en2gClKsy5WwCwWo/mJh9rA6AySDuHNCMdflJsTXgsRWpvo3e/vVh+eDNNRwv3+GaBJS8vxeJoFW52GGFGfdE8PCHn9cGnQoz3q8cOMQnjZmA7foa2vABhqcu7or1fdUrBOzt2n8bI1Dkm4Qus3gdLlYenYz1+mIYj02VA7tZQrLHoZSx5NGmvl1et6aLM1Rykoa6n9Lq3xO7P3C8uWaN0tVO1MA01VnZ9JVZ7P7OlolGUrN6URScDOIGDZT6ne//mpkq9394nsVvClYY+WLoKya0q5vS5s3Hon0EyAtTQw1s2AXEv1slSe/uGeY4nOwLV0GMlTlzxYgzJjYTRbrfoplony6OcmtVoH9rVDVtI+DaUNXfqkhF4sjyxxseSmqwaOhZhRtj53j2xEuSDZHls1RNYMj9NlFLuSGgdyCEjN4Z1xjBgebQs6sVOOs+mzhsJvdrANRndp6J7VeRMQpwpxEiQ5sn2qbClOr3y2VL51QfYiKkW5EMJsUZJLqrzG583CVEc70v1LiGW448HAQCqdwn9Tq+AUySA6l1C7xp/1vZcpPKv8c7e9XwN7koY0FoFqF4dJCuctai7b3eswpDWMuMJck1CU7WSUBVL8osSmk4yiLUSoIS7yUKYMx/7HfD24SBZwTbEBPRQ5ChZbagNMfNKFmKv9XZ+vO4szymzc9tZLkP9Irfr2rYxUdmwX+o/27brvrLzZHo2IVjbVL1aPUY/Dlkr1VeNvhMKVR70OgTS7PDpoViA8lDk9DglJpRS9otDdPTHxItDo86ZEWZQRnA+vgjfBOfaea3Ve/W7B6hb4Qgl+6YTvPw0+OBHtZ0h4pRRPZAQpU+IccSZY1IpVvqHGWUglQkzAWlLlLAXHylSXZCbVBHw+yT9V1f/FOuZYPT6HRqPx1IG0USDImNhr8sIVpSlwqirufs650KgnPgjWDPzSWC0g5CH3h8GwjSpgDyo/jBa/+Niim4ta67C3/HIVOYJeeqNJbGxuD+WvorFxiL+FeK+WAodSz5YD5a95q+wA8XyQeL/xMppmLjb/zbzxBNPPPHEE0/84/EXqrqgdaE+G+kAAAAASUVORK5CYII=",wb:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABIUExURUxpcUJCQkREREVFRUREREREREVFRUVFRT8/P0RERPj4+EZGRtPT0////6CgoOHh4f39/bKysmRkZFFRUcXFxY+Pj+/v73p6esE377UAAAAKdFJOUwAoZMREiPDfEqnkaJEWAAAFq0lEQVR42u2b2ZajOgxFmzCaGMzM///pRTIhsoF0IBaw+qKHfqjK6ux1JB3LQ/35c8cdd9xxxx13OI3ES66GFITxc4hIPC4E5fnPKeLLgIVPI/zkQlR92TRlW6NgyVWo2i4rUoiyvgZXMGDUzQg1RFMNPxCnY0EHEqpUIZd3AbFyQpUqWV5ALjGkMM1SiiX7gevk6oqGcqdiARbIFZxrpFBZlAqw5NCN4emlpQwsqbHE+ViUqhuo2uflsIYc5rBmn1tbyYBQmjmEgj+54tFNezOH4KanTxGhmUV1gcJ6OURPxGouMkEImB/eYlUXKCyIx/PN1WEXiqtQVUqvPyhWdIEU4gzYp1n2Fiu8CFVbjGv1VcRCqjIbqbRYk2UF4sQmHCbT11wjTbHik2o/1FP8i6rDZSekvSDOopITVWpOpUn0PIXLplJo8MLa0ooz/OqdQRArJwYPa1JVH84V2FQKCz6m3YBT6qE25kXaGTIy0DSEIdEL+MFcSYy7Q1OsluxaobIkbLHrI4cvX3v7mwomeJrDAbvSW/8DB2jQokozusM3cxi8R2nwsmPWIzwM6UhhoVi0D2Gr3Y2/g9z6RxQWlLvMLLHASyO61Z5+2R9T9sIudxSLbllBzub920MGVvDRqqApRLEa0nJQex3Zox1QXpDCWhli4f4+J/ZgbdLSAyZpMfqoJRaUVry2peVPY/BKoSWWXVqSYqGrsu7SwEiVKRYWvFVatUGVKuYZH+q9zUyxMIf0pM23SgvIec9T49FIM+tACxfE5O1auYmV8p6nPl71Xlg5pBXvGa71UrRnlCvG81tTLMwhJEkQdpXaWWz45AoWxBqxSEnPK34a9D2uNpyJpUuLNqJ4DTXmpxquZvTGxTCbHeHajdjOsPRpPcsSFL48a46Vf27E6bT+wVPwfWbncPKHaG3pmfq1Zhm8vKWCH7Esf5CLWC3LnQuOKzOx0pc/+KRdVbpQ80xZ9BdzmC7ZVreIxXK5kSznUPsWueR5LNmWxqJztUsvVXOxNJY5P1QLWMoaFR2WVl18gSXWsRqG4hJjaRULPdaYm7F+BYvjQi+eT1oT1udp641Vua/5+Qxvtr73ae2ZD/wOG7FZEGtaV/6CZS8GDj1ermHRJTFeWhJHteBzPP6wKAR2fqJjBWu2orNjKfw6EsdjFQvf2H2B1UnJ4qcfsPQ2kES5UlrHqjV8aWmEPA5r7MR0Z0jJ04mjb+2k0qXF4Ft6ril2YukcMrg87hwcYLme5n376dH2HHIs1TBH7cUaxeIYbHAM/KkPjbHMqXH9JhbH0Ly8Ld0iFoM/jOPpT2LR3aTTmq9/aUOWHYbel8pfxMpZTriSlUnqWyoOjx8NtdqfQrZzt11ZnKiMmz3X1z397hQat7PujwP3UpVst9bec6N1ESrOx0pim1yUqmS89THfJ26h4n3ZJRYuTv7eg+O5Kd8VGbwWqbptfoWexXyhGH5Z9UYCJf+zT/+bNHYWFf/LXQ+fbW2SCv2d++UuPjhQX1cVeEN9xEMI6Mb1sp9BaaoDXiX5o16dUrJp4NAhH6LV0eO/8IOybJoXFf9jlsR74GvEun5+EfpTccD650hBKOLnzojFg4UtENGqJBWNelXIOHRNFviUA769b3OpVIe3xPPooPLytq/6vqKUvsuWnP5cs2pLqVZI1iNVTdlW438hnDlYoIu8bTYDGQI2vU6l55Cqzrvs5+had1z46q7/BFVY8eGjqnL1VhBsvS9shjT94vymSGek+JjLgb2+n2whzP4Y6brayaCKA/xvQCack31sEu09qVkNFzvGYMP4/mWUDs5Iwp3nR5/GRAeTjti+w/9rODjajZ2XFhbXr6N9tOtU63M4uDbYf5K7Hu1lsX50iMS9P+Aj5+jG2uCnP2J5/yOs3AlWnzuO3gkWR/ybWEnMFH/uuOOOO+644447nMd/5mwuGyzR1rsAAAAASUVORK5CYII=",wr:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA/UExURUxpcUFBQUNDQ0REREREREVFRUVFRUVFRf////j4+O/v7+Li4tPT08XFxbS0tKCgoI+Pj3p6emNjY1NTU0ZGRi8lq24AAAAIdFJOUwAiRmyXweDwOT8tswAABR1JREFUeNrtm2FzozYQht+VsO/aGZxk2v//C3vTnP3h7my0bz9gbIEhloTkuK02M5nYKPDw7mq1SAKoVq1atWrVqlWrVq1atWrVriZ5ziLnExHkU2BZEdmNvtmTdJ+Ntd3NfLk/PhZLREQAoBt89edwiP7Z/hraNwBAMtK3TURbY8xFmr/d9bY6VVIhAESMWAvImcK8XARU1QJYYm07o7IAOLnLN6RCPayrM3bAwTnmxRL7OvyphBgYD4tjAPU+mb597/gWeA8EC8OyTQsAdOoUwGaL3bfL+anjGCUvH2QHdEcA1lojAF4PncuHJS0A13XsL+9wcZNMYh0AOGQxyNBYtTPWGqB9zxtb/NVd3USBUQ9r3J+vXxiArv8kcM5sg3tXGBMgnRdBCk8PTrMM/aPqQesQiJmwphlOgZcrlmAJ6wXQpIwdrBaMh+Yu/9nO3D+B9nJy592VlFer/zx7IfpHnaQMKeFq+eeknv9Tzowju0Cb68Hlm8iIBR9rWa0pFnI78QDIJJO31hgjmCmwSECMMbadSCnAIevgM720A/C2ePsUvHoNfbWYM7ZuUqYSH3iFoyAcqZUX66YbaRiWJlabTZpa+PVR6+Nx/p7C1WqQZkw5mDtv3aqVVJsXiS1ZS5V9TLzNp4li5Vcrpuky1jOpJSikFg9r1LpiHTI7UTNgmZlqYyUWAZvqxfM1xAT7MEYtbJKnc/qnOuRXS/fARlaJZYF9biw4QLYpWtlhmJNrmXP/eTl4EDx9hZHoeSsZ7rtpgO9d/hmbDsBGjlwKn3NWGherZvD7xp5PkX20sm8A9NRdhehnu2QyWpLsZ7T0EiLWGm/yKfMgat8AQDsVIyIhUakESbEGcVRxI4ppdskpdd8pCmEBzWjuDSAx/AznO/+MT3xwXVxPie7vr713SFJJf/Z7Zpr1HHfvLnJaPLZoJgH80JvHwtsiceiS8gXxk/XRtbxMn7IGBlkoX0kpVp0uPIyNLq/K+KeRjGotO3hWMeIBan1YNFH5SVjtx16ZWRMgsCuNdbcep+bIQ9mxbrn4IKw7o8iU6xFYCMiNE66Uhc8EtRgLzoc4MeDm9TmxbtqUxtqFYenKxGVy54cZroSuaLLnh1svlscKrwi4qoQopdYUq7gTA++dXJMh4rE0ye3FYys0UnRNcJno5oznZ8p1MhaBy4BtSSxBqlqRwWUK5YcbfnkWta4ttTxW0m42lsWK6+xMzxDxaiViydNgjdqWxNqlzSjEF4KmWH7w1YpOXKZcflhTCEb3xGS18H9TK7ra8vN8Uaz0HcvPiMWnwuJDsNo1arWlsGKz6YquaIrmBz4K60FqNekR3y/oyGhLCM+/2W+S97ikGBYAPa9tSthOIKJf8oQyrrCJVMv8HplCk3adRrTtN0YuSLLM4tvBBb9gEIhl7Is/6zEsRy+9QCP9Sme/kO27+7vTfFiXdwuoTqmxKVWMGDus8YeteIZgyWYHAJ3r1rxaJI1tAGB/YhYs2bYATifFWjObDYDD8T5XwK6R7Q7Qn6cML2HROSv4EvA6xn21mlfA/Zx0ttA0RJl2068WeO9WY8kfgP5gwrPe/AApvxng2z3pTYiXj5x29KSYFxEBjyGhE4LlnOR5XxCAiHMZsEwbsesqzBzQmpVYErW/Kci6gCgNwFLmxaJmwcpMFfS88S/FQhksZAj5ArZWrbaMWu16J36GVaz/AFbAA5mVx0sRgmWrEwPz2rbQdY+oVq1atWrVqlXLbP8ALD7swRCgEUgAAAAASUVORK5CYII=",wq:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABOUExURUxpcUBAQENDQ0REREREREVFRUREREVFRUVFRUVFRf////j4+PHx8ejo6N7e3tPT08nJyby8vK+vr6CgoJGRkYKCgnBwcGBgYFFRUUZGRknouq0AAAAKdFJOUwAVMlVylLzf7PdB/fgsAAAHtUlEQVR42u1c27akKAxt71qAeBf+/0dngZaSQNVRwbN6ZsxL9+qiZJuE7Gyg+s+fxx577LHHHnvssceiACPCWpzlpZSyyNNPM0dpXkgpyzyLfwtUoiZcrcpcwKJsHyHz5Fdil0tgpT1rWsEh2f3RjBdXjX3bdsO8zIqGLK6ah67t+kn/vbgbV6xySnT09SLKmsnGpb051usI1v8Crkj5amKvdU5CiJ41NSOocLfGCK58mt8KS8VnJMachHUq8XdnxApVbY4gzYyQB3eWyhmAilDegzCqEDZgBKkbIWUZ3essDucknKv8igxnDWgE08hvdFcp5YTmJJy3xqQKOEUjaq7Sq7hvGUopWzQn5XrSd0oXUo5ohII1GA4NX97drlCTVnvyuYArhyY3ppZwzKlTJ9r8yR3A+Z3JlUk5u+ZUNSLeYDE4gqkRXPwqrGXODnirflnuvNdbqoC75oRBbF6WO3lzZ26plOf2nKpwvZd/JWXvGNFvYb6pyPewZmlXiL3M54oGcJA18PK+cppLKagVw8GIkHJohwfo+pDd2JcqasGw1JyFSQSCoRBqerqzeVZ9TQtDpPuDBCyLiYIga3fe2tmolbYHSddv3E2pFmKuTVijvLeBWJ0hJ757Q+DeU3eK8x7kTnfWQatD5O5tpJzbd+5MFgnHWwJSzvul3U9CichV6BV5gr6faFnTv+ftrEnTrbrRJYCyjA8++0dQ2a6pytQhAvttqQmHxJi3II+2HjOfXZ3SakkJdF6B3nZPe6YnrqIPNVd/Wnx9dnk86wyht0jBKvkAi9hRVDGst08HXN5T/OzDFL6utrcUtFZSZBQvpqOYu2NIaqND3Auy8ezp+CrV3+z2lp2p/KhiCKshIH2gIOt3WIqjcd3rDTkwoGd/V6hAUuEqHZuwmI5i6ozhqnkixBJApPTymPpI0fuod56Aq2Ozv6FAYeiJJwIxR1+eTerxWBgL3YKCb+rWJQewauPTEelEs4PoAEkXi/oF/W0jjhCmQ3RxJKhU8jFjaqwT8Wfxd0F3SKwpP8MXomvTmwJdZjoT6sTJfCMASyknYsE6JNYyLZwtGTEbtVwjd78vjCEhsInPrWfrlxYHesTcksX12sjlBiwBBuxRzKAjSY1hDRgWg6/8BdaANxl+gMX2LYZS7TOBVzKjX1jPfjch+QFYk0N0mW+UQRmxFrZ4zboWIjZ1q44EgsWPeUsLegsWSHkLFmtWCZFBCYJhZcjNi7OaI7xoaUH67sbNBTWhV16VIo4hoSCfLWfq5XRIQ0YVejRdlWABVgXK2+XR9rQERqiEfqb1mh/lsa6mQX4egZ9tWHSJoiNIEFYGBEq9Ce4DGlKVnplBd01AR9iwSK1ks3L04PggB13ACAV3K1Ab+c1dCJfuufLIWOdodqrfGfsZwVp2zylQtgrVwUZQKT3RgBxoTDVYoJ0IHaylBcYx1A1C/hlVL44rW/19ObXMrNYGrtIBiy2nKIP171szr8+KZmpWnUWt5UdVxvu0aaYGwYgtNRHvLdbpb/DPsHIzN+pldZ9CpfJr0UwtceFywqqFxFVWu+WtMQAqtpZCKatze4RRpnSTWTXrbsUV2dVJ2SgdsdXNerWuI1Gb7K8CWF440stQUPTpjkyhwtitBT0r6NUxKrbut17aTY1wCq+4YjcsKhwxXHJO63DBQU8yHSxXP+79vc8GM1dq6yj2H2BpOdwAIvTYH0ys3F5wuaNFGue/tus3Wsj9o8f+YGGtLbqsH8mIy13ECdZa0+vxweX9wdTOohUXdSFwYl3Kf+c4jrm8E2c1OeqpeseKHLZaosLBjzcz32oEc+ASx2ExtJ5ZgA3x2FUi6XQGFoGo6LbJ67PHm7s8Q6f5BCwxWuquEZ4b4omTaOh4AtZIrcOWwfv0oLTkhJfxd8J7nlxnH2rnNau340fPw8XI1dtdNbqdAFW+hxoWMXqHMMhxWeJs+jxCGCDh3cR40d5HniLIcVnqbq+uJpYfHX4nRo8QetLhd2K8HsJg58OxWztcC6E3Hf5AjBdRNSLY+bCbGC8lFrgFEOLaVhhUQS9y+RIj21B1Ie/aeBLjllhh6DAQMRqomrC3R3yI0UAViA6DEGNtwBKBb49cJ0YTVR/8nsZVYjRRBaNDX2KkANUN16UuEaOZ7UHp0H2P4BqqRtxwXeo8MTKIKigdXiZGmFah6fAqMWJXBaZD17WsK64KTYcXiNEFKjQdniZGJ6jwdHiKGClzgwpPh67bdSsE3jRt23W9skHZOOo/hr7vu65tmhvpEBEj4203jNMs5BET8zyNQ981N94ejgrpY/kd6zBK8y8uMU18dOTpm5M/H5iZv1ZbAtM2vGZU/erHNqpyv2m7XsXb+GaVhgS23X6cp4HT11mjfJjE+ZuTR3hHyrmvXz5W9+4f6HmhmpqXvy23MrNg5UrfrAxgyw/0QsQxrtT1A/z410HSViPBN9tAt9Tz9U7mC/947LQtz+iChFEJ/dEbkYktSIeTBj0veB98JgFiOJGwNgeIYhVgh9K+GuHb1MeBtr+tOwj+LWkdGBb3b1TTUwfTx4+vE29YIjQs+nfCIv6KMQt1EPUvgCUeWA+s5XZ0H9qCpPwt9t+ElRb32K/8by2PPfbYY4899tj/y/4BGYsA2gPdkaEAAAAASUVORK5CYII=",wk:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABIUExURUxpcUFBQUNDQ0REREREREREREVFRUVFRUVFRf////39/fj4+PHx8eTk5NTU1MnJyb6+vq+vr56enoaGhnNzc2JiYlJSUkZGRt7Q2EcAAAAJdFJOUwAaSmmEosHg8fYyyCoAAAXsSURBVHja7ZvXuqM6DIXpkLjhut7/Tc+FYSeAIQacMudDlxPKvyUhL8meLLvssssuu+yyf8+KheW/gNVhbtWF9Q9iKfow90NYt/to5KewyJ9dWBdWstq+xKq/V+8n1WqG9cUKdmEdru3kgXX/br2f1vb7A+thX8Mim3ZhXVgX1oX1c1j3n8TS/WjsCUb8/av79lLdP2GZ31EQz95SP4NlnzNKfBUrH60F9DMWBVCNP35N0+cA5OQDtED9sbcXZVXVdV1XVTlpHAoAfIKlgXZyZ1FWtb81bctR1O1s+NHWVeF/qwA3LVcSQD4QVc18cNKMN55mWo5kxjfkWdYAZorFARRZllfNyn1tddppxePZzhpjjHXTNwBQy+peVxP/OmuMsY9bu3NgeT08VktGbjcv2ikTUtunl4oZ1nNBNUqKR1VjQg0/duVxqtKHT4v77Xa7T1dAKtSIRmdY6g+J0+VKSaW/rznqMO8qRZdM4x8vDRapNRRUI9nqGi4MAHSHcj9vAECz2+22oRSYcmrhDzjFtsVF7wCgPEolb9tUhBC6JJCUvDJmjnE1ABx/CXXcFHwh2Z1Xlr2RypfdnVwlAPdeKu+vds/3mHdDBMk7jWrsW9UbAP2bfUUI4XZXGAsA+v1UhPWYqo2XznL0/VSEcr2jShQA1LsTy0dRuHh3NYAjH3AWIYyr6OzKvbM+QEUoFy72YywBsE9hcQ10sTG0H8ksQgjnMjaKL2LIeyl7TmOzR0jZC7aeXDwyigUAvuYsod2fxmMvmR5X25WrGecGaCJTi4SdxfSkVdB8eym2EzkvV7AUgDjtYMMxZHbew+gNBbq8OIz16N9eZbwOYlELAHWR+wbQ+0CsfGJez3d1mWdZlpdeUwY/xT4u51tABVNLTfuCoSuS69qzLaepARbC4nHrT7eCRd1cHXldHfKXWU5rikBD6bHipnMdIEMxFAFnV7OR2xNWWwTKYSi3IrGwgiUDX0y+jlWHvnAawrKnsFRgrd+DVYSSKx6r+zRWXBBbQK0FMT+BtZw4EUJ49JfYACaExQKj0B1YeRcYC1AeXbcqwAWLvFm6awdWHbqUcb/45LFyi4QrRHMUq0CoPnAeLbhyADIoIJZtXTRW3i1GrEMMuY1TEFkLmCAWtfP0isXK22CNZ0NqRfU+FQAWFDbczZ4RiZU3QQFBhxgij20xdFicitn0JxKrAWBpMLOEi4yhfwqLmrLEYTUALAuGkOv4dr9Y0WxLriisGoALa5pd7WvWrOiVUXX9TT1jsGoAjoepuNkzG8nDufAoE10ejVVtUUlEZ9b4rLUwPnO9xirDStFTCRf7GT5qV/B9f1xep77EKraouN2741iEXT881Iy+f4VVIHjBQKX3hfAxPF3jsgDqoiw3RHNTlWXZBXuQgUo9Jem+UfNa2jMX3j4P7PqoNSp5ZADuq4RZ4+IuEstsUh3Zxmi3uMSwIWdNKAPVuEu39PdA1bujG+zbXIy9HNrQwDXPVAd3tPNuq3wdnbOdpcqyIjXXM1WTZT/ClYgqMVcyqqRcCakSciWlGrhUKiqRiCoR10hlU1ENOkCmoOL2zEmDIJdIQGX27reekDnxVDotlVfR5iyVPCKwXsscdY5KuEMC67Wc4DOBwIXopZRKKaWUVlpppZRSUsq+F4J7/TBScfOOs4LjJIiJXik9Oy+1as4ao5WUYnfztSe9rMVBc3Zv8xUZxWrjlRNzq45si9RQ9fPjrdFKyV5wxii5BexOKWNc9FJpbZ4p2zJ1AD2QFIzedtqd8v5vZzGhx/xumJHsdsLuXHm0MiWV4bfTdvw02Uoj68SWH+a2AaaRqKYW45mpKQQhEScS7mQBKncdq9kOIR94zmibkU4nCaM/cHNPdVjD/1fiNkVmOZq0hZUpsqtL3VgH97R2l/etseBBM+fX7GJ9Rn/mqOLZ5CoBvONk5/nV0KbGEuclTn1Cw6+eafpdrOL3sFgSLP2DWM0bsOiF9XEsq1JbEqy32P8Tq27fY6kb2csuu+yyyy677LLsP+d98B4+O0hIAAAAAElFTkSuQmCC",bp:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAwUExURUxpcSQkJCUlJSUlJSUlJSUlJSUlJSUlJSwsK3d0dGZjYlZTUk1KSUVCQjo5OSYmJrRYvAoAAAAJdFJOUwAfN1Z6o8Tg+2/nYHEAAAPpSURBVHja7ZlNTxNRFIZb2gpL4kKX4EbdlcSYuMMYEt3Vf4D+growcVklboDEWU/5BdA/AJxWtioUtiXktluRxApoGejHa+5MP+ZOKb09lxij8+7K4sk5Z87HO0MkEipUqFChQoUKFeqf1s0Hd66J9DADoPbkGkjRp/D02pz1DB29N0XdA5yDtVzhK4CXZqiYhdaGnSOiggVnxoiVgrPqoogKwKkJKg7s2yvkaR0wCWwWdTtLHVVxYtAPFjbaGUrt4mySzbqhhCXL/9wgxcNutYgoXzJIMg3bJp/KqLGbCw1/ikRFC9NMVgLnvspLVgWPmawJ7CspUqGEV0xWEqtZlVXGMXuA/E9RsgR7jOZbarkk6ye3JZp9LOsXk5VpqKWXrBqblf0rWemm+hipyK/XfCvAEvznmEKuj3XK7nsVlRf8vp/AUaBc/HlMoB5IscJerDG01I4Q/P0VyWBbSdFgr0Zm/QUrCGGy72+g6XuIMkX+HYpaOOhlKMom9zEy2w2sKIQwutvST7gVy0tUycxPjFlwJGpHyjJKMZICvnWr/8nIGt4FlnurIl81sIZxQNn4woLDvLVjGWkK/Y1fBmqT3GLtK36iIB8lq2S3gSVbObYF2WKsks2iYdvKgfTG6ITF+rK5uUYBVpnFSioLp50jc0tP9eZaYf1gsMYD296bb97GT6ARPEPuruB065i67b2whAVWs6a9Vz3RVtn7yTMBSZUlvJ/vmOfxMhZvuKNzc3NzGafHqsk/GKzDTKvYYbH9Ukdo5busMzPUGJrUCayKSSNWHHXKd1lm79vjWKZOYBWDq+312BF1AivhreF3gO3O9Iiy2XeAiOV0p1o2mGnpu2Mtqnwn55Z+qbduRAUvjMq16ds3JZOCRS0n69uDwvD7RNa/CKsGHZbC/op/QZfYrzCRGJze3S56K4w7Rvdx4bvbXpILbFO4YQevozPNDKvh/wST987QAq9afZaJ7X9TMqwV9d1KBsZ4lLeAz6plcrMsMQxY3ELdtu1+c1Id+XNmNC29qp3tdyeje9ZHsvCBFNuwEkZ7lnHXqwZTlNpxPevMSM+waV8WlvdqZI2ye2LAhh1oCB9td5TAku4zzNIgVUdwOxk3rNxA1kf9KxJ3qzUYJQPTtU5TWLwqQyLa0k5yHquXtYN/AHSnMipTzF3JIsvRLdfF1RkS0Z5mwcZxOCwsWtc8u0llNQ/qimPNARrU8b7e1xyjtDM0RSJNI2w1skNRVD3Ta4n6ynBWRcsIx3AxPEXa0/JicZyTDmtGi7WowdrSatZE2wteD2tZg7Wuyfrwfbj0bF0CevrjrDd64v6nKFSoUP+zfgN+r0dDyFRp3AAAAABJRU5ErkJggg==",bn:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAwUExURUxpcSUlJSUlJSUlJSUlJSUlJSUlJSUlJSwsLHd0dGZjYlZTUk5LSkVCQjo5OCYmJvq3tckAAAAJdFJOUwASKUhtlMDg/auJd7sAAAV0SURBVHja7ZlNTxtHGMeNwUmOSEmbK6e2N9Nbb6GKWvXmREFqb05U9UzSF/XoSk0qIhL2vHb7AWz6AYpnnV6LjMXVyMz6CiFh1QL2FrD/1azNendnvDNjVlUOfs7Wz8/b/OeZZ1OpqU1talN7V+zm3cRQHwBLCaFmDeAkIdZHQGKOreD1TkKOpdE3f0vIsQz+NUvtZBy7hgOzVEvGsRvYMoskGceyKJtFkoxjOZhmkSTjWN71WDVg+eMromYKPY9F2gB+WV64CmsO5wNWjbU/ug+ulPrnAxZpejA8W5y46wvYNM0SYxHL3vdc+3RC1ofomaa5QQZmNRjNvT+Z3hRwYJom8a1hG5PCPkE/4JbnGt0HukuTFJG5VSQkCuvo98YdL1skbNsM9lS7iAa2whEOckYd4JEm6/pln3IwA90F3WO9K3CLpcwGftY8iq7QLUJqtKmpQd5RLIlYhFJDT4OusaM4cKPOOWbrOZb11JkQy0CPd8zBsY4KYhAiU66WyDENxSj0vSpaTBzOuVJSB9+qn2uWekLIK8a64HusiY7WJcvStSNk1Vgp76l3/a6XLoex1gRt0VTP/h1seiyDyV9dcJBsdOc1yshS7x7tr7dEvU8d1SBnjJ7HqrWEnc8qqRzkHM446YokzFat5HU8Fx/sUcKoo9iuOWxKWW08VhacUhyrxoI8VuvUc4EO1uqh5FO1hGUvBSccV4SllrCCN8JxtauHCknbKh2WQU8QokVbYVYTf6scIFFHNEKsBkv+iUIVURZUkUZZ1OgoSP2FIPMWz3IwL2/UA0GINRrK/YC1JL383bLgkqVhVs1L/kNpiOditwSsx1Lp2hVkvv2S0ijbxj+yW8MVZR59nkVlTXEbZ4IQ/4IrYBmnstfnlqDnDeDtHs/qSBS1L3QLeNniWA4kD+wzPvOWgR/Qa0XEkLEW4kPcNAVudW+iX+dY7VjVmUNP6NaTGTFrSXJp+Jmnw2y30ZmfQZ8IWPdiFXWzGDjNe8PEP0rNRsYwhqLNWFYOoxBZqfa8UeeU6eOFiPUw/iEbDmPPBtxFFvxaRIHkrH4peDfvr7Lh5L7ncItn2bGHO+9uBAZ5w3uAfu0NGC4nGzKhyKE+Ynko98FAiHoCVrxfWRz6P28CnW+WF4dCtMa3BLXxU6wQ+v/fcHAy799ykYGOKrBmRxM4Dczd+UhHWFQhxlT+8qxYzZHSvQ/UBemSiXQGQ1jD8ZsnXYiO0g2q0F+p1BeA+8YL0V3wH97R8ZdShTOUSqXzANb3AiHOAS+IKF3y6ST91WBH4vufj0iEny6J5njzxOeD7c28n/hDIkyX0gR260v4D/SZAvfouwxRZaBgm+PP7vqLGLc+JkRqdHX3Qy/ImBBVhqbwfsgl40Kkes/udIF/pfkh2lov5dRt3q1RiLbKwDpqjxXerVGI8vkrfDpdMjZEtaE8ILMvRAOiRqsG1uSojw9RsVV5lRWEqNdeOe4kBqpIKU41qmi4JCZErfbKCEIMsJqxNwd3wa3FhajVXnnU41htjcWVKF2B7pJNmJG7MjZdWuqVGS6rrO0GpUcjeztBS9zAoUWPVg1w5q6uH+m1RBariLFVjZa4VQh5MrQg7anqcXxvENs6rVcrZTNgxQrZHk55z9Rg7GMh3lTNcVbcYGu27xT7FIdlM9Z+N9TWrBngtSmzkqPUFjm20ZHarypr1rSB8jDRlUr0NVmtVi6r8SeeKAjquVewOKtWTLOkEGQWu8UNIrVq2XEV1h1EzXbklVxxFVl/yK9IbhIcZ6+k6460QLnG7A2lI8Usv84eY5ZsdcI+diizjqWsNUUWkbIyGqyTKesdZq0fKZoCS93+T9bcj+r2fWpqU5va1HTsP1MAb+04YA6IAAAAAElFTkSuQmCC",bb:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAqUExURUxpcSUlJSUlJSUlJSUlJSUlJSUlJSwsLHd0dGdkZFZTUkVCQjw6OiYmJk6AIV8AAAAIdFJOUwAWNFWCq977e1jxYQAABNNJREFUeNrtmb9v20YUx/XDUlZrSScBGVJkMpCtk4AiuwAXBdqJQIMk3Qg07eAkCHfSyB9ACegc+9hdgk+aGyTSEDsSK4nf/6W4H6QpmSLveETRAHqbnfiD977v3feeTrXaIQ5xiK8qOpWRHtpY/lgN6luweFYF6ggifqiAZQEfyQRYHleR1tgj5C/gqTHrBCuXEEJGWBizbPjnjEUdPDBENbHhaZFgjlNDVguveFqEjvDZkHUP46HIa4IbY+l9IvKi+GLMGiQs00b2MCSxXgvjvKRcdI4/DFldkFh6PDZktfFRsEbGbawdYS3kMh/VWgMhZ02q8AmLF1lFiWwoompOIzvbeO0xlwjNS+wjcj0m15eaeRsxdrlcLytQfu2ec7m+Z009NXIvXHgkkau9MEpr5Q5JIlffoJktwPfEdDFPrTsGVtGXadEpT6gFlE6sCfiuPIwPuGeUT6yHFWsiCaizFOpR8H6WONYOLlzhg1z6OkIyLTmz97FmI08IneCaz+2GBCUd0cKYK8+s/hdui28ImeL3UscncmWJU65SD1eEBKV8rIfXosRAttHi1l/GfOo2fFmibKPDjIy8L6F+C2tRYnzLNrDhPzr66vfwIS6Rcn+Ob5Gp9lJXd+DzQSUBnfDTyNtI2Ia4MChRjESXtbFUkSdxiZx1yosWKP0i7bhEQuV49WOWbifZaikmIqByvOxQsgLNzbWNV1IuzjpOxqvEXdnDhZQrkKMajxd32WstuUJXysVYC171WrKI3obYZBMxlNIL9zpKsbQEazG5blk3/FdvEtZUR7AuxlJ6QqUTxkud8LOXOheQL6XnrM980U9Yequ+HcXSc9Zv6SPE/V9d/Mat9MlxPEmzxMQp2vM/W6yt4yhYj9Wn/kMsfTZLo5HdZOozjjZjjbiEiifIv8sKU6yJ+inqI2kjL4iJY6VZVH0orCiRfh9L2cLsTZolb8cozXKUByzx+hTL3mYtVe+gXdbxHdY8VB77VdJGvshlsFCW1el0OrusY3XWeZrFoxyrucUKjFgNuT7LkKxNFSwq4ir9Cy0WyQmq0ce6AivUmPsClvLc15y1l4MKqM55tDfVsazIyy9Rw3P6KGTdqHv0MJ+l4dFdFMilcXe0b+/VfSzlOy2102TLNVX/GNlMHeSstKRtKx6iKJ+lPvZbF1hWiVpPmr294vO0JjrL7ze3i1tWWmKLUv80lJMWneu8BjT2iS8sVu8xzEJOWpqPYSfZglEpl9ZjWCtzWkVaenKxj7Xh3rQoljWt6GcUGcQlaj6Ptu8WKVH6L8ANZ3f0Y1SJF+Deru/QJK1rTVSthTATNSnzBGaxxFhhMxZns7ez2ewTS0v/DabxHeAgK55pfuf08CfkxIsnGjn9nP7L8IzHVpLPVXNr2vz/v/17djXw3VR4AzqbnfF/XKjB6haAT5dblC3icMRgSkP2CNjsBYk4n6t9Hdlw2EeFgvCmStN/H5HvFsMcFc9nT6FC6MFgd0W5vBwMBgL2TmFmG+wp1BvkLTrkkrVXwfRbWHm5IInz/yw+l/uvxp14XyxYL29f2vKz4u9c+yCKUWzVOWvJLquwkXakyirey9VZ80KWs1FmFV6TqI5V12CF/0/W9OtlRTPFcIpZ6vGfsn7ViNohDnGIQ2jGv7ULQsgUpwsIAAAAAElFTkSuQmCC",br:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAwUExURUxpcSUlJSUlJSYmJiUlJSYmJiUlJYiGhXh1dW1ramBeXVZTUk1LSkVCQjk3NyYmJt1oLkIAAAAHdFJOUwApUXmew+Gm1HRSAAAEcklEQVR42u2ZvW8cRRjGf7N2QBcRMnM+UlDAnnEoaEj8DxBb9EhBQqJBUESpIKHmP0AIXUOBUuAaKYEORQqJKwoULIsCiRDsoySxbkdHsKXEvpdid897vv2YWR+EYt/uZnefeZ73az4OGmusscYaa6yxo6YcXukaiAb2+JMtvSOxXVo9NtYVSW23rsb2otH73wACEJn03RcuSLS1nf/NfO5o8OZN4NEpUBxc37JLoTKLWlt47Wvg0q1+7ld5gwsf3kx5KPY3bCdEBvHnGuDaL+ddsTo7PSBKngnBOQCLBkLZttDaWHHTOPcQDq63WQq1RQGLyQMNqvfkS169qLl9ftOFl4IHn/ycEFFYFWawGBG8tGUTsZVYwuPPCcESgsIupMMaAoRlGFiso+9HECYfK2xKK/7Zn9OAdfS9JCEU1qDFcKymByfZ7Mb6XHmpBCsAGGamIGQYFuZ9Aa8AEBTosZOTn8NErjsvAGyQxQIFoYTFdZfLSyUAJ7MEBAVrkkJb13qMsaxetlnvBIvl3S4P6+pnCRY/JS6PmejfD4O851iPVhXKGEMLzr7XRe/b2AHaVWPK6+DWxPDdPH6VGit6sfbTWMtq8FJevs937b/ES82Kl/bjFVbqceW1W46lQfG+I9aoFCtOmL4z1lwFlnbGkqsnSkIZAnrPusZxkwulSaTYd95P/MBCocIQMLznXHpqxE5miVcaJBHV1qC6GOtcxq9vcr8PqK7SJh2MxA6CGOqv591bQnCAbCljpp9EYKDb9yjTM1JmH/jtMd9YTwtK0j3mmOWjU5578re+RaIosihzWMwGA38/57GmJQV+N46VDKLuobciFsWnTxzdMci2rd0Lp7qKTBw6VA1eWRtMr3i1sdh24FX4QEa3JydNe1pbK09eKmcPW9Xwi7GOhr4/ThZ9nDgeJXZcjZllUx8fK6qPZQtEyyx4jdF9sVo5uwp7eP7wwtIlkVXeOWGd9hB1ecXw4s0r98Bj62nUNe4hAp8NlszQX1LeDP002loaeyV6Wn5YqjTntCeWlCTxTLCkDq+ZnTuK/SX1/GVLFgI9C17U4dUq4GXLmmHgX9qFrAP3Vlh5HAw82lf2AuUpaZwplpQl6wx5WT+sXmk7bj2t2i5sX6XFHdQoR+uJJTWKe748kbRBnU4ucCyRWN87PlDYttFqcvp2sjuUoRcvRadTMLmBts/dUefKxNEzGg0iibIjuyuuETt7L1Yz2I4mPKS0Me1ufCR9+4YTVuchcH9ju4h1+5VVYPWOA5b6qMdvN8qdcPYiey9OxXT65ubM9/z4XYVDB78un7i3WZ2r7/LgziRzpYw5Erqdr/iiWuP8E/k0drTSmbP/+OghNg7HZb2yXoX1cv/PNUzeNUcGMop45uPh6apcPcd6u1vhLmMY/DHt6imsUBYWHNK5beyzVb5XPXGrDWVbugIrcDhzpufcsIqXR0/WlViu/6WKA9bseM1yHWp5aOz993vfBst5fXQqbUcs87/UuHfZ/dvHNNZYY4352T/ZP4i5JEtsbQAAAABJRU5ErkJggg==",bq:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAzUExURUxpcSYmJiUlJSUlJSUlJSUlJSUlJSUlJS4uLXd0dGZjY1ZTUk5MS0VCQjw6OiYmJh8fH+/JGhMAAAAJdFJOUwAWOFp1lLzg/a0PANwAAAbDSURBVHja7ZvrlqsqDIC3ipqRW9//ac8CvJAQW6ph1l77mPk3pfCZxFyA/vnzyCOPPPLII4888kgnMEJW+nEC7/08DWcrd2qavfcwqf63oIaw4CowcmDdeIzw06+AdZNHAkMxRAEeMra3Zp9U5YzWxqXlRzIkqQqyEXNrri5S6Z+fn0VrrY1/FVxRm27ZRrjXL3AFKrdBBYHXy/vcjmrj3kbYgD41pRopVdIGHMroA9WCRkQu1dKEwWcQlTY2cI3IhIhKa2tfr5y8ibLImsZGZXSZsmxmwYTl2qprTibUGCtfNICTEdpG8rldcEjOvBAs6w+XnqOyFooFmULlwzuvirAoHM6nyYgAHhTaLNir6PCFsuKi3a7PpVRWdHrV0OOBUVaBVY5oj7WUa77DMu2xQgCn0SH6lt+wgm8tzIiANbR0eUZZAWt7/cF7s5Qj3OvVzuWDLgyniiPMT95DSZW9qy0kZBbGhtnbHxRqC+6grLFhXRoyNefwMyoxDFWWbxm21kWpMjyqbMJrAURZofhpWtnEssWi+E2rqWmtTHMjty0gtiJvXTUuG6pAVHvG+hWyFOBpodiiFVwLdXuehPvdAU2IHa8TqmvqWxu9shUcYtfg8qpmKBS6GzHW1HNfOfdHqKzRA8V85vZXrXj3j9BlkjJJP9aN8KHNPA0EuNGjT3u4fVoY+XN3QKdPZ7ajO5v7k1+jRm84wdKlFVUWuJjw/mnuD1R7oxcTMfpul2GZaMWJteGK5WlAzppIqOfqSaMXuXI7ESz8LvZ5Iki6pHObrMJ14R99bSRfsm8a6zyKmD3OL66I8uTDDs+dt7bahLnnShMaVLGngmrgsQzqMOLCQJrI7s3cmsz9TllAvklWRlgaW7EnSRP3FuXcoeeu2Qoom66U+bKHHhCWKfpEc4bFN3TgK5o1VTRdMbP5rC0ecNVF+0TQZ1iKaegMkyf4NsLRXj1hjfns+HlRi2Hx9kO25lTMnSKM/1wjTrEtLrAgcwCCpTMrjvQjimUZLF+LVfYu77Ci186MDVks3NsW79M5lmMaPcieaCRrm72apzZMWOp07n0LY6zwLWCwcpenWMfi1IbaIKxi7uQhNbtMQznzGiD6U6zdioA6kO2T8XRubWu3TTpfmCgpa2aTcRaqe9KNlVjU9fYWpSL7jKV/xFUVcj9d2mosbUixRtqgrMqq6CG7rIc4KvK8jyixdFRnB/wHE+o+XLkNUNUWjSdcU5dtVZLVYyFQ6JlgZT0R6rcr93Kmo7XBXOdYOljRFzZMXjeVVLmuajvbdFIBlua97fuMrdY6k8Hdd3PiWRHut1MLOdV2GdtpE1CukZby2Ip4P2fHnWm3vYar1+srqr1JzVePoStxcVjRiWjcWLGgoDJpC+BVdnsfG0Ugy+xcHYsVrej4f2/PiXZywt7FfOFIbyRGSVzqBCs2C0azxuWo3NXd1I4+fvIf1bPra8PZMNF2mMqsyrq4izMV6THZkcfSwNgwYWEqfXN/sC9TnFtbdA7Lsv/dvkE26+DG/uBc2GXj4gA0Z8P0huJ3et0Qv7w/qEqANWzqarGUymw2vLwTx+XexPUllrtWzNTGiJ2rHsuQ99neig7MPkf2yn2H5crO4Obx4sRpxgDUY2n8XPa2w5eHEsf7+AWW06yy7p0ezHzsvijGCjj8mdNfFyvh8GxilFHW7UON6atwUEMlclzW82XMdRMKOLyo01srEx1OE+MdE9btsl1LjHeUJXWvRSZGWCsWHd4lxosmFLxtM913+p3Kyp0PD/djhLWi0WHv7kGGSvQi112nP6hEr73dTIwGKUvwjP9WYsyorOztkTtOn1OB8O2R64kxp7LSt0cuJ0ZE5cTvaVx0ekTV4JrntRiBqRpcl7qUGDFVk8unFxIjobItrkt9HyMIlHh0uJQYqapa3Wv+zulLqka3wL+JESWUdDq8kBg5KOl0+LXT81CNHL4yMZoTqDbRgU+MxqwUbhMAF/5WaZoOqdOH+4AOgPzw6VQAImbDXz10s78jTX6C1KnpnUZyOR03SZsxv/0YMJwNTrYs4frZiSzx3ryxLucEJamy/WYlOPsO5RRxu57o/TyI5p1wSHkBCLElNCVJ5e4xrWTgvRcK9vtP6CTEfHPT9FNd6hfizFE+paFFrwPzL2tyW/RWht5xrvfWG58WMWOXfpF4BwjD/TgJdSm5DfDszGwQsCHIYmkQsKLkKcZxfD0LvIdWGMv62/3iIHoUdThXfx9L67/O51UDLP3PYo3y8SFiqQfrwfprsbyTFhmsFvJvYqm5jTT7kfUjjzzyyCOPPPL/lf8AtuykcwsccVwAAAAASUVORK5CYII=",bk:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAzUExURUxpcSIiIiUlJSUlJSUlJSUlJSUlJSUlJSUlJYWDgnd0dGNgYFZTUk5MS0NAQDIxMSYmJtBHgnAAAAAJdFJOUwARMVJ8nr7f8e5A/hcAAAUDSURBVHja7ZrrmqMgDIYrB3WLHO7/avcBPCJgwNh29+GbX9Pq+E4SYxLzejU1NTU1Nf17oieRX8AaTSjWsP5BrOnPqvdPYb0XTT+FJaZFDathoeX2Mxb/Xr4/ZKsA64sZrGHV5/YNS2yffQ3rvSX3RdtH769hba6LqWE1rIbVsH4O6z39IpZaJXcwcv30649qtcPSP1RB7KR+Bkv/Dla3aAiwXKQvX36tpu+C0HLBxT92dUIZd2KMkp0VqDFGhlhDcOZy6uHM20iUD8HwY+gZ9VfgQcT74OrmE1kfDk56htMNEX4eyeyu0IehNUljDH29COsT5w3sts3o9re11kpprY9XOIWW7xTZ0b7aaf115LfAOj7/VTUJV54LIYRN5Ac4GWDtv9NKye17KdX85XgjdVDvPjUjBb5armDCZ6FakWTsUTmf19cazJtKxpj2ZPr0cYbJH+DARlrlQBdVKg01k51CywZXhmlnUFpLNeWhPNn5otOlvMHKA8xSaXHoTHGlauxl40oDTHWXqyy30uepPNdQcj92NjOIh6l8fPHCwJqeppozGC1yoXqeymaXY7WRl32ePXgPVpqLzrl9eh6rxFy9N5Z4HksWmKv7mLFsTwm+GZlPDh8wlvWiNmbsgD7UnzGWxVJQL3ofiozh1VWBMO0Lv0MhWO1FkvOh1CZf4xUeLZ0XB2BoJXwo9bFAl9dJKT6nCLBMB6oddNxYAVUe7HywSkQErI7o3YMnhuUuxG1/2K3dlsyWnyN378jmo1USi4KePDLqQ3t+T3b9Y8Y3OuwHafx/kOAx2JjCOlVHpE/Zy1fE3enxfw9rimHJiLFZwlz27iKRdHgDyySw7OnX45r00IZFOsoFi9/CGu5g0ZjDLRZs8DR+GgvmxNSdGMsvJVg85kT4QNrnrXjI83os27XoFBaFZvnEXU+qsXjsUKnAWZ66R/UUN1fQ1sGxqEkZyxZcwOI0/trk3NaBscgYTbyzsXpg36PidY0OoxOKZafkiRwPfgXjiub4PCucsgCx3PQnnuKhdY2vA2W8ZpbBlAWGlaBajQXy4dyQgaY/MKw+XpmtxgL2r8TNSyFcICyermmK2lc/GcnUdyMpwMpSFc1GSDwWzlwALJajKoisZErep4mZ6xrrkqpkHpjIMzsun+4vsahJJyzvwqKpLsm1D47LTfuvsMglVf8qErvmopTlimbG3NpgnmosfZXBc2EvL9o/nftaqqrA2idBAFceS2epal5jDFdpwr+Qk9E+X0Ooqt6SkSyXBAxtpMxSVb7RdkWSxh7/3aV6gGtP1b9eP8KFRIXMhUaFyoVIhch1oLq/pUHG3GP7W1Tz+32FRKWxqJLVyZepkhPGOqoBb/uH3eN6iOqizIFSHboTHPU3wkvdK2UuyxwZFgjbMqfS88+68ymX+kGpysq9pElzKMG6VEZuQaqm+SoJezBNhA8/sJwX2YVJVqWPGyi2C7k574oJId5p+QW0YANtQA0uNq4dQxYlibgtyQ5ojvQ7U0ZP71sS87s8ipizlk28e/KdGkXL8AYDyqqyaU3sTIkgmIVfqcxqOez4H01FazX5hRux3Vu1Wvlwtvv9wo1AWtawaBrDXDwzsKwsKDCia8RurB0WQ3hCK1wsmyV6jNDCX1UcEOqGJzYo70e8xsZCiPmGVfiYfgSLNiyoGtbnsRSyNArWI/o/sfjwjLAb2aampqampqam1195W8+wSJhrTQAAAABJRU5ErkJggg=="},Kt;(function(e){(function(n){n[n.DefaultWidth=300]="DefaultWidth",n[n.DefaultHeight=300]="DefaultHeight",n.DefaultDarkSquareColor="#000000",n.DefaultLightSquareColor="#ffffff"})(e.Board||(e.Board={})),function(n){n[n.Opacity=.2]="Opacity"}(e.AnalysisOverlay||(e.AnalysisOverlay={})),function(n){n[n.Opacity=.8]="Opacity",n[n.FrameCropRatio=.9]="FrameCropRatio"}(e.CustomItem||(e.CustomItem={})),function(n){n[n.SizeRatio=.4]="SizeRatio",n[n.OffsetRatio=.44]="OffsetRatio"}(e.Effect||(e.Effect={}));let t;(function(n){n.Color="#000000",n[n.Opacity=.1]="Opacity",n[n.RadiusRatio=.16]="RadiusRatio"})(t=e.MoveHint||(e.MoveHint={})),function(n){n[n.Color=t.Color]="Color",n[n.Opacity=.1]="Opacity",n[n.OuterRadiusRatio=.5]="OuterRadiusRatio",n[n.InnerRadiusRatio=.41]="InnerRadiusRatio"}(e.CaptureHint||(e.CaptureHint={})),function(n){n[n.ImageSize=256]="ImageSize"}(e.SVG||(e.SVG={}))})(Kt||(Kt={}));var Mn;(function(e){(function(t){t.PIECE_PERSPECTIVE_UNSPECIFIED="PIECE_PERSPECTIVE_UNSPECIFIED",t.TOP_DOWN="TOP_DOWN",t.PSEUDO_3D="PSEUDO_3D",t.REAL_3D="REAL_3D"})(e.Perspective||(e.Perspective={})),e.pieceShortNames=["wk","wq","wr","wb","wn","wp","bk","bq","br","bb","bn","bp"]})(Mn||(Mn={}));function at(e){return At(e.themeAssets),e}function _e(e){return Yt(e.themeAssets),e}function At(e){if(!e||e.config.perspective!==Mn.Perspective.REAL_3D)return e;throw new Error("ThemeAssets: Expected 2D assets, received 3D assets")}function Yt(e){if(!e||e.config.perspective===Mn.Perspective.REAL_3D)return e;throw new Error("ThemeAssets: Expected 3D assets, received 2D assets")}function $t(e){return Ce(ge({},e),{board:{assets:{background:e.board.assets.background},config:ge({lightSquareCoordinateHex:Kt.Board.DefaultDarkSquareColor,darkSquareCoordinateHex:Kt.Board.DefaultLightSquareColor},e.board.config)},pieces:{assets:Pi},config:{perspective:Mn.Perspective.TOP_DOWN}})}const kt=["wp","wn","wb","wr","wq","wk","bp","bn","bb","br","bq","bk"],Tt={"8_bit":["#6a9b41","#f3f3f4","8_bit",".png","#ffff00"],bases:["#c26b38","#efcca1","bases",".jpg","#f5cc2a"],blackwhite:["#667188","#282f3f","translucent",".png","#5b91b3"],blue:["#4D6D92","#ECECD7","blue",".png","#00a5ff"],brown:["#B58863","#F0D9B5","brown",".png","#ffff00"],bubblegum:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],burled_wood:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],checkers:["#e3a6a9","#999999","checkers",".jpg","#fae18a"],dark_wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],dash:["#6b3a27","#bd9257","dash",".jpg","#eca722"],default:["#779952","#edeed1","green",".png","#ffff00"],glass:["#282f3f","#667188","glass",".png","#5b91b3"],graffiti:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],green:["#779952","#edeed1","green",".png","#ffff00"],grey:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],icy_sea:["#7a9db2","#c5d5dc","icy_sea",".jpg","#5ed7f1"],light:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],lolz:["#909898","#e0e9e9","lolz",".jpg","#a3becd"],marble:["#706b66","#c7bdaa","marble",".jpg","#f0db86"],marbleblue:["#c2d7e2","#efefef","marbleblue",".jpg","#65daf7"],marblebrown:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],marblegreen:["#706b66","#c7bdaa","marblegreen",".jpg","#f0db86"],metal:["#6e6e6e","#c9c9c9","metal",".jpg","#a3becd"],natural:["#D08B18","#FCE4B2","tan",".png","#f0e464"],nature:["#8c976e","#c3d1a4","translucent",".png","#eef396"],neon:["#636363","#b9b9b9","neon",".png","#6d90a6"],newspaper:["#5a5956","#5a5956","newspaper",".jpg","#99976e"],orange:["#D08B18","#FCE4B2","orange",".png","#ffff00"],overlay:["#789ebd","#4878a0","overlay",".png","#0d9acf"],parchment:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],pink:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],purple:["#8877B7","#EFEFEF","purple",".png","#7dacc9"],red:["#BA5546","#F0D8BF","red",".png","#f8f893"],sand:["#b8a590","#e5d3c4","sand",".jpg","#e2bc87"],sky:["#c2d7e2","#efefef","sky",".png","#65daf7"],stone:["#666463","#c8c3bd","stone",".jpg","#36525f"],tan:["#D08B18","#FCE4B2","tan",".png","#f7d84a"],tournament:["#316549","#ebece8","tournament",".jpg","#a4c25b"],translucent:["#667188","#282f3f","translucent",".png","#5b91b3"],walnut:["#835f42","#c0a684","walnut",".jpg","#d1a52d"],winboard:["#316549","#ebece8","tournament",".jpg","#a4c25b"],wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],wooddark:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],woodlight:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],woodmid:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],woodolive:["#6e6e6e","#c9c9c9","woodolive",".jpg","#a3becd"]},fn={"3d_staunton":{format:"png",isPseudo3d:!0,path:"3d_staunton"},"3dchesskid":{format:"png",isPseudo3d:!0,path:"3d_chesskid"},"3dplastic":{format:"png",isPseudo3d:!0,path:"3d_plastic"},"3dwood":{format:"png",isPseudo3d:!0,path:"3d_wood"},"8_bit":{format:"png",path:"8_bit"},alpha:{format:"png",path:"alpha"},bases:{format:"png",path:"bases"},blindfold:{format:"png",path:"blindfold"},book:{format:"png",path:"book"},bubblegum:{format:"png",path:"bubblegum"},cases:{format:"png",path:"cases"},classic:{format:"png",path:"classic"},club:{format:"png",path:"club"},condal:{format:"png",path:"condal"},dash:{format:"png",path:"dash"},game_room:{format:"png",path:"game_room"},glass:{format:"png",path:"glass"},gothic:{format:"png",path:"gothic"},graffiti:{format:"png",path:"graffiti"},icy_sea:{format:"png",path:"icy_sea"},light:{format:"png",path:"light"},lolz:{format:"png",path:"lolz"},luca:{format:"png",path:"luca"},marble:{format:"png",path:"marble"},maya:{format:"png",path:"maya"},metal:{format:"png",path:"metal"},modern2:{format:"png",path:"modern"},nature:{format:"png",path:"nature"},neo:{format:"png",path:"neo"},neo_wood:{format:"png",path:"neo_wood"},neon:{format:"png",path:"neon"},newspaper:{format:"png",path:"newspaper"},ocean:{format:"png",path:"ocean"},real3d:{format:"png",path:"neo"},sky:{format:"png",path:"sky"},space:{format:"png",path:"space"},tigers:{format:"png",path:"tigers"},tournament:{format:"png",path:"tournament"},vintage:{format:"png",path:"vintage"},wood:{format:"png",path:"wood"}};function $(e){const t=Tt[e];if(!t)return null;const[n,r,i,o,s]=t;return{darkSquareColor:n,lightSquareColor:r,path:i,extension:o,highlightColor:s}}function W(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return[0,0,0,0,0,0,0,0,0,0].reduce(t=>t+e.charAt(Math.floor(Math.random()*e.length)),"")}function z(){return{allowMarkings:!0,disableUserMarkings:!1,analysisHighlightColors:{alt:pr.HighlightColors.Blue,ctrl:pr.HighlightColors.Orange,default:pr.HighlightColors.Red,shift:pr.HighlightColors.Green},analysisHighlightOpacity:.8,animationType:pr.Animation.Types.Default,arrowColors:{alt:pr.HighlightedArrowColors.Blue,ctrl:pr.HighlightedArrowColors.Red,default:pr.HighlightedArrowColors.Orange,shift:pr.HighlightedArrowColors.Green},aspectRatio:1,autoClaimDraw:!0,autoPromote:!1,autoResize:!0,boardStyle:"green",captureKeyStrokes:!0,checkBlinkingSquareColor:"#ff0000",coordinates:pr.CoordinatesPositions.Inside,darkMode:!1,diagramStyle:!0,enabled:!0,fadeSetup:0,flipped:!1,highlightColor:void 0,highlightLegalMoves:!0,highlightMoves:!0,highlightOpacity:.5,hoverSquareOutline:!0,id:W(),moveListContextMenuEnabled:!0,moveListDisplayType:pr.MoveListDisplayTypes.Text,moveMethod:pr.MoveMethods.Drag,overlayInAnalysisMode:!1,pieceStyle:"neo",playSounds:!0,premoveDelay:200,premoveHighlightColor:"#f42a32",premoveHighlightOpacity:.5,rounded:!0,soundTheme:"default",syncEffects:!0,threatSquareColor:"#ff0000",threatSquareOpacity:.8,useSharedStyleTag:!1}}function k(){let e,t,n;return{match:[{condition:xt([M.InstanceEvents.RendererSet,M.OptionsEvents.Update,M.InstanceEvents.WebGLAssetsInitialized]),handler:r}],create:({options:i})=>{e=i.boardStyle,t=i.pieceStyle,n=i.themeAssets},name:pn.Plugin.Name};function r(i,o){var s,l;const{options:d,renderer:f,api:h}=o;if(!f||!f.areAssetsLoaded())return;const g=d.pieceStyle!==t||!(0,w.f)(n?.pieces,(s=d.themeAssets)==null?void 0:s.pieces);(d.boardStyle!==e||!(0,w.f)(n?.board,(l=d.themeAssets)==null?void 0:l.board))&&f.updateBoardImage(o);const S=()=>{g&&f.updatePieceBaseImage(o)};if(f.name==="webgl-3d"||!f.getPieceStyles)S();else{const P=f.getPieceStyles();U(P[o.options.pieceStyle],o.options.themeAssets).then(S).catch(I=>{if(I instanceof pr.StylesSetFailed){if(o.api.emit(M.InstanceEvents.StylesSetFailed,Vr(M.InstanceEvents.StylesSetFailed,{message:"Problem updating styles. Will fallback to default.",error:I})),o.options.themeAssets){h.setOptions({themeAssets:$t(o.options.themeAssets)});return}o.options.pieceStyle=z().pieceStyle,f.updatePieceBaseImage(o,!0)}else g&&S()})}e=d.boardStyle,t=d.pieceStyle,n=d.themeAssets}}function ve({path:e,format:t}){return new Promise(function(n,r){const i=go(e),s=kt.map(l=>`${i}/${l}.${t}`).map(l=>Pe(l));Promise.all(s).then(()=>n(!0)).catch(l=>{r(new pr.StylesSetFailed(l.message))})})}function U(e,t){return t?new Promise((n,r)=>{try{At(t)}catch{return n(!0)}const i=[];if(Object.keys(t.pieces.assets).forEach(s=>{t.pieces.assets[s]!==Pi[s]&&i.push(t.pieces.assets[s])}),i.length===0)return n(!0);const o=i.map(s=>Pe(s));Promise.all(o).then(()=>n(!0)).catch(s=>{r(new pr.StylesSetFailed(s.message))})}):ve(e)}function Pe(e){return new Promise(function(t,n){const r=new Image;r.addEventListener("load",()=>t(e)),r.addEventListener("error",()=>n(new Error(`Failed to load image: ${e}`))),e||n(new Error(`Unknown url: ${e}`)),r.src=e})}function Ie(){return{match:[{condition:Je(M.APIEvents.BlinkHighlight),handler:e}],name:dt.Plugin.Name};function e(t,n){const{renderer:r}=n;r?.blinkHighlights(t.data,n)}}var jt=`.board-disabled *:not(canvas) {
  pointer-events: none;
}`,Xe;(function(e){(function(t){t.Name="board-disabled"})(e.Plugin||(e.Plugin={}))})(Xe||(Xe={}));var it;(function(e){e.Pseudo3d="pseudo3d",e.Disabled="board-disabled",e.Flipped="flipped"})(it||(it={}));var ln;(function(e){e.All="All",e.Move="Move"})(ln||(ln={}));var v;(function(e){(function(t){t.Default="default",t.WebGL2D="webgl-2d",t.WebGL3D="webgl-3d"})(e.Types||(e.Types={})),e.TriggerOptions=[pr.SaveableOptions.AnimationType,pr.SaveableOptions.PieceStyle]})(v||(v={}));function C(){return{create:e,match:[{condition:Je(M.OptionsEvents.Update),handler:t}],name:Xe.Plugin.Name};function e(n){n.el.classList.toggle(it.Disabled,!n.options.enabled)}function t(n,r){const{data:i}=n,{el:o,renderer:s}=r;"enabled"in i&&(o.classList.toggle(it.Disabled,!i.enabled),s?.setBoardEnabled(i.enabled))}}function G(){return{match:[{condition:xt([M.UIEvents.Resize,M.InstanceEvents.RendererSet]),handler:e}],name:ot.Plugin.Name};function e(t,n){const{renderer:r}=n;r?.resize(n)}}const ae=(0,w.c)({data:je(),initialState:"idle",states:{changedPiece:{load:Ve,move:()=>({data:{chosenPiece:void 0,didChangePieces:!0,mouseCoords:[...ae.getData().mouseCoords,ae.getData().tentativeMouseCoords],moveHoldTimes:[...ae.getData().moveHoldTimes,Date.now()-ae.getData().moveHoldTimeStart]},nextState:"idle"})},chosenPiece:{choosePiece:({tentativeMouseCoords:e,moveHoldTimeStart:t})=>({data:{moveHoldTimeStart:t,tentativeMouseCoords:e},nextState:"changedPiece"}),load:Ve,move:()=>({data:{chosenPiece:void 0,mouseCoords:[...ae.getData().mouseCoords,ae.getData().tentativeMouseCoords],moveHoldTimes:[...ae.getData().moveHoldTimes,Date.now()-ae.getData().moveHoldTimeStart]},nextState:"idle"})},idle:{choosePiece:({chosenPiece:e,moveHoldTimeStart:t,tentativeMouseCoords:n})=>({data:{chosenPiece:e,didChangePieces:!1,moveHoldTimeStart:t,tentativeMouseCoords:n},nextState:"chosenPiece"}),load:Ve}}});function je(){return{chosenPiece:"",didChangePieces:!1,mouseCoords:[],moveHoldTimes:[],tentativeMouseCoords:{x:0,y:0}}}function Ve(){return{data:je(),nextState:"idle"}}var K;(function(e){(function(t){t.AddingMarkings="AddingMarkings",t.Idle="Idle",t.PieceDragging="PieceDragging",t.PieceSelected="PieceSelected",t.PromotionAreaShowing="PomotionAreaShowing"})(e.States||(e.States={}))})(K||(K={}));var Et;(function(e){e.Name="core"})(Et||(Et={}));function Gn(e){const t={},n=e.mouseCoords.length/2;return e.mouseCoords.some(r=>{if(!r)return!1;const i=`${r.x}-${r.y}`;return typeof t[i]>"u"?t[i]=0:t[i]+=1,t[i]>=n},{})}function ur({machine:e}){return{get:t};function t(){const n=e.getData();return{didChangePieces:n.didChangePieces,didUseCheatMouse:Gn(n),moveHoldTimes:n.moveHoldTimes}}}function Pr(){return{api:()=>ur({machine:ae}),match:[{condition:xt([M.UserEvents.PointerdownLeft,M.UserEvents.Pointerup]),handler:e},{condition:Je(M.APIEvents.Load),handler:t},{condition:Je(M.APIEvents.Move),handler:n}],name:Kn.Plugin.Name};function e(r,i){const{mode:o,state:s}=i;if(s.get(M.State.MachineState)===K.States.PromotionAreaShowing||!r.data||!o.isAllowedToMove())return;const l=s.get(M.State.SelectedPiece)||s.get(M.State.DraggingPiece);if(l&&l!==ae.getData().chosenPiece){if(!r.data.coordsInsideSquare){i.run({type:Kn.Events.CheatDetectionError,data:{corePiece:l,cheatDetectionPiece:ae.getData().chosenPiece,eventData:r.data,variant:i.api.getVariant()}});return}ae.transition("choosePiece",{chosenPiece:l,moveHoldTimeStart:Date.now(),tentativeMouseCoords:r.data.coordsInsideSquare})}}function t(){ae.transition("load")}function n(){ae.transition("move")}}function Hn(){let e,t=!1;return{match:[{condition:xt([M.InstanceEvents.RendererSet,M.OptionsEvents.Update]),handler:n}],name:nr.Plugin.Name};function n(r,i){const{options:o,renderer:s}=i;s&&((o.coordinates!==e||o.flipped!==t||r.type===M.InstanceEvents.RendererSet)&&s.setCoordinates({flipped:o.flipped,position:o.coordinates},i),e=o.coordinates,t=o.flipped)}}function Vt(e){return{getDefaultStarColor:t};function t(){return e}}function et(e){return function(){return Vt(e)}}function Re(e,t,n){const r=ge({},e);return r.data[t]=n,r}var Xt=`.custom-item {
  background-clip: content-box;
  box-sizing: border-box;
  height: 12.5%;
  opacity: 0.8;
  pointer-events: none;
  position: absolute;
  width: 12.5%;
}

.captured svg {
  -webkit-animation: capture-star 0.5s infinite;
          animation: capture-star 0.5s infinite;
}

@-webkit-keyframes capture-star {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0;
    transform: scale(2);
  }
}

@keyframes capture-star {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0;
    transform: scale(2);
  }
}`;function un(e){return e}function cr(e){return e*(2-e)}function or(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}function ar(e){return--e*e*e+1}function Nn(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}function Er(e){return Math.sin(e*Math.PI/2)}function Mr(e){return Math.sqrt(1- --e*e)}function vr(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1}function en(e){const{animatedProps:t,animatedPropsKeyframes:n,frameInfo:r,isTargetHTMLElement:i,params:o}=e,{keyframes:s,target:l}=o,{elapsedPercentage:d}=r,f=o.easing||un;if(!s)return;let h,g,m,S,P;Object.keys(t).forEach(I=>{for(let D=1;D<n[I].length;D++)if(m=n[I][D-1],S=n[I][D],d>=m&&d<=S){h=s[m][I],g=s[S][I];break}P=(d-m)/(S-m),P=f(P),t[I]=h+(g-h)*P,l&&!i&&(l[I]=t[I])})}function qt(e){const{data:t,keyframes:n,repeat:r,target:i,onEnd:o}=e,s=Rn(n),l=$e(s,n),d={animatedProps:s,animatedPropsKeyframes:l,data:ge({},t),endCallbacks:[],ended:!1,endTime:0,forcedEnd:!1,frameInfo:{deltaTime:0,elapsedInterval:0,elapsedPercentage:0},isTargetHTMLElement:i instanceof HTMLElement,onEnd:f=>d.endCallbacks.push(f),params:e,repeatCount:r||1,started:!1,startTime:0,keptAlive:!1};return o&&d.endCallbacks.push(o),d}function Rn(e){if(!e)return{};if(!e[0])throw new Error("The animation keyframes must contain values at `0` percentage.");return ge({},e[0])}function $e(e,t){if(!t)return{};const n=Object.keys(e),r={};return n.forEach(i=>r[i]=[]),Object.keys(t).sort((i,o)=>parseInt(i,10)-parseInt(o,10)).forEach(i=>{n.forEach(o=>{t[i][o]!==void 0&&r[o].push(parseInt(i,10))})}),r}function It(e=!1){const t=[];let n=0,r=0;return{end:o,endAll:s,play:h,playingAnimationsCount:()=>t.length,update:P};function i(I){const D=(I-r)*.001;t.forEach(be=>{if(be.startTime>I)return;const Ye=be.frameInfo;Ye.deltaTime=D,!(!be.started&&!d(be,I))&&(be.endTime&&(Ye.elapsedInterval=(I-be.startTime)/(be.endTime-be.startTime),Ye.elapsedInterval>1&&(Ye.elapsedInterval=1),Ye.elapsedPercentage=Math.round(Ye.elapsedInterval*100)),f(be),be.endTime&&be.endTime<=I&&l(be))}),r=I,t.length&&!e&&(n=requestAnimationFrame(i))}function o(I){I.ended||t.indexOf(I)<0||(I.frameInfo.elapsedInterval=1,I.frameInfo.elapsedPercentage=100,f(I),l(I,!0))}function s(){[...t].forEach(o)}function l(I,D=!1){const{duration:be,keepAlive:Ye,repeatDelay:Se}=I.params;if(I.repeatCount--,I.forcedEnd=D,!D&&I.repeatCount>0&&be&&be!==1/0){I.startTime=I.endTime+(Se||0),I.endTime=I.startTime+be;return}if(!D&&Ye){I.keptAlive=!0;return}I.ended=!0,I.endCallbacks.forEach(Ze=>Ze(I)),g(I)}function d(I,D){const{duration:be,delay:Ye,onStart:Se}=I.params;return I.startTime||(I.startTime=D+(Ye||0),be&&be!==1/0&&(I.endTime=I.startTime+be)),I.startTime>D?!1:(I.started=!0,Se?.(I),!0)}function f(I){const{onUpdate:D}=I.params;en(I),D?.(I)}function h(I){const D=qt(I);return t.push(D),!n&&!e&&m(),D}function g(I){const D=t.indexOf(I);D>=0&&t.splice(D,1),!t.length&&!e&&S()}function m(){r=performance.now(),n=requestAnimationFrame(i)}function S(){n&&cancelAnimationFrame(n),n=0}function P(I){i(I)}}function Ht(e={}){const t=e;function n(d){if(t[d]===void 0)throw new Error(`Requested object at key ${d} is undefined.`);return t[d]}function r(){return t}function i(d,f){t[d]=f}function o(){return Object.keys(t)}function s(d){return t[d]!==void 0}function l(d){delete t[d]}return{deleteItem:l,get:n,getCollection:r,isDefined:s,keys:o,set:i}}var b;(function(e){e.Arrows="arrows",e.BlinkingHighlights="blinking-highlights",e.CaptureHints="capture-hints",e.Coordinates="coordinates",e.Effects="effects",e.FadeSetup="fade-setup",e.HoverSquare="hover-square",e.MoveHints="move-hints",e.Pieces="pieces",e.PromotionWindow="promotion-window",e.Squares="squares"})(b||(b={}));function se(e,t){return e.split(" ").filter(n=>!n.startsWith(t)).join(" ").trim()}function oe(e){return{file:e.toLowerCase().charCodeAt(0)-96,rank:Number(e.charAt(1))}}function fe({square:e,el:t}){const n=oe(e);n&&(t.className=se(t.className,"square-"),t.classList.add(`square-${n.file}${n.rank}`),t.style.transform="")}function Te(e,t){return e?(Object.entries(t).forEach(([n,r])=>{const i=`${n.charAt(0).toUpperCase()}${n.slice(1)}`;typeof r>"u"?delete e.dataset[`test${i}`]:e.dataset[`test${i}`]=r}),!0):!1}var Ne;(function(e){e.Anchor="anchor",e.Blinking="blinking",e.Color="color",e.Dragging="dragging",e.Editable="editable",e.Element="element",e.EnPassant="enPassant",e.File="file",e.Figurine="figurine",e.Flipped="flipped",e.Inside="inside",e.Interval="interval",e.LeadingFigurine="leadingFigurine",e.Opacity="opacity",e.Outside="outside",e.Position="position",e.Rank="rank",e.Selected="selected",e.ShortString="shortstring",e.Square="square",e.Star="star",e.TextColor="textColor",e.TextValue="textValue",e.Times="times",e.TrailingFigurine="trailingFigurine",e.Type="type",e.WholeMoveNumber="wholeMoveNumber",e.X="x",e.Y="y"})(Ne||(Ne={}));var yn;(function(e){e.Arrow="arrow",e.BlinkingHighlight="blinking-highlight",e.Board="board",e.CommentLink="comment-link",e.Coordinates="coordinates",e.CustomItem="custom-item",e.Effect="effect",e.FadeInOverlay="fade-in-overlay",e.GameResult="game-result",e.HalfMove="half-move",e.Highlight="highlight",e.Hint="hint",e.HoverSquare="hover-square",e.Move="move",e.Piece="piece",e.PotentialCapture="capture-hint",e.PromotionCloseButton="promotion-close-button",e.PromotionPiece="promotion-piece",e.PromotionWindow="promotion-window",e.Square="square",e.SiblingBoard="sibling-board"})(yn||(yn={}));function F(e){if(!e)return null;const t=e.position===Pn.Positions.Below;return e.target===Pn.Targets.Arrows?{insertBefore:t,type:b.Arrows}:e.target===Pn.Targets.Effects?{insertBefore:t,type:b.Effects}:e.target===Pn.Targets.Pieces?{insertBefore:!t,type:t?b.Effects:b.Pieces}:null}const he=`
<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
  <image x="7.5" y="7.5" width="25" height="25" />
</svg>
`,we=`
  <svg xmlns="http://www.w3.org/2000/svg" style="fill: #ffa704" viewBox="0 0 40 40">
    <path
      d="M23.12,17.84H16.4a1.11,1.11,0,0,1-1.06-1.43L18.7,5.21a1.11,1.11,0,0,1,2.13,0l3.36,11.2A1.11,1.11,0,0,1,23.12,17.84Z" />
    <path
      d="M27.21,34.11,4.35,16.88a1.11,1.11,0,0,1,.67-2l17.89,0a1.11,1.11,0,0,1,1.06.8l5,17.19A1.11,1.11,0,0,1,27.21,34.11Z" />
    <path
      d="M35.17,16.88,12.31,34.11a1.11,1.11,0,0,1-1.74-1.2l5-17.19a1.11,1.11,0,0,1,1.06-.8l17.89,0A1.11,1.11,0,0,1,35.17,16.88Z" />
  </svg>
`,Oe=`
<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect x="5" y="12.5" width="30" height="15" rx="3" fill="inherit" />
  <text fill="#676767" font-size="0.8rem" x="20.5" y="20.5" dominant-baseline="middle" text-anchor="middle"></text>
</svg>
`;var y=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Image:he,Star:we,TextBox:Oe});function T({board:e,el:t,options:n}){const r=Ht(),i=Ht(),o=It(),s=Ht(),l=document.createComment("/Custom Items");return e.addToDom({el:l,insertAfter:!0,type:b.Pieces}),{addCustomItems:d,removeCustomItems:g};function d(P){P.forEach(I=>{const{data:{color:D,image:be,opacity:Ye,text:Se,type:Ze,visualOrder:mt,frame:zn,removalClass:Sn,square:tn}}=I;i.isDefined(tn)&&h(tn,Sn),s.isDefined(tn)&&o.end(s.get(tn));const Ct=document.createElement("div");if(Ct.classList.add(Tr.Classes.Root),zn){Ct.classList.add("custom-item__frame"),zn.imageAnimated&&Ct.classList.add("custom-item__frame--animated");const Zn=f(zn);Zn&&Ct.appendChild(Zn)}else Ct.innerHTML=y[Ze],Ln();fe({el:Ct,square:tn}),n.test&&Te(Ct,{[Ne.Color]:D,[Ne.Element]:yn.CustomItem,[Ne.Opacity]:Ye,[Ne.Square]:tn,[Ne.Type]:Ze});const Ft=F(mt);Ft?e.addToDom(ge({el:Ct},Ft)):t.insertBefore(Ct,l),r.set(tn,Ct);function Ln(){const Zn=Ct.querySelector("svg");if(Zn){if(D&&(Zn.style.fill=D),Ye&&(Zn.style.opacity=String(Ye)),be){const br=Zn.querySelector("image");if(!br)return;if(br.setAttribute("href",be.url),be.percentOfSquare){const{width:tr}=Zn.viewBox.baseVal,kr=tr*be.percentOfSquare*.01,Qn=(tr-kr)/2;Object.assign(br.style,{height:`${kr}px`,width:`${kr}px`,x:`${Qn}px`,y:`${Qn}px`})}}if(Se){const br=Zn.querySelector("text");if(!br)return;br.innerHTML=Se.value,Se.color&&(br.style.fill=Se.color)}}}})}function f(P){if(!P)return;const I=document.createElement("div"),{imageURL:D,imageAnimated:be,positionRatioX:Ye,positionRatioY:Se,widthRatio:Ze,heightRatio:mt}=P,zn=Ye/Ze,Sn=Se/mt,tn=1/Ze,Ct=1/mt,Ft=zn/(tn-1)*100,Ln=Sn/(Ct-1)*100,Zn=be?"auto 100%":`${1/Ze*100}% ${1/mt*100}%`;return I.style.backgroundImage=`url(${D})`,I.style.backgroundSize=Zn,I.style.backgroundPositionX=`${Ft}%`,I.style.backgroundPositionY=`${Ln}%`,I}function h(P,I="captured"){const D=r.get(P);D&&D.classList.contains(I)&&(m(D,P),clearTimeout(i.get(P)),i.deleteItem(P))}function g(P){P.forEach(I=>{const{data:D}=I,{frame:be,removalClass:Ye="captured",removalTimeout:Se=250,square:Ze}=D,mt=r.get(Ze);mt&&(be?.imageAnimated?S({customItemElement:mt,imageURL:be.imageURL,square:Ze,onAnimationEnd:()=>{s.isDefined(Ze)&&s.deleteItem(Ze),m(mt,Ze)}}):(mt.classList.add(Ye),i.set(Ze,window.setTimeout(()=>{i.isDefined(Ze)&&i.deleteItem(Ze),mt&&m(mt,Ze)},Se))))})}function m(P,I){t.removeChild(P),r.deleteItem(I)}function S({customItemElement:P,imageURL:I,square:D,onAnimationEnd:be}){const Ye=P.querySelector("div");if(!Ye){be();return}const Se=new Image;Se.src=I,Se.onload=()=>{const Ze=P.clientHeight,mt=Math.ceil(Se.naturalWidth/Se.naturalHeight),zn=1/mt,Sn=o.play({duration:mt/24*1e3,data:{currentFrame:1},onUpdate:()=>{const{data:tn,frameInfo:Ct}=Sn;zn*tn.currentFrame<Ct.elapsedInterval&&(Ye.style.backgroundPositionX=`-${Ze*tn.currentFrame}px`,tn.currentFrame++)},onEnd:be});s.set(D,Sn)}}}function x(e){const{api:t,options:n,renderer:r}=e,i=t.markings;r?.extendRenderer(T);const o=n.allowMarkings?i.getAllWhere({types:[mn]}):[];r?.addCustomItems(o,e)}function H(){return[{condition:Ur(mn),handler:e},{condition:Ut(mn),handler:t},{condition:Je(M.InstanceEvents.RendererSet),handler:(n,r)=>x(r)}];function e(n,r){const{api:i,renderer:o}=r,s=i["custom-items"],l=n.data.filter(Gt(mn)).map(d=>d.data.color?d:Re(d,"color",s.getDefaultStarColor()));o?.addCustomItems(l,r)}function t(n,r){const{api:i,queue:o,renderer:s}=r,l=n.data.filter(Gt(mn));l.forEach(d=>{const f=d.data.removalSound;f&&o.add(i.playSound,f)}),s?.removeCustomItems(l,r)}}var O;(function(e){e.DefaultSquareColor="#ffa704"})(O||(O={}));function X({defaultStarColor:e=O.DefaultSquareColor}={}){return{create:x,api:et(e),match:H(),name:Tr.Plugin.Name}}var Z;(function(e){(function(t){t.EntryAdded="EntryAdded"})(e.Events||(e.Events={})),function(t){t.Debug="Debug",t.Error="Error",t.None="None"}(e.Levels||(e.Levels={}))})(Z||(Z={}));function _t(){let e,t;return{create:n,name:ft.Plugin.Name};function n(i){const{api:{logger:o}}=i;o.on(Z.Events.EntryAdded,r)}function r(i){i.code===void 0||i.code===M.LogCodes.State&&JSON.stringify(i.data)===e||i.code===M.LogCodes.Event&&i.data.type===M.UserEvents.Pointermove&&t===M.UserEvents.Pointermove||i.code===M.LogCodes.Event&&i.data.type===M.UIEvents.Resize&&t===M.UIEvents.Resize||(i.code===M.LogCodes.State&&(e=JSON.stringify(i.data)),i.code===M.LogCodes.Event&&(t=i.data.type),console.group(i.code),i.level===Z.Levels.Error?console.error(i.data):console.log(i.data),console.groupEnd())}}var nt=`.effect {
  background-clip: content-box;
  border-radius: 50%;
  box-sizing: border-box;
  height: 12.5%;
  /*rtl:ignore*/
  left: 5.5%;
  padding: 3.75%;
  pointer-events: none;
  position: absolute;
  top: -5.5%;
  width: 12.5%;
  z-index: 1;
}

.effects {
  pointer-events: none;
  position: absolute;
}

.flipped .effects {
  /*rtl:ignore*/
  transform: scale(-1, -1);
}

.tuck-right {
  margin-left: -2%;
}

.tuck-top {
  margin-top: 2%;
}`;function Ue(e){if(!e)return!1;const t=["a","h","1","8"];let n=!1;return t.forEach(r=>{e.includes(r)&&(n=!0)}),n}var j;(function(e){(function(t){t.Background="icon-background",t.Component="icon-component",t.ComponentShadow="icon-component-shadow",t.Shadow="icon-shadow"})(e.ClassNames||(e.ClassNames={}))})(j||(j={}));const qe=`<g id="alternative">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M14.57,4.71l-4.42.2a.2.2,0,0,0-.11,0A.16.16,0,0,0,10,5a.21.21,0,0,0,0,.11.31.31,0,0,0,0,.1l1.4,1.4L8.92,9.13,6.5,6.71,8,5.24a.19.19,0,0,0,0-.1A.14.14,0,0,0,8,5,.15.15,0,0,0,8,4.94a.21.21,0,0,0-.11,0L3.42,4.71l-.08,0-.06,0a.18.18,0,0,0,0,.07.19.19,0,0,0,0,.08l.19,4.42a.15.15,0,0,0,0,.11.18.18,0,0,0,.08.07.25.25,0,0,0,.12,0,.18.18,0,0,0,.09-.06L5.21,8l2.55,2.56v4.49a.29.29,0,0,0,0,.09l0,.07.08,0,.09,0H9.85l.09,0a.18.18,0,0,0,.07,0l.05-.07a.29.29,0,0,0,0-.09V10.57l2.63-2.63,1.55,1.54a.16.16,0,0,0,.09,0,.17.17,0,0,0,.12,0,.18.18,0,0,0,.08-.07.13.13,0,0,0,0-.1l.19-4.43a.19.19,0,0,0,0-.08.18.18,0,0,0,0-.07l-.07,0Z"></path>
      </g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M14.57,4.21l-4.42.2a.2.2,0,0,0-.11,0,.16.16,0,0,0-.07.09.21.21,0,0,0,0,.11.31.31,0,0,0,0,.1l1.4,1.4L8.92,8.63,6.5,6.21,8,4.74a.19.19,0,0,0,0-.1.14.14,0,0,0,0-.11A.15.15,0,0,0,8,4.44a.21.21,0,0,0-.11,0L3.42,4.21l-.08,0-.06,0a.18.18,0,0,0,0,.07.19.19,0,0,0,0,.08l.19,4.42a.15.15,0,0,0,0,.11A.18.18,0,0,0,3.53,9a.25.25,0,0,0,.12,0A.18.18,0,0,0,3.74,9L5.21,7.51l2.55,2.56v4.49a.29.29,0,0,0,0,.09l0,.07.08,0,.09,0H9.85l.09,0a.18.18,0,0,0,.07,0l.05-.07a.29.29,0,0,0,0-.09V10.07l2.63-2.63L14.26,9a.16.16,0,0,0,.09,0,.17.17,0,0,0,.12,0A.18.18,0,0,0,14.55,9a.13.13,0,0,0,0-.1l.19-4.43a.19.19,0,0,0,0-.08.18.18,0,0,0,0-.07l-.07,0Z"></path>
    </g>
  </g>`,Qt=`<g id="best">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path class="${j.ClassNames.ComponentShadow}" opacity="0.2" d="M9,3.43a.5.5,0,0,0-.27.08.46.46,0,0,0-.17.22L7.24,7.17l-3.68.19a.52.52,0,0,0-.26.1.53.53,0,0,0-.16.23.45.45,0,0,0,0,.28.44.44,0,0,0,.15.23l2.86,2.32-1,3.56a.45.45,0,0,0,0,.28.46.46,0,0,0,.17.22.41.41,0,0,0,.26.09.43.43,0,0,0,.27-.08l3.09-2,3.09,2a.46.46,0,0,0,.53,0,.46.46,0,0,0,.17-.22.53.53,0,0,0,0-.28l-1-3.56L14.71,8.2A.44.44,0,0,0,14.86,8a.45.45,0,0,0,0-.28.53.53,0,0,0-.16-.23.52.52,0,0,0-.26-.1l-3.68-.2L9.44,3.73a.46.46,0,0,0-.17-.22A.5.5,0,0,0,9,3.43Z"></path>
    <path class="${j.ClassNames.Component}" fill="#fff" d="M9,2.93A.5.5,0,0,0,8.73,3a.46.46,0,0,0-.17.22L7.24,6.67l-3.68.19A.52.52,0,0,0,3.3,7a.53.53,0,0,0-.16.23.45.45,0,0,0,0,.28.44.44,0,0,0,.15.23L6.15,10l-1,3.56a.45.45,0,0,0,0,.28.46.46,0,0,0,.17.22.41.41,0,0,0,.26.09.43.43,0,0,0,.27-.08l3.09-2,3.09,2a.46.46,0,0,0,.53,0,.46.46,0,0,0,.17-.22.53.53,0,0,0,0-.28l-1-3.56L14.71,7.7a.44.44,0,0,0,.15-.23.45.45,0,0,0,0-.28A.53.53,0,0,0,14.7,7a.52.52,0,0,0-.26-.1l-3.68-.2L9.44,3.23A.46.46,0,0,0,9.27,3,.5.5,0,0,0,9,2.93Z"></path>
  </g>`,Fn=`<g id="blunder">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#ca3431" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M14.74,5.45A2.58,2.58,0,0,0,14,4.54,3.76,3.76,0,0,0,12.89,4a4.07,4.07,0,0,0-1.2-.19A3.92,3.92,0,0,0,10.51,4a5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06l.11-.08a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83V11a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.8a1,1,0,0,1,.26-.7q.27-.28.66-.63A5.79,5.79,0,0,0,14.05,9a4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5.45Z"></path>
      <path d="M12.38,12.65H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V13a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.65Z"></path>
      <path d="M6.79,12.65H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,15a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V13a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.65Z"></path>
      <path d="M8.39,4.54A3.76,3.76,0,0,0,7.3,4a4.07,4.07,0,0,0-1.2-.19A3.92,3.92,0,0,0,4.92,4a5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06l.11-.08a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,6.06a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.9a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83V11a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1A.5.5,0,0,0,7,11V10.8a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9.47c.18-.15.35-.31.52-.48A7,7,0,0,0,9,8.39a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1,2.66,2.66,0,0,0-.29-1.27A2.58,2.58,0,0,0,8.39,4.54Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M14.74,5A2.58,2.58,0,0,0,14,4a3.76,3.76,0,0,0-1.09-.56,4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06L10.37,6a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.3a1,1,0,0,1,.26-.7q.27-.28.66-.63a5.79,5.79,0,0,0,.51-.48,4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M12.38,12.15H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.15Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M6.79,12.15H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,14.51a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.15Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M8.39,4A3.76,3.76,0,0,0,7.3,3.48a4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06L4.78,6a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,5.56a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.4a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1.5.5,0,0,0,0-.12V10.3a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9c.18-.15.35-.31.52-.48A7,7,0,0,0,9,7.89a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1A2.66,2.66,0,0,0,9.15,5,2.58,2.58,0,0,0,8.39,4Z"></path>
    </g>
  </g>`,Vn=`<g id="book">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#a88865" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g>
      <path class="${j.ClassNames.ComponentShadow}" opacity="0.3" isolation="isolate" d="M8.45,5.9c-1-.75-2.51-1.09-4.83-1.09H2.54v8.71H3.62a8.16,8.16,0,0,1,4.83,1.17Z"></path>
      <path class="${j.ClassNames.ComponentShadow}" opacity="0.3" isolation="isolate" d="M9.54,14.69a8.14,8.14,0,0,1,4.84-1.17h1.08V4.81H14.38c-2.31,0-3.81.34-4.84,1.09Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M8.45,5.4c-1-.75-2.51-1.09-4.83-1.09H3V13h.58a8.09,8.09,0,0,1,4.83,1.17Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M9.54,14.19A8.14,8.14,0,0,1,14.38,13H15V4.31h-.58c-2.31,0-3.81.34-4.84,1.09Z"></path>
    </g>
  </g>`,Un=`<g id="Brilliant">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#1bada6" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M12.57,14.6a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.84A.41.41,0,0,1,10,14.6V12.7a.32.32,0,0,1,.09-.23.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.9A.36.36,0,0,1,10,3.66a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
      <path d="M8.07,14.6a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.7a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.67a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.9a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M12.57,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.34A.41.41,0,0,1,10,14.1V12.2A.32.32,0,0,1,10,12a.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.4A.36.36,0,0,1,10,3.16a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M8.07,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2A.31.31,0,0,1,8,12a.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.17a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
    </g>
  </g>`,an=`<g id="checkmate_black">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path d="M11.44,8.41h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.86H8.31l.18-2.78H6.94L6.76,6.86H5l-.1,1.55H6.66l-.11,1.68H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.64H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,10.09l.1-1.68H9.89l-.1,1.68Z"></path>
    <path class="${j.ClassNames.ComponentShadow}" fill="#fff" d="M11.44,7.91h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.36H8.31l.18-2.78H6.94L6.76,6.36H5l-.1,1.55H6.66L6.55,9.59H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.14H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.59l.1-1.68H9.89l-.1,1.68Z"></path>
  </g>`,gs=`<g id="checkmate_white">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <circle class="${j.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>
    <path class="${j.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path d="M11.44,8.11h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.56H8.31l.18-2.78H6.94L6.76,6.56H5l-.1,1.55H6.66L6.55,9.79H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.34H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.79l.1-1.68H9.89l-.1,1.68Z"></path>
  </g>`,na=`<g id="correct">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.ComponentShadow}" opacity="0.2" d="M15.11,6.81,9.45,12.47,7.79,14.13a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.78a.39.39,0,0,1-.11-.28.39.39,0,0,1,.11-.27L4.28,7.85a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09l2.69,2.68,5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.81Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M15.11,6.31,9.45,12,7.79,13.63a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.28A.39.39,0,0,1,2.78,9a.39.39,0,0,1,.11-.27L4.28,7.35a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09L7.52,10l5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.31Z"></path>
    </g>
  </g>`,Qs=`<g id="critical">
    <g class="${j.ClassNames.Shadow}" opacity="0.3">
      <path d="M17.68,5.2,11.06,16.67a2.37,2.37,0,0,1-4.11,0L.32,5.2A2.38,2.38,0,0,1,2.38,1.64H15.62A2.38,2.38,0,0,1,17.68,5.2Z"></path>
    </g>
    <path class="${j.ClassNames.Background}" fill="#ad5b8c" d="M17.68,4.7,11.06,16.17a2.37,2.37,0,0,1-4.11,0L.32,4.7A2.38,2.38,0,0,1,2.38,1.14H15.62A2.38,2.38,0,0,1,17.68,4.7Z"></path>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M8.67,3.22,5.9,9.92V10a.14.14,0,0,0,0,.06l0,0,0,0H8.4a.1.1,0,0,1,.09,0,.09.09,0,0,1,0,.08l0,5c0,.11.17.17.21.07L12.1,8V7.92a.14.14,0,0,0,0-.06.09.09,0,0,0-.05,0l-.06,0H9.32a.11.11,0,0,1-.08,0,.12.12,0,0,1,0-.09l-.32-4.4C8.87,3.18,8.71,3.12,8.67,3.22Z"></path>
    </g>
    <path class="${j.ClassNames.Component}" fill="#fff" d="M8.67,2.72,5.9,9.42v.05a.14.14,0,0,0,0,.06l0,0,0,0H8.4a.1.1,0,0,1,.09,0,.09.09,0,0,1,0,.08l0,5c0,.11.17.17.21.07l3.4-7.24V7.42a.14.14,0,0,0,0-.06.09.09,0,0,0-.05,0l-.06,0H9.32a.11.11,0,0,1-.08,0,.12.12,0,0,1,0-.09l-.32-4.4C8.87,2.68,8.71,2.62,8.67,2.72Z"></path>
  </g>`,_s=`<g id="draw_black">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path d="M2.92,7V5.84c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V7Zm8.87-2.39L7,13.88H5l4.8-9.26ZM9.85,13.88c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,8.26,15,8.78,15,10c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>
    <path class="${j.ClassNames.ComponentShadow}" fill="#fff" d="M2.92,6.51V5.34c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V6.51Zm8.87-2.39L7,13.38H5l4.8-9.26ZM9.85,13.38c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,7.76,15,8.28,15,9.5c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>
  </g>`,Js=`<g id="draw_white">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <circle class="${j.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>
    <path class="${j.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <path d="M2.92,6.61V5.44c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V6.61Zm8.87-2.39L7,13.48H5l4.8-9.26ZM9.85,13.48c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,7.86,15,8.38,15,9.6c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>
  </g>`,ja=`<g id="excellent">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M13.79,11.34c0-.2.4-.53.4-.94S14,9.72,14,9.58a2.06,2.06,0,0,0,.18-.83,1,1,0,0,0-.3-.69,1.13,1.13,0,0,0-.55-.2,10.29,10.29,0,0,1-2.07,0c-.37-.23,0-1.18.18-1.7S11.9,4,10.62,3.7c-.69-.17-.66.37-.78.9-.05.21-.09.43-.13.57A5,5,0,0,1,7.05,8.23a1.57,1.57,0,0,1-.42.18v4.94A7.23,7.23,0,0,1,8,13.53c.52.12.91.25,1.44.33A11.11,11.11,0,0,0,11,14a6.65,6.65,0,0,0,1.18,0,1.09,1.09,0,0,0,1-.59.66.66,0,0,0,.06-.2,1.63,1.63,0,0,1,.07-.3c.13-.28.37-.3.5-.68S13.74,11.53,13.79,11.34Z"></path>
      <path d="M5.49,8.09H4.31a.5.5,0,0,0-.5.5v4.56a.5.5,0,0,0,.5.5H5.49a.5.5,0,0,0,.5-.5V8.59A.5.5,0,0,0,5.49,8.09Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M13.79,10.84c0-.2.4-.53.4-.94S14,9.22,14,9.08a2.06,2.06,0,0,0,.18-.83,1,1,0,0,0-.3-.69,1.13,1.13,0,0,0-.55-.2,10.29,10.29,0,0,1-2.07,0c-.37-.23,0-1.18.18-1.7s.51-2.12-.77-2.43c-.69-.17-.66.37-.78.9-.05.21-.09.43-.13.57A5,5,0,0,1,7.05,7.73a1.57,1.57,0,0,1-.42.18v4.94A7.23,7.23,0,0,1,8,13c.52.12.91.25,1.44.33a11.11,11.11,0,0,0,1.62.16,6.65,6.65,0,0,0,1.18,0,1.09,1.09,0,0,0,1-.59.66.66,0,0,0,.06-.2,1.63,1.63,0,0,1,.07-.3c.13-.28.37-.3.5-.68S13.74,11,13.79,10.84Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M5.49,7.59H4.31a.5.5,0,0,0-.5.5v4.56a.5.5,0,0,0,.5.5H5.49a.5.5,0,0,0,.5-.5V8.09A.5.5,0,0,0,5.49,7.59Z"></path>
    </g>
  </g>`,_a=`<g id="fast_win">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M4.85,4.7,9.67,9.19a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18l-.05.07L4.85,14a.24.24,0,0,1-.11.06.3.3,0,0,1-.13,0A.23.23,0,0,1,4.52,14a.28.28,0,0,1,0-.12v-9a.28.28,0,0,1,0-.12.23.23,0,0,1,.09-.08.3.3,0,0,1,.13,0A.24.24,0,0,1,4.85,4.7Z"></path>
      <path d="M10,4.7l4.82,4.49a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18l-.05.07L10,14a.24.24,0,0,1-.11.06.27.27,0,0,1-.13,0A.18.18,0,0,1,9.7,14a.19.19,0,0,1,0-.12v-9a.19.19,0,0,1,0-.12.18.18,0,0,1,.09-.08.27.27,0,0,1,.13,0A.24.24,0,0,1,10,4.7Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M4.85,4.2,9.67,8.69a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18L9.67,9,4.85,13.5a.24.24,0,0,1-.11.06.3.3,0,0,1-.13,0,.23.23,0,0,1-.09-.08.28.28,0,0,1,0-.12v-9a.28.28,0,0,1,0-.12.23.23,0,0,1,.09-.08.3.3,0,0,1,.13,0A.24.24,0,0,1,4.85,4.2Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M10,4.2l4.82,4.49a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18L14.85,9,10,13.5a.24.24,0,0,1-.11.06.27.27,0,0,1-.13,0,.18.18,0,0,1-.09-.08.19.19,0,0,1,0-.12v-9a.19.19,0,0,1,0-.12.18.18,0,0,1,.09-.08.27.27,0,0,1,.13,0A.24.24,0,0,1,10,4.2Z"></path>
    </g>
  </g>`,el=`<g id="free_piece">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M9.76,9.66h3.89v4.19a.68.68,0,0,1-.68.68H9.76Z"></path>
      <path d="M4.35,9.66H8.24v4.87H5a.58.58,0,0,1-.26-.06.6.6,0,0,1-.36-.36.58.58,0,0,1,0-.26V9.66Z"></path>
      <path d="M13.39,7H10.13l2-1a.78.78,0,0,0,.29-.25.78.78,0,0,0,.13-.36A.82.82,0,0,0,12.53,5a.87.87,0,0,0-.23-.31l-1.15-1a.76.76,0,0,0-.34-.16.74.74,0,0,0-.39,0,.94.94,0,0,0-.33.2.84.84,0,0,0-.19.33L9.08,7H9l-.83-2.9A.73.73,0,0,0,8,3.81a.79.79,0,0,0-.33-.2.7.7,0,0,0-.38,0,.75.75,0,0,0-.35.16l-1.14,1A.87.87,0,0,0,5.54,5a.71.71,0,0,0,0,.38.78.78,0,0,0,.13.36A.71.71,0,0,0,5.91,6l2,1H4.61a.46.46,0,0,0-.49.44v.87a.47.47,0,0,0,.49.45h8.78a.47.47,0,0,0,.49-.45V7.48A.47.47,0,0,0,13.39,7Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M9.76,14H13a.71.71,0,0,0,.48-.19.72.72,0,0,0,.2-.48V9.16H9.76Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M4.36,13.35a.58.58,0,0,0,0,.26.6.6,0,0,0,.36.36A.58.58,0,0,0,5,14H8.24V9.16H4.36Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M13.39,6.54H10.13l2-1a.78.78,0,0,0,.29-.25.78.78,0,0,0,.13-.36.82.82,0,0,0-.05-.38.87.87,0,0,0-.23-.31l-1.15-1a.76.76,0,0,0-.34-.16.74.74,0,0,0-.39,0,.94.94,0,0,0-.33.2.84.84,0,0,0-.19.33l-.82,2.9H9l-.83-2.9A.73.73,0,0,0,8,3.31a.79.79,0,0,0-.33-.2.7.7,0,0,0-.38,0,.75.75,0,0,0-.35.16l-1.14,1a.87.87,0,0,0-.23.31.71.71,0,0,0,0,.38.78.78,0,0,0,.13.36.71.71,0,0,0,.29.25l2,1H4.61A.46.46,0,0,0,4.12,7v.87a.47.47,0,0,0,.49.45h8.78a.47.47,0,0,0,.49-.45V7A.47.47,0,0,0,13.39,6.54Z"></path>
    </g>
  </g>`,tl=`<path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
<path class="${j.ClassNames.Background}" fill="#7979a1" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
<g class="${j.ClassNames.ComponentShadow}" opacity="0.1">
    <polygon points="11.29 11.34 11.29 8.56 7.79 11.3 7.79 11.34 5.39 11.34 9.54 16.5 13.73 11.34 11.29 11.34"></polygon>
    <polygon points="7.83 7.51 7.83 10.32 11.33 7.58 11.33 7.5 13.73 7.5 9.58 2.35 5.39 7.51 7.83 7.51"></polygon>
  </g>
<g>
    <polygon class="${j.ClassNames.Component}" fill="#fff" points="10.9 10.92 10.9 8.13 7.4 10.87 7.4 10.92 5 10.92 9.15 16.07 13.34 10.92 10.9 10.92"></polygon>
    <polygon class="${j.ClassNames.Component}" fill="#fff" points="7.44 7.08 7.44 9.9 10.94 7.16 10.94 7.08 13.34 7.08 9.19 1.93 5 7.08 7.44 7.08"></polygon>
  </g>`,ba=`<g id="great_find">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#5c8bb0" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g>
      <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M10.32,14.6a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.7a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.9a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
      </g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M10.32,14.1a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>
    </g>
  </g>`,bs=`<g id="forced">
    <g id="fast_win">
      <g>
        <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
        <path class="${j.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
      </g>
    </g>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M14.39,9.07,9,4.31a.31.31,0,0,0-.3,0,.32.32,0,0,0-.13.1.29.29,0,0,0,0,.16V7.42H3.9a.58.58,0,0,0-.19,0,.5.5,0,0,0-.17.11.91.91,0,0,0-.11.16.63.63,0,0,0,0,.19v3.41a.58.58,0,0,0,0,.19.64.64,0,0,0,.11.16.39.39,0,0,0,.17.11.41.41,0,0,0,.19,0H8.5v2.74a.26.26,0,0,0,.16.26.3.3,0,0,0,.16,0A.34.34,0,0,0,9,14.79L14.39,10a.69.69,0,0,0,.16-.22.7.7,0,0,0,0-.52A.69.69,0,0,0,14.39,9.07Z"></path>
    </g>
    <path class="${j.ClassNames.Component}" fill="#fff" d="M14.39,8.57,9,3.81a.31.31,0,0,0-.3,0,.32.32,0,0,0-.13.1A.29.29,0,0,0,8.5,4V6.92H3.9a.58.58,0,0,0-.19,0,.5.5,0,0,0-.17.11.91.91,0,0,0-.11.16.63.63,0,0,0,0,.19v3.41a.58.58,0,0,0,0,.19.64.64,0,0,0,.11.16.39.39,0,0,0,.17.11.41.41,0,0,0,.19,0H8.5v2.74a.26.26,0,0,0,.16.26.3.3,0,0,0,.16,0A.34.34,0,0,0,9,14.29l5.42-4.76a.69.69,0,0,0,.16-.22.7.7,0,0,0,0-.52A.69.69,0,0,0,14.39,8.57Z"></path>
  </g>`,qa=`<g id="good">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.ComponentShadow}" opacity="0.2" d="M15.11,6.81,9.45,12.47,7.79,14.13a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.78a.39.39,0,0,1-.11-.28.39.39,0,0,1,.11-.27L4.28,7.85a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09l2.69,2.68,5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.81Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M15.11,6.31,9.45,12,7.79,13.63a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.28A.39.39,0,0,1,2.78,9a.39.39,0,0,1,.11-.27L4.28,7.35a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09L7.52,10l5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.31Z"></path>
    </g>
  </g>`,ys=`<g id="inaccuracy">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#f7c045" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M13.66,14.8a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.8V12.9a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,4.1A.5.5,0,0,1,11,3.86l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>
      <path d="M7.65,14.82a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V13a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73A5.58,5.58,0,0,1,9,9a4.85,4.85,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7V11a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27A1.16,1.16,0,0,0,6.49,6,1.61,1.61,0,0,0,6,6.11a3,3,0,0,0-.41.18,1.75,1.75,0,0,0-.29.18l-.11.09A.5.5,0,0,1,5,6.62a.31.31,0,0,1-.21-.13l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.68a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17,3.92,3.92,0,0,1,2.3.75,2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.71,3,3,0,0,1,9.85,7.65Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M13.66,14.3a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.3V12.4a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,3.6A.5.5,0,0,1,11,3.36l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M7.65,14.32a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.49a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6A4.85,4.85,0,0,1,8.48,9a8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24A1.61,1.61,0,0,0,6,5.61a3,3,0,0,0-.41.18A1.75,1.75,0,0,0,5.3,6l-.11.09A.5.5,0,0,1,5,6.12.31.31,0,0,1,4.74,6l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.18a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17A3.92,3.92,0,0,1,8.93,4a2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.21,3,3,0,0,1,9.85,7.15Z"></path>
    </g>
  </g>`,nl=`<g id="incorrect">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#ca3431" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M14,12.51a.57.57,0,0,1,.08.13.39.39,0,0,1,0,.3.5.5,0,0,1-.08.12l-1.38,1.38a.5.5,0,0,1-.12.08l-.15,0-.15,0a.57.57,0,0,1-.13-.08L9,11.37,5.94,14.44a.57.57,0,0,1-.13.08l-.15,0-.15,0a.36.36,0,0,1-.12-.08L4,13.06a.39.39,0,0,1-.11-.27A.41.41,0,0,1,4,12.51L7.07,9.45,4,6.39a.43.43,0,0,1-.11-.28A.39.39,0,0,1,4,5.84L5.39,4.46a.39.39,0,0,1,.27-.11.43.43,0,0,1,.28.11L9,7.52l3.06-3.06a.41.41,0,0,1,.28-.11.39.39,0,0,1,.27.11L14,5.84a.36.36,0,0,1,.08.12.39.39,0,0,1,0,.3.57.57,0,0,1-.08.13L10.92,9.45Z"></path>
    </g>
    <path class="${j.ClassNames.Component}" fill="#f1f2f2" d="M14,12a.57.57,0,0,1,.08.13.39.39,0,0,1,0,.3.5.5,0,0,1-.08.12l-1.38,1.38a.5.5,0,0,1-.12.08l-.15,0-.15,0a.57.57,0,0,1-.13-.08L9,10.87,5.94,13.94a.57.57,0,0,1-.13.08l-.15,0-.15,0a.36.36,0,0,1-.12-.08L4,12.56a.39.39,0,0,1-.11-.27A.41.41,0,0,1,4,12L7.07,9,4,5.89a.43.43,0,0,1-.11-.28A.39.39,0,0,1,4,5.34L5.39,4a.39.39,0,0,1,.27-.11A.43.43,0,0,1,5.94,4L9,7,12.06,4a.41.41,0,0,1,.28-.11.39.39,0,0,1,.27.11L14,5.34a.36.36,0,0,1,.08.12.39.39,0,0,1,0,.3.57.57,0,0,1-.08.13L10.92,9Z"></path>
  </g>`,rl=`<g id="mate">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g>
      <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M11.44,8.61h1.74l.1-1.55H11.54l.18-2.78H10.17L10,7.06H8.31l.18-2.78H6.94L6.76,7.06H5l-.1,1.55H6.66l-.11,1.68H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.84H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,10.29l.1-1.68H9.89l-.1,1.68Z"></path>
      </g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M11.44,8.11h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.56H8.31l.18-2.78H6.94L6.76,6.56H5l-.1,1.55H6.66L6.55,9.79H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.34H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.79l.1-1.68H9.89l-.1,1.68Z"></path>
    </g>
  </g>`,il='<defs><style>.cls-1{fill:#f1f2f2;}.cls-2{fill:#ee6b55;}.cls-3{opacity:.2;}.cls-4{opacity:.3;}</style></defs><g id="incorrect"><path class="cls-4" d="M9,.5C4.03,.5,0,4.53,0,9.5s4.03,9,9,9,9-4.03,9-9S13.97,.5,9,.5Z"/><path class="cls-2" d="M9,0C4.03,0,0,4.03,0,9s4.03,9,9,9,9-4.03,9-9S13.97,0,9,0Z"/><g class="cls-3"><path d="M13.99,12.51s.06,.08,.08,.13c.02,.05,.03,.1,.03,.15s-.01,.1-.03,.15c-.02,.05-.05,.09-.08,.13l-1.37,1.37s-.08,.06-.13,.08c-.05,.02-.1,.03-.15,.03s-.1-.01-.15-.03c-.05-.02-.09-.05-.13-.08l-3.06-3.06-3.06,3.06s-.08,.06-.13,.08c-.05,.02-.1,.03-.15,.03s-.1-.01-.15-.03c-.05-.02-.09-.05-.13-.08l-1.37-1.37c-.07-.07-.11-.17-.11-.28s.04-.2,.11-.28l3.06-3.06-3.06-3.06c-.07-.07-.11-.17-.11-.28s.04-.2,.11-.28l1.37-1.37c.07-.07,.17-.11,.28-.11s.2,.04,.28,.11l3.06,3.06,3.06-3.06c.07-.07,.17-.11,.28-.11s.2,.04,.28,.11l1.37,1.37s.06,.08,.08,.13c.02,.05,.03,.1,.03,.15s-.01,.1-.03,.15c-.02,.05-.05,.09-.08,.13l-3.06,3.06,3.06,3.06Z"/></g><path class="cls-1" d="M13.99,12.01s.06,.08,.08,.13c.02,.05,.03,.1,.03,.15s-.01,.1-.03,.15c-.02,.05-.05,.09-.08,.13l-1.37,1.37s-.08,.06-.13,.08c-.05,.02-.1,.03-.15,.03s-.1-.01-.15-.03c-.05-.02-.09-.05-.13-.08l-3.06-3.06-3.06,3.06s-.08,.06-.13,.08c-.05,.02-.1,.03-.15,.03s-.1-.01-.15-.03c-.05-.02-.09-.05-.13-.08l-1.37-1.37c-.07-.07-.11-.17-.11-.28s.04-.2,.11-.28l3.06-3.06-3.06-3.06c-.07-.07-.11-.17-.11-.28s.04-.2,.11-.28l1.37-1.37c.07-.07,.17-.11,.28-.11s.2,.04,.28,.11l3.06,3.06,3.06-3.06c.07-.07,.17-.11,.28-.11s.2,.04,.28,.11l1.37,1.37s.06,.08,.08,.13c.02,.05,.03,.1,.03,.15s-.01,.1-.03,.15c-.02,.05-.05,.09-.08,.13l-3.06,3.06,3.06,3.06Z"/></g>',Wa=`<g id="missed_win">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
        <rect x="2.74" y="8.1" width="12.51" height="3.11" rx="0.36"></rect>
      </g>
      <rect class="${j.ClassNames.Component}" fill="#fff" x="2.74" y="7.6" width="12.51" height="3.11" rx="0.36"></rect>
    </g>
  </g>`,dn=`<g id="mistake">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#e58f2a" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g>
      <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M9.92,15a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08A.31.31,0,0,1,7.39,15V13.19A.32.32,0,0,1,7.48,13l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35A2.42,2.42,0,0,1,7.61,10a2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34.75.75,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07,3,3,0,0,0-.41.18,1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.69L6,5.48a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2,3.07,3.07,0,0,1,.56-.38,5.38,5.38,0,0,1,.89-.37A3.75,3.75,0,0,1,8.9,4a4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.85Z"></path>
      </g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M9.92,14.52a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.69a.32.32,0,0,1,.09-.23l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35a2.42,2.42,0,0,1,.13-.84,2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34A.75.75,0,0,0,9.48,6a1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07A3,3,0,0,0,7.86,6a1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.19L6,5a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2A3.07,3.07,0,0,1,6.81,4a5.38,5.38,0,0,1,.89-.37,3.75,3.75,0,0,1,1.2-.17,4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.35Z"></path>
    </g>
  </g>`,$n=`<g id="resign_black">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g>
      <path d="M4.94,6.34H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.78A.62.62,0,0,0,4.94,6.34Z"></path>
      <path d="M12.33,4.48c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69a.46.46,0,0,0,.12-.44c-.21-.78-.8-3-1.1-4.05C12.62,4.44,12.42,4.36,12.33,4.48Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.ComponentShadow}" fill="#fff" d="M4.94,5.74H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.18A.62.62,0,0,0,4.94,5.74Z"></path>
      <path class="${j.ClassNames.ComponentShadow}" fill="#fff" d="M12.33,3.88c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69A.46.46,0,0,0,13.76,8c-.21-.78-.8-3-1.1-4C12.62,3.84,12.42,3.76,12.33,3.88Z"></path>
    </g>
  </g>`,st=`<g id="resign_white">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <circle class="${j.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>
      <g>
        <path d="M4.94,5.74H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.18A.62.62,0,0,0,4.94,5.74Z"></path>
        <path d="M12.33,3.88c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69A.46.46,0,0,0,13.76,8c-.21-.78-.8-3-1.1-4C12.62,3.84,12.42,3.76,12.33,3.88Z"></path>
      </g>
    </g>
    <path class="${j.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
  </g>`,Ee=`<g id="sharp">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#ad5b8c" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M13.37,11.74,9.25,2.81a.22.22,0,0,0-.1-.11.27.27,0,0,0-.28,0,.18.18,0,0,0-.1.11L4.63,11.74a.26.26,0,0,0,0,.15.25.25,0,0,0,.08.14l2.67,2.29.07.09a.3.3,0,0,1,0,.1v1.08a.25.25,0,0,0,.08.18.24.24,0,0,0,.18.07h2.57a.26.26,0,0,0,.18-.07.25.25,0,0,0,.08-.18V14.51a.16.16,0,0,1,0-.1.47.47,0,0,1,.06-.09L13.31,12a.25.25,0,0,0,.08-.14A.26.26,0,0,0,13.37,11.74ZM9,5v8.73a.24.24,0,0,1-.38.17L5.91,11.76a.3.3,0,0,1-.09-.13.22.22,0,0,1,0-.16L8.84,5a.08.08,0,0,1,0,0h.06A.09.09,0,0,1,9,5S9,5,9,5Z"></path>
    </g>
    <path class="${j.ClassNames.Component}" fill="#fff" d="M13.37,11.24,9.25,2.31a.22.22,0,0,0-.1-.11.26.26,0,0,0-.28,0,.18.18,0,0,0-.1.11L4.63,11.24a.26.26,0,0,0,0,.15.25.25,0,0,0,.08.14l2.67,2.29.07.09a.3.3,0,0,1,0,.1v1.08a.25.25,0,0,0,.08.18.24.24,0,0,0,.18.07h2.57a.26.26,0,0,0,.18-.07.25.25,0,0,0,.08-.18V14a.16.16,0,0,1,0-.1.47.47,0,0,1,.06-.09l2.67-2.29a.25.25,0,0,0,.08-.14A.26.26,0,0,0,13.37,11.24ZM9,4.51v8.73a.24.24,0,0,1-.38.17L5.91,11.26a.3.3,0,0,1-.09-.13.22.22,0,0,1,0-.16l3-6.49a.08.08,0,0,1,0,0h.06a.09.09,0,0,1,.05,0S9,4.49,9,4.51Z"></path>
  </g>`,Rt=`<g id="take_back">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M3.67,10.38a.25.25,0,0,1,.24-.31L5,9.93a.49.49,0,0,1,.2.05.26.26,0,0,1,.1.2,3.77,3.77,0,0,0,1.26,2.34,3.87,3.87,0,0,0,2.52.94,3.53,3.53,0,0,0,1.47-.31,3.72,3.72,0,0,0,1.22-.81,4.13,4.13,0,0,0,.82-1.2,3.74,3.74,0,0,0,0-3A3.94,3.94,0,0,0,11.77,7a3.72,3.72,0,0,0-1.22-.81,3.53,3.53,0,0,0-1.47-.31,3.43,3.43,0,0,0-1.23.22,3.07,3.07,0,0,0-1.09.6L7.85,7.75c.16.14.22.29.16.38s-.18.16-.4.16H4.45a.33.33,0,0,1-.19,0,1,1,0,0,1-.17-.1A.57.57,0,0,1,4,8a.46.46,0,0,1,0-.21V4.6a.4.4,0,0,1,.16-.38c.11,0,.26,0,.42.17L5.6,5.49a5.93,5.93,0,0,1,1.63-1,5.42,5.42,0,0,1,4,.11A5.17,5.17,0,0,1,12.93,5.8a5.48,5.48,0,0,1,1.16,1.73,5.17,5.17,0,0,1,.44,2.12,5,5,0,0,1-.44,2.12,5.54,5.54,0,0,1-2.88,2.91,5.77,5.77,0,0,1-2.13.42,5.39,5.39,0,0,1-1.94-.37,5.36,5.36,0,0,1-2.85-2.48A5.43,5.43,0,0,1,3.67,10.38Z"></path>
    </g>
    <path class="${j.ClassNames.Component}" fill="#fff" d="M3.67,9.88a.25.25,0,0,1,.24-.31L5,9.43a.49.49,0,0,1,.2.05.26.26,0,0,1,.1.2A3.77,3.77,0,0,0,6.56,12,3.87,3.87,0,0,0,9.08,13a3.53,3.53,0,0,0,1.47-.31,3.72,3.72,0,0,0,1.22-.81,4.13,4.13,0,0,0,.82-1.2,3.74,3.74,0,0,0,0-3,3.94,3.94,0,0,0-.82-1.2,3.72,3.72,0,0,0-1.22-.81,3.53,3.53,0,0,0-1.47-.31,3.43,3.43,0,0,0-1.23.22,3.07,3.07,0,0,0-1.09.6L7.85,7.25c.16.14.22.29.16.38s-.18.16-.4.16H4.45a.33.33,0,0,1-.19,0,1,1,0,0,1-.17-.1A.57.57,0,0,1,4,7.47a.46.46,0,0,1,0-.21V4.1a.4.4,0,0,1,.16-.38c.11-.05.26,0,.42.17L5.6,5A5.93,5.93,0,0,1,7.23,4a5.42,5.42,0,0,1,4,.11A5.17,5.17,0,0,1,12.93,5.3,5.48,5.48,0,0,1,14.09,7a5.17,5.17,0,0,1,.44,2.12,5,5,0,0,1-.44,2.12,5.54,5.54,0,0,1-2.88,2.91,5.77,5.77,0,0,1-2.13.42,5.39,5.39,0,0,1-1.94-.37,5.63,5.63,0,0,1-1.65-1,5.59,5.59,0,0,1-1.2-1.5A5.43,5.43,0,0,1,3.67,9.88Z"></path>
  </g>`,rn=`<g id="threat">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
    <path class="${j.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path d="M15.12,9.65a6.14,6.14,0,0,1-3.78,5.65,6.19,6.19,0,0,1-3.53.35A6.15,6.15,0,0,1,3,10.84,6.11,6.11,0,0,1,9,3.53a6.15,6.15,0,0,1,6.12,6.12ZM5,9.65a4,4,0,0,0,.67,2.22,4.09,4.09,0,0,0,1.79,1.47,4,4,0,0,0,5.22-5.22A4,4,0,0,0,5,9.65Z"></path>
      <path d="M6.75,9.65a2.24,2.24,0,0,0,.38,1.25,2.27,2.27,0,0,0,1,.83,2.22,2.22,0,0,0,1.3.12,2.22,2.22,0,0,0,1.76-1.76,2.22,2.22,0,0,0-.13-1.3,2.25,2.25,0,0,0-4.32.86Z"></path>
    </g>
    <g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M15.12,9.15a6.14,6.14,0,0,1-3.78,5.65,6.19,6.19,0,0,1-3.53.35A6.15,6.15,0,0,1,3,10.34,6.11,6.11,0,0,1,9,3a6.15,6.15,0,0,1,6.12,6.12ZM5,9.15a4,4,0,0,0,.67,2.22,4.09,4.09,0,0,0,1.79,1.47,4,4,0,0,0,5.22-5.22A4,4,0,0,0,5,9.15Z"></path>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M6.75,9.15a2.24,2.24,0,0,0,.38,1.25,2.27,2.27,0,0,0,1,.83,2.22,2.22,0,0,0,1.3.12A2.22,2.22,0,0,0,11.2,9.59a2.22,2.22,0,0,0-.13-1.3,2.25,2.25,0,0,0-4.32.86Z"></path>
    </g>
  </g>`,sn=`<path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
<path class="${j.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
<path d="M8.57,7.26,8.11,10l.89.86L9.89,10,9.45,7.26ZM9,12.86A3.35,3.35,0,1,1,12.36,9.5,3.34,3.34,0,0,1,9,12.86Zm.7-8.29V4.12h.82V2.79h-3V4.12H8.3v.45a5,5,0,1,0,1.4,0Z"></path>
<path class="${j.ClassNames.ComponentShadow}" fill="#fff" d="M8.57,6.76,8.11,9.48l.89.86.89-.86L9.45,6.76ZM9,12.36A3.35,3.35,0,1,1,12.36,9,3.34,3.34,0,0,1,9,12.36Zm.7-8.29V3.62h.82V2.29h-3V3.62H8.3v.45a5,5,0,1,0,1.4,0Z"></path>`,Ot=`<path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
<circle class="${j.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>
<path class="${j.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
<path d="M8.57,6.76,8.11,9.48l.89.86.89-.86L9.45,6.76ZM9,12.36A3.35,3.35,0,1,1,12.36,9,3.34,3.34,0,0,1,9,12.36Zm.7-8.29V3.62h.82V2.29h-3V3.62H8.3v.45a5,5,0,1,0,1.4,0Z"></path>`,Nt=`
  <path
    class="${j.ClassNames.Shadow}"
    d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"
    opacity=".3"></path>
  <path
    class="${j.ClassNames.Background}"
    d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"
    fill="#8a8886"></path>
  <path
    d="M3.59,10.23a.25.25,0,0,1,.24-.31l1.08-.15a.49.49,0,0,1,.2.06.25.25,0,0,1,.11.2,3.58,3.58,0,0,0,.42,1.28,3.68,3.68,0,0,0,.84,1.06,3.76,3.76,0,0,0,1.16.69A3.9,3.9,0,0,0,9,13.31,3.58,3.58,0,0,0,10.47,13a3.94,3.94,0,0,0,1.22-.81A4.09,4.09,0,0,0,12.5,11a3.74,3.74,0,0,0,0-3,4.09,4.09,0,0,0-.81-1.2A3.94,3.94,0,0,0,10.47,6,3.65,3.65,0,0,0,9,5.69a3.61,3.61,0,0,0-1.23.21,3.23,3.23,0,0,0-1.09.6L7.77,7.59c.16.15.21.29.16.38s-.18.17-.4.17H4.37a.36.36,0,0,1-.2,0A.76.76,0,0,1,4,8a.52.52,0,0,1-.17-.38V4.45c0-.2.06-.33.17-.38s.25,0,.41.16L5.51,5.34a5.83,5.83,0,0,1,1.64-1A5.19,5.19,0,0,1,9,4.05a5.3,5.3,0,0,1,2.12.44,5,5,0,0,1,1.73,1.16A5.59,5.59,0,0,1,14,7.38a5.23,5.23,0,0,1,.44,2.12A5.16,5.16,0,0,1,14,11.62a5.59,5.59,0,0,1-1.16,1.73,5.32,5.32,0,0,1-1.73,1.18A5.64,5.64,0,0,1,9,15a5.23,5.23,0,0,1-1.94-.37A5.27,5.27,0,0,1,4.21,12.1,5.1,5.1,0,0,1,3.59,10.23Z"
    class="${j.ClassNames.ComponentShadow}"
    opacity=".3"></path>
  <path
    d="M3.59,9.73a.25.25,0,0,1,.24-.31l1.08-.15a.49.49,0,0,1,.2.06.25.25,0,0,1,.11.2,3.58,3.58,0,0,0,.42,1.28,3.68,3.68,0,0,0,.84,1.06,3.76,3.76,0,0,0,1.16.69A3.9,3.9,0,0,0,9,12.81a3.58,3.58,0,0,0,1.47-.31,3.94,3.94,0,0,0,1.22-.81,4.09,4.09,0,0,0,.81-1.2,3.74,3.74,0,0,0,0-3,4.09,4.09,0,0,0-.81-1.2,3.94,3.94,0,0,0-1.22-.81A3.65,3.65,0,0,0,9,5.19a3.61,3.61,0,0,0-1.23.21A3.23,3.23,0,0,0,6.68,6L7.77,7.09c.16.15.21.29.16.38s-.18.17-.4.17H4.37a.36.36,0,0,1-.2,0A.76.76,0,0,1,4,7.49a.52.52,0,0,1-.17-.38V4c0-.2.06-.33.17-.38s.25,0,.41.16L5.51,4.84a5.83,5.83,0,0,1,1.64-1A5.19,5.19,0,0,1,9,3.55,5.3,5.3,0,0,1,11.12,4a5,5,0,0,1,1.73,1.16A5.59,5.59,0,0,1,14,6.88,5.23,5.23,0,0,1,14.45,9,5.16,5.16,0,0,1,14,11.12a5.59,5.59,0,0,1-1.16,1.73A5.32,5.32,0,0,1,11.12,14,5.64,5.64,0,0,1,9,14.45a5.23,5.23,0,0,1-1.94-.37A5.27,5.27,0,0,1,4.21,11.6,5.1,5.1,0,0,1,3.59,9.73Z"
    class="${j.ClassNames.Component}"
    fill="#ffffff"></path>
`,_n=`<g id="winner">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path class="cls-4" d="M4.35,12.66,2.86,7.72a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,7.34a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21.05L6.27,9.15l.14,0h.14a.31.31,0,0,0,.13-.06A.48.48,0,0,0,6.77,9L8.69,5.54a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18L11.22,9a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21-.05.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.37.37,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.66Z"></path>
    </g>
    <path class="${void 0}" fill-rule="evenodd" d="M4.35,12.06,2.86,7.12a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,6.74a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21,0L6.27,8.55l.14,0h.14a.31.31,0,0,0,.13-.06.48.48,0,0,0,.09-.11L8.69,4.94a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18l1.91,3.48a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21,0,.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.38.38,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.06Z"></path>
  </g>`,Cn=`<g id="winner-white" fill="#fff">
    <g>
      <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>
      <path class="${j.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>
    </g>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
      <path class="cls-4" d="M4.35,12.66,2.86,7.72a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,7.34a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21.05L6.27,9.15l.14,0h.14a.31.31,0,0,0,.13-.06A.48.48,0,0,0,6.77,9L8.69,5.54a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18L11.22,9a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21-.05.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.37.37,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.66Z"></path>
    </g>
    <path class="${void 0}" fill-rule="evenodd" d="M4.35,12.06,2.86,7.12a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,6.74a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21,0L6.27,8.55l.14,0h.14a.31.31,0,0,0,.13-.06.48.48,0,0,0,.09-.11L8.69,4.94a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18l1.91,3.48a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21,0,.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.38.38,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.06Z"></path>
  </g>`,Nr=`<g id="interesting">
    <path class="${j.ClassNames.Shadow}" d="m9 .5a9 9 0 1 0 9 9 9 9 0 0 0 -9-9z" opacity="0.3"></path>
    <path  class="${j.ClassNames.Background}" d="m0 9a9 9 0 1 0 9-9 9 9 0 0 0 -9 9z" fill="#7979a1"></path>
    <g  class="${j.ClassNames.Component}" opacity=".2">
      <path d="m4.75 12.9a.28.28 0 0 1 0-.13.25.25 0 0 1 .08-.1.33.33 0 0 1 .23-.1h2 .12l.11.08a.36.36 0 0 1 .07.1.59.59 0 0 1 0 .13v1.9a.36.36 0 0 1 -.09.24.27.27 0 0 1 -.1.08h-.13-2-.12a.44.44 0 0 1 -.19-.19.28.28 0 0 1 0-.13zm-.06-8.8a.41.41 0 0 1 .08-.24.35.35 0 0 1 .23-.1h2.14.13l.11.08a.5.5 0 0 1 .09.24l-.15 6.77c0 .21-.15.31-.34.31h-1.78a.3.3 0 0 1 -.2-.06.3.3 0 0 1 -.1-.1.31.31 0 0 1 0-.13z"/><path d="m12.39 14.82a.25.25 0 0 1 0 .12.28.28 0 0 1 -.08.11l-.1.07h-.12-1.91a.27.27 0 0 1 -.13 0 .39.39 0 0 1 -.05-.12.35.35 0 0 1 -.08-.22v-1.78a.32.32 0 0 1 .09-.23l.1-.07h.12 1.89a.33.33 0 0 1 .23.09.61.61 0 0 1 .07.1.27.27 0 0 1 0 .13zm2.2-7.17a2.49 2.49 0 0 1 -.36.73 4.51 4.51 0 0 1 -.48.6 6 6 0 0 1 -.52.49q-.39.34-.66.63a1 1 0 0 0 -.27.7v.2a.22.22 0 0 1 0 .12.35.35 0 0 1 -.17.17.2.2 0 0 1 -.11 0h-1.75-.12a.23.23 0 0 1 -.1-.07.26.26 0 0 1 -.07-.1.22.22 0 0 1 .02-.12v-.35a2.41 2.41 0 0 1 .12-.84 2.91 2.91 0 0 1 .33-.66 3.38 3.38 0 0 1 .45-.55l.49-.42a6.55 6.55 0 0 0 .61-.62 1 1 0 0 0 .26-.67.66.66 0 0 0 -.08-.34.64.64 0 0 0 -.18-.27 1.18 1.18 0 0 0 -.77-.28 1.66 1.66 0 0 0 -.49.07 3 3 0 0 0 -.41.18 2.29 2.29 0 0 0 -.29.18l-.1.09a.53.53 0 0 1 -.24.06c-.12 0-.19-.07-.21-.13l-1-1.21a.29.29 0 0 1 0-.4 1.36 1.36 0 0 1 .21-.2 3 3 0 0 1 .55-.38 5.87 5.87 0 0 1 .9-.37 3.75 3.75 0 0 1 1.2-.17 4.12 4.12 0 0 1 1.2.19 4 4 0 0 1 1.09.56 2.73 2.73 0 0 1 .77.92 2.7 2.7 0 0 1 .29 1.28 2.72 2.72 0 0 1 -.11.98z"/></g><g fill="#fff"><path d="m4.75 12.4a.28.28 0 0 1 0-.13.25.25 0 0 1 .08-.1.33.33 0 0 1 .23-.1h2 .12l.11.08a.36.36 0 0 1 .07.1.59.59 0 0 1 0 .13v1.9a.36.36 0 0 1 -.09.24.27.27 0 0 1 -.1.08h-.13-2-.12a.44.44 0 0 1 -.19-.19.28.28 0 0 1 0-.13zm-.06-8.8a.41.41 0 0 1 .08-.24.35.35 0 0 1 .23-.1h2.14.13l.11.08a.5.5 0 0 1 .09.24l-.15 6.77c0 .21-.15.31-.34.31h-1.78a.3.3 0 0 1 -.2-.06.3.3 0 0 1 -.07-.1.31.31 0 0 1 0-.13z"/><path d="m12.39 14.32a.25.25 0 0 1 0 .12.28.28 0 0 1 -.08.11l-.1.07h-.12-1.91a.27.27 0 0 1 -.13 0 .39.39 0 0 1 -.1-.08.35.35 0 0 1 -.08-.22v-1.83a.32.32 0 0 1 .09-.23l.1-.07h.12 1.89a.33.33 0 0 1 .23.09.61.61 0 0 1 .07.1.27.27 0 0 1 0 .13zm2.2-7.17a2.49 2.49 0 0 1 -.36.73 4.51 4.51 0 0 1 -.48.6 6 6 0 0 1 -.52.49q-.39.34-.66.63a1 1 0 0 0 -.27.7v.22a.22.22 0 0 1 0 .12.35.35 0 0 1 -.17.17.2.2 0 0 1 -.11 0h-1.75-.12a.23.23 0 0 1 -.1-.07.26.26 0 0 1 -.07-.1.22.22 0 0 1 0-.12v-.35a2.41 2.41 0 0 1 .12-.84 2.91 2.91 0 0 1 .33-.66 3.38 3.38 0 0 1 .45-.55l.49-.42a6.55 6.55 0 0 0 .63-.64 1 1 0 0 0 .26-.67.66.66 0 0 0 -.08-.34.64.64 0 0 0 -.18-.27 1.18 1.18 0 0 0 -.73-.24 1.66 1.66 0 0 0 -.49.07 3 3 0 0 0 -.41.18 2.29 2.29 0 0 0 -.37.21l-.1.09a.53.53 0 0 1 -.24.06c-.12 0-.19-.07-.21-.13l-1-1.21a.29.29 0 0 1 0-.4 1.36 1.36 0 0 1 .21-.2 3 3 0 0 1 .55-.38 5.87 5.87 0 0 1 .9-.37 3.75 3.75 0 0 1 1.2-.17 4.12 4.12 0 0 1 1.2.19 4 4 0 0 1 1.16.52 2.73 2.73 0 0 1 .77.92 2.7 2.7 0 0 1 .29 1.28 2.72 2.72 0 0 1 -.14.95z"/>
    </g>
  </g>`,En=`<g id="warning">
    <g>
      <g class="${j.ClassNames.Shadow}" opacity="0.3">
        <path d="M.32,14.3,6.94,2.83a2.37,2.37,0,0,1,4.11,0L17.68,14.3a2.38,2.38,0,0,1-2.06,3.56H2.38A2.38,2.38,0,0,1,.32,14.3Z"></path>
      </g>
      <path class="${j.ClassNames.Background}" fill="#ec6250" d="M.32,13.8,6.94,2.33a2.37,2.37,0,0,1,4.11,0L17.68,13.8a2.38,2.38,0,0,1-2.06,3.56H2.38A2.38,2.38,0,0,1,.32,13.8Z"></path>
    </g>
    <g>
      <g class="${j.ClassNames.ComponentShadow}" opacity="0.2">
        <path d="M10.21,15.19a.5.5,0,0,1,0,.12.26.26,0,0,1-.07.1.31.31,0,0,1-.22.09H8.1a.25.25,0,0,1-.12,0,.31.31,0,0,1-.09-.07.35.35,0,0,1-.08-.22V13.45a.29.29,0,0,1,.09-.21A.22.22,0,0,1,8,13.17l.11,0H9.9a.31.31,0,0,1,.22.09.27.27,0,0,1,.09.21ZM10.1,11.6a.22.22,0,0,1,0,.11.23.23,0,0,1-.07.1.27.27,0,0,1-.21.07H8.18a.29.29,0,0,1-.31-.28L7.73,5.41a.35.35,0,0,1,.08-.22.23.23,0,0,1,.1-.07A.25.25,0,0,1,8,5.1H10a.32.32,0,0,1,.23.09.35.35,0,0,1,.08.22Z"></path>
      </g>
      <path class="${j.ClassNames.Component}" fill="#fff" d="M10.21,14.69a.5.5,0,0,1,0,.12.26.26,0,0,1-.07.1A.31.31,0,0,1,9.9,15H8.1A.25.25,0,0,1,8,15a.31.31,0,0,1-.09-.07.35.35,0,0,1-.08-.22V13a.29.29,0,0,1,.09-.21A.22.22,0,0,1,8,12.67l.11,0H9.9a.31.31,0,0,1,.22.09.27.27,0,0,1,.09.21ZM10.1,11.1a.22.22,0,0,1,0,.11.23.23,0,0,1-.07.1.27.27,0,0,1-.21.07H8.18a.29.29,0,0,1-.31-.28L7.73,4.91a.35.35,0,0,1,.08-.22.23.23,0,0,1,.1-.07A.25.25,0,0,1,8,4.6H10a.32.32,0,0,1,.23.09.35.35,0,0,1,.08.22Z"></path>
    </g>
  </g>`,Mt=`<g id="equal">
    <path class="${j.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"/>
    <path class="${j.ClassNames.Background}" fill="#a88865" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"/>
    <g class="${j.ClassNames.ComponentShadow}" opacity="0.4">
      <path d="M5.31,8.36l-.15,0A.57.57,0,0,1,5,8.25.57.57,0,0,1,5,8.12a.4.4,0,0,1,0-.15V6a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V8a.4.4,0,0,1,0,.15.57.57,0,0,1-.08.13.57.57,0,0,1-.13.08l-.15,0Z"/>
      <path d="M5.31,13.36l-.15,0A.57.57,0,0,1,5,13.25.57.57,0,0,1,5,13.12a.4.4,0,0,1,0-.15V11a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V13a.4.4,0,0,1,0,.15.33.33,0,0,1-.21.21l-.15,0Z"/>
    </g>
    <g>
      <path class="${j.ClassNames.Component}" fill="#f1f2f2" d="M5.31,7.86l-.15,0A.57.57,0,0,1,5,7.75.57.57,0,0,1,5,7.62a.4.4,0,0,1,0-.15V5.53a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V7.47a.4.4,0,0,1,0,.15.57.57,0,0,1-.08.13.57.57,0,0,1-.13.08l-.15,0Z"/>
      <path class="${j.ClassNames.Component}" fill="#f1f2f2" d="M5.31,12.86l-.15,0A.57.57,0,0,1,5,12.75.57.57,0,0,1,5,12.62a.4.4,0,0,1,0-.15V10.53a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39v1.94a.4.4,0,0,1,0,.15.33.33,0,0,1-.21.21l-.15,0Z"/>
    </g>
  </g>`,Ar={[ie.Alternative]:qe,[ie.BestMove]:Qt,[ie.Blunder]:Fn,[ie.Book]:Vn,[ie.Brilliant]:Un,[ie.CheckmateBlack]:an,[ie.CheckmateWhite]:gs,[ie.Correct]:na,[ie.Critical]:Qs,[ie.DrawBlack]:_s,[ie.DrawWhite]:Js,[ie.Excellent]:ja,[ie.FastWin]:_a,[ie.Forced]:bs,[ie.FreePiece]:el,[ie.Gamechanger]:tl,[ie.Good]:qa,[ie.GreatFind]:ba,[ie.Inaccuracy]:ys,[ie.Incorrect]:nl,[ie.Mate]:rl,[ie.Miss]:il,[ie.MissedWin]:Wa,[ie.Mistake]:dn,[ie.ResignBlack]:$n,[ie.ResignWhite]:st,[ie.Sharp]:Ee,[ie.Takeback]:Rt,[ie.Threat]:rn,[ie.TimeoutBlack]:sn,[ie.TimeoutWhite]:Ot,[ie.Undo]:Nt,[ie.Winner]:_n,[ie.WinnerWhite]:Cn,[ie.Interesting]:Nr,[ie.Warning]:En,[ie.Equal]:Mt};function kn({className:e="",path:t="",size:n="24",viewBox:r="0 0 18 19"}){return`
    <svg xmlns="http://www.w3.org/2000/svg" class="${e}" width="${n}" height="${n}" viewBox="${r}">
      ${t}
    </svg>
  `}function Wn({square:e,isFlipped:t,effectEl:n}){const r=St(e,t);r.top&&n.classList.add("tuck-top"),r.right&&n.classList.add("tuck-right")}function St(e,t){const n={top:t?"1":"8",right:t?"a":"h"};return{top:e.includes(n.top),right:e.includes(n.right)}}function qr({board:e,el:t,options:n}){const r=document.createComment("/Effects");e.addToDom({el:r,insertAfter:!0,type:b.HoverSquare});const i=new Map;return{addEffects:o,getEffectElements:l,removeEffects:s};function o(d){d.forEach(f=>{const{data:{square:h,type:g},key:m}=f,S=document.createElement("div");S.classList.add("effect"),S.innerHTML=kn({path:Ar[g],size:"100%"}),fe({el:S,square:h}),n.test&&Te(S,{[Ne.Element]:yn.Effect,[Ne.Square]:h,[Ne.Type]:g}),Ue(h)&&Wn({square:h,isFlipped:e.el.classList.contains("flipped"),effectEl:S});const P=i.get(m);P&&e.el.removeChild(P),t.insertBefore(S,r),i.set(m,S)})}function s(d){d.forEach(f=>{const{key:h}=f,g=i.get(h);g&&(e.el.removeChild(g),i.delete(h))})}function l(){return i}}function Gr(e){const{api:t,options:n,renderer:r}=e;if(r?.extendRenderer(qr),!t.markings)return;const i=t.markings,o=n.allowMarkings?i.getAllWhere({types:[Bn]}):[];r?.addEffects(o,e)}function ui(){return[{condition:Ur(Bn),handler:t},{condition:Ut(Bn),handler:n},{condition:Je(M.InstanceEvents.RendererSet),handler:e}];function e(r,i){Gr(i)}function t(r,i){const{renderer:o}=i,s=r.data.filter(Gt(Bn));o?.addEffects(s,i)}function n(r,i){const{renderer:o}=i,s=r.data.filter(Gt(Bn));o?.removeEffects(s,i)}}function di(){return{create:Gr,match:ui(),name:Dn.Plugin.Name,destroy:e};function e(t){const{api:n,renderer:r}=t;if(!n.markings)return;const o=n.markings.getAllWhere({types:[Bn]});r?.removeEffects(o,t)}}function Ki(){return{match:[{condition:xt([M.InstanceEvents.RendererSet,M.APIEvents.Load]),handler:e}],name:E.Plugin.Name};function e(t,n){var r;(r=n?.renderer)==null||r.fadeSetup(n)}}var Br;(function(e){e.FlipBoardModifierKey="x",function(t){t.Name="flip-board"}(e.Plugin||(e.Plugin={}))})(Br||(Br={}));var bi;(function(e){(function(t){t.Name="keys"})(e.Plugin||(e.Plugin={})),function(t){t.Keydown="Keydown",t.Keyup="Keyup"}(e.Events||(e.Events={}))})(bi||(bi={}));function oo(e=Br.FlipBoardModifierKey){let t;return{match:[{condition:xt([M.InstanceEvents.Create,M.InstanceEvents.RendererSet,M.OptionsEvents.Update]),handler:r},{condition:Je(bi.Events.Keydown),handler:n}],name:Br.Plugin.Name};function n(i,o){const{api:s,options:l,queue:d}=o;i.data===e&&d.add(s.setOptions,{flipped:!l.flipped})}function r(i,o){const{options:s,renderer:l,state:d}=o;if(l){if(s.flipped!==t){l.flipBoard(s.flipped,o);const f=d.get(M.State.PromotionMove);f&&l.openPromotionWindow(f,o)}t=s.flipped}}}function Ai(e){return Object.prototype.toString.call(e)==="[object Object]"}function Qr(e,t,{isDuplicateWhen:n}={}){const r=new Set(e);return t.forEach(i=>{if(Ai(i)&&n){const o=e.find(s=>n(s,i));o&&r.delete(o);return}r.delete(i)}),[...r]}function fi(e,t){return e.key===t.key&&e.data.color===t.data.color}function $i(e){const t=new Set(e),n=new Map;return Ce(ge({},t),{addModule:i,getModules:s,removeModule:l,getAll:o,update:d,clearState:r});function r(){n.clear()}function i(f){return t.add(f)}function o(){return Array.from(n.values())}function s(){return Array.from(t)}function l(f){return t.delete(f)}function d(...f){const h=o();r();const g=Array.from(s().reduce((P,I)=>(I(...f).forEach(D=>{P.set(D.data.square,D)}),P),new Map).values());g.forEach(P=>n.set(P.data.square,P));const m=Qr(g,h,{isDuplicateWhen:fi}),S=Qr(h,g,{isDuplicateWhen:fi});return{toAdd:m,toRemove:S}}}function ya(e){return function(){return $i(e)}}function Zi(e){const{api:t,renderer:n}=e;if(!t.markings||!t.highlights)return;const r=t.highlights;r.clearState();const{toAdd:i}=r.update({data:{},type:"DummyHighlightInitEventName"},e);n?.addHighlights(i,e)}function Si(e){const t=new Set(Array.isArray(e)?e:Object.values(e));return function(r){return!t.has(r.type)}}function ao(){return[{condition:Si([M.UserEvents.Pointermove,M.InstanceEvents.RendererSet,M.APIEvents.NodeUpdated]),handler:t},{condition:Je(M.InstanceEvents.RendererSet),handler:e}];function e(n,r){Zi(r)}function t(n,r){const{api:i,renderer:o}=r;if(!o)return;const s=i.highlights,{toAdd:l,toRemove:d}=s.update(n,r);o.removeHighlights(d,r),o.addHighlights(l,r)}}function Ea(e){return{api:ya(e),destroy:t,create:Zi,match:ao(),name:bt.Plugin.Name};function t(n){const{api:r,renderer:i}=n,o=r.highlights;i?.removeHighlights(o.getAll(),n)}}function Wr(...e){return function(n,r){return e.every(i=>i(n,r))}}function ol(e){return function(n,r){var i,o;return!!((o=(i=r.api)==null?void 0:i.getOptions)!=null&&o.call(i)[e])}}function Ka(){const e=(0,w.c)({data:{square:void 0},initialState:"hidden",states:{hidden:{dragPiece:n=>({data:{square:n},nextState:"showing"})},showing:{dragPiece:n=>({data:{square:n},nextState:"showing"}),dropPiece:()=>({nextState:"hidden"}),setOptionToFalse:()=>({nextState:"hidden"})}}});return{match:[{condition:Wr(ol(pr.BooleanOptions.HoverSquareOutline),Si([M.APIEvents.ClearMarkings,In.Events.Tick])),handler:t}],name:de.Plugin.Name};function t(n,r){const{options:i,renderer:o,state:s}=r,l=s.get(M.State.HideHoverSquare)!==!0&&s.get(M.State.MachineState)!==K.States.PromotionAreaShowing&&s.get(M.State.DraggingPiece),d=n.data&&(n.data.square||n.data.squareInsideBoard||e.getData().square||l);let f=!1;i.highlightMoves?l?f=e.transition("dragPiece",d):f=e.transition("dropPiece"):f=e.transition("setOptionToFalse"),!(!f||!o)&&(e.getCurrentState()==="hidden"?o.hideHoverSquare(r):o.showHoverSquare(e.getData().square,r))}}function $a(e){return Array.isArray(e)?e:[e]}function al(e){return e.reduce((t,n,r,i)=>{if(r%2===0)return t;const o=i[r-1];return t[o]=n,t},{})}var Ti;(function(e){e.Alt="a",e.Ctrl="l",e.Custom="c",e.Default="d",e.Shift="s"})(Ti||(Ti={}));function Ri(e){var t;const{color:n,data:r=[],type:i}=e,o=al(r);Object.keys(o).forEach(h=>{o[h]=decodeURIComponent(o[h])});const s=o,{persistent:l}=s,d=Be(s,["persistent"]),f={key:Es(e.key,e.type),node:!0,data:Ce(ge({},d),{keyPressed:(t=d.keyPressed)!=null?t:Aa(n)}),type:i};return typeof l<"u"&&(f.persistent=l==="true"),f}function Es(e,t){return`${t}|${e}`}function Aa(e){switch(e){case Ti.Alt:return _r.Alt;case Ti.Default:return _r.None;case Ti.Shift:return _r.Shift;case Ti.Ctrl:return _r.Ctrl;default:return}}function wa(e,t){const n=[],r=t??e.markings();return Object.values(r).forEach(i=>{Object.values(i).forEach(o=>{n.push(Ri(o))})}),n}function ra(e,t,n){const{key:r}=t,i=e.ids(),o=t.node&&typeof t.node=="object",{move:s,line:l}=t.node;o&&e.selectPosition(s,l);const d=wa(e,n);return o&&e.selectPosition(i.move,i.line),!!d.find(f=>f.key===r)}function As(e,...t){const n=ge({},e);return t.forEach(r=>{delete n[r]}),n}function Za(e){return Object.entries(e).reduce((t,[n,r])=>(r===void 0||t.push(n,r.toString()),t),[])}function Ya(e){const{data:t,persistent:n}=e,r=n!==void 0?Ce(ge({},t),{persistent:n}):t,i=Ss(t.keyPressed),o=i===Ti.Custom?r:As(r,"color");return Object.keys(o).forEach(s=>{o[s]=encodeURIComponent(o[s])}),{color:i!==Ti.Custom?i:void 0,data:Za(o),key:ws(e),type:e.type}}function ws(e){const{data:{from:t,square:n,to:r},key:i}=e;return n||(t&&r?`${t}${r}`:i)}function Ss(e){switch(e){case _r.Alt:return Ti.Alt;case _r.None:return Ti.Default;case _r.Shift:return Ti.Shift;case _r.Ctrl:return Ti.Ctrl;default:return Ti.Custom}}var zr;(function(e){(function(t){t.$1="$1",t.$2="$2",t.$3="$3",t.$4="$4",t.$5="$5",t.$6="$6",t.$9="$9",t.$10="$10",t.$11="$11",t.$12="$12",t.$13="$13",t.$14="$14",t.$15="$15",t.$16="$16",t.$17="$17",t.$18="$18",t.$19="$19",t.$22="$22",t.$36="$36",t.$40="$40",t.$146="$146",t.$256="$256"})(e.Nags||(e.Nags={})),function(t){t.$1="!",t.$2="?",t.$3="!!",t.$4="??",t.$5="!?",t.$6="?!",t.$9="\u2612",t.$10="=",t.$11="=",t.$12="=",t.$13="\u221E",t.$14="\u2A72",t.$15="\u2A71",t.$16="\xB1",t.$17="\u2213",t.$18="+-",t.$19="-+",t.$22="\u2A00",t.$40="\u2191",t.$146="N",t.$256="=/\u221E"}(e.Values||(e.Values={})),function(t){t.GreatFind="!",t.Mistake="?",t.Brilliant="!!",t.Blunder="??",t.Interesting="!?",t.Inaccuracy="?!"}(e.Effects||(e.Effects={})),function(t){t.Drawish="=",t.Unclear="\u221E",t.WhiteHasModerateAdvantage="\xB1",t.BlackHasModerateAdvantage="\u2213",t.WhiteHasDecisiveAdvantage="+-",t.BlackHasDecisiveAdvantage="-+",t.PositionInZugzwang="\u2A00",t.WithCompensation="\u2191",t.Novelty="N",t.WithAttack="=/\u221E"}(e.Additional||(e.Additional={}))})(zr||(zr={}));function Xa(e,t,n){const r=Ya(t),i=e.ids(),o=t.node&&typeof t.node=="object";if(o){const{move:l,line:d}=t.node;e.selectPosition(l,d)}e.mark(r,!0),zr.Effects[t.data.type]&&n.updateNode(o?t.node:i,{annotation:"",isSync:!0}),o&&e.selectPosition(i.move,i.line)}function sl(e,t,n){const r=Ya(t),i=e.ids(),o=t.node&&typeof t.node=="object";if(o){const{move:h,line:g}=t.node;e.selectPosition(h,g)}e.mark(r);const s=zr.Effects[t.data.type],l=n.getSelectedNode(),d=l?.to===t.data.square,f=l?.annotation===s;s&&d&&!f&&n.updateNode(o?t.node:i,{annotation:s,isSync:!0}),o&&e.selectPosition(i.move,i.line)}const Yi=[M.APIEvents.CreateGame,M.APIEvents.DeletePosition,M.APIEvents.Load,M.APIEvents.Move,M.APIEvents.MoveBackward,M.APIEvents.MoveForward,M.APIEvents.MoveVariation,M.APIEvents.PromoteVariation,M.APIEvents.SelectLineEnd,M.APIEvents.SelectLineStart,M.APIEvents.SelectNode,M.APIEvents.Reload,M.APIEvents.ResetToMainLine,M.APIEvents.Undo];function Go(...e){if(e.length===1)return e[0];const t=new Set;for(const n of e)for(const r of n)e.every(i=>i.has(r))&&t.add(r);return t}function ll(...e){const t=new Set;for(const n of e)for(const r of n)t.add(r);return t}function ia({batchCallbacks:e=!0,onEntryAdded:t,onEntryRemoved:n,primaryKey:r="id"}={primaryKey:"id"}){const i=new Map,o=new Map,{flush:s,isBatching:l,stack:d,startBatching:f}=I({added:t,removed:n});function h(Ft){return e&&l()?d("added")(Ft):t?.(Ft)}function g(Ft){return e&&l()?d("removed")(Ft):n?.(Ft)}return{addOne:P,addMany:m(S),batch:m,getAll:D,getManyByTags:Ze,getMatchingKeys:mt,getMap:Ye,getMany:be,getOne:Se,removeAll:m(zn),removeMany:m(Sn),removeManyByTags:m(tn),removeOne:Ct};function m(Ft){return(...Ln)=>{f();const Zn=Ft(...Ln);return s(),Zn}}function S(Ft,Ln){return Ft.map((br,tr)=>P(br,Ln?.[tr]))}function P(Ft,Ln){const Zn=Ft[r],br=i.get(Zn);return br&&(i.delete(Zn),g?.(br)),Ln?.forEach(tr=>{var kr;o.get(tr)||o.set(tr,new Set),(kr=o.get(tr))==null||kr.add(Zn)}),i.set(Zn,Ft),h?.(Ft),Zn}function I(Ft){let Ln=!1;const Zn=new Map;return Object.entries(Ft).forEach(([Qn,ri])=>{ri&&Zn.set(Qn,{callback:ri,entries:new Set})}),{flush:kr,isBatching(){return Ln},stack:br,startBatching:tr};function br(Qn){return function(Bi){var Fi;(Fi=Zn.get(Qn))==null||Fi.entries.add(Bi)}}function tr(){Ln=!0}function kr(){Zn.forEach(Qn=>{var ri;const Bi=Array.from(Qn.entries.values());Bi.length&&((ri=Qn.callback)==null||ri.call(Qn,Bi),Qn.entries.clear()),Ln=!1})}}function D(){return Array.from(i.values())}function be(Ft){return Ft.map(Ln=>i.get(Ln)).filter(Ln=>Ln!==void 0)}function Ye(){return i}function Se(Ft){return i.get(Ft)}function Ze(Ft,Ln={}){return mt(Ft,Ln).map(Zn=>i.get(Zn)).filter(Zn=>Zn!==void 0)}function mt(Ft,Ln={}){const{matchAll:Zn}=Ln,br=Ft.map(kr=>o.get(kr)).filter(kr=>kr!==void 0);let tr;return Zn?tr=Array.from(Go(...br)):tr=Array.from(ll(...br)),tr}function zn(){for(const[Ft,Ln]of i.entries())g?.(Ln);return i.clear(),o.clear(),!0}function Sn(Ft){return Ft.every(Ct)}function tn(Ft,Ln={}){return mt(Ft,Ln).every(Zn=>Ct(Zn))}function Ct(Ft){var Ln;const Zn=i.get(Ft);Zn&&(i.delete(Ft),g?.(Zn));const br=o.entries();for(const[tr,kr]of br)kr.has(Ft)&&kr.delete(Ft),((Ln=o.get(tr))==null?void 0:Ln.size)===0&&o.delete(tr);return!0}}function bo(e){const{node:t,persistent:n,tags:r=[],type:i}=e;return[t?"node":"board",n?"persistent":"temporary",...r,i]}function Qa(e){const{from:t,square:n,to:r}=e.data,i=n?[n]:[t,r];for(const o of i)if(!ul(o))return!1;return!0}function ul(e){return/^([a-h][1-8])$/.test(e)}function Mi(e,t){const n={a:Object.getOwnPropertyNames(e),b:Object.getOwnPropertyNames(t)};return n.a.length!==n.b.length?!1:n.a.every(r=>e[r]===t[r])}function Cs({generateKey:e=N,context:t,onMarkingAdded:n,onMarkingRemoved:r}={}){const i=ia({batchCallbacks:!0,onEntryAdded:n,onEntryRemoved:r,primaryKey:"key"}),o=ia({batchCallbacks:!0,onEntryAdded:n,onEntryRemoved:r,primaryKey:"id"});return{addOne:d,addMany:s,getMany:i.getMany,getAll:i.getAll,getAllWhere:g,getOne:i.getOne,removeAll:i.removeAll,removeAllWhere:S,removeOne:h,removeMany:f,toggleMany:P,toggleOne:I,factory:{buildStandardAnalysisHighlight:be,buildStandardArrow:Ye}};function s(Se){return l(Se)}function l(Se){return Se.map(d)}function d(Se){if(!Qa(Se))return null;const Ze=bo(Se);if(Se.node&&typeof Se.node=="object"){const mt=t?.api.getSelectedNode(),zn=mt?.ids.move===Se.node.move&&mt?.ids.line===Se.node.line,Sn=D(Se),{move:tn,line:Ct}=Sn.node;if(Sn.id=`${Sn.key}-${tn}|${Ct}`,o.addOne(Sn,Ze),zn)Se.node=!0;else return Sn.key}return i.addOne(D(Se),Ze)}function f(Se){return Se.every(h)}function h(Se,Ze){if(typeof Se!="string"&&Se.node&&typeof Se.node=="object")return h(Se.key,Se.node),!1;if(Ze&&typeof Ze=="object"){const{move:mt,line:zn}=Ze;o.removeOne(`${Se}-${mt}|${zn}`)}return typeof Se!="string"?!1:i.removeOne(Se)}function g(Se={}){return m(Se).map(Ze=>i.getMap().get(Ze)).filter(Boolean)}function m(Se={}){const{node:Ze,persistent:mt,tags:zn,types:Sn}=Se;let tn;Ze!==void 0&&(tn=Ze?"node":"board");let Ct;mt!==void 0&&(Ct=mt?"persistent":"temporary");const Ft=[tn,Ct,zn,Sn].filter(Zn=>Zn!==void 0);if(!Ft.length)return Array.from(i.getMap().keys());const Ln=Ft.map($a).map(Zn=>new Set(i.getMatchingKeys(Zn)));return Array.from(Go(...Ln))}function S(Se={}){var Ze;return((Ze=Se.types)==null?void 0:Ze.length)===0&&(Se.types=void 0),i.removeMany(m(Se))}function P(Se){return Se.map(I)}function I(Se){const Ze=D(Se),mt=i.getOne(Ze.key);return mt&&Mi(mt.data,Ze.data)?i.removeOne(Ze.key):d(Ze)}function D(Se){return Ce(ge({},Se),{key:Se.key||e(Se)})}function be(Se,Ze=_r.None){const mt=t?.api.getOptions?t?.api.getOptions():z();return{data:{keyPressed:Ze,opacity:mt.analysisHighlightOpacity,square:Se},node:!0,persistent:!1,type:er}}function Ye(Se,Ze,mt=_r.None){const zn=t?.api.getOptions?t?.api.getOptions():z();return{data:{keyPressed:mt,from:Se,opacity:zn.analysisHighlightOpacity,to:Ze},node:!0,persistent:!1,type:Qe}}}function N(e){const{data:{from:t,square:n,to:r},type:i}=e;if(!n&&!(t&&r))throw new Error('Markings that do not have a "square" property must provide a "from" and "to"');const o=n||`${t}${r}`;return`${i}|${o}`}function J(e){if(!e)return;const t=new Map;return Object.keys(zr.Effects).forEach(n=>{t.set(zr.Effects[n],n)}),t.get(e)}const B=e=>(t,n)=>{n.api.getOptions().syncEffects&&e(t,n)},ce=[{condition:xt(Yi),handler:rt},{condition:Je(M.APIEvents.Mark),handler:B(ee)},{condition:Je(M.APIEvents.Unmark),handler:B(le)},{condition:Je(M.APIEvents.Load),handler:B(Lt)},{condition:Je(M.APIEvents.NodeUpdated),handler:B(ut)}];function ee(e,t){const{data:n}=e,{game:r}=t.api.getContext();(Array.isArray(n)?n:[n]).forEach(o=>{o.node&&!ra(r,o)&&sl(r,o,t.api)})}function le(e,t){const{data:n}=e,{game:r}=t.api.getContext();(Array.isArray(n)?n:[n]).forEach(o=>{o.node&&ra(r,o)&&Xa(r,o,t.api)})}function rt(e,t){const{api:n,queue:r}=t;e.data.plyDiff===0&&e.data.lineDiff===0||r.add(()=>ze(n))}function Lt(e,t){const{api:n}=t,r=n.getRawLines(),i=[];ze(n),r.forEach(o=>{o.forEach(s=>{const l=J(s.annotation);l&&i.push({data:{square:s.to,type:l},type:Bn,node:s.ids,persistent:!0})})}),n.markings.addMany(i)}function ut(e,t){var n,r,i;const{api:o}=t,{ids:s,changes:l}=e.data;if(!("annotation"in l)||l.isSync)return;const d=o.getPosition(s.move,s.line);if(!("to"in d))return;const f=J(l.annotation),h=o.getNodeByIds(s);if(!f&&h?.commands){const g=((i=(r=(n=h.commands.c_effect)==null?void 0:n.split(","))==null?void 0:r.find(P=>P.includes(h.to)))==null?void 0:i.split(";"))||[],m=g[g.length-1];zr.Effects[m]&&o.markings.addOne({data:g,key:h?.to,type:Bn,persistent:!0})}if(!f){const g=N({data:{square:d.to},type:Bn});o.markings.removeOne(g,s);return}o.markings.addOne({data:{square:d.to,type:f},type:Bn,node:s,persistent:!0})}function ze(e){const{game:t}=e.getContext(),n=wa(t);e.markings.removeAllWhere({node:!0}),n.length&&e.markings.addMany(n)}function xn(e,t){return e.reduce((n,r)=>(n[+!t(r)].push(r),n),[[],[]])}function Yn(e){const{respond:t}=e;return Cs({onMarkingAdded:r=>n("Mark",r),onMarkingRemoved:r=>n("Unmark",r),context:e});function n(r,i){const o={Mark:ee,Unmark:le}[r],s=e.api.getContext().game.ids(),[l,d]=xn($a(i),f=>Ai(f.node)&&s!==f.node);l.length&&o({data:l},e),d.length&&t(M.APIEvents[r],d)}}var lr;(function(e){(function(t){t.Name="markings"})(e.Plugin||(e.Plugin={}))})(lr||(lr={}));function pt(){return{api:Yn,match:ce,name:lr.Plugin.Name}}function Lr(e){return[...new Set(e)]}var ct;(function(e){(function(n){n[n.White=1]="White",n[n.Black=2]="Black"})(e.ColorsAsNumbers||(e.ColorsAsNumbers={}));let t;(function(n){n.Bughouse="bughouse",n.Chess="chess",n.Chess960="chess960",n.Crazyhouse="crazyhouse",n.KingOfTheHill="kingofthehill",n.ThreeCheck="threecheck"})(t=e.Variants||(e.Variants={})),e.JCEVariantTypes={[t.Bughouse]:"Bughouse",[t.Chess]:"Chess",[t.Chess960]:"Chess960",[t.Crazyhouse]:"Crazyhouse",[t.ThreeCheck]:"3-check",[t.KingOfTheHill]:"King of the Hill"},function(n){n.White="w",n.Black="b"}(e.ColorsAsLetters||(e.ColorsAsLetters={})),function(n){n.White="white",n.Black="black"}(e.ColorsAsWords||(e.ColorsAsWords={})),e.DefaultTimeControl=5,function(n){n.Black="?",n.Event="?",n.Date="????.??.??",n.Site="?",n.Value="?",n.Result="*",n.Round="?",n.White="?"}(e.EmptyPGNHeaders||(e.EmptyPGNHeaders={})),function(n){(function(r){r[r.Capture=1]="Capture",r[r.BigPawn=2]="BigPawn",r[r.EPCapture=4]="EPCapture",r[r.AnyCapture=5]="AnyCapture",r[r.Promotion=8]="Promotion",r[r.CapturePromotion=9]="CapturePromotion",r[r.KingsideCastle=16]="KingsideCastle",r[r.QueensideCastle=32]="QueensideCastle",r[r.AnyCastle=48]="AnyCastle",r[r.Drop=64]="Drop",r[r.DropOrCapture=69]="DropOrCapture",r[r.DropOrPromote=72]="DropOrPromote"})(n.Flags||(n.Flags={})),function(r){r[r.Capture=0]="Capture",r[r.Castle=1]="Castle",r[r.Check=2]="Check",r[r.Checkmate=3]="Checkmate",r[r.Normal=4]="Normal",r[r.Premove=5]="Premove",r[r.Promotion=6]="Promotion"}(n.Types||(n.Types={}))}(e.Move||(e.Move={})),function(n){(function(r){(function(i){(function(o){(function(s){s.Arrows="arrows",s.Effects="effects",s.Pieces="pieces"})(o.Targets||(o.Targets={})),function(s){s.Above="above",s.Below="below"}(o.Positions||(o.Positions={}))})(i.VisualOrder||(i.VisualOrder={})),function(o){o.Image="Image",o.Star="Star",o.TextBox="TextBox"}(i.Types||(i.Types={}))})(r.CustomItem||(r.CustomItem={})),function(i){i.alt="a",i.custom="c",i.default="d",i.shift="s",i.ctrl="l"}(r.ColorKeys||(r.ColorKeys={})),function(i){i.a="alt",i.c="custom",i.d="default",i.s="shift",i.l="ctrl"}(r.JCEColorsMap||(r.JCEColorsMap={})),function(i){i.Arrow="arrow",i.Effect="effect",i.Square="square",i.CustomItem="customItem"}(r.Types||(r.Types={}))})(n.Marking||(n.Marking={}))}(e.Node||(e.Node={})),function(n){(function(r){r.p="pawn",r.n="knight",r.b="bishop",r.r="rook",r.q="queen",r.k="king"})(n.Names||(n.Names={})),function(r){r.Pawn="p",r.Knight="n",r.Bishop="b",r.Rook="r",r.Queen="q",r.King="k"}(n.Types||(n.Types={}))}(e.Piece||(e.Piece={})),function(n){(function(r){r.Color="#ffff00",r[r.Opacity=.5]="Opacity"})(n.Defaults||(n.Defaults={})),function(r){r.Analysis="analysis",r.Move="move",r.Premove="premove",r.Selection="selection"}(n.Types||(n.Types={}))}(e.Highlight||(e.Highlight={})),function(n){n.Blitz="blitz",n.Bullet="bullet",n.Rapid="rapid"}(e.TimeControlTypes||(e.TimeControlTypes={})),function(n){n.Black="0-1",n.Draw="1/2-1/2",n.None="*",n.White="1-0"}(e.Results||(e.Results={}))})(ct||(ct={}));function hn({addMoveHints:e,addCaptureHints:t,context:n,currentHints:r,getNextHints:i,removeHints:o}){let s=r;const{api:l,mode:d,options:f,state:h}=n;if(!f||!f.highlightLegalMoves||!d.isAllowedToMove())return o([...r],n),s.length=0,s;const g=h.get(M.State.SelectedPiece)||h.get(M.State.DraggingPiece);if(!g)return s.length&&(o(s,n),s=[]),s;const m=h.get(M.State.MachineState)===K.States.PromotionAreaShowing?[]:l.getLegalMoves().filter(Ze=>Ze.from===g),S=Lr(m.map(Ze=>Ze.to));S.push(...Se(m));const P=s.filter(Ze=>!S.includes(Ze));o(P,n);const I=i(S),D=[],be=[],Ye=l.getPieces().keys();return I.forEach(Ze=>{t&&Ye.includes(Ze)?be.push(Ze):D.push(Ze)}),D.length&&e(D,n),be.length&&t?.(be,n),s.filter(Ze=>!P.includes(Ze)).concat(I);function Se(Ze){if(l.getVariant()===ct.Variants.Chess960||Ze.length===0||Ze[0].from===void 0)return[];const mt=l.getPieces().getCollection(),zn=mt[Ze[0].from];return zn?.type!=="k"?[]:Ze.reduce((Sn,tn)=>{let Ct;if(tn.san==="O-O-O")Ct=tn.color===ct.ColorsAsNumbers.White?"a1":"a8";else if(tn.san==="O-O")Ct=tn.color===ct.ColorsAsNumbers.White?"h1":"h8";else return Sn;const Ft=mt[Ct];return Ft?.type.toLowerCase()==="r"&&Ft?.color===zn.color&&!Ft?.promoted&&tn.to!==Ct&&Sn.push(Ct),Sn},[])}}function cu(){let e=[];return{match:[{condition:Si([M.UserEvents.Pointermove,In.Events.Tick]),handler:n},{condition:Je(M.InstanceEvents.RendererSet),handler:t}],name:Ae.Plugin.Name};function t(r,i){e=[],n(r,i)}function n(r,i){const{renderer:o}=i;o&&(e=hn({addMoveHints:o.addMoveHints,addCaptureHints:o.addCaptureHints,context:i,currentHints:e,getNextHints:s=>s.filter(l=>!e.includes(l)),removeHints:o.removeHints}))}}function Wc(){return{match:[{condition:xt(M.APIEvents),handler:t},{condition:Je(M.InstanceEvents.RendererSet),handler:e}],name:on.Plugin.Name};function e(n,r){const{api:i,renderer:o}=r;o?.loadPieces({pieces:i.getPieces()},r)}function t(n,r){const{renderer:i}=r;if(!i)return;if(n.type===M.APIEvents.IllegalMove){i.illegalMove(!1,r);return}const{plyDiff:o,move:s,pieces:l}=n.data;if(l){i.loadPieces({pieces:l},r);return}if(s&&o===-1){s.san!=="--"&&i.undoMove(s,r);return}s&&i.makeMove(s,r)}}var cl;(function(e){(function(t){t.StateDesynchronisation="StateDesynchronisation"})(e.ErrorCodes||(e.ErrorCodes={})),function(t){t.Name="rendererErrorCatcher"}(e.Plugin||(e.Plugin={}))})(cl||(cl={}));function xh({context:e,method:t}){return function(...r){try{return t(...r)}catch(i){const{api:o,renderer:s}=e;console.error(`Board position reloaded due to game and renderer state desynchronisation:
`,i),o.logger.log({code:cl.ErrorCodes.StateDesynchronisation,data:i,level:Z.Levels.Error}),s?.loadPieces({pieces:o.getPieces(),reloadAll:!0},e)}}}const Ih=()=>!1;function Kc(){let e={};return{create:t,destroy:n,match:[{condition:Je(M.InstanceEvents.RendererSet),handler:(r,i)=>t(i)}],name:cl.Plugin.Name};function t(r){const{options:i,renderer:o}=r;!o||Ih()||i.test||["dragPiece","dropPiece","makeMove","removePiece","undoMove"].forEach(s=>{const l=xh({context:r,method:o[s]});e[s]=o[s],o[s]=l})}function n(r){const{renderer:i}=r;i&&(Object.keys(e).forEach(o=>{i[o]=e[o]}),e={})}}const du={enPassant:"https://www.chess.com/article/view/how-to-capture-en-passant",soundsDefault:"https://www.chess.com/bundles/web/sounds",soundsTheme:"https://images.chesscomfiles.com/chess-themes/sounds/",webglAssetPaths:"__CHESSCOM_WEBGL_ASSET_PATHS__",webglDataUrl:"https://www.chess.com/bundles/web/images/webgl_data",webglDataUrlDev:"static/webgl_data"};function Rh({theme:e="default",type:t,format:n}){return`${du.soundsTheme}_${n.toUpperCase()}_/${e}/${t}.${n}`}function Oh(e,t){return["webm","ogg","mp3","wav"].map(n=>Rh({format:n,theme:e,type:t}))}function $c(e,t){return["webm","ogg","mp3","wav"].map(n=>`${e}/${n}/${t}.${n}`)}function Xi(e){return["webm","ogg","mp3","wav"].reduce((n,r)=>(e[r]&&n.push(e[r]),n),[])}function Zc(e){return{[Q.BoardSounds.GameStart]:(0,w.l)(Xi(e.gameStart)),[Q.BoardSounds.GameEnd]:(0,w.l)(Xi(e.gameEnd)),[Q.BoardSounds.Capture]:(0,w.l)(Xi(e.capture)),[Q.BoardSounds.Castle]:(0,w.l)(Xi(e.castle)),[Q.BoardSounds.Premove]:(0,w.l)(Xi(e.premove)),[Q.BoardSounds.MoveSelf]:(0,w.l)(Xi(e.moveSelf)),[Q.BoardSounds.MoveCheck]:(0,w.l)(Xi(e.moveCheck)),[Q.BoardSounds.MoveOpponent]:(0,w.l)(Xi(e.moveOpponent)),[Q.BoardSounds.Promote]:(0,w.l)(Xi(e.promote)),[Q.BoardSounds.Notify]:(0,w.l)(Xi(e.notify)),[Q.BoardSounds.TenSeconds]:(0,w.l)(Xi(e.tenSeconds)),[Q.BoardSounds.Illegal]:(0,w.l)(Xi(e.illegal))}}const fu=[Q.BoardSounds.GameStart,Q.BoardSounds.GameEnd,Q.BoardSounds.Capture,Q.BoardSounds.Castle,Q.BoardSounds.Premove,Q.BoardSounds.MoveSelf,Q.BoardSounds.MoveCheck,Q.BoardSounds.MoveOpponent,Q.BoardSounds.Promote,Q.BoardSounds.Notify,Q.BoardSounds.TenSeconds,Q.BoardSounds.Illegal];function Nh(e){let t=fu,n="default";e&&(t=e.codes,n=e.theme);let r,i=n;return d({codes:t,theme:n,soundAssets:e?.soundAssets}),{destroy:o,getSounds:s,getTheme:l,load:d,loadExtra:f,play:h};function o(){Object.keys(r).forEach(g=>{r[g].unload()})}function s(){return r}function l(){return i}function d(g){i=g.theme,g.soundAssets?r=Zc(g.soundAssets):r=(g.codes||fu).reduce((m,S)=>(m[S]=(0,w.l)(Oh(i,S)),m),{}),(0,w.e)()}function f(g){const m=g.codes.reduce((S,P)=>(S[P]=(0,w.l)($c(g.baseURL,P)),S),{});Object.keys(m).forEach(S=>{var P;(P=r[S])==null||P.unload(),r[S]=m[S]}),(0,w.e)()}function h(g){const m=r[g],S=l();if(!m)return S;try{return(0,w.p)(m),S}catch{return S}}}function Io(e){return e.flags===void 0?!1:(e.flags&1)===1||e.flags===ct.Move.Flags.EPCapture}function dl(e){return e.flags===ct.Move.Flags.AnyCastle||e.flags===ct.Move.Flags.KingsideCastle||e.flags===ct.Move.Flags.QueensideCastle}function Yc(e){return!e||!e.san?!1:["+","#"].includes(e.san.slice(-1))}function hu(e){return e.flags===ct.Move.Flags.Promotion||e.flags===ct.Move.Flags.CapturePromotion}function Lh(e,t){if(!e||!e.san)return null;let n;return Yc(e)?n=Q.BoardSounds.MoveCheck:e.isPremove?n=Q.BoardSounds.Premove:hu(e)?n=Q.BoardSounds.Promote:Io(e)?n=Q.BoardSounds.Capture:dl(e)?n=Q.BoardSounds.Castle:n=t?Q.BoardSounds.MoveOpponent:Q.BoardSounds.MoveSelf,n}function Dh(e){return function(n){return e!==n.type}}function pu(e){let t=e,n;return{api:()=>({getSoundsInstance:()=>t}),match:[{condition:Dh(M.UserEvents.Pointermove),handler:i}],name:Q.Plugin.Name,create:r};function r(o){var s;n=(s=o.options.themeAssets)==null?void 0:s.sound.assets,t||(t=Nh({theme:o.options.soundTheme,soundAssets:n}))}function i(o,s){var l,d,f;if(!t)return;const{api:h,options:g,state:m}=s,S=g.soundTheme!==t.getTheme()||!(0,w.f)(n,(l=s.options.themeAssets)==null?void 0:l.sound.assets);if(n=(d=s.options.themeAssets)==null?void 0:d.sound.assets,o.type===M.OptionsEvents.Update&&S){t.destroy(),t.load({theme:g.soundTheme,soundAssets:n});return}if(o.type===M.SoundEvents.Play){t.play(o.data.sound),m.set({soundPlayed:o.data.sound});return}if(!g.playSounds||!((f=o.data)!=null&&f.plyDiff))return;let P=h.getSelectedNode();if(o.type===M.APIEvents.MoveBackward&&(P=o.data.move),!P)return;const I=h.getPlayingAs(),D=!!(I&&I!==P.color),be=Lh(P,D);be&&(t.play(be),m.set({soundPlayed:be}))}}function fl(e){return{create:t,name:yt.Plugin.Name};function t(n){const{api:r}=n;e&&r.timeControl.set(e)}}function mu(e){return!!(!e||e.isContentEditable||["INPUT","TEXTAREA"].includes(e.tagName))}var Qi;(function(e){(function(t){t.Shift="Shift",t.Control="Control",t.Alt="Alt",t.Meta="Meta"})(e.Modifiers||(e.Modifiers={}))})(Qi||(Qi={}));const Xc=["Escape","Tab","Backspace","Enter","Backlash","Period","Slash","Comma","Space","Delete","Home","End","PageUp","PageDown","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],Qc=[Qi.Modifiers.Meta.toLowerCase(),Qi.Modifiers.Alt.toLowerCase(),Qi.Modifiers.Control.toLowerCase()];function vu(e){let t;if(e)return e.includes("Digit")?t=e.replace("Digit",""):e.includes("Numpad")?t=e.replace("Numpad",""):e.includes("Key")?t=e.replace("Key",""):e.includes(Qi.Modifiers.Control)?t=Qi.Modifiers.Control:e.includes(Qi.Modifiers.Shift)?t=Qi.Modifiers.Shift:e.includes(Qi.Modifiers.Alt)?t=Qi.Modifiers.Alt:e.includes(Qi.Modifiers.Meta)?t=Qi.Modifiers.Meta:Xc.includes(e)&&(t=e),t?.toLowerCase()}function Jc({onKeydown:e,onKeyup:t}={}){let n=!0;const r=new Set;return document.addEventListener("keydown",s),document.addEventListener("keyup",l),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),{isPressed:i,getPressedKeys:o,disable:f,enable:h,destroy:g};function i(m){return r.has(m.toLowerCase())}function o(){return[...r].sort()}function s(m){const S=document.activeElement;if(!n||mu(S))return;const P=vu(m.code);P&&(r.add(P),e?.(P))}function l(m){const S=vu(m.code);S&&(Qc.includes(S)&&r.clear(),r.delete(S),t?.(S))}function d(){r.clear()}function f(){n=!1,r.clear()}function h(){n=!0}function g(){document.removeEventListener("keydown",s),document.removeEventListener("keyup",l),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d),r.clear()}}function ed(){let e;const t=Jc({onKeydown:s(bi.Events.Keydown),onKeyup:s(bi.Events.Keyup)}),n={[bi.Events.Keydown]:{},[bi.Events.Keyup]:{}},r={isPressed:t.isPressed,getPressedKeys:t.getPressedKeys,setOverrides:d,removeOverrides:f};return{api:()=>r,create:i,destroy:o,match:[{condition:Je(M.OptionsEvents.Update),handler:h},{condition:Je(bi.Events.Keydown),handler:l},{condition:Je(bi.Events.Keyup),handler:l}],name:bi.Plugin.Name};function i({run:m,options:S}){e=m,g(S.enabled)}function o(){t.destroy()}function s(m){return function(P){e?.(Vr(m,P))}}function l(m,S){const{type:P,data:I}=m,D=n[P][I];D&&S.queue.add(D(S.api))}function d(m){m.forEach(({key:S,callback:P,trigger:I=bi.Events.Keydown})=>{n[I][S]=P})}function f(m){m.forEach(({trigger:S=bi.Events.Keydown,key:P})=>{delete n[S][P]})}function h(m,S){const{options:P}=S,I=P.captureKeyStrokes&&P.enabled;g(I)}function g(m){m?t.enable():t.disable()}}var ks;(function(e){e.DefaultAcceptableFrequency=1e3,function(t){t.Name="webgl-context-lost"}(e.Plugin||(e.Plugin={}))})(ks||(ks={}));function Bh(e=ks.DefaultAcceptableFrequency){let t,n=0,r=!1,i=!1;return{api:()=>({activateBoard:l}),destroy:m,match:[{condition:Je(M.InstanceEvents.RendererSet),handler:o}],name:ks.Plugin.Name};function o(S,P){t=P;const{renderer:I}=t,D=I?.name===v.Types.WebGL2D||I?.name===v.Types.WebGL3D;!I||!D||!I.getWebGLCanvas||d(I.getWebGLCanvas())}function s(){if(!t)return;i=!0;const S=n&&Date.now()-n<e;if(n=Date.now(),S){g();return}r&&h()}function l(S=!0){r=S,r&&i&&h()}function d(S){S.removeEventListener("webglcontextlost",s),S.addEventListener("webglcontextlost",s)}function f(S){S.removeEventListener("webglcontextlost",s)}function h(){var S;if(!t||!t.renderer)return;const{renderer:P}=t;(S=P.handleWebGLContextLost)==null||S.call(P),i=!1,P.getWebGLCanvas&&d(P.getWebGLCanvas())}function g(){if(!t)return;const{api:S,renderer:P}=t,I=S.getOptions(),D={animationType:pr.Animation.Types.Default};P?.name===v.Types.WebGL3D&&(D.pieceStyle="neo",I.themeAssets&&(D.themeAssets=$t(I.themeAssets))),S.setOptions(D)}function m(){!t||!t.renderer||!t.renderer.getWebGLCanvas||f(t.renderer.getWebGLCanvas())}}var Ci;(function(e){(function(t){t.Name="recorder"})(e.Plugin||(e.Plugin={})),function(t){t.Idle="Idle",t.Playing="Playing",t.Recording="Recording"}(e.Mode||(e.Mode={}))})(Ci||(Ci={}));const gu=[{name:"addMoveToEndOfLine"},{name:"agreeDraw"},{name:"blinkSquare"},{name:"claimDraw"},{name:"clearMarkings"},{name:"createContinuation"},{name:"createGame"},{name:"setPlayingAs"},{name:"usePlayingAs"},{name:"deletePosition"},{name:"load"},{name:"mark"},{name:"move"},{name:"moveBackward"},{name:"moveForward"},{name:"moveVariation"},{name:"outOfTime"},{name:"promoteVariation"},{name:"reload"},{name:"resetGame"},{name:"resetToMainLine"},{name:"resign"},{name:"selectLineEnd"},{name:"selectLineStart"},{name:"selectNode"},{name:"setGameDetails"},{name:"setResult"},{name:"setTurn"},{name:"toggleMarking"},{name:"undo"},{name:"unmark"},{name:"updateLineComment"},{name:"updateNode"},{name:"setOptions"},{name:"setMode"},{name:"playSound"},{namespace:"arrowKeys",name:"setKeys"},{namespace:"arrowKeys",name:"resetKeys"},{namespace:"boardImages",name:"mark"},{namespace:"boardImages",name:"unmark"},{namespace:"boardImages",name:"showWindow"},{namespace:"boardImages",name:"hideWindow"},{namespace:"clocks",name:"activate"},{namespace:"clocks",name:"deactivate"},{namespace:"clocks",name:"resetClocks"},{namespace:"clocks",name:"stopClocks"},{namespace:"hml",name:"addDiagramActions"},{namespace:"hml",name:"addCommentLink"},{namespace:"hml",name:"setScrollContainer"},{namespace:"hml",name:"updateNodeLimits"},{namespace:"keys",name:"setOverrides"},{namespace:"keys",name:"removeOverrides"},{namespace:"premoves",name:"cancel"},{namespace:"premoves",name:"consumeNext"},{namespace:"premoves",name:"loadQueue"},{namespace:"premoves",name:"move"},{namespace:"premoves",name:"reload"},{namespace:"threats",name:"enable"},{namespace:"threats",name:"onlyShowThreatsCreatedByColor"},{namespace:"vml",name:"activate"},{namespace:"vml",name:"deactivate"},{namespace:"vml",name:"waitForVMLReady"},{namespace:"markings",name:"addMany"},{namespace:"markings",name:"addOne"},{namespace:"markings",name:"removeAll"},{namespace:"markings",name:"removeAllWhere"},{namespace:"markings",name:"removeMany"},{namespace:"markings",name:"removeOne"},{namespace:"markings",name:"toggleMany"},{namespace:"markings",name:"toggleOne"}];function td(e,t){const{api:n}=e;return{record:o,play:f,step:h,forward:g,stop:s,init:d,clear:l,get:()=>t,getJSON:r,load:i};function r(){return t.recording?JSON.stringify(t.recording):""}function i(S){const P=JSON.parse(S);return l(),t.recording=P,d()}function o(S=!0){l(),t.recording={modeName:n.getMode().name,variant:n.getVariant(),modeOptions:n.getMode().getOptions(),boardOptions:n.getOptions(),pgn:n.getPGN(),plugins:n.plugins.get().map(P=>P.name),timestamp:new Date().toISOString(),events:[]},t.mode=Ci.Mode.Recording,t.recordEvents=S}function s(){return t.mode=Ci.Mode.Idle,t.recording.events.length}function l(){t.mode=Ci.Mode.Idle,t.lastRecordedEventTime=0,t.recording={events:[],pgn:"",modeName:"",variant:"",modeOptions:{},boardOptions:{},plugins:[],timestamp:""},t.playState={playCounter:0,initDirty:!1,playedEvents:[]}}function d(){if(s(),!t.recording)return 0;t.playState={playCounter:0,playedEvents:[],initDirty:!1};const{pgn:S,events:P}=t.recording;return e.api.load({pgn:S}),e.api.markings.removeAll(),window.location.hostname==="localhost"&&e.api.boardImages&&!e.api.boardImages.isInitialized()&&e.api.boardImages.initDefault(),t.playState.initDirty=!1,P.length}function f({fixedDelay:S,skipEvents:P=!1,verbose:I=!0}={}){s(),t.playState.initDirty&&d(),t.mode=Ci.Mode.Playing,t.verbose=I,t.verbose&&console.log("Playing",t.recording.events.length-1),m({fixedDelay:S,skipEvents:P,autoContinue:!0})}function h({fastForwardEvents:S=!1,skipEvents:P=!1,verbose:I=!0}={}){s(),t.mode=Ci.Mode.Playing,t.verbose=I,m({fixedDelay:0,skipEvents:P,fastForwardEvents:S,autoContinue:!1})}function g({eventNumber:S,skipEvents:P=!1,verbose:I=!0}){s(),(!t.playState.playCounter||t.playState.playCounter>=S||t.playState.playCounter===t.recording.events.length)&&d(),t.mode=Ci.Mode.Playing,t.verbose=I,m({fixedDelay:0,maxEventNumber:S,skipEvents:P,autoContinue:!0})}function m({maxEventNumber:S,fixedDelay:P,skipEvents:I,fastForwardEvents:D,autoContinue:be}){const Ye=t.recording.events[t.playState.playCounter];if(!Ye){t.mode=Ci.Mode.Idle;return}const{name:Se,args:Ze,namespace:mt}=Ye;mt?n[mt][Se](...Ze):Se==="event"?I?(t.playState.playCounter+=1,t.playState.playedEvents.push(`skipped: ${Ze[0].type}`)):n.emit(Ze[0].type,Ze[0]):n[Se](...Ze);const zn=t.recording.events[t.playState.playCounter];if(t.mode!==Ci.Mode.Playing||!zn||!be&&(!I||!D)||S&&t.playState.playCounter>=S){t.mode=Ci.Mode.Idle,!zn&&t.verbose&&console.log("Finished playing");return}let Sn=P??zn.time;I&&zn.name==="event"&&(Sn=0),(be||(I||D)&&zn.name==="event")&&setTimeout(()=>{m({maxEventNumber:S,fixedDelay:P,skipEvents:I,fastForwardEvents:D,autoContinue:be})},Sn)}}const ni={mode:Ci.Mode.Idle,recordEvents:!1,lastRecordedEventTime:0,verbose:!1,playState:{playCounter:0,initDirty:!1,playedEvents:[]},recording:{events:[],pgn:"",modeName:"",variant:"",modeOptions:{},boardOptions:{},plugins:[],timestamp:""}};function Ps(){return{api:t=>td(t,ni),create:t=>setTimeout(()=>e(t)),match:[{condition:()=>ni.mode===Ci.Mode.Recording&&ni.recordEvents,handler:t=>{ni.recording.events.push({name:"event",args:[t],time:bu()})}},{condition:()=>ni.mode===Ci.Mode.Playing,handler:t=>{ni.verbose&&console.log(`${ni.playState.playCounter} / ${ni.recording.events.length-1}`,t),ni.playState.playCounter+=1,ni.playState.playedEvents.push(t)}}],name:Ci.Plugin.Name};function e(t){const{api:n}=t;_u(n);const r=(i,o,s)=>{const d=(Array.isArray(s[0])?s[0]:s).map(h=>h.name),f=i(...s);return d.forEach(h=>{_u(n,h)}),f};t.api.plugins.add=new Proxy(t.api.plugins.add,{apply:r}),t.api.plugins.addMany=new Proxy(t.api.plugins.addMany,{apply:r})}}function _u(e,t){(t?gu.filter(r=>r.namespace===t):gu).forEach(({namespace:r,name:i})=>{if(!r&&!e[i]||r&&!e[r]||r&&e[r]&&!e[r][i])return;const o=nd(i,r);r?e[r][i]=new Proxy(e[r][i],{apply:o}):e[i]=new Proxy(e[i],{apply:o})})}function nd(e,t){return function(r,i,o){if(ni.playState.initDirty=!0,ni.mode===Ci.Mode.Recording){const s=bu(),l=t?{namespace:t}:{};ni.recording.events.push(ge({name:e,args:o,time:s},l))}if(ni.mode===Ci.Mode.Playing){const s=ni.recording.events[ni.playState.playCounter];if(s&&s.name===e&&(!s.namespace||s.namespace===t)&&JSON.stringify(s.args).substring(0,50)===JSON.stringify(o).substring(0,50)){if(ni.verbose){const d=s.namespace?`${s.namespace}.${s.name}`:s.name;console.log(`${ni.playState.playCounter} / ${ni.recording.events.length-1}`,`${d}`,...s.args)}ni.playState.playCounter+=1}const l=t?{namespace:t}:{};ni.playState.playedEvents.push(ge({name:e,args:o},l))}return r(...o)}}function bu(){const e=Date.now(),t=ni.lastRecordedEventTime===0?0:e-ni.lastRecordedEventTime;return ni.lastRecordedEventTime=e,t}function oa({color:e,type:t,opacity:n,square:r,turn:i}){return{data:{color:e,opacity:n,square:r,turn:i,type:t},key:`${t}|${r}`,type:"highlight"}}function rd(e,t){switch(e){case _r.Alt:return t.analysisHighlightColors.alt;case _r.Ctrl:return t.analysisHighlightColors.ctrl;case _r.Shift:return t.analysisHighlightColors.shift;case _r.None:return t.analysisHighlightColors.default;default:return}}function id(e,t){const{api:n,options:r}=t;return!r||!r.allowMarkings?[]:n.markings.getAllWhere({types:[er]}).map(({data:{color:i,keyPressed:o,opacity:s,square:l}})=>{var d,f;return oa({color:(f=(d=rd(o,r))!=null?d:i)!=null?f:r.analysisHighlightColors.default,opacity:s??r.analysisHighlightOpacity,square:l,type:"analysis"})})}const yu="move";function Eu(e,t){const{api:n,options:r}=t,i=[];if(!r||!r.highlightMoves)return i;const o=n.getSelectedNode();return o&&[o.from,o.to].forEach(s=>{var l,d,f,h,g;if(!s)return;const m=oa({color:(g=(h=(d=(l=r.themeAssets)==null?void 0:l.board.config.highlightSquareHex)!=null?d:r.highlightColor)!=null?h:(f=$(r.boardStyle))==null?void 0:f.highlightColor)!=null?g:pr.HighlightColors.Selected,opacity:r.highlightOpacity,square:s,turn:o.color,type:yu});i.push(m)}),i}function od(e,t){var n,r,i,o;const{options:s,state:l}=t;if(!s||!s.highlightMoves)return[];const d=l.get(M.State.SelectedPiece)||l.get(M.State.DraggingPiece);return d?[oa({color:(o=(i=(n=s.themeAssets)==null?void 0:n.board.config.highlightSquareHex)!=null?i:(r=$(s.boardStyle))==null?void 0:r.highlightColor)!=null?o:pr.HighlightColors.Selected,opacity:s.highlightOpacity,square:d,type:"SelectionHiglight"})]:[]}function Ts(e,t){return t._withIDBStore("readwrite",n=>{e.forEach(r=>{n.put(r,r.f)})})}const ad="e2992d839bbeb7eff7ae6145f8bdcdb3";let Ro;const hl="IS_POPULATED",sd="VERSION";function Fh({name:e,table:t}){Ro=new w.S(e,t)}function pl(){return Ro}async function Au({ecoPath:e,http:t}){const n=ad,r=await xs(),i=await Ms();if(!r||!i&&n||i!==n)return wu(n),ud({ecoPath:e,http:t}).then(ld)}function ld(){return(0,w.s)(hl,!0,Ro)}function wu(e){return(0,w.s)(sd,e,Ro)}async function Ms(){return(0,w.g)(sd,Ro).then(String)}async function xs(){return(0,w.g)(hl,Ro).then(Boolean)}async function ud({ecoPath:e,http:t}){return t.get(e).then(n=>{var r,i;Ts((i=(r=n?.data)!=null&&r.positions?n.data.positions:n.data)!=null?i:n,Ro)})}function Uh(e){return e.reverse().map(t=>t.split(" ").slice(0,3).join(" "))}async function cd({ecoPath:e,fens:t,http:n}){const r=Uh(t);return await Au({ecoPath:e,http:n}),(await ml(r)).find(Boolean)}function ml(e){return Promise.all(e.map(t=>(0,w.g)(t,pl())))}function dd(e,t){let n;return{get:()=>n,update:r};async function r(){const{api:i,respond:o}=e;n=await cd(Ce(ge({},t),{fens:i.getHistoryFENs()})),o(Dt.Events.Update,n)}}var vl;(function(e){e.ECO="chesscom_eco"})(vl||(vl={}));var gl;(function(e){e.ECO="eco"})(gl||(gl={}));const fd={get:e=>fetch(e,{method:"GET"}).then(t=>t.json())};function Su({ecoPath:e="",http:t=fd,storeData:n={name:vl.ECO,table:gl.ECO}}={}){if(!("indexedDB"in window))return{name:Dt.Name};function r(o){pl()||Fh(ge({},n)),i(null,o)}return{api:o=>dd(o,{ecoPath:e,http:t}),create:r,match:[{condition:xt(Yi),handler:i}],name:Dt.Name};function i(o,s){s.api.eco.update()}}function hd(){let e,t=!1;return{create:i,destroy:o,match:[{condition:Je(M.APIEvents.SetPlayingAs),handler:(s,l)=>r(l.api)}],name:L.Plugin.Name,requires:["premoves"]};function n(s){const{api:l}=s;return{get:d,set:f};function d(){return t}function f(h){var g,m,S,P,I;if(t=h,r(l),h===!1){const D=(m=(g=l.getPositionDetails())==null?void 0:g.sideToMove)!=null?m:ct.ColorsAsNumbers.White;if(l.setTurn(D),((P=(S=l.premoves)==null?void 0:S.getQueue()[0])==null?void 0:P.color)===D){const be=(I=l.premoves)==null?void 0:I.consumeNext(),Ye=be===null?M.APIEvents.IllegalMove:M.APIEvents.Move;l.getContext().respond(Ye,be)}}}}function r(s){t&&s.setTurn(s.getPlayingAs()===ct.ColorsAsNumbers.White?ct.ColorsAsNumbers.Black:ct.ColorsAsNumbers.White)}function i(s){const{api:l}=s;if(!l.premoves)return"The premoves plugin must be registered in order to use the pregame plugin.";e=l.extendAPI(L.Plugin.Name,{pregame:()=>n(s)})}function o(){e()}}function yo({api:e}){return e.premoves.cancel}function Hh({api:e}){return e.premoves.getLegalMovesForSquare}function Gh({api:e}){return e.premoves.getLegalMoves}function Vh({api:e}){return e.premoves.getMove}function ei({api:e}){return e.premoves.getPieces}function pd({api:e}){return function(...n){var r;const i=(r=n[0])==null?void 0:r.premoves,o=e.getContext().game;i?.forEach(s=>{o.premove.move(s)}),e.premoves.loadQueue(i),n[0].pieces=e.premoves.getPieces()}}function md({api:e}){return e.premoves.reload}function vd({api:e}){return e.premoves.move}function Cu({api:e}){return function(n){return e.getContext().respond(M.APIEvents.SetBoardPosition,{pieces:e.premoves.getPieces(),holdSelectedPiece:!0}),n}}function Sa(e){return e.api.getPlayingAs()!==e.api.getTurn()}function gd(e,t){return!t.userGenerated}function ku(e,t){return!!t.userGenerated}function Ca(e){return e.api.premoves.getQueue().length}function ka(e){return e.api.premoves.getQueue().length>0}function _d(e,t){return!!t?.premoves}function bd(){return{moveBackward:{handler:yo,run:"before"},moveForward:{handler:yo,run:"before"},outOfTime:{handler:yo,run:"before"},resign:{handler:yo,run:"before"},selectLineEnd:{handler:yo,run:"before"},selectLineStart:{handler:yo,run:"before"},selectNode:{handler:yo,run:"before"},undo:{handler:yo,run:"before"},agreeDraw:{handler:yo,run:"before"},deletePosition:{handler:yo,run:"before"},getLegalMovesForSquare:{conditions:Sa,handler:Hh,run:"instead"},getLegalMoves:{conditions:Sa,handler:Gh,run:"instead"},getMove:{conditions:Sa,handler:Vh,run:"instead"},getPieces:{conditions:Ca,handler:ei,run:"instead"},load:[{handler:yo,run:"before"},{conditions:_d,handler:pd,run:"before"}],move:[{conditions:[Sa,ka],handler:md,run:"before"},{conditions:[Sa,ku],handler:vd,run:"instead"},{conditions:[Sa,gd,ka],handler:Cu,run:"after"}]}}function Pu({api:e,canMoveWhenNotPlayerTurn:t,modeOptions:n}){const{canAddMovesToMainLine:r,canMoveWhenGameIsOver:i,canModifyExistingMovesOnMainLine:o}=n;return!!((i||!e.isGameOver())&&(r&&e.isAtEndOfLine()||o)&&(t||e.getPlayingAs()===e.getTurn()))}function yd(e,t){return function(){return Pu({api:t,canMoveWhenNotPlayerTurn:!0,modeOptions:e.getOptions()})}}function Ed(){return{isAllowedToMove:yd}}function Ad(e){return function(){const{api:n,game:r}=e;return n.premoves.getQueue().length?(r.premove.cancel(),n.reload()):null}}function Ja({api:e,node:t,timestamp:n}){var r;const{game:i,respond:o}=e.getContext(),{line:s,move:l}=t.ids;if(n===null)return(r=t.commands)!=null&&r.timestamp&&delete t.commands.timestamp,o(M.APIEvents.NodeUpdated,{changes:{timestamp:n,node:t}});t.commands||(t.commands={}),i.updateNode({commands:Object.assign(t.commands,{timestamp:`${n}`})},l,s)}const es=1;function Vo(e){return Math.round(e/100)}function Tu({api:e,node:t}){return e.getNodeByIds({move:t.ids.move-2,line:t.ids.line})}function wd({api:e,timeControl:t}){const n=e.getLine(0);if(!n)return null;const r=n[n.length-1],i=Tu({api:e,node:r}),{baseTime:o,increment:s}=t,l=Sd({baseTime:Vo(o),increment:Vo(s),lastNodeTime:i?.time});return l&&r&&(r.time=l),l}function Sd({baseTime:e,increment:t,lastNodeTime:n}){return r()-es;function r(){return n?n+t:e}}function Cd(e){return function(){const{api:n,game:r,mutateGame:i}=e;if(!n.premoves.getQueue().length)return null;if(n.isGameOver())return n.premoves.cancel();n.premoves.reload();const s=i(function(){r.premove.consume()});if(!s||s.plyDiff===0)return null;if(s.consumedPremove=!0,n.premoves.getQueue().length&&(s.pieces=n.premoves.getPieces()),s.move){const l=n.timeControl.get();l&&(wd({api:n,timeControl:l}),Ja({api:n,node:s.move,timestamp:es})),Object.assign(s.move,{animate:!1,userGenerated:!0})}return s.result&&n.setResult(s.result),s}}function kd(e){return function(n){const{game:r}=e,i=r.premove.moves(n);return i?Lr(i.filter(o=>typeof n>"u"||o.from===n).map(o=>o.to)):[]}}function zh(e){return function(){const{game:n}=e;return n.premove.moves()||[]}}function Pd(e){return function(n){const{game:r}=e,i=r.premove.moves(n.from);let o=i?i.find(s=>s.to===n.to):null;if(!o&&r.premove.getPieces(!0)[n.from].type.toLowerCase()==="k"){const s=[...r.premove.queue];o=r.premove.move(n),o&&(r.premove.cancel(),s.forEach(r.premove.move))}return o?r.moveDetails(ge({},o)):null}}function jh(e){return function(){const{game:n}=e;return Ht(n.premove.getPieces(!0))}}function qh(e){return function(){const{game:n}=e;return n.premove.queue}}function Td(e){return function(n){const{game:r}=e;return r.premove.move(n)?(r.undo(),!0):!1}}function Md(e){return function(n){const{game:r}=e;r.premove.queue.length=0,r.premove.queue.push(...n)}}function xd(e){return function(n){const{api:r,game:i,respond:o}=e;return"tcn"in n||!i.premove.move(n)?null:(r.getOptions().playSounds&&o(M.SoundEvents.Play,{sound:Q.BoardSounds.Premove}),o(M.APIEvents.SetBoardPosition,{pieces:r.premoves.getPieces()}))}}function Wh(e){return function(){const{api:n}=e;if(n.premoves.getQueue().length){const r=[...n.premoves.getQueue()];n.reload(),n.premoves.loadQueue(r)}else n.reload()}}function Id(){return function(t){return{cancel:Ad(t),consumeNext:Cd(t),getLegalMovesForSquare:kd(t),getLegalMoves:zh(t),getMove:Pd(t),getPieces:jh(t),getQueue:qh(t),isLegalMove:Td(t),loadQueue:Md(t),move:xd(t),reload:Wh(t)}}}function Rd(e){return e.type===M.APIEvents.Move&&!e.data.consumedPremove}const Mu="premove";function _l(e,t){var n;const{api:r,options:i}=t,o=(n=r.premoves)==null?void 0:n.getQueue();if(!i||!i.allowMarkings||!o.length)return[];const s=[];return o.forEach(l=>{if(l.from){const f=oa({color:i.premoveHighlightColor,opacity:i.premoveHighlightOpacity,square:l.from,type:Mu});s.push(f)}const d=oa({color:i.premoveHighlightColor,opacity:i.premoveHighlightOpacity,square:l.kingTo||l.to,type:Mu});s.push(d)}),s}function Od(){return{api:Id(),apiOverrides:bd(),beforeState:[{condition:Je(M.UserEvents.PointerdownRight),handler:n},{condition:Je(M.APIEvents.Move),handler:r}],create:e,destroy:t,modeOverrides:Ed(),name:pe.Plugin.Name};function e(i){const{api:o}=i;o.highlights&&o.highlights.addModule(_l)}function t(i){var o,s;const{api:l}=i;(o=l.premoves)==null||o.cancel(),(s=l.highlights)==null||s.removeModule(_l)}function n(i,o){const{api:s,queue:l}=o;return s.premoves.getQueue().length>0?(l.add(s.premoves.cancel),!1):!0}function r(i,o){const{api:s,queue:l}=o;return s.premoves.getQueue().length&&Rd(i)?(l.add(function(){const f=s.premoves.consumeNext(),h=f===null?M.APIEvents.IllegalMove:M.APIEvents.Move;s.once(M.APIEvents.Move,()=>{s.getContext().respond(h,Ce(ge({},f),{holdSelectedPiece:!0}))})}),!1):!0}}function xu(e,t){const{requestIdleCallback:n}=window;if(n){n(e,t);return}r(e);function r(i){const o=Date.now();return setTimeout(function(){i({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-o))})},1)}}function Nd({onAll:e,onDebug:t,onError:n}){return{create:r,name:ye.Plugin.Name};function r(s){if(!e&&!t&&!n)return;const{api:{logger:l}}=s;l.on(Z.Events.EntryAdded,d=>i(d,l))}function i(s,l){const d=l.get();e&&o({callback:e,entry:s,previousLogs:d}),t&&s.level===Z.Levels.Debug&&o({callback:t,entry:s,previousLogs:d}),n&&s.level===Z.Levels.Error&&o({callback:n,entry:s,previousLogs:d})}function o({callback:s,entry:l,previousLogs:d}){xu(()=>s(l,d))}}var tt;(function(e){(function(t){(function(n){n.ClearAllAnalysis="Clear All Analysis",n.DeleteCommentAfter="Delete Comment After",n.DeleteCommentBefore="Delete Comment Before",n.DeleteLine="Delete Entire Variation",n.DeleteMove="Delete Move",n.InsertCommentAfter="Comment After",n.InsertCommentBefore="Comment Before",n.InsertContinuation="Insert Continuation",n.MoveVariationDown="Move Variation Down",n.MoveVariationUp="Move Variation Up",n.Promote="Promote",n.RemoveAnnotation="Remove Annotation",n.RemoveBegin="Remove Begin",n.RemoveEnd="Remove End",n.RemoveEvaluationAnnotation="Remove Evaluation Annotation",n.RemoveFocus="Remove Focus",n.SetBegin="Set Begin",n.SetEnd="Set End",n.SetFocus="Set Focus"})(t.Actions||(t.Actions={})),function(n){n.BadMove="Bad move",n.BlackHasDecisiveAdvantage="Black has a decisive advantage",n.BlackHasModerateAdvantage="Black has a moderate advantage",n.BlackHasSlightAdvantage="Black has a slight advantage",n.Blunder="Blunder",n.Drawish="Drawish",n.DubiousMove="Dubious move",n.ExcellentMove="Excellent move",n.GoodMove="Good move",n.Miss="Miss",n.Novelty="Novelty",n.Unclear="Unclear",n.PositionInZuqZwang="The position is in zugzwang",n.SpeculativeMove="Speculative move",n.WhiteHasSlightAdvantage="White has a slight advantage",n.WhiteHasModerateAdvantage="White has a moderate advantage",n.WhiteHasDecisiveAdvantage="White has a decisive advantage",n.WithInitiative="With initiative",n.WithCompensation="With compensation",n.WithAttack="With an attack"}(t.Annotations||(t.Annotations={})),function(n){n.B="B",n.K="K",n.N="N",n.P="P",n.Q="Q",n.R="R"}(t.Pieces||(t.Pieces={})),function(n){n.NumberOfDays="numberOfDays",n.NumberOfHours="numberOfHours",n.NumberOfMinutes="numberOfMinutes"}(t.Plural||(t.Plural={})),function(n){n.AddComment="Add Comment..."}(t.Prompt||(t.Prompt={})),function(n){n.EnPassant="En passant is a special pawn move by which a pawn captures another pawn that has advanced two squares.",n.ThreeFoldRepetition="This game ended in a draw because the same position was repeated three times."}(t.Tooltips||(t.Tooltips={}))})(e.Translation||(e.Translation={})),function(t){t.HML="hml",t.VML="vml",t.MOVE_LIST="move-list"}(e.Types||(e.Types={}))})(tt||(tt={}));const Pa={[tt.Translation.Prompt.AddComment]:()=>tt.Translation.Prompt.AddComment,[tt.Translation.Annotations.BadMove]:()=>tt.Translation.Annotations.BadMove,[tt.Translation.Annotations.BlackHasDecisiveAdvantage]:()=>tt.Translation.Annotations.BlackHasDecisiveAdvantage,[tt.Translation.Annotations.BlackHasModerateAdvantage]:()=>tt.Translation.Annotations.BlackHasModerateAdvantage,[tt.Translation.Annotations.BlackHasSlightAdvantage]:()=>tt.Translation.Annotations.BlackHasSlightAdvantage,[tt.Translation.Annotations.Blunder]:()=>tt.Translation.Annotations.Blunder,[tt.Translation.Actions.ClearAllAnalysis]:()=>tt.Translation.Actions.ClearAllAnalysis,[tt.Translation.Actions.DeleteCommentAfter]:()=>tt.Translation.Actions.DeleteCommentAfter,[tt.Translation.Actions.DeleteCommentBefore]:()=>tt.Translation.Actions.DeleteCommentBefore,[tt.Translation.Actions.DeleteLine]:()=>tt.Translation.Actions.DeleteLine,[tt.Translation.Actions.DeleteMove]:()=>tt.Translation.Actions.DeleteMove,[tt.Translation.Annotations.Drawish]:()=>tt.Translation.Annotations.Drawish,[tt.Translation.Annotations.DubiousMove]:()=>tt.Translation.Annotations.DubiousMove,[tt.Translation.Annotations.ExcellentMove]:()=>tt.Translation.Annotations.ExcellentMove,[tt.Translation.Tooltips.EnPassant]:()=>tt.Translation.Tooltips.EnPassant,[tt.Translation.Annotations.GoodMove]:()=>tt.Translation.Annotations.GoodMove,[tt.Translation.Actions.InsertCommentAfter]:()=>tt.Translation.Actions.InsertCommentAfter,[tt.Translation.Actions.InsertCommentBefore]:()=>tt.Translation.Actions.InsertCommentBefore,[tt.Translation.Actions.InsertContinuation]:()=>tt.Translation.Actions.InsertContinuation,[tt.Translation.Annotations.Miss]:()=>tt.Translation.Annotations.Miss,[tt.Translation.Actions.MoveVariationDown]:()=>tt.Translation.Actions.MoveVariationDown,[tt.Translation.Actions.MoveVariationUp]:()=>tt.Translation.Actions.MoveVariationUp,[tt.Translation.Annotations.Novelty]:()=>tt.Translation.Annotations.Novelty,[tt.Translation.Pieces.B]:()=>tt.Translation.Pieces.B,[tt.Translation.Pieces.K]:()=>tt.Translation.Pieces.K,[tt.Translation.Pieces.N]:()=>tt.Translation.Pieces.N,[tt.Translation.Pieces.P]:()=>tt.Translation.Pieces.P,[tt.Translation.Pieces.Q]:()=>tt.Translation.Pieces.Q,[tt.Translation.Pieces.R]:()=>tt.Translation.Pieces.R,[tt.Translation.Actions.Promote]:()=>tt.Translation.Actions.Promote,[tt.Translation.Actions.RemoveAnnotation]:()=>tt.Translation.Actions.RemoveAnnotation,[tt.Translation.Actions.RemoveBegin]:()=>tt.Translation.Actions.RemoveBegin,[tt.Translation.Actions.RemoveEnd]:()=>tt.Translation.Actions.RemoveEnd,[tt.Translation.Actions.RemoveEvaluationAnnotation]:()=>tt.Translation.Actions.RemoveEvaluationAnnotation,[tt.Translation.Actions.RemoveFocus]:()=>tt.Translation.Actions.RemoveFocus,[tt.Translation.Actions.SetBegin]:()=>tt.Translation.Actions.SetBegin,[tt.Translation.Actions.SetEnd]:()=>tt.Translation.Actions.SetEnd,[tt.Translation.Actions.SetFocus]:()=>tt.Translation.Actions.SetFocus,[tt.Translation.Annotations.SpeculativeMove]:()=>tt.Translation.Annotations.SpeculativeMove,[tt.Translation.Tooltips.ThreeFoldRepetition]:()=>tt.Translation.Tooltips.ThreeFoldRepetition,[tt.Translation.Annotations.PositionInZuqZwang]:()=>tt.Translation.Annotations.PositionInZuqZwang,[tt.Translation.Annotations.Unclear]:()=>tt.Translation.Annotations.Unclear,[tt.Translation.Annotations.WhiteHasDecisiveAdvantage]:()=>tt.Translation.Annotations.WhiteHasDecisiveAdvantage,[tt.Translation.Annotations.WhiteHasModerateAdvantage]:()=>tt.Translation.Annotations.WhiteHasModerateAdvantage,[tt.Translation.Annotations.WhiteHasSlightAdvantage]:()=>tt.Translation.Annotations.WhiteHasSlightAdvantage,[tt.Translation.Annotations.WithAttack]:()=>tt.Translation.Annotations.WithAttack,[tt.Translation.Annotations.WithCompensation]:()=>tt.Translation.Annotations.WithCompensation,[tt.Translation.Annotations.WithInitiative]:()=>tt.Translation.Annotations.WithInitiative,[tt.Translation.Plural.NumberOfDays]:e=>e===1?`${e} day`:`${e} days`,[tt.Translation.Plural.NumberOfHours]:e=>e===1?`${e} hr`:`${e} hrs`,[tt.Translation.Plural.NumberOfMinutes]:e=>e===1?`${e} min`:`${e} mins`};function ts(e){return e===ct.ColorsAsNumbers.Black?ct.ColorsAsWords.Black:ct.ColorsAsWords.White}function Eo(e,t){return e===t}function Ld(e){return e===0}function Dd(e){return e>1}function zo(e){return Object.entries(e).reduce((t,[n,r])=>(r&&t.push(n),t),[]).join(" ")}function Iu(e){let t,n,r,i,o,s;function l(h,g){return(n==null||g&64)&&(n=!!h[7](h[6])),n?Kh:Ru}let d=l(e,-1),f=d(e);return{c(){t=(0,w.d)("div"),f.c(),(0,w.h)(t,"data-ply",r=e[0].ply),(0,w.h)(t,"class",i=`node ${e[4]} ${zo({selected:Eo(e[0].hash,e[5])})}`)},m(h,g){(0,w.j)(h,t,g),f.m(t,null),o||(s=(0,w.k)(t,"click",e[8]),o=!0)},p(h,g){d===(d=l(h,g))&&f?f.p(h,g):(f.d(1),f=d(h),f&&(f.c(),f.m(t,null))),g&1&&r!==(r=h[0].ply)&&(0,w.h)(t,"data-ply",r),g&49&&i!==(i=`node ${h[4]} ${zo({selected:Eo(h[0].hash,h[5])})}`)&&(0,w.h)(t,"class",i)},d(h){h&&(0,w.m)(t),f.d(),o=!1,s()}}}function Ru(e){let t=Is({san:e[0].san,translations:e[3]})+"",n;return{c(){n=(0,w.t)(t)},m(r,i){(0,w.j)(r,n,i)},p(r,i){i&9&&t!==(t=Is({san:r[0].san,translations:r[3]})+"")&&(0,w.r)(n,t)},d(r){r&&(0,w.m)(n)}}}function Kh(e){let t,n,r,i,o=Is({san:e[0].san,translations:e[3],showFigurine:!0})+"",s;return{c(){t=(0,w.d)("span"),i=(0,w.u)(),s=(0,w.t)(o),(0,w.h)(t,"class",n=`icon-font-chess ${El(e[0])}-${e[4]}`),(0,w.h)(t,"data-figurine",r=e[0].san[0])},m(l,d){(0,w.j)(l,t,d),(0,w.j)(l,i,d),(0,w.j)(l,s,d)},p(l,d){d&17&&n!==(n=`icon-font-chess ${El(l[0])}-${l[4]}`)&&(0,w.h)(t,"class",n),d&1&&r!==(r=l[0].san[0])&&(0,w.h)(t,"data-figurine",r),d&9&&o!==(o=Is({san:l[0].san,translations:l[3],showFigurine:!0})+"")&&(0,w.r)(s,o)},d(l){l&&(0,w.m)(t),l&&(0,w.m)(i),l&&(0,w.m)(s)}}}function Bd(e){let t,n=e[0]&&Iu(e);return{c(){n&&n.c(),t=(0,w.n)()},m(r,i){n&&n.m(r,i),(0,w.j)(r,t,i)},p(r,[i]){r[0]?n?n.p(r,i):(n=Iu(r),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:w.o,o:w.o,d(r){n&&n.d(r),r&&(0,w.m)(t)}}}function $h(e,t,n){let r,i,o=w.o,s=()=>(o(),o=(0,w.q)(P,Se=>n(5,i=Se)),P),l,d=w.o,f=()=>(d(),d=(0,w.q)(I,Se=>n(6,l=Se)),I);e.$$.on_destroy.push(()=>o()),e.$$.on_destroy.push(()=>d());var h;let{eventHandlers:g}=t,{node:m}=t,{wholeMoveNumber:S=1}=t,{selectedNode:P}=t;s();let{textType:I}=t;f();let{translations:D}=t;const be=Se=>Se==="figurine";function Ye(Se){var Ze;g.clickNode(Se,(Ze=m?.moveNumber)!==null&&Ze!==void 0?Ze:0)}return e.$$set=Se=>{"eventHandlers"in Se&&n(9,g=Se.eventHandlers),"node"in Se&&n(0,m=Se.node),"wholeMoveNumber"in Se&&n(10,S=Se.wholeMoveNumber),"selectedNode"in Se&&s(n(1,P=Se.selectedNode)),"textType"in Se&&f(n(2,I=Se.textType)),"translations"in Se&&n(3,D=Se.translations)},e.$$.update=()=>{e.$$.dirty&2049&&n(4,r=ts(n(11,h=m?.color)!==null&&h!==void 0?h:1))},[m,P,I,D,r,i,l,be,Ye,g,S,h]}class Zh extends w.a{constructor(t){super(),(0,w.i)(this,t,$h,Bd,w.b,{eventHandlers:9,node:0,wholeMoveNumber:10,selectedNode:1,textType:2,translations:3})}}function Fd(e,t,n){const r=e.slice();return r[6]=t[n],r}function Ou(e){let t,n;return t=new Zh({props:{eventHandlers:e[3],node:e[6],wholeMoveNumber:e[0],selectedNode:e[2],textType:e[4],translations:e[5]}}),{c(){(0,w.v)(t.$$.fragment)},m(r,i){(0,w.w)(t,r,i),n=!0},p(r,i){const o={};i&8&&(o.eventHandlers=r[3]),i&2&&(o.node=r[6]),i&1&&(o.wholeMoveNumber=r[0]),i&4&&(o.selectedNode=r[2]),i&16&&(o.textType=r[4]),i&32&&(o.translations=r[5]),t.$set(o)},i(r){n||((0,w.x)(t.$$.fragment,r),n=!0)},o(r){(0,w.y)(t.$$.fragment,r),n=!1},d(r){(0,w.z)(t,r)}}}function Yh(e){let t,n,r,i,o=e[1],s=[];for(let d=0;d<o.length;d+=1)s[d]=Ou(Fd(e,o,d));const l=d=>(0,w.y)(s[d],1,1,()=>{s[d]=null});return{c(){t=(0,w.d)("div"),n=(0,w.t)(e[0]),r=(0,w.t)(`.
  
  `);for(let d=0;d<s.length;d+=1)s[d].c();(0,w.h)(t,"class","move"),(0,w.h)(t,"data-whole-move-number",e[0])},m(d,f){(0,w.j)(d,t,f),(0,w.A)(t,n),(0,w.A)(t,r);for(let h=0;h<s.length;h+=1)s[h].m(t,null);i=!0},p(d,[f]){if((!i||f&1)&&(0,w.r)(n,d[0]),f&63){o=d[1];let h;for(h=0;h<o.length;h+=1){const g=Fd(d,o,h);s[h]?(s[h].p(g,f),(0,w.x)(s[h],1)):(s[h]=Ou(g),s[h].c(),(0,w.x)(s[h],1),s[h].m(t,null))}for((0,w.B)(),h=o.length;h<s.length;h+=1)l(h);(0,w.C)()}(!i||f&1)&&(0,w.h)(t,"data-whole-move-number",d[0])},i(d){if(!i){for(let f=0;f<o.length;f+=1)(0,w.x)(s[f]);i=!0}},o(d){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)(0,w.y)(s[f]);i=!1},d(d){d&&(0,w.m)(t),(0,w.D)(s,d)}}}function Xh(e,t,n){let{wholeMoveNumber:r=1}=t,{nodes:i}=t,{selectedNode:o}=t,{eventHandlers:s}=t,{textType:l}=t,{translations:d}=t;return e.$$set=f=>{"wholeMoveNumber"in f&&n(0,r=f.wholeMoveNumber),"nodes"in f&&n(1,i=f.nodes),"selectedNode"in f&&n(2,o=f.selectedNode),"eventHandlers"in f&&n(3,s=f.eventHandlers),"textType"in f&&n(4,l=f.textType),"translations"in f&&n(5,d=f.translations)},[r,i,o,s,l,d]}class Ud extends w.a{constructor(t){super(),(0,w.i)(this,t,Xh,Yh,w.b,{wholeMoveNumber:0,nodes:1,selectedNode:2,eventHandlers:3,textType:4,translations:5})}}function bl(e,t,n){const r=e.slice();return r[9]=t[n],r[11]=n,r}function Nu(e){let t,n;return t=new Ud({props:{wholeMoveNumber:e[11]+1,nodes:e[9],selectedNode:e[5],eventHandlers:e[0],textType:e[6],translations:e[1]}}),{c(){(0,w.v)(t.$$.fragment)},m(r,i){(0,w.w)(t,r,i),n=!0},p(r,i){const o={};i&4&&(o.nodes=r[9]),i&1&&(o.eventHandlers=r[0]),i&2&&(o.translations=r[1]),t.$set(o)},i(r){n||((0,w.x)(t.$$.fragment,r),n=!0)},o(r){(0,w.y)(t.$$.fragment,r),n=!1},d(r){(0,w.z)(t,r)}}}function yl(e){let t,n,r;return{c(){t=(0,w.d)("div"),n=(0,w.d)("span"),r=(0,w.t)(e[3]),(0,w.h)(n,"class","game-result"),(0,w.h)(t,"class","move")},m(i,o){(0,w.j)(i,t,o),(0,w.A)(t,n),(0,w.A)(n,r)},p(i,o){o&8&&(0,w.r)(r,i[3])},d(i){i&&(0,w.m)(t)}}}function Hd(e){let t,n,r,i=e[2],o=[];for(let d=0;d<i.length;d+=1)o[d]=Nu(bl(e,i,d));const s=d=>(0,w.y)(o[d],1,1,()=>{o[d]=null});let l=e[3]&&yl(e);return{c(){for(let d=0;d<o.length;d+=1)o[d].c();t=(0,w.u)(),l&&l.c(),n=(0,w.n)()},m(d,f){for(let h=0;h<o.length;h+=1)o[h].m(d,f);(0,w.j)(d,t,f),l&&l.m(d,f),(0,w.j)(d,n,f),r=!0},p(d,[f]){if(f&103){i=d[2];let h;for(h=0;h<i.length;h+=1){const g=bl(d,i,h);o[h]?(o[h].p(g,f),(0,w.x)(o[h],1)):(o[h]=Nu(g),o[h].c(),(0,w.x)(o[h],1),o[h].m(t.parentNode,t))}for((0,w.B)(),h=i.length;h<o.length;h+=1)s(h);(0,w.C)()}d[3]?l?l.p(d,f):(l=yl(d),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},i(d){if(!r){for(let f=0;f<i.length;f+=1)(0,w.x)(o[f]);r=!0}},o(d){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)(0,w.y)(o[f]);r=!1},d(d){(0,w.D)(o,d),d&&(0,w.m)(t),l&&l.d(d),d&&(0,w.m)(n)}}}function Gd(e,t,n){let r,i,{data:o}=t,{eventHandlers:s}=t,{translations:l}=t;const{wholeMoves:d,selectedNode:f,textType:h,result:g}=o;return(0,w.E)(e,d,m=>n(2,r=m)),(0,w.E)(e,g,m=>n(3,i=m)),e.$$set=m=>{"data"in m&&n(8,o=m.data),"eventHandlers"in m&&n(0,s=m.eventHandlers),"translations"in m&&n(1,l=m.translations)},[s,l,r,i,d,f,h,g,o]}class Vd extends w.a{constructor(t){super(),(0,w.i)(this,t,Gd,Hd,w.b,{data:8,eventHandlers:0,translations:1})}}function zd(e,t){const n=document.createDocumentFragment(),r=new e(Object.assign({},t,{target:n}));return t.target.replaceWith(n),r}function ns({ComponentType:e,methods:t,options:n,replaceContainer:r=!0}){const i=r?zd(e,n):new e(n),o={destroy:s,el:n.target,get:l,instance:i,on:d,set:f};return t&&t.length&&t.forEach(h=>{o[h]=i[h]}),o;function s(){i.$destroy()}function l(h){return typeof h=="string"?i.$$.ctx[h]:(0,w.F)(i.$$.ctx,h)}function d(h,g){i.$on(h,g)}function f(h){i.$set(h)}}function jd({options:e,target:t,replaceContainer:n=!1}){return ns({ComponentType:Vd,options:Ce(ge({},e),{target:t}),replaceContainer:n})}function Is({showFigurine:e=!1,san:t="",translations:n}){return t.split("").map(r=>{if(!("NBRQK".includes(r)&&e))return!"NBRQK".includes(r)||!n?r:n?.[r]()}).join("")}function qd(e){return e.reduce((t,n)=>{var r;if(n.wholeMoveNumber){const i=n.wholeMoveNumber-1;return[...t.slice(0,i),[...(r=t[i])!=null?r:[],n],...t.slice(i+1)]}return t},[])}function El(e){return ct.Piece.Names[e.san[0].toLowerCase()]}var so;(function(e){e.LineStart="lineStart",e.NodeSelected="nodeSelected",e.ResultSelected="resultSelected"})(so||(so={}));var jo;(function(e){e.LOAD_LINE="LOAD_LINE",e.GO_TO_START="GO_TO_START",e.SELECT_NODE="SELECT_NODE"})(jo||(jo={}));function Rs(e){const t=(0,w.c)(e);function n(i,o){t.transition(i,o),t.emit("action",{type:i,value:o,nextState:t.getCurrentState()})}return Object.assign({},t,{send:n,onTransition:i=>t.on("action",i)})}function Wd(e){const t=Rs(Kd(e));return t.onTransition(n=>[Qh].forEach(r=>r(n,e))),t}function Qh({type:e,value:t,nextState:n},r){var i;const o=r.data.currentState.get(),{setWholeMoves:s,selectNode:l,setResult:d,setState:f}=r.actions;o!==n&&f(n);const h={[jo.LOAD_LINE]:({line:g,result:m,node:S})=>{s(g),l(S),d(m)},[jo.GO_TO_START]:l,[jo.SELECT_NODE]:l};(i=h[e])==null||i.call(h,t,n)}function Kd({game:e,data:t}){return{initialState:so.LineStart,states:{[so.LineStart]:{SELECT_NODE:()=>so.NodeSelected,LOAD_LINE:()=>so.NodeSelected},[so.NodeSelected]:{GO_TO_START:()=>so.LineStart,SELECT_NODE:()=>so.NodeSelected,LOAD_LINE:()=>so.NodeSelected}}}}function Gi(e){let t=e;const n=(0,w.G)(t);function r(s){return n.set(t=s)}function i(s){n.update(l=>t=s(l))}function o(){return t}return{set:r,update:i,subscribe:n.subscribe,get:o}}function Jh(){const e={currentState:so.LineStart,wholeMoves:[],selectedNode:null,textType:pr.MoveListDisplayTypes.Text,result:null},t={wholeMoves:Gi(e.wholeMoves),currentState:Gi(e.currentState),selectedNode:Gi(e.selectedNode),textType:Gi(e.textType),result:Gi(e.result)};return{data:t,actions:e1(t)}}function e1({wholeMoves:e,currentState:t,selectedNode:n,textType:r,result:i}){function o(h){t.set(h)}function s(h){i.set(h==="*"?null:h)}function l(h){e.set(qd(h))}function d(h){n.set(h)}function f(h){r.set(h)}return{setTextType:f,setState:o,setWholeMoves:l,selectNode:d,setResult:s}}function $d(e,{game:t,data:n}){return{clickNode(r,i){r.stopPropagation(),t.selectNode(0,i)}}}var t1=`@charset "UTF-8";
[data-tooltip] {
  position: relative;
}
[data-tooltip] body.dark-mode:after, body.dark-mode [data-tooltip]:after {
  background: rgba(0, 0, 0, 0.7);
}
[data-tooltip]:after {
  opacity: 0;
  pointer-events: none;
  position: absolute;
  transition: all 0.16s ease-out 0.08s;
  z-index: 1;
  background: #262421;
  border-radius: 2px;
  color: #fff;
  content: attr(data-tooltip);
  font-size: 1.4rem;
  font-weight: 600;
  max-width: 200px;
  padding: 5px 8px;
  text-align: center;
  white-space: nowrap;
}
[data-tooltip]:before {
  opacity: 0;
  pointer-events: none;
  position: absolute;
  transition: all 0.16s ease-out 0.08s;
  z-index: 1;
  border: 5px solid transparent;
  content: "";
  height: 0;
  width: 0;
}
[data-tooltip]:hover:before, [data-tooltip]:hover:after {
  opacity: 1;
}
[data-tooltip][data-tooltip-position=bottom]:after, [data-tooltip][data-tooltip-position=bottom]:before {
  left: 50%;
  top: 100%;
  transform: translate3d(-50%, -4px, 0);
}
[data-tooltip][data-tooltip-position=bottom]:after {
  margin-top: 10px;
}
[data-tooltip][data-tooltip-position=bottom]:before {
  border-bottom-color: #262421;
}
[data-tooltip][data-tooltip-position=bottom]:before body.dark-mode, body.dark-mode [data-tooltip][data-tooltip-position=bottom]:before {
  border-bottom-color: rgba(0, 0, 0, 0.7);
}
[data-tooltip][data-tooltip-position=bottom]:hover:after, [data-tooltip][data-tooltip-position=bottom]:hover:before {
  transform: translate3d(-50%, 0, 0);
}
[data-tooltip][data-tooltip-position=left]:after, [data-tooltip][data-tooltip-position=left]:before {
  right: 100%;
  top: 50%;
  transform: translate3d(4px, -50%, 0);
}
[data-tooltip][data-tooltip-position=left]:after {
  margin-right: 10px;
}
[data-tooltip][data-tooltip-position=left]:before {
  border-left-color: #262421;
}
[data-tooltip][data-tooltip-position=left]:before body.dark-mode, body.dark-mode [data-tooltip][data-tooltip-position=left]:before {
  border-left-color: rgba(0, 0, 0, 0.7);
}
[data-tooltip][data-tooltip-position=left]:hover:after, [data-tooltip][data-tooltip-position=left]:hover:before {
  transform: translate3d(0, -50%, 0);
}
[data-tooltip][data-tooltip-position=right]:after, [data-tooltip][data-tooltip-position=right]:before {
  left: 100%;
  top: 50%;
  transform: translate3d(-4px, -50%, 0);
}
[data-tooltip][data-tooltip-position=right]:after {
  margin-left: 10px;
}
[data-tooltip][data-tooltip-position=right]:before {
  border-right-color: #262421;
}
[data-tooltip][data-tooltip-position=right]:before body.dark-mode, body.dark-mode [data-tooltip][data-tooltip-position=right]:before {
  border-right-color: rgba(0, 0, 0, 0.7);
}
[data-tooltip][data-tooltip-position=right]:hover:after, [data-tooltip][data-tooltip-position=right]:hover:before {
  transform: translate3d(0, -50%, 0);
}
[data-tooltip][data-tooltip-position=top]:after, [data-tooltip][data-tooltip-position=top]:before {
  bottom: 100%;
  left: 50%;
  transform: translate3d(-50%, 4px, 0);
}
[data-tooltip][data-tooltip-position=top]:after {
  margin-bottom: 10px;
}
[data-tooltip][data-tooltip-position=top]:before {
  border-top-color: #262421;
}
[data-tooltip][data-tooltip-position=top]:before body.dark-mode, body.dark-mode [data-tooltip][data-tooltip-position=top]:before {
  border-top-color: rgba(0, 0, 0, 0.7);
}
[data-tooltip][data-tooltip-position=top]:hover:after, [data-tooltip][data-tooltip-position=top]:hover:before {
  transform: translate3d(-50%, 0, 0);
}
.horizontal-move-list .icon-font-chess:before,
.vertical-move-list .icon-font-chess:before {
  pointer-events: none;
}
.horizontal-move-list .icon-font-chess.knight-black:before,
.vertical-move-list .icon-font-chess.knight-black:before {
  content: "\xC7";
}
.horizontal-move-list .icon-font-chess.knight-white:before,
.vertical-move-list .icon-font-chess.knight-white:before {
  content: "\u0116";
}
.horizontal-move-list .icon-font-chess.bishop-black:before,
.vertical-move-list .icon-font-chess.bishop-black:before {
  content: "\u0102";
}
.horizontal-move-list .icon-font-chess.bishop-white:before,
.vertical-move-list .icon-font-chess.bishop-white:before {
  content: "\xC4";
}
.horizontal-move-list .icon-font-chess.queen-black:before,
.vertical-move-list .icon-font-chess.queen-black:before {
  content: "\u012E";
}
.horizontal-move-list .icon-font-chess.queen-white:before,
.vertical-move-list .icon-font-chess.queen-white:before {
  content: "\u0136";
}
.horizontal-move-list .icon-font-chess.king-black:before,
.vertical-move-list .icon-font-chess.king-black:before {
  content: "\u0100";
}
.horizontal-move-list .icon-font-chess.king-white:before,
.vertical-move-list .icon-font-chess.king-white:before {
  content: "\u0104";
}
.horizontal-move-list .icon-font-chess.rook-black:before,
.vertical-move-list .icon-font-chess.rook-black:before {
  content: "\u013D";
}
.horizontal-move-list .icon-font-chess.rook-white:before,
.vertical-move-list .icon-font-chess.rook-white:before {
  content: "\u013B";
}
.dark-mode .horizontal-move-list .icon-font-chess.knight-black:before,
.dark-mode .vertical-move-list .icon-font-chess.knight-black:before {
  content: "\u0116";
}
.dark-mode .horizontal-move-list .icon-font-chess.knight-white:before,
.dark-mode .vertical-move-list .icon-font-chess.knight-white:before {
  content: "\xC7";
}
.dark-mode .horizontal-move-list .icon-font-chess.bishop-black:before,
.dark-mode .vertical-move-list .icon-font-chess.bishop-black:before {
  content: "\xC4";
}
.dark-mode .horizontal-move-list .icon-font-chess.bishop-white:before,
.dark-mode .vertical-move-list .icon-font-chess.bishop-white:before {
  content: "\u0102";
}
.dark-mode .horizontal-move-list .icon-font-chess.queen-black:before,
.dark-mode .vertical-move-list .icon-font-chess.queen-black:before {
  content: "\u0136";
}
.dark-mode .horizontal-move-list .icon-font-chess.queen-white:before,
.dark-mode .vertical-move-list .icon-font-chess.queen-white:before {
  content: "\u012E";
}
.dark-mode .horizontal-move-list .icon-font-chess.king-black:before,
.dark-mode .vertical-move-list .icon-font-chess.king-black:before {
  content: "\u0104";
}
.dark-mode .horizontal-move-list .icon-font-chess.king-white:before,
.dark-mode .vertical-move-list .icon-font-chess.king-white:before {
  content: "\u0100";
}
.dark-mode .horizontal-move-list .icon-font-chess.rook-black:before,
.dark-mode .vertical-move-list .icon-font-chess.rook-black:before {
  content: "\u013B";
}
.dark-mode .horizontal-move-list .icon-font-chess.rook-white:before,
.dark-mode .vertical-move-list .icon-font-chess.rook-white:before {
  content: "\u013D";
}
:root {
  --nodeBackground: #fff35f;
  --nodeBorder: rgba(0, 0, 0, 0.05);
  --nodeColor: #262421;
  --nodeColorSelected: #262421;
  --nodeNumber: rgba(0, 0, 0, 0.7);
}
:global(.dark-mode) {
  --nodeNumber: rgba(255, 255, 255, 0.5);
  --nodeColor: rgba(255, 255, 255, 0.72);
  --nodeBackground: rgba(255, 255, 0, 0.2);
  --nodeBorder: rgba(255, 255, 0, 0.4);
  --nodeColorSelected: #fff;
}
.move-list {
  --timeBarMaxWidth: 65px;
  --timeMaxValue: 0;
  --whiteNodeSpace: 4rem;
  --blackNodeSpace: 12rem;
  overflow-x: hidden;
  overflow-y: auto;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.move-list body.dark-mode .move, body.dark-mode .move-list .move {
  color: rgba(255, 255, 255, 0.5);
}
.move-list body.dark-mode .move:nth-child(even), body.dark-mode .move-list .move:nth-child(even) {
  background-color: rgba(255, 255, 255, 0.02);
}
.move-list body.dark-mode .time-white:after, body.dark-mode .move-list .time-white:after {
  background-color: rgba(255, 255, 255, 0.8);
}
.move-list body.dark-mode .time-black:after, body.dark-mode .move-list .time-black:after {
  background-color: rgba(255, 255, 255, 0.2);
}
.move-list .move {
  box-sizing: border-box;
  color: #262421;
  font-size: 13px;
  font-weight: 600;
  height: 30px;
  line-height: 30px;
  overflow: hidden;
  padding: 0 5px 0 15px;
  position: relative;
  width: 100%;
}
.move-list .move:nth-child(even) {
  background-color: #f8f8f8;
}
.move-list .move .node {
  font-weight: 700;
}
.move-list .move .node .icon-font-chess {
  display: inline-block;
  font-size: 2.3rem;
  margin-right: 0.2rem;
  margin-top: -1.3rem;
}
.move-list .move .node .move-info-icon {
  --tooltip-top: 1px;
  cursor: pointer;
  display: inline-block;
  margin-left: 5px;
  margin-top: 0;
  vertical-align: top;
}
.move-list .move .node .move-info-icon:before {
  display: contents;
}
.move-list .move .node .move-info-icon[data-tooltip]:after {
  margin-top: 24px;
  position: fixed;
  top: var(--tooltip-top);
  transform: translateX(-50%);
  transition: opacity 0.16s;
  white-space: initial;
  z-index: 1000;
}
.move-list .move .node .move-info-icon[data-tooltip][data-tooltip-position=top]:after {
  bottom: initial;
  left: initial;
  margin-top: 0;
  right: initial;
  top: initial;
  transform: translate3d(-50%, -100%, 0);
}
.move-list .move .node .move-info-icon .circle-info:before {
  content: ")";
}
.move-list .move .node .move-info-icon .redo:before {
  content: "\u1F22";
}
.move-list [data-ply]:not(.selected) {
  cursor: pointer;
}
.move-list .white,
.move-list .black,
.move-list .game-result {
  height: 24px;
  line-height: 24px;
  min-width: 40px;
  padding: 0 4px;
  position: absolute;
  top: 3px;
}
.move-list .white body.dark-mode, body.dark-mode .move-list .white,
.move-list .black body.dark-mode,
body.dark-mode .move-list .black,
.move-list .game-result body.dark-mode,
body.dark-mode .move-list .game-result {
  color: rgba(255, 255, 255, 0.72);
}
.move-list .white.selected,
.move-list .black.selected,
.move-list .game-result.selected {
  background-color: var(--nodeBackground);
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-color: var(--nodeBorder);
  border-radius: 2px;
  color: var(--nodeColorSelected);
  cursor: default;
}
.move-list .white.selected body.dark-mode, body.dark-mode .move-list .white.selected,
.move-list .black.selected body.dark-mode,
body.dark-mode .move-list .black.selected,
.move-list .game-result.selected body.dark-mode,
body.dark-mode .move-list .game-result.selected {
  background-color: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.1);
}
.move-list.movelist-colored .node {
  color: var(--nodeCustomColor, --nodeColor);
}
.move-list.movelist-colored .node body.dark-mode, body.dark-mode .move-list.movelist-colored .node {
  color: var(--nodeCustomColor, rgba(255, 255, 255, 0.72));
}
.move-list .white {
  left: var(--whiteNodeSpace);
}
.move-list .black {
  left: var(--blackNodeSpace);
}
.move-list .game-result {
  left: var(--whiteNodeSpace);
}
.move-list .time-white,
.move-list .time-black {
  font-size: 10px;
  height: 10px;
  line-height: 10px;
  position: absolute;
  right: 5px;
  width: var(--timestampWidth);
}
.move-list .time-white:after,
.move-list .time-black:after {
  background-clip: content-box;
  border-radius: 2px;
  box-sizing: border-box;
  content: "";
  height: 10px;
  left: -3px;
  max-width: var(--timeBarLimit);
  min-width: 2px;
  position: absolute;
  transform: translateX(-100%);
  width: calc(var(--timeValue) / var(--timeMaxValue) * var(--timeBarMaxWidth));
}
.move-list.timestamps-with-base-time .time-white:after,
.move-list.timestamps-with-base-time .time-black:after {
  width: var(--timeBarWidth);
}
.move-list .time-white {
  top: 4px;
}
.move-list .time-white:after {
  background-color: rgba(0, 0, 0, 0.2);
  top: 0;
}
.move-list .time-black {
  bottom: 3px;
}
.move-list .time-black:after {
  background-color: rgba(0, 0, 0, 0.8);
  bottom: -1px;
}
.toggle-timestamps > .move .time-white,
.toggle-timestamps > .move .time-black {
  color: transparent;
  width: 0;
}
.toggle-timestamps > .move:hover .time-white,
.toggle-timestamps > .move:hover .time-black {
  color: #8b8987;
  width: auto;
}
.toggle-timestamps > .move:hover .time-white body.dark-mode, body.dark-mode .toggle-timestamps > .move:hover .time-white,
.toggle-timestamps > .move:hover .time-black body.dark-mode,
body.dark-mode .toggle-timestamps > .move:hover .time-black {
  color: rgba(255, 255, 255, 0.5);
}
.toggle-timestamps > .move:hover .time-white:after,
.toggle-timestamps > .move:hover .time-black:after {
  visibility: hidden;
}`;function Zd({containerEl:e,translations:t=Pa,game:n}){const{data:r,actions:i}=Jh(),o=Wd({data:r,actions:i,game:n}),s=$d(o.send,{data:r,game:n});return{destroy:jd({options:{props:{data:r,eventHandlers:s,translations:t}},target:e}).destroy,setTextType:d=>i.setTextType(d),loadLine:(d,f,h)=>o.send(jo.LOAD_LINE,{line:d,result:f,node:h}),goToStart:()=>o.send(jo.GO_TO_START),selectNode:d=>o.send(jo.SELECT_NODE,{node:d}),setResult:i.setResult}}var Al;(function(e){(function(t){t.Ready="Ready",t.Updated="Updated"})(e.Events||(e.Events={})),e.Name="move-list"})(Al||(Al={}));function Os(...e){return function(n,r){return!!e.find(i=>i(n,r))}}function n1({containerEl:e,translations:t=Pa}){let n;return{api:d=>({getMoveList:()=>n}),create:o,destroy:l,match:[{condition:xt([...Yi]),handler:r},{condition:Je(M.OptionsEvents.Update),handler:i},{condition:Je(M.APIEvents.UpdatePGNHeaders),handler:s}],name:Al.Name};function r(d,f){var h;const{api:g}=f,m=g.getLine(0),S=g.getResult(),P=(h=g.getSelectedNode())==null?void 0:h.hash;n.loadLine(m,S,P)}function i(d){d.data.moveListDisplayType&&n.setTextType(d.data.moveListDisplayType)}function o(d){n=Zd({containerEl:e,game:d.api,translations:t})}function s(d,f){const h=f.api.getResult();n.setResult(h)}function l(){n&&n.destroy()}}const qo=()=>{};function Zt(e=!0){const t=[];let n=!1;return{add:r,clear:i,flush:o,getEntries:s};function r(l,...d){let f=qo,h=qo;const g=new Promise((m,S)=>{h=m,f=S});return t.push({fn:l,params:d,reject:f,resolve:h}),e&&n===!1&&o(),g}function i(){n=!1,t.length=0}async function o(){const l=t.shift();if(!l){n=!1;return}n=!0;try{const d=await l.fn(...l.params);return l.resolve(d),o()}catch(d){l.reject(d)}}function s(){return t}}function Lu(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),reject:t,resolve:e}}function Yd(){let e=!1;const t=Lu();return{isReady:()=>e,ready:n,waitForReady:()=>t.promise};function n(r){var i;e=!0,(i=t.resolve)==null||i.call(t,r)}}function Xd(e){return function({context:n,event:r,line:i,selectedNode:o,queue:s}){const{data:l,type:d}=r,f=o?.ply;return d===M.APIEvents.AddMove&&l.listMove?e.addNode(l.listMove):l&&l.plyDiff===1&&o?(e.addNode(o),e.selectNode(f)):d===M.APIEvents.CreateGame||d===M.APIEvents.Load||d===M.APIEvents.DeletePosition?e.loadNodes(i):d===M.APIEvents.LineUpdated?(e.loadNodes(i),e.selectNode(f)):l.moveListDisplayType?(e.setMoveListDisplayType(l.moveListDisplayType),e.loadNodes(i,f)):d===M.APIEvents.NodeUpdated&&l.changes&&Object.prototype.hasOwnProperty.call(l.changes,"timestamp")?e.updateTimestamp(l.changes.node):d===M.APIEvents.UpdatePGNHeaders&&l.Result?(e.setResult(l.Result),n.game.inThreefoldRepetition()&&s.add(e.addThreeFoldIcons,i)):f===0?e.deselectNode():d!==M.OptionsEvents.Update&&e.selectNode(f),l.changes&&Object.prototype.hasOwnProperty.call(l.changes,"customColor")&&e.updateNodeColor(l.ids.move+1,l.changes.customColor),f}}var lo;(function(e){(function(t){t.EnPassant="circle-info",t.MoveInfoIcon="move-info-icon",t.ThreeFoldIcon="redo",t.IconFont="icon-font-chess",t.MoveList="move-list"})(e.Classes||(e.Classes={})),function(t){t.EnPassantIcon="span"}(e.Tags||(e.Tags={})),function(t){t.Color="--nodeCustomColor"}(e.CssVariables||(e.CssVariables={}))})(lo||(lo={}));function uo({el:e,value:t,variable:n}){if(t!==void 0)return e.style.setProperty(n,t);e.style.removeProperty(n)}function Xn(e,t){Object.values(lo.CssVariables).forEach(n);function n(r){uo({el:e,value:t,variable:r})}}var jr;(function(e){e.Mousedown="mousedown",e.MouseMove="mousemove",e.Mouseup="mouseup",e.PointerDown="pointerdown",e.PointerMove="pointermove",e.PointerUp="pointerup",e.Touchstart="touchstart",e.Touchmove="touchmove",e.Touchend="touchend"})(jr||(jr={}));const{Pointerdown:Ji,Pointermove:Ta,Pointerup:rs}=r1();function r1(){const e="onpointerdown"in window,t="ontouchstart"in window;let n,r,i;return e?(n=jr.PointerDown,r=jr.PointerMove,i=jr.PointerUp):t?(n=jr.Touchstart,r=jr.Touchmove,i=jr.Touchend):(n=jr.Mousedown,r=jr.MouseMove,i=jr.Mouseup),{Pointerdown:n,Pointermove:r,Pointerup:i}}function Qd(e,t){const n=document.createElement("div"),r=document.createElement(lo.Tags.EnPassantIcon);return n.appendChild(r),n.classList.add(lo.Classes.MoveInfoIcon),r.classList.add(lo.Classes.IconFont,lo.Classes.EnPassant),n.addEventListener(Ji,o),n.addEventListener("mouseover",i),n.dataset.tooltip=t[tt.Translation.Tooltips.EnPassant](),{el:n,listener:{el:n,eventName:Ji,handler:o}};function i(){const s=n.getBoundingClientRect().y;n.style.setProperty("--tooltip-top",`${s}px`)}function o(s){s.stopPropagation(),window.open(e,"_blank")}}function i1(e={}){const t=ge({},e);return{get:n,set:r};function n(){return t}function r(i){Object.assign(t,i)}}function Jn(e){return ct.Piece.Names[e.toLowerCase()]}function wl(e,t){return e.toUpperCase()===e?Jd(e,t):e}function Jd(e,t){return`<span class="icon-font-chess ${Jn(e)}-${t}" data-figurine="${e}"></span>`}function mr({color:e,moveListDisplayType:t,san:n,translations:r}){return n.split("").map(i=>"NBRQK".includes(i)?t===pr.MoveListDisplayTypes.Figurine?wl(i,e):r[i]():i).join("")}const Oi=65;function Du(e,t){const n=t/40,r=e/n;return Oi*2/Math.PI*Math.atan(r/3)}function Bu(e,t){if(!e)return;const n=e.map(({fen:r})=>r.split(" ").slice(0,2).join(" "));return Fu(n).map(r=>t[r])}function Fu(e){return e.reduceRight((t,n,r,i)=>((n===i[i.length-1]?t.push(r):t.length)===3&&(i.length=0),t),[])}function Oo(e){return`time-${e}`}function Ns(e){return e===ct.Move.Flags.EPCapture}const Uu=7;function aa(e){return`.${e}`}var Sr;(function(e){(function(t){(function(n){n.Ply="data-ply",n.Time="data-time",n.WholeMoveNumber="data-whole-move-number",n.VMLElement="data-vml-element"})(t.Attributes||(t.Attributes={})),function(n){n.TimeBarWidth="--timeBarWidth",n.TimeValue="--timeValue",n.MaxMoveTimeTaken="--timeMaxValue",n.TimestampWidth="--timestampWidth"}(t.CSSVariables||(t.CSSVariables={})),function(n){n.ColorsEnabled="movelist-colored",n.List="vertical-move-list",n.GameResult="game-result",n.Move="move",n.Node="node",n.Selected="selected",n.WithBaseTime="timestamps-with-base-time",n.ToggleTimestamps="toggle-timestamps"}(t.ClassNames||(t.ClassNames={})),function(n){n.Timestamp="timestamp"}(t.ElementTypes||(t.ElementTypes={}))})(e.DOM||(e.DOM={})),function(t){t.SelectNode="SelectNode"}(e.Events||(e.Events={}))})(Sr||(Sr={}));function Hu({containerEl:e,moveListEl:t,nodeEl:n}){if(!t||!n)return;const r=e||t,i=r.getBoundingClientRect(),o=n.getBoundingClientRect(),s=(i.bottom-i.top)/2,l=i.top-o.top+s;r.scrollTop-=l}function ef(e){const{el:t,toggleTimestamps:n}=e,r=[],i=i1(e);return{addMove:o,addNode:s,addTimestamp:l,clearList:d,createList:f,deselectNode:P,destroyList:D,enableColors:be,getLastPly:Ye,getParams:i.get,getResult:Ft,getResultNodeElement:Ln,getTimestamp:Zn,hasResultNode:Qn,addThreeFoldMoveIcons:si,removeTimestamp:ri,scrollToSelectedNode:Bi,selectNode:ir,selectNodeElement:Fi,setResultNode:Hr,setTimestampValue:ki,setParams:i.set,updateNodeColor:vo};function o(Wt){const bn=document.createElement("div");return bn.classList.add(Sr.DOM.ClassNames.Move),Wt&&(bn.setAttribute(Sr.DOM.Attributes.WholeMoveNumber,`${Wt}`),bn.innerHTML=`${Wt}.`),t.appendChild(bn),bn}function s(Wt){const{color:bn,flags:hr,ids:Zr,ply:li,san:ci,wholeMoveNumber:ti}=Wt;if(!bn||!li||!ci||!ti||tn(li))return;let Hi=Ze(ti);Hi||(Hi=o(ti));const Wi=h({color:ts(bn),moveId:Zr.move,isEPCapture:hr?Ns(hr):!1,ply:li,san:ci});if(Wi)return Wt.ply&&Object.prototype.hasOwnProperty.call(Wt,"customColor")&&Xn(Wi,Wt.customColor),Hi.appendChild(Wi)}function l({baseTime:Wt,node:bn,timestamp:hr,title:Zr,value:li}){const{color:ci,ply:ti,wholeMoveNumber:Hi}=bn;if(!ci||!ti||!Hi)return;const Wi=Ze(Hi);if(!Wi)return;const uu=br(ti);uu&&Wi.removeChild(uu);const Ga=S(ti);return Zr&&Ui(Zr,Ga),gi(ci,Ga),ki({baseTime:Wt,ply:ti,timestamp:hr,value:li},Ga),Wi.appendChild(Ga),Ga}function d(){D(),f()}function f(){D(),t.classList.add(Sr.DOM.ClassNames.List),n&&t.classList.add(Sr.DOM.ClassNames.ToggleTimestamps)}function h({color:Wt,isEPCapture:bn,moveId:hr,ply:Zr,san:li}){const{EPIconInfoPath:ci,moveListDisplayType:ti,translations:Hi}=i.get(),Wi=document.createElement("div");if(Wi.setAttribute(Sr.DOM.Attributes.Ply,Zr.toString()),Wi.classList.add(Wt,Sr.DOM.ClassNames.Node),Wi.innerHTML=mr({color:Wt,moveListDisplayType:ti,san:li,translations:Hi}),bn){const{el:Ga,listener:i5}=Qd(ci,Hi);Wi.appendChild(Ga),r.push({el:Ga,eventName:Ji,handler:i5.handler})}return Wi.addEventListener(Ji,uu),r.push({eventName:Ji,handler:uu}),Wi;function uu(){t.dispatchEvent(new CustomEvent(Sr.Events.SelectNode,{detail:{ids:{move:hr,line:0},ply:Zr}}))}}function g(Wt,bn){const hr=document.createElement("span");return hr.innerHTML=Wt,hr.classList.add(bn,Sr.DOM.ClassNames.GameResult),hr}function m(){const{translations:Wt}=i.get(),bn=document.createElement("div"),hr=document.createElement("span");return bn.appendChild(hr),bn.classList.add(lo.Classes.MoveInfoIcon),hr.classList.add(lo.Classes.IconFont,lo.Classes.ThreeFoldIcon),bn.dataset.tooltip=Wt[tt.Translation.Tooltips.ThreeFoldRepetition](),bn.addEventListener("mouseover",Zr),bn;function Zr(){const li=bn.getBoundingClientRect().y;bn.style.setProperty("--tooltip-top",`${li}px`)}}function S(Wt){const bn=document.createElement("div");return bn.setAttribute(Sr.DOM.Attributes.Ply,Wt.toString()),bn.setAttribute(Sr.DOM.Attributes.VMLElement,Sr.DOM.ElementTypes.Timestamp),bn}function P(Wt){const bn=Wt?tn(Wt):kr();bn&&I(bn)}function I(Wt){Wt.classList.remove(Sr.DOM.ClassNames.Selected)}function D(){r.forEach(Wt=>{t.removeEventListener(Wt.eventName,Wt.handler)}),t.classList.remove(Sr.DOM.ClassNames.List),t.innerHTML=""}function be(Wt){const{colorsEnabled:bn}=i.get();bn!==Wt&&(i.set({colorsEnabled:Wt}),t.classList[Wt?"add":"remove"](Sr.DOM.ClassNames.ColorsEnabled))}function Ye(){const Wt=Ct();if(!Wt.length)return;const bn=Sn(Wt[Wt.length-1]);if(bn)return bn}function Se(){const Wt=t.style.getPropertyValue(Sr.DOM.CSSVariables.MaxMoveTimeTaken);return Wt.length?parseFloat(Wt):null}function Ze(Wt){return t.querySelector(`[${Sr.DOM.Attributes.WholeMoveNumber}="${Wt}"]`)}function mt(){return Array.from(t.querySelectorAll(`${aa(Sr.DOM.ClassNames.Move)}`))}function zn(Wt){return Wt.classList.contains(ct.ColorsAsWords.Black)?ct.ColorsAsNumbers.Black:ct.ColorsAsNumbers.White}function Sn(Wt){const bn=Wt.getAttribute(Sr.DOM.Attributes.Ply);return bn?parseInt(bn,10):null}function tn(Wt){return t.querySelector(`${aa(Sr.DOM.ClassNames.Node)}[${Sr.DOM.Attributes.Ply}="${Wt}"]`)}function Ct(){return Array.from(t.querySelectorAll(`${aa(Sr.DOM.ClassNames.Node)}`))}function Ft(){const Wt=Ln();return Wt?Wt.innerText:ct.Results.None}function Ln(){return t.querySelector(aa(Sr.DOM.ClassNames.GameResult))}function Zn(Wt){const bn=br(Wt);if(!bn)return null;const hr=bn.getAttribute(Sr.DOM.Attributes.Time);return hr?.length===0?null:parseFloat(hr)}function br(Wt){return t.querySelector(`[${Sr.DOM.Attributes.VMLElement}="${Sr.DOM.ElementTypes.Timestamp}"][${Sr.DOM.Attributes.Ply}="${Wt}"]`)}function tr(){const Wt=t.style.getPropertyValue(Sr.DOM.CSSVariables.TimestampWidth);return Wt.length?parseFloat(Wt):null}function kr(){return t.querySelector(aa(Sr.DOM.ClassNames.Selected))}function Qn(){return!!t.querySelector(aa(Sr.DOM.ClassNames.GameResult))}function ri(Wt){const bn=br(Wt);bn&&bn.parentNode.removeChild(bn)}function Bi(){const{scrollContainer:Wt}=i.get(),bn=kr(),hr=Wt||t;if(!bn){hr.scrollTop=0;return}Hu({containerEl:hr,moveListEl:t,nodeEl:bn})}function Fi(Wt){const bn=kr();Wt!==bn&&(bn&&I(bn),Wt.classList.add(Sr.DOM.ClassNames.Selected))}function ir(Wt){const bn=tn(Wt);bn&&Fi(bn)}function wr(Wt){if(Wt===null){t.style.removeProperty(Sr.DOM.CSSVariables.MaxMoveTimeTaken);return}t.style.setProperty(Sr.DOM.CSSVariables.MaxMoveTimeTaken,Wt.toString())}function Hr(Wt){const bn=Ln();if(bn!==null){const ti=bn.parentNode;if(!ti)return;ti.removeChild(bn),ti.childNodes.length===0&&ti.parentNode.removeChild(ti)}if(Wt===ct.Results.None)return;const hr=Ct().slice(-1)[0],Zr=!hr||zn(hr)===ct.ColorsAsNumbers.Black?ct.ColorsAsWords.White:ct.ColorsAsWords.Black,li=Zr===ct.ColorsAsWords.White?o():mt().slice(-1)[0],ci=g(Wt,Zr);li.appendChild(ci)}function si(Wt){const bn=Bu(Wt,Ct());!bn||bn.length!==3||bn.forEach(hr=>{hr.querySelector(aa(lo.Classes.MoveInfoIcon))||hr.appendChild(m())})}function gi(Wt,bn){bn.classList.add(Oo(ts(Wt)))}function Ui(Wt,bn){bn.title=Wt}function ki({baseTime:Wt,ply:bn,value:hr,timestamp:Zr},li){const ci=li||br(bn);if(!ci)return;const ti=tr(),Hi=Se();if(ci.setAttribute(Sr.DOM.Attributes.Time,Zr.toString()),ci.style.setProperty(Sr.DOM.CSSVariables.TimeValue,Zr.toString()),ci.innerHTML=hr,(!ti||hr.length*Uu>ti)&&no(hr.length),Wt){const Wi=Du(Zr,Vo(Wt));ci.style.setProperty(Sr.DOM.CSSVariables.TimeBarWidth,`${Wi}px`),t.classList.add(Sr.DOM.ClassNames.WithBaseTime),Hi&&wr(null);return}t.classList.remove(Sr.DOM.ClassNames.WithBaseTime),(!Hi||Zr>Hi)&&wr(Zr)}function no(Wt){const bn=Wt*Uu;t.style.setProperty(Sr.DOM.CSSVariables.TimestampWidth,`${bn}px`)}function vo(Wt,bn){const hr=tn(Wt);hr&&Xn(hr,bn)}}var o1=`@charset "UTF-8";
[data-tooltip] {
  position: relative;
}
[data-tooltip] body.dark-mode:after, body.dark-mode [data-tooltip]:after {
  background: rgba(0, 0, 0, 0.7);
}
[data-tooltip]:after {
  opacity: 0;
  pointer-events: none;
  position: absolute;
  transition: all 0.16s ease-out 0.08s;
  z-index: 1;
  background: #262421;
  border-radius: 2px;
  color: #fff;
  content: attr(data-tooltip);
  font-size: 1.4rem;
  font-weight: 600;
  max-width: 200px;
  padding: 5px 8px;
  text-align: center;
  white-space: nowrap;
}
[data-tooltip]:before {
  opacity: 0;
  pointer-events: none;
  position: absolute;
  transition: all 0.16s ease-out 0.08s;
  z-index: 1;
  border: 5px solid transparent;
  content: "";
  height: 0;
  width: 0;
}
[data-tooltip]:hover:before, [data-tooltip]:hover:after {
  opacity: 1;
}
[data-tooltip][data-tooltip-position=bottom]:after, [data-tooltip][data-tooltip-position=bottom]:before {
  left: 50%;
  top: 100%;
  transform: translate3d(-50%, -4px, 0);
}
[data-tooltip][data-tooltip-position=bottom]:after {
  margin-top: 10px;
}
[data-tooltip][data-tooltip-position=bottom]:before {
  border-bottom-color: #262421;
}
[data-tooltip][data-tooltip-position=bottom]:before body.dark-mode, body.dark-mode [data-tooltip][data-tooltip-position=bottom]:before {
  border-bottom-color: rgba(0, 0, 0, 0.7);
}
[data-tooltip][data-tooltip-position=bottom]:hover:after, [data-tooltip][data-tooltip-position=bottom]:hover:before {
  transform: translate3d(-50%, 0, 0);
}
[data-tooltip][data-tooltip-position=left]:after, [data-tooltip][data-tooltip-position=left]:before {
  right: 100%;
  top: 50%;
  transform: translate3d(4px, -50%, 0);
}
[data-tooltip][data-tooltip-position=left]:after {
  margin-right: 10px;
}
[data-tooltip][data-tooltip-position=left]:before {
  border-left-color: #262421;
}
[data-tooltip][data-tooltip-position=left]:before body.dark-mode, body.dark-mode [data-tooltip][data-tooltip-position=left]:before {
  border-left-color: rgba(0, 0, 0, 0.7);
}
[data-tooltip][data-tooltip-position=left]:hover:after, [data-tooltip][data-tooltip-position=left]:hover:before {
  transform: translate3d(0, -50%, 0);
}
[data-tooltip][data-tooltip-position=right]:after, [data-tooltip][data-tooltip-position=right]:before {
  left: 100%;
  top: 50%;
  transform: translate3d(-4px, -50%, 0);
}
[data-tooltip][data-tooltip-position=right]:after {
  margin-left: 10px;
}
[data-tooltip][data-tooltip-position=right]:before {
  border-right-color: #262421;
}
[data-tooltip][data-tooltip-position=right]:before body.dark-mode, body.dark-mode [data-tooltip][data-tooltip-position=right]:before {
  border-right-color: rgba(0, 0, 0, 0.7);
}
[data-tooltip][data-tooltip-position=right]:hover:after, [data-tooltip][data-tooltip-position=right]:hover:before {
  transform: translate3d(0, -50%, 0);
}
[data-tooltip][data-tooltip-position=top]:after, [data-tooltip][data-tooltip-position=top]:before {
  bottom: 100%;
  left: 50%;
  transform: translate3d(-50%, 4px, 0);
}
[data-tooltip][data-tooltip-position=top]:after {
  margin-bottom: 10px;
}
[data-tooltip][data-tooltip-position=top]:before {
  border-top-color: #262421;
}
[data-tooltip][data-tooltip-position=top]:before body.dark-mode, body.dark-mode [data-tooltip][data-tooltip-position=top]:before {
  border-top-color: rgba(0, 0, 0, 0.7);
}
[data-tooltip][data-tooltip-position=top]:hover:after, [data-tooltip][data-tooltip-position=top]:hover:before {
  transform: translate3d(-50%, 0, 0);
}
.horizontal-move-list .icon-font-chess:before,
.vertical-move-list .icon-font-chess:before {
  pointer-events: none;
}
.horizontal-move-list .icon-font-chess.knight-black:before,
.vertical-move-list .icon-font-chess.knight-black:before {
  content: "\xC7";
}
.horizontal-move-list .icon-font-chess.knight-white:before,
.vertical-move-list .icon-font-chess.knight-white:before {
  content: "\u0116";
}
.horizontal-move-list .icon-font-chess.bishop-black:before,
.vertical-move-list .icon-font-chess.bishop-black:before {
  content: "\u0102";
}
.horizontal-move-list .icon-font-chess.bishop-white:before,
.vertical-move-list .icon-font-chess.bishop-white:before {
  content: "\xC4";
}
.horizontal-move-list .icon-font-chess.queen-black:before,
.vertical-move-list .icon-font-chess.queen-black:before {
  content: "\u012E";
}
.horizontal-move-list .icon-font-chess.queen-white:before,
.vertical-move-list .icon-font-chess.queen-white:before {
  content: "\u0136";
}
.horizontal-move-list .icon-font-chess.king-black:before,
.vertical-move-list .icon-font-chess.king-black:before {
  content: "\u0100";
}
.horizontal-move-list .icon-font-chess.king-white:before,
.vertical-move-list .icon-font-chess.king-white:before {
  content: "\u0104";
}
.horizontal-move-list .icon-font-chess.rook-black:before,
.vertical-move-list .icon-font-chess.rook-black:before {
  content: "\u013D";
}
.horizontal-move-list .icon-font-chess.rook-white:before,
.vertical-move-list .icon-font-chess.rook-white:before {
  content: "\u013B";
}
.dark-mode .horizontal-move-list .icon-font-chess.knight-black:before,
.dark-mode .vertical-move-list .icon-font-chess.knight-black:before {
  content: "\u0116";
}
.dark-mode .horizontal-move-list .icon-font-chess.knight-white:before,
.dark-mode .vertical-move-list .icon-font-chess.knight-white:before {
  content: "\xC7";
}
.dark-mode .horizontal-move-list .icon-font-chess.bishop-black:before,
.dark-mode .vertical-move-list .icon-font-chess.bishop-black:before {
  content: "\xC4";
}
.dark-mode .horizontal-move-list .icon-font-chess.bishop-white:before,
.dark-mode .vertical-move-list .icon-font-chess.bishop-white:before {
  content: "\u0102";
}
.dark-mode .horizontal-move-list .icon-font-chess.queen-black:before,
.dark-mode .vertical-move-list .icon-font-chess.queen-black:before {
  content: "\u0136";
}
.dark-mode .horizontal-move-list .icon-font-chess.queen-white:before,
.dark-mode .vertical-move-list .icon-font-chess.queen-white:before {
  content: "\u012E";
}
.dark-mode .horizontal-move-list .icon-font-chess.king-black:before,
.dark-mode .vertical-move-list .icon-font-chess.king-black:before {
  content: "\u0104";
}
.dark-mode .horizontal-move-list .icon-font-chess.king-white:before,
.dark-mode .vertical-move-list .icon-font-chess.king-white:before {
  content: "\u0100";
}
.dark-mode .horizontal-move-list .icon-font-chess.rook-black:before,
.dark-mode .vertical-move-list .icon-font-chess.rook-black:before {
  content: "\u013B";
}
.dark-mode .horizontal-move-list .icon-font-chess.rook-white:before,
.dark-mode .vertical-move-list .icon-font-chess.rook-white:before {
  content: "\u013D";
}
:root {
  --nodeBackground: #fff35f;
  --nodeBorder: rgba(0, 0, 0, 0.05);
  --nodeColor: #262421;
  --nodeColorSelected: #262421;
  --nodeNumber: rgba(0, 0, 0, 0.7);
}
:global(.dark-mode) {
  --nodeNumber: rgba(255, 255, 255, 0.5);
  --nodeColor: rgba(255, 255, 255, 0.72);
  --nodeBackground: rgba(255, 255, 0, 0.2);
  --nodeBorder: rgba(255, 255, 0, 0.4);
  --nodeColorSelected: #fff;
}
.vertical-move-list {
  --timeBarMaxWidth: 65px;
  --timeMaxValue: 0;
  --whiteNodeSpace: 4rem;
  --blackNodeSpace: 12rem;
  overflow-x: hidden;
  overflow-y: auto;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.vertical-move-list body.dark-mode .move, body.dark-mode .vertical-move-list .move {
  color: rgba(255, 255, 255, 0.5);
}
.vertical-move-list body.dark-mode .move:nth-child(even), body.dark-mode .vertical-move-list .move:nth-child(even) {
  background-color: rgba(255, 255, 255, 0.02);
}
.vertical-move-list body.dark-mode .time-white:after, body.dark-mode .vertical-move-list .time-white:after {
  background-color: rgba(255, 255, 255, 0.8);
}
.vertical-move-list body.dark-mode .time-black:after, body.dark-mode .vertical-move-list .time-black:after {
  background-color: rgba(255, 255, 255, 0.2);
}
.vertical-move-list .move {
  box-sizing: border-box;
  color: #262421;
  font-size: 13px;
  font-weight: 600;
  height: 30px;
  line-height: 30px;
  overflow: hidden;
  padding: 0 5px 0 15px;
  position: relative;
  width: 100%;
}
.vertical-move-list .move:nth-child(even) {
  background-color: #f8f8f8;
}
.vertical-move-list .move .node {
  font-weight: 700;
}
.vertical-move-list .move .node .icon-font-chess {
  display: inline-block;
  font-size: 2.3rem;
  margin-right: 0.2rem;
  margin-top: -1.3rem;
}
.vertical-move-list .move .node .move-info-icon {
  --tooltip-top: 1px;
  cursor: pointer;
  display: inline-block;
  margin-left: 5px;
  margin-top: 0;
  vertical-align: top;
}
.vertical-move-list .move .node .move-info-icon:before {
  display: contents;
}
.vertical-move-list .move .node .move-info-icon[data-tooltip]:after {
  margin-top: 24px;
  position: fixed;
  top: var(--tooltip-top);
  transform: translateX(-50%);
  transition: opacity 0.16s;
  white-space: initial;
  z-index: 1000;
}
.vertical-move-list .move .node .move-info-icon[data-tooltip][data-tooltip-position=top]:after {
  bottom: initial;
  left: initial;
  margin-top: 0;
  right: initial;
  top: initial;
  transform: translate3d(-50%, -100%, 0);
}
.vertical-move-list .move .node .move-info-icon .circle-info:before {
  content: ")";
}
.vertical-move-list .move .node .move-info-icon .redo:before {
  content: "\u1F22";
}
.vertical-move-list [data-ply]:not(.selected) {
  cursor: pointer;
}
.vertical-move-list .white,
.vertical-move-list .black {
  height: 24px;
  line-height: 24px;
  min-width: 40px;
  padding: 0 4px;
  position: absolute;
  top: 3px;
}
.vertical-move-list .white body.dark-mode, body.dark-mode .vertical-move-list .white,
.vertical-move-list .black body.dark-mode,
body.dark-mode .vertical-move-list .black {
  color: rgba(255, 255, 255, 0.72);
}
.vertical-move-list .white.selected,
.vertical-move-list .black.selected {
  background-color: var(--nodeBackground);
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-color: var(--nodeBorder);
  border-radius: 2px;
  color: var(--nodeColorSelected);
  cursor: default;
}
.vertical-move-list .white.selected body.dark-mode, body.dark-mode .vertical-move-list .white.selected,
.vertical-move-list .black.selected body.dark-mode,
body.dark-mode .vertical-move-list .black.selected {
  background-color: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.1);
}
.vertical-move-list.movelist-colored .node {
  color: var(--nodeCustomColor, --nodeColor);
}
.vertical-move-list.movelist-colored .node body.dark-mode, body.dark-mode .vertical-move-list.movelist-colored .node {
  color: var(--nodeCustomColor, rgba(255, 255, 255, 0.72));
}
.vertical-move-list .white {
  left: var(--whiteNodeSpace);
}
.vertical-move-list .black {
  left: var(--blackNodeSpace);
}
.vertical-move-list .time-white,
.vertical-move-list .time-black {
  font-size: 10px;
  height: 10px;
  line-height: 10px;
  position: absolute;
  right: 5px;
  width: var(--timestampWidth);
}
.vertical-move-list .time-white:after,
.vertical-move-list .time-black:after {
  background-clip: content-box;
  border-radius: 2px;
  box-sizing: border-box;
  content: "";
  height: 10px;
  left: -3px;
  max-width: var(--timeBarLimit);
  min-width: 2px;
  position: absolute;
  transform: translateX(-100%);
  width: calc(var(--timeValue) / var(--timeMaxValue) * var(--timeBarMaxWidth));
}
.vertical-move-list.timestamps-with-base-time .time-white:after,
.vertical-move-list.timestamps-with-base-time .time-black:after {
  width: var(--timeBarWidth);
}
.vertical-move-list .time-white {
  top: 4px;
}
.vertical-move-list .time-white:after {
  background-color: rgba(0, 0, 0, 0.2);
  top: 0;
}
.vertical-move-list .time-black {
  bottom: 3px;
}
.vertical-move-list .time-black:after {
  background-color: rgba(0, 0, 0, 0.8);
  bottom: -1px;
}
.toggle-timestamps > .move .time-white,
.toggle-timestamps > .move .time-black {
  color: transparent;
  width: 0;
}
.toggle-timestamps > .move:hover .time-white,
.toggle-timestamps > .move:hover .time-black {
  color: #8b8987;
  width: auto;
}
.toggle-timestamps > .move:hover .time-white body.dark-mode, body.dark-mode .toggle-timestamps > .move:hover .time-white,
.toggle-timestamps > .move:hover .time-black body.dark-mode,
body.dark-mode .toggle-timestamps > .move:hover .time-black {
  color: rgba(255, 255, 255, 0.5);
}
.toggle-timestamps > .move:hover .time-white:after,
.toggle-timestamps > .move:hover .time-black:after {
  visibility: hidden;
}`;function tf(e){const t=Math.ceil(e/10);let n=Math.floor(t/(3600*24)),r=Math.floor(t%(3600*24)/3600),i=Math.ceil(t%3600/60);return i===60&&(i=0,r+=1),r===24&&(r=0,n+=1),{days:n,hours:r,minutes:i}}function nf(e,t){const{days:n,hours:r,minutes:i}=tf(e),o={days:r>0||i>0?", ":"",hours:i>0?", ":""},s=n>0?`${t[tt.Translation.Plural.NumberOfDays](n)}${o.days}`:"",l=r>0?`${t[tt.Translation.Plural.NumberOfHours](r)}${o.hours}`:"",d=i>0?`${t[tt.Translation.Plural.NumberOfMinutes](i)}`:"";return`${s}${l}${d}`}function a1(e,t){const{days:n,hours:r,minutes:i}=tf(e);return n?n>0?`${t[tt.Translation.Plural.NumberOfDays](n)}`:"":r?r>0?`${t[tt.Translation.Plural.NumberOfHours](r)}`:"":i>0?`${t[tt.Translation.Plural.NumberOfMinutes](i)}`:""}function Gu(e){const t=Math.floor(e/600),n=((e-t*600)/10).toFixed(1);if(t===0)return n;const r=`0${n}`.substr(-4);return`${t}:${r}`}function Vu({formatTimestampAsHumanReadable:e,timestamp:t,translations:n}){return{title:e?nf(t,n):void 0,value:e?a1(t,n):Gu(t)}}function Sl(e){var t;return(t=e.commands)!=null&&t.timestamp?parseInt(e.commands.timestamp,10):null}function rf({colorsEnabled:e=!1,el:t,epIconInfoPath:n=du.enPassant,getTimeControl:r,formatTimestampAsHumanReadable:i=!1,moveListDisplayType:o=pr.MoveListDisplayTypes.Text,scrollContainer:s,showResultNode:l=!0,showTimestamps:d=!0,toggleTimestamps:f=!1,translations:h=Pa}){let g=r;const m=ef({colorsEnabled:e,el:t,EPIconInfoPath:n,moveListDisplayType:o,scrollContainer:s,toggleTimestamps:f,translations:h});return m.createList(),{addNode:S,addThreeFoldIcons:Ze,create:m.createList,deselectNode:m.deselectNode,destroy:m.destroyList,enableColors:m.enableColors,loadNodes:D,selectNode:be,setMoveListDisplayType:Ye,setResult:Se,setGetTimeControl:mt,updateNodeColor:m.updateNodeColor,updateTimestamp:zn};function S(Sn){const tn=m.getResult();tn!==ct.Results.None&&m.setResultNode(ct.Results.None),m.addNode(Sn),P(Sn),tn!==ct.Results.None&&m.setResultNode(tn)}function P(Sn){const tn=Sl(Sn);if(!tn||!d)return;const{title:Ct,value:Ft}=Vu({formatTimestampAsHumanReadable:i,timestamp:tn,translations:h});m.addTimestamp({baseTime:I(),node:Sn,timestamp:tn,title:Ct,value:Ft})}function I(){var Sn;return(Sn=g?.())==null?void 0:Sn.baseTime}function D(Sn,tn){const Ct=m.getResult();m.clearList(),Sn.forEach(Ln=>{m.addNode(Ln),P(Ln)}),Ct!==ct.Results.None&&m.setResultNode(Ct);const Ft=tn??m.getLastPly();Ft!==void 0&&m.selectNode(Ft),m.scrollToSelectedNode()}function be(Sn){Sn===void 0?m.deselectNode():typeof Sn=="number"?m.selectNode(Sn):m.selectNodeElement(Sn),m.scrollToSelectedNode()}function Ye(Sn){m.setParams({moveListDisplayType:Sn})}function Se(Sn){if(!l){m.getResult()!==ct.Results.None&&m.setResultNode(ct.Results.None);return}m.setResultNode(Sn)}function Ze(Sn){m.addThreeFoldMoveIcons(Sn)}function mt(Sn){g=Sn}function zn(Sn){const{ply:tn}=Sn,Ct=Sl(Sn);if(!tn)return;if(Ct===null)return m.removeTimestamp(tn);const{title:Ft,value:Ln}=Vu({formatTimestampAsHumanReadable:i,timestamp:Ct,translations:h}),Zn=m.getTimestamp(tn);Zn?Zn!==Ct&&m.setTimestampValue({baseTime:I(),ply:tn,timestamp:Ct,value:Ln}):m.addTimestamp({baseTime:I(),node:Sn,timestamp:Ct,title:Ft,value:Ln})}}var co;(function(e){(function(t){t.AddMove="AddMove",t.AnalysisEnd="AnalysisEnd",t.AnalysisStart="AnalysisStart"})(e.APIEvents||(e.APIEvents={})),function(t){t.Name="observing"}(e.Plugin||(e.Plugin={}))})(co||(co={}));function fo(e){return e?.ids!==void 0}function of({colorsEnabled:e=!1,displayTimeInClockFormat:t=!0,el:n,emitter:r=(0,w.H)(),formatTimestampAsHumanReadable:i=!t,loadLineOnCreate:o=!0,namespace:s=Fr.Plugin.Name,scrollContainer:l,showResultNode:d=!0,showTimestamps:f=!0,toggleTimestamps:h=!1,translations:g=Pa}){let m=!0,S;const P=Yd(),I=Zt(!1),D=rf({el:n,formatTimestampAsHumanReadable:i,getTimeControl:()=>null,scrollContainer:l||n,showResultNode:d,showTimestamps:f,toggleTimestamps:h,translations:g}),be=Xd(D);return{api:tn=>Ce(ge({activate:()=>{zn(!0),mt(Vr(M.APIEvents.Load),tn.api)},deactivate:()=>zn(!1)},r),{getMoveList:()=>D,isActive:()=>!!m,isReady:()=>P.isReady(),waitForVMLReady:P.waitForReady}),create:Ye,destroy:Se,match:[{condition:Sn,handler:(tn,Ct)=>mt(tn,Ct.api)},{condition:Je(M.OptionsEvents.Update),handler:tn=>{"enabled"in tn.data&&zn(tn.data.enabled)}}],name:s};function Ye(tn){var Ct;const{api:Ft}=tn;if(D.setGetTimeControl(Ft.timeControl.get),D.create(),S=Ze(Ft),e&&D.enableColors(e),o){const Ln=Ft.getLine(0),Zn=(Ct=Ft.getSelectedNode())==null?void 0:Ct.ply,br=Ft.getOptions().moveListDisplayType;br===pr.MoveListDisplayTypes.Figurine&&D.setMoveListDisplayType(br),Ln?.length&&D.loadNodes(Ln,Zn),d&&(D.setResult(Ft.getResult()),Ft.getContext().game.inThreefoldRepetition()&&D.addThreeFoldIcons(Ln))}P.ready(D),r.emit(Fr.Events.Ready,D),m=Ft.getOptions().enabled}function Se(){S?.(),D&&D.destroy()}function Ze(tn){return n.addEventListener(Sr.Events.SelectNode,Ct),function(){n.removeEventListener(Sr.Events.SelectNode,Ct)};function Ct({detail:Ft}){if(!m)return;const{ids:Ln}=Ft;tn.selectNode(Ln.line,Ln.move)}}function mt(tn,Ct){var Ft;const Ln=Ct.getRelativeNode();I.add(be,{context:Ct.getContext(),event:tn,line:(Ft=Ct.getLine)==null?void 0:Ft.call(Ct,0),selectedNode:fo(Ln)?Ln:void 0,queue:I}),requestAnimationFrame(()=>{requestAnimationFrame(function(){I.flush(),r.emit(Fr.Events.Updated,D)})})}function zn(tn){m=tn}function Sn(tn){return m&&xt([...Yi,co.APIEvents.AddMove,M.APIEvents.LineUpdated,M.APIEvents.NodeUpdated,M.APIEvents.DeletePosition,M.APIEvents.UpdatePGNHeaders,M.InstanceEvents.Create,M.InstanceEvents.ModeChanged,M.OptionsEvents.Update])(tn)}}var xr;(function(e){(function(t){t.GameResult="game-result",t.Moves="moves"})(e.Placeholders||(e.Placeholders={})),function(t){t.Component="horizontal-move-list",t.MainLine="main",t.Variation="variation"}(e.ClassNames||(e.ClassNames={})),e.ComponentIdentifier="data-id",function(t){t.Copy="copy",t.UpdateNodeLimit="UpdateNodeLimit"}(e.Events||(e.Events={})),function(t){t.Before="(",t.After=")"}(e.VariationParenthesis||(e.VariationParenthesis={})),function(t){t.Begin="begin",t.Focus="focus",t.End="end"}(e.NodeLimitTypes||(e.NodeLimitTypes={}))})(xr||(xr={}));var xi;(function(e){e.EndOfLineSelected="EndOfLineSelected",e.MiddleOfLineSelected="MiddleOfLineSelected",e.StartingPosition="StartingPosition"})(xi||(xi={}));function Ma(e){return e.id!==void 0}function zu(e,t){return!e||Ma(e)?xi.StartingPosition:e.ids.move===Object.keys(t[e.ids.line]).length-1?xi.EndOfLineSelected:xi.MiddleOfLineSelected}function Cl({node:e,lines:t}){return zu(e,t)}function ju(){return{[M.APIEvents.SelectNode]:Cl,[M.APIEvents.Move]:function({component:t,event:n}){const{api:r,dom:i}=t;return r.getMoveNode({line:n.ids.line,move:n.ids.move})?(r.selectNode({line:n.ids.line,move:n.ids.move}),xi.MiddleOfLineSelected):n.ids.line!==0?(i.insertVariation({node:n}),xi.EndOfLineSelected):(i.insertNode({node:n}),xi.EndOfLineSelected)}}}function af(){return{[M.APIEvents.SelectNode]:Cl,[M.APIEvents.Move]:function({component:t,event:n}){const{api:r,dom:i}=t;return i.insertNode({node:n,nodeToInsertAfter:r.getSelectedNode()}),xi.EndOfLineSelected}}}function s1(){return{[M.APIEvents.SelectNode]:Cl,[M.APIEvents.Move]:function({component:t,event:n}){const{api:r,dom:i}=t;return r.getMoveNode({line:n.ids.line,move:n.ids.move})?(r.selectNode({line:n.ids.line,move:n.ids.move}),xi.MiddleOfLineSelected):(i.insertVariation({node:n}),xi.EndOfLineSelected)}}}function l1(){return{initialState:xi.StartingPosition,states:{[xi.StartingPosition]:ju(),[xi.EndOfLineSelected]:af(),[xi.MiddleOfLineSelected]:s1()}}}function u1(){return(0,w.c)(l1())}function sf(e,t){const n=e.find(r=>r[0](t));if(n)return n[1](t)}const c1={condition:lf,handler:d1};function lf({event:e}){return function(){return e.type===M.APIEvents.AddMove}}function d1({context:e,event:t}){const{moveList:n}=e,{listMove:r}=t.data;if(!r?.ids)return;const i=n.api.getMoveNode({line:0,move:r.ids.move-1});n.dom.insertNode({node:r,nodeToInsertAfter:i})}const f1={condition:uf,handler:h1};function uf({event:e}){return function(){return e.type===M.APIEvents.CreateContinuation}}function h1({context:e,event:t,selectedNode:n}){const{moveList:r,methods:{selectCurrentPosition:i}}=e;if(r.dom.insertVariation({node:t.data.node}),r.api.getMoveNode(t.data.node.ids)){r.api.selectNode(t.data.node.ids);return}i(n)}const p1={condition:m1,handler:v1};function m1({event:e}){return function(){return M.APIEvents.UpdatePGNHeaders===e.type&&e.data.Result}}function v1({context:e,coreContext:t}){const{moveList:n}=e;n.dom.setResultNode(t.api.getResult())}var Kr;(function(e){(function(t){t.FocusOut="comment-field-focus-out",t.CommentChanged="comment-has-changed"})(e.Events||(e.Events={})),function(t){t.Component="editable-comment"}(e.Classes||(e.Classes={})),function(t){t[t.CommentUpdateDelay=500]="CommentUpdateDelay"}(e.Constants||(e.Constants={}))})(Kr||(Kr={}));function kl(e){return!!e.getElement().querySelector((0,w.I)(Kr.Classes.Component))}const g1={condition:_1,handler:Ls};function _1({event:e}){return function(){return e.type===M.APIEvents.LineCommentUpdated}}function Ls({context:e,event:t}){const{moveList:n}=e,{data:r}=t;kl(n.dom)||n.dom.updateLineComponent(r.lineId,{initComment:r.comment})}const fr={condition:b1,handler:cf};function b1({event:e}){return function(){return[M.APIEvents.CreateGame,M.APIEvents.CreateContinuation,M.APIEvents.DeletePosition,M.APIEvents.Load,M.APIEvents.MoveVariation,M.APIEvents.PromoteVariation,M.APIEvents.ResetToMainLine].includes(e.type)||e.data.linesReordered}}function cf({context:e,coreContext:t}){const{moveList:n,methods:{destroyContextMenu:r},queue:i}=e,{api:o}=t;r(),i.flush(),n.dom.load(),n.dom.setResultNode(o.getResult())}const y1={condition:E1,handler:xa};function E1({event:e}){return function(){return e.type===M.APIEvents.Move}}function xa({context:e,event:t,selectedNode:n}){const{moveList:r,stateMachine:i,methods:{selectCurrentPosition:o}}=e;if(r.api.getMoveNode(t.data.move.ids)){r.api.selectNode(t.data.move.ids);return}i.transition(M.APIEvents.Move,{component:r,event:t.data.move,selectedNode:n}),o(n)}const A1={condition:w1,handler:ho};function w1({event:e}){return function(){return e.type===M.APIEvents.NodeUpdated}}function ho({context:e,event:t}){const{moveList:n}=e,{data:r}=t;kl(n.dom)||r.ids&&n.dom.updateMoveNodeComponent(r.ids,r.changes)}const df={condition:ff,handler:qu};function ff({event:e}){return function(){return[M.APIEvents.ResetToMainLine].includes(e.type)}}function qu({context:e}){const{moveList:t}=e;t.dom.load()}const S1={condition:C1,handler:k1};function C1({event:e}){return function(){return e.type===M.OptionsEvents.Update}}function k1({coreContext:e,context:t,event:n}){const{el:r,moveList:i,methods:{destroyContextMenu:o}}=t,s=e.api.getOptions();i.api.setOptions(n.data),s.test&&Te(r,{[Ne.Editable]:n.data.moveListContextMenuEnabled}),n.data.moveListContextMenuEnabled===!1&&o()}const P1={condition:T1,handler:M1};function T1({event:e}){return function(){return e.type===M.APIEvents.MoveForward||e.type===M.APIEvents.MoveBackward||e.type===M.APIEvents.SelectLineEnd||e.type===M.APIEvents.SelectLineStart||e.type===M.APIEvents.SelectNode||e.type===M.APIEvents.ResetToMainLine}}function M1({context:e,selectedNode:t}){const{methods:{selectCurrentPosition:n}}=e;n(t)}var lv=`@charset "UTF-8";
.horizontal-move-list .icon-font-chess:before,
.vertical-move-list .icon-font-chess:before {
  pointer-events: none;
}
.horizontal-move-list .icon-font-chess.knight-black:before,
.vertical-move-list .icon-font-chess.knight-black:before {
  content: "\xC7";
}
.horizontal-move-list .icon-font-chess.knight-white:before,
.vertical-move-list .icon-font-chess.knight-white:before {
  content: "\u0116";
}
.horizontal-move-list .icon-font-chess.bishop-black:before,
.vertical-move-list .icon-font-chess.bishop-black:before {
  content: "\u0102";
}
.horizontal-move-list .icon-font-chess.bishop-white:before,
.vertical-move-list .icon-font-chess.bishop-white:before {
  content: "\xC4";
}
.horizontal-move-list .icon-font-chess.queen-black:before,
.vertical-move-list .icon-font-chess.queen-black:before {
  content: "\u012E";
}
.horizontal-move-list .icon-font-chess.queen-white:before,
.vertical-move-list .icon-font-chess.queen-white:before {
  content: "\u0136";
}
.horizontal-move-list .icon-font-chess.king-black:before,
.vertical-move-list .icon-font-chess.king-black:before {
  content: "\u0100";
}
.horizontal-move-list .icon-font-chess.king-white:before,
.vertical-move-list .icon-font-chess.king-white:before {
  content: "\u0104";
}
.horizontal-move-list .icon-font-chess.rook-black:before,
.vertical-move-list .icon-font-chess.rook-black:before {
  content: "\u013D";
}
.horizontal-move-list .icon-font-chess.rook-white:before,
.vertical-move-list .icon-font-chess.rook-white:before {
  content: "\u013B";
}
.dark-mode .horizontal-move-list .icon-font-chess.knight-black:before,
.dark-mode .vertical-move-list .icon-font-chess.knight-black:before {
  content: "\u0116";
}
.dark-mode .horizontal-move-list .icon-font-chess.knight-white:before,
.dark-mode .vertical-move-list .icon-font-chess.knight-white:before {
  content: "\xC7";
}
.dark-mode .horizontal-move-list .icon-font-chess.bishop-black:before,
.dark-mode .vertical-move-list .icon-font-chess.bishop-black:before {
  content: "\xC4";
}
.dark-mode .horizontal-move-list .icon-font-chess.bishop-white:before,
.dark-mode .vertical-move-list .icon-font-chess.bishop-white:before {
  content: "\u0102";
}
.dark-mode .horizontal-move-list .icon-font-chess.queen-black:before,
.dark-mode .vertical-move-list .icon-font-chess.queen-black:before {
  content: "\u0136";
}
.dark-mode .horizontal-move-list .icon-font-chess.queen-white:before,
.dark-mode .vertical-move-list .icon-font-chess.queen-white:before {
  content: "\u012E";
}
.dark-mode .horizontal-move-list .icon-font-chess.king-black:before,
.dark-mode .vertical-move-list .icon-font-chess.king-black:before {
  content: "\u0104";
}
.dark-mode .horizontal-move-list .icon-font-chess.king-white:before,
.dark-mode .vertical-move-list .icon-font-chess.king-white:before {
  content: "\u0100";
}
.dark-mode .horizontal-move-list .icon-font-chess.rook-black:before,
.dark-mode .vertical-move-list .icon-font-chess.rook-black:before {
  content: "\u013B";
}
.dark-mode .horizontal-move-list .icon-font-chess.rook-white:before,
.dark-mode .vertical-move-list .icon-font-chess.rook-white:before {
  content: "\u013D";
}
.horizontal-move-list {
  display: block;
  font-size: 1.3rem;
  min-width: 223px;
  overflow-x: hidden;
  overflow-y: auto;
  padding: 10px 15px;
}
.horizontal-move-list .comment {
  color: #0381b8;
}
.horizontal-move-list .comment body.dark-mode, body.dark-mode .horizontal-move-list .comment {
  color: #52b1dc;
}
.horizontal-move-list .game-result-node {
  color: var(--nodeColor);
  margin-left: 5px;
}
.horizontal-move-list .diagram-begin, .horizontal-move-list .diagram-end {
  padding-left: 3px;
}
.variation.main {
  background-color: #f1f1f1;
  display: block;
  margin: 7px -15px;
  padding: 7px 15px;
}
.variation.main body.dark-mode, body.dark-mode .variation.main {
  background-color: rgba(0, 0, 0, 0.1);
}
.variation.main + .move-node .move-number {
  /**
   * To prevent !important usage and extra DOM modification,
   * this rule should contain indent opposite to the
   * \`.move-number\` \`margin-left\` value
   */
  display: inline-block;
  text-indent: -4px;
}
.variation .variation {
  margin-left: 4px;
}
.variation:before {
  color: rgba(0, 0, 0, 0.7);
  content: "(";
}
.variation:after {
  color: rgba(0, 0, 0, 0.7);
  content: ")";
  position: relative;
  z-index: 2;
}
.variation body.dark-mode:before, .variation body.dark-mode:after, body.dark-mode .variation:before, body.dark-mode .variation:after {
  color: rgba(255, 255, 255, 0.5);
}`,An;(function(e){(function(t){t.ClearAnalysis="ClearAnalysis",t.DeleteComment="DeleteComment",t.DeleteCommentBefore="DeleteCommentBefore",t.DeleteMove="DeleteMove",t.DeleteVariation="DeleteVariation",t.InsertComment="InsertComment",t.InsertCommentBefore="InsertCommentBefore",t.InsertContinuation="InsertContinuation",t.MoveVariationDown="MoveVariationDown",t.MoveVariationUp="MoveVariationUp",t.PromoteVariation="PromoteVariation",t.RemoveAnnotation="RemoveAnnotation",t.RemoveBegin="RemoveBegin",t.RemoveEnd="RemoveEnd",t.RemoveAdditionalAnnotation="RemoveAdditionalAnnotation",t.RemoveFocus="RemoveFocus",t.SetBegin="SetBegin",t.SetEnd="SetEnd",t.SetFocus="SetFocus"})(e.Actions||(e.Actions={})),function(t){t.AddAnnotation="AddAnnotation",t.AddAdditionalAnnotation="AddAdditionalAnnotation"}(e.AnnotationActions||(e.AnnotationActions={})),function(t){t.Actions="actions",t.Translations="translations"}(e.Keys||(e.Keys={})),function(t){t.ActionClicked="action-clicked",t.AnnotationClicked="annotation-clicked",t.Close="close-context-menu"}(e.Events||(e.Events={})),function(t){t.Name="contextMenu"}(e.Plugin||(e.Plugin={}))})(An||(An={}));var sa;(function(e){(function(t){t.ActionName="action-name",t.Annotation="annotation",t.AnnotationsContainer="annotations-container",t.Component="move-node-context-menu",t.Divider="divider"})(e.Classes||(e.Classes={}))})(sa||(sa={}));var ii;(function(e){(function(t){t.Annotation="annotation",t.CustomColor="customColor",t.id="id",t.MoveNumber="moveNumber",t.San="san",t.Selected="selected"})(e.Keys||(e.Keys={})),function(t){t.Annotation="annotation",t.CustomColor="customColor",t.MoveNumber="moveNumber",t.San="san"}(e.TouchableKeys||(e.TouchableKeys={}))})(ii||(ii={}));var oi;(function(e){(function(t){t.Comment="comment",t.GameResultNode="game-result-node",t.IconFont="icon-font-chess",t.MoveNode="move-node",t.MoveNumber="move-number",t.MoveText="move-text",t.Selected="selected",t.StaticComment="static-comment"})(e.Classes||(e.Classes={})),function(t){t[t.TouchDelay=500]="TouchDelay"}(e.Constants||(e.Constants={})),function(t){t.Click="click",t.OpenContextMenu="contextmenu"}(e.Events||(e.Events={}))})(oi||(oi={}));class hi extends Error{constructor({code:t,message:n,data:r}){super(n),this.code=t,this.data=r,this.message=n,this.name="ChessError"}}var ai;(function(e){e.BadData="Bad Data",e.BeforeStateHooksConflict="Before State hooks conflict",e.DOMDoesNotMatchJCE="DOM Does Not Match JCE",e.ElementAlreadyExists="Element Already Exists",e.ElementNotFound="Element Not Found",e.IllegalJCECall="Illegal JCE Call",e.IncorrectMode="Incorrect Mode",e.InvalidStateMachine="Invalid State Machine",e.MissingPluginDependency="Missing Plugin Dependency"})(ai||(ai={}));function x1(){return{action:An.Actions.ClearAnalysis,handler:e,isVisible(){return!0},name:tt.Translation.Actions.ClearAllAnalysis};function e(t,{context:{game:n},event:r,moveList:i}){n.hml.contextMenu.requestConfirmation({action:o,data:{event:r},text:"Are you sure you want to clear all analysis?",type:An.Actions.ClearAnalysis});function o(){const s=Object.keys(i.api.getNodes()),l=n.getLine(0);if(!l)return;const d={};if(s.length>1)for(let f=s.length-1;f>0;f--){const h=n.getLine(f);if(!h)return;i.dom.removeLine(h),h.parentId===0&&(d[h.atMoveNode]=!0)}Object.keys(i.api.getComments()).forEach(f=>{i.api.getComments()[f].destroy()}),n.resetToMainLine(),l.forEach(f=>{var h,g;const m=[];let S=!1;if(d[f.ids.move]&&m.push(ii.TouchableKeys.MoveNumber),(f.annotation||f.additionalAnnotation)&&m.push(ii.TouchableKeys.Annotation),f.comment&&f.color===ct.ColorsAsNumbers.White&&(S=!0),n.updateNode(f.ids,{additionalAnnotation:void 0,annotation:"",comment:void 0}),(h=t.commands)==null||delete h.href,(g=t.commands)==null||delete g.text,Object.keys(m).length>0||S){const P=i.api.getMoveNode(f.ids);if(!P)throw new hi({code:ai.ElementNotFound,data:t,message:"No move node found."});m.forEach(I=>{P.touch(I)}),P.touchNextNode()}}),l.initComment&&n.updateLineComment(void 0,l.id)}}}function I1(){return{action:An.Actions.DeleteComment,handler:t,isVisible:e,name:tt.Translation.Actions.DeleteCommentAfter};function e({node:n}){return typeof n.comment=="string"}function t(n,{context:{game:r},moveList:i,moveNodeComponent:o}){r.updateNode(n.ids,{comment:void 0}),i.dom.removeComment(n),o.touchNextNode()}}function R1(){return{action:An.Actions.DeleteCommentBefore,handler:t,isVisible:e,name:tt.Translation.Actions.DeleteCommentBefore};function e({api:n,node:r}){if(r.ids.move===0){const o=n.getLine(r.ids.line);return!!(o&&o.initComment)}const i=n.getNodeByIds(r.previous);return fo(i)&&!!i.comment}function t(n,{context:{game:r},moveList:i,moveNodeComponent:o}){let s=n;const l=r.getLine(n.ids.line);l&&n.ids.move===0?(s=l,r.updateLineComment(void 0,l.id)):(s=r.getNodeByIds(n.previous),r.updateNode(s.ids,{comment:void 0}),o.touch(ii.TouchableKeys.MoveNumber)),i.dom.removeComment(s)}}function O1(){return{action:An.Actions.DeleteMove,handler:t,isVisible:e,name:tt.Translation.Actions.DeleteMove};function e({api:n,node:r}){return r.ids.line===0?n.getMode().getOptions().canModifyExistingMovesOnMainLine:!0}function t(n,{context:{game:r}}){r.deletePosition(n.ids.move,n.ids.line)}}function hf(){return{action:An.Actions.DeleteVariation,handler:t,isVisible:e,name:tt.Translation.Actions.DeleteLine};function e({node:n}){return n.ids.line!==0}function t(n,{context:{game:r},moveList:i}){r.deletePosition(-1,n.ids.line),i.dom.load()}}function pf(){return{action:An.Actions.InsertComment,handler:t,isVisible:e,name:tt.Translation.Actions.InsertCommentAfter};function e({node:n}){return typeof n.comment>"u"}function t(n,{moveList:r}){r.dom.insertEditableComment(n)}}function N1(){return{action:An.Actions.InsertCommentBefore,handler:t,isVisible:e,name:tt.Translation.Actions.InsertCommentBefore};function e({api:n,node:r}){if(r.ids.move===0){const o=n.getLine(r.ids.line);return!o||!o.initComment}const i=n.getNodeByIds(r.previous);return fo(i)&&!i.comment}function t(n,{moveList:r,context:i}){const{game:o}=i;let s=n;const l=o.getLine(n.ids.line);n.ids.move===0&&l?s=l:s=o.getNodeByIds(n.previous),r.dom.insertEditableComment(s)}}function Pl(){return{action:An.Actions.InsertContinuation,handler:t,isVisible:e,name:tt.Translation.Actions.InsertContinuation};function e({api:n,node:r}){const i=n.getRawLines();return r.ids.move===i[r.ids.line].length-1}function t(n,{context:{game:r}}){r.createContinuation()}}function mf(e,t){return t.lines?e.ids.line===t.lines[0]:!1}function Wu(){return{action:An.Actions.MoveVariationUp,handler:t,isVisible:e,name:tt.Translation.Actions.MoveVariationUp};function e({api:n,node:r}){if(r.ids.line===0)return!1;const i=n.getLine(r.ids.line);if(!i)return!1;const o=n.getNodeByIds({line:i.parentId,move:i.atMoveNode});return o&&o.lines&&o.lines.length>1?!mf(r,o):!1}function t(n,{context:{game:r}}){r.moveVariation(n.ids.line,!0)}}function Tl(e,t){return t.lines?e.ids.line===t.lines[t.lines.length-1]:!1}function vf(){return{action:An.Actions.MoveVariationDown,handler:t,isVisible:e,name:tt.Translation.Actions.MoveVariationDown};function e({api:n,node:r}){if(r.ids.line===0)return!1;const i=n.getLine(r.ids.line);if(!i)return!1;const o=n.getNodeByIds({line:i.parentId,move:i.atMoveNode});return o&&o.lines&&o.lines.length>1?!Tl(r,o):!1}function t(n,{context:{game:r}}){r.moveVariation(n.ids.line,!1)}}var Ml;(function(e){e[e.MainLine=0]="MainLine",e[e.MainLineChild=-1]="MainLineChild",e[e.Parent=1]="Parent"})(Ml||(Ml={}));function gf(){return{action:An.Actions.PromoteVariation,handler:t,isVisible:e,name:tt.Translation.Actions.Promote};function e({api:n,node:r}){const i=r.ids.line;if(i===0)return!1;const o=n.getLine(i);if(!o)return!1;if(o.parentId===0){const{canAddMovesToMainLine:l,canModifyExistingMovesOnMainLine:d}=n.getMode().getOptions();return l&&d}return!0}function t(n,{context:{game:r}}){r.promoteVariation(n.ids.line,Ml.Parent)}}function _f(){return{action:An.Actions.RemoveAnnotation,handler:t,isVisible:e,name:tt.Translation.Actions.RemoveAnnotation};function e({node:n}){return!!n.annotation}function t(n,{context:{game:r},moveNodeComponent:i}){r.updateNode(n.ids,{annotation:void 0}),i.touch(ii.TouchableKeys.Annotation)}}function xl(){return{action:An.Actions.RemoveAdditionalAnnotation,handler:t,isVisible:e,name:tt.Translation.Actions.RemoveEvaluationAnnotation};function e({node:n}){return!!(n.additionalAnnotation&&n.additionalAnnotation.length>0)}function t(n,{context:{game:r},moveNodeComponent:i}){r.updateNode(n.ids,{additionalAnnotation:void 0}),i.touch(ii.TouchableKeys.Annotation)}}const bf={[An.Actions.InsertCommentBefore]:N1(),[An.Actions.InsertComment]:pf(),[An.Actions.DeleteCommentBefore]:R1(),[An.Actions.DeleteComment]:I1(),[An.Actions.RemoveAnnotation]:_f(),[An.Actions.RemoveAdditionalAnnotation]:xl(),[An.Actions.DeleteVariation]:hf(),[An.Actions.DeleteMove]:O1(),[An.Actions.PromoteVariation]:gf(),[An.Actions.MoveVariationDown]:vf(),[An.Actions.MoveVariationUp]:Wu(),[An.Actions.InsertContinuation]:Pl(),[An.Actions.ClearAnalysis]:x1()};function L1(e){return function(n){Object.keys(n).forEach(r=>{e.contextMenuActions[r]=n[r]})}}function yf(e){const t=new Map;let n=e;return{cancelConfirmation:r,cancelAllConfirmations:i,confirmAction:o,registerConfirmationCallback:s,requestConfirmation:l};function r(d){t.delete(d)}function i(){t.clear()}function o(d){var f;(f=t.get(d))==null||f(),t.delete(d)}function s(d){n=d}async function l(d){const{action:f,data:h,text:g,type:m}=d;if(t.set(m,f),n)return await n({data:h,text:g,type:m})?o(m):r(m);if(window.confirm(g))return o(m);r(m)}}function D1(e){return yf(e)}function B1(e){return{api:()=>D1(e),destroy:t,name:An.Plugin.Name};function t(n){n&&n.game.hml.contextMenu.cancelAllConfirmations()}}function Ef(e){return function(n){const{contextMenuActions:r,game:i}=e,o=i.getNodeByIds(n);if(!fo(o))throw new hi({code:ai.BadData,data:n,message:"No move node found"});const s=[];return Object.values(r).forEach(l=>{if(!l)return;l.isVisible({api:i,node:o,options:i.getOptions(),state:e.state})&&s.push(l)}),s}}function Af(e){return function({line:n,move:r}){const{state:i}=e;return i.nodes[n]&&e.state.nodes[n][r]}}function wf(e){return function(){const{state:n}=e;n.selectedNode&&(n.selectedNode.set({[ii.Keys.Selected]:!1}),n.selectedNode=void 0)}}function Ku(e){return function(n){const{api:r,stateMachine:i}=e;r.resetSelectedNode(),i.transition(M.APIEvents.SelectNode,{lines:r.getNodes(),node:n}),e.scrollContainer.scrollTop=0}}function Ds({containerEl:e,moveNode:t,moveListEl:n}){let r;try{r=t.getElement()}catch{}r&&Hu({containerEl:e,moveListEl:n,nodeEl:r})}function No(e,t){return t.querySelector(`[${xr.ComponentIdentifier}="line-${e}"]`)}function Il(e,t=[]){requestAnimationFrame(()=>{requestAnimationFrame(()=>{e(...t)})})}function $u(e){return function({line:n,move:r}){const{api:i,el:o,scrollContainer:s,state:l,stateMachine:d}=e;if(typeof n>"u"||typeof r>"u")return;i.resetSelectedNode();const f=i.getMoveNode({line:n,move:r});f&&(f.set({[ii.Keys.Selected]:!0}),l.selectedNode=f,d.transition(M.APIEvents.SelectNode,{lines:i.getNodes(),node:l.selectedNode.getNodeData()}),Il(()=>{!o.classList.contains(xr.ClassNames.Component)||f.ids.line!==0&&!No(f.ids.line,o)||Ds({containerEl:s,moveListEl:o,moveNode:f})}))}}function Rl(e,t){Object.keys(e).forEach(n=>{(Object.keys(e[n])||[]).forEach(r=>{t(e[n][r])})})}function Zu(e){const t=e.api.getNodes();Rl(t,function(r){r.touch(ii.TouchableKeys.San)})}function Sf(e){const t=e.state.comments;Object.keys(t).forEach(n=>{t[n][e.options.moveListContextMenuEnabled?"registerClickListeners":"deregisterClickListeners"]()})}function Cf(e){const t={moveListContextMenuEnabled:Sf,moveListDisplayType:Zu};return function(r){Object.keys(e.options).forEach(i=>{if(!(i in r))return;const o=e.options[i]!==r[i];e.options[i]=r[i],o&&t[i]&&t[i](e)})}}function Ol(e){return{getComments:()=>e.state.comments,getContext:()=>e,getContextMenuActions:Ef(e),getMoveNode:Af(e),getNodes:()=>e.state.nodes,getOptions:()=>e.options,getSelectedNode:()=>e.state.selectedNode,resetSelectedNode:wf(e),selectLineStart:Ku(e),selectNode:$u(e),setOptions:Cf(e)}}var uv=':root{--nodeBackground:#fff35f;--nodeBorder:rgba(0, 0, 0, 0.05);--nodeColor:#262421;--nodeColorSelected:#262421;--nodeNumber:rgba(0, 0, 0, 0.7)}.dark-mode{--nodeNumber:rgba(255, 255, 255, 0.5);--nodeColor:rgba(255, 255, 255, 0.72);--nodeBackground:rgba(255, 255, 0, 0.2);--nodeBorder:rgba(255, 255, 0, 0.4);--nodeColorSelected:#fff}.move-node.svelte-66vnx0.svelte-66vnx0{cursor:pointer;line-height:2rem;padding:0;position:relative;z-index:1}.move-node.selected.customColor.svelte-66vnx0 .move-text.svelte-66vnx0{color:#fff}.move-node.selected.svelte-66vnx0 .move-text.svelte-66vnx0{color:var(--nodeCustomColor, var(--nodeColorSelected));position:relative;z-index:1}.move-node.selected.svelte-66vnx0 .move-text.svelte-66vnx0:before{background-color:var(--nodeBackground);border-bottom-style:solid;border-bottom-width:3px;border-color:var(--nodeBorder);border-radius:2px;background-color:var(--nodeCustomColor, var(--nodeBackground));border-width:0 0 3px 0;content:"";height:100%;left:0;margin-left:-2px;position:absolute;top:0;width:calc(100% + 4px);z-index:-1}.move-node.svelte-66vnx0 .hidden.svelte-66vnx0{display:none}.move-node.svelte-66vnx0 .move-number.svelte-66vnx0{color:var(--nodeNumber)}.move-node.svelte-66vnx0 .move-text.svelte-66vnx0{font-weight:700;color:var(--nodeCustomColor, var(--nodeColor));display:inline-block;white-space:pre}.move-node.svelte-66vnx0:not(:first-of-type) .move-number.svelte-66vnx0{margin-left:4px}.move-node.svelte-66vnx0 .move-text .icon-font-chess{display:inline-block;font-size:2.3rem;margin-right:0.2rem;margin-top:-1.3rem}.move-node.svelte-66vnx0 .comment.svelte-66vnx0{cursor:pointer;font-weight:400;margin-left:5px;outline:none;white-space:normal}.move-node.svelte-66vnx0 .comment.svelte-66vnx0:first-child{margin-left:0}';function kf(e){let t,n,r;return{c(){t=(0,w.d)("span"),n=(0,w.t)(e[2]),(0,w.h)(t,"class",r=(0,w.J)(oi.Classes.MoveNumber)+" svelte-66vnx0")},m(i,o){(0,w.j)(i,t,o),(0,w.A)(t,n)},p(i,o){o&4&&(0,w.r)(n,i[2])},d(i){i&&(0,w.m)(t)}}}function F1(e){let t,n,r,i,o,s,l=(e[4]||"")+"",d,f,h=e[2]&&kf(e);return{c(){t=(0,w.d)("span"),h&&h.c(),n=(0,w.u)(),r=(0,w.d)("span"),i=new w.N,o=(0,w.n)(),s=new w.N,i.a=o,s.a=null,(0,w.h)(r,"class",(0,w.J)(oi.Classes.MoveText)+" svelte-66vnx0"),(0,w.h)(t,"data-id",e[1]),(0,w.h)(t,"class",(0,w.J)(oi.Classes.MoveNode)+" svelte-66vnx0"),(0,w.K)(t,"customColor",e[0]),(0,w.K)(t,"selected",e[5])},m(g,m){(0,w.j)(g,t,m),h&&h.m(t,null),(0,w.A)(t,n),(0,w.A)(t,r),i.m(e[3],r),(0,w.A)(r,o),s.m(l,r),d||(f=[(0,w.k)(t,"click",e[7]),(0,w.k)(t,"contextmenu",e[6]),(0,w.k)(t,"touchstart",e[8]),(0,w.k)(t,"touchend",e[9],{passive:!0})],d=!0)},p(g,[m]){g[2]?h?h.p(g,m):(h=kf(g),h.c(),h.m(t,n)):h&&(h.d(1),h=null),m&8&&i.p(g[3]),m&16&&l!==(l=(g[4]||"")+"")&&s.p(l),m&2&&(0,w.h)(t,"data-id",g[1]),m&1&&(0,w.K)(t,"customColor",g[0]),m&32&&(0,w.K)(t,"selected",g[5])},i:w.o,o:w.o,d(g){g&&(0,w.m)(t),h&&h.d(),d=!1,(0,w.L)(f)}}}function U1(e,t,n){const r=(0,w.M)();let i,{customColor:o}=t,{id:s}=t,{moveListEl:l}=t,{moveNumber:d}=t,{san:f}=t,{annotation:h}=t,{selected:g}=t;function m(be){be.preventDefault(),r(oi.Events.OpenContextMenu)}function S(be){r(oi.Events.Click)}function P(be){S(),i=setTimeout(()=>{m(be),i=null},oi.Constants.TouchDelay)}function I(){i&&clearTimeout(i)}function D(be){const Ye=l.querySelector(`[${xr.ComponentIdentifier}="${s}"]`);Ye&&Xn(Ye,be)}return e.$$set=be=>{"customColor"in be&&n(0,o=be.customColor),"id"in be&&n(1,s=be.id),"moveListEl"in be&&n(10,l=be.moveListEl),"moveNumber"in be&&n(2,d=be.moveNumber),"san"in be&&n(3,f=be.san),"annotation"in be&&n(4,h=be.annotation),"selected"in be&&n(5,g=be.selected)},e.$$.update=()=>{e.$$.dirty&1&&D(o)},[o,s,d,f,h,g,m,S,P,I,l]}class H1 extends w.a{constructor(t){super(),(0,w.i)(this,t,U1,F1,w.b,{customColor:0,id:1,moveListEl:10,moveNumber:2,san:3,annotation:4,selected:5})}}function G1(e,{anchor:t,props:n}){return ns({ComponentType:H1,options:{anchor:t,props:n,target:e},replaceContainer:!1})}function Pf(e){return!!(e&&e.charAt(0)==="$")}const Yr={$1:"!",$2:"?",$3:"!!",$4:"??",$5:"!?",$6:"?!",$9:"\u2612",$10:"=",$11:"=",$12:"=",$13:"\u221E",$14:"\u2A72",$15:"\u2A71",$16:"\xB1",$17:"\u2213",$18:"+-",$19:"-+",$22:"\u2A00",$23:"\u2A00",$32:"\u27F3",$33:"\u27F3",$36:"\u2192",$37:"\u2192",$40:"\u2191",$41:"\u2191",$44:"\u221E/=",$45:"=/\u221E",$132:"\u21C6",$133:"\u21C6",$146:"N",$256:"=/\u221E"},Bs={"??":"?\\?","!?":"!\\?","-+":"-\\+","\u221E/=":"\u221E\\/\\=","=/\u221E":"=\\/\\\u221E","=":"s=",N:"N\\b"},Fs=["!","?","!!","??","!?","?!","="],Nl=(0,w.O)(Yr),Yu=[{action:An.AnnotationActions.AddAnnotation,code:zr.Nags.$1,display:Yr.$1,meaning:tt.Translation.Annotations.GoodMove},{action:An.AnnotationActions.AddAnnotation,code:zr.Nags.$2,display:Yr.$2,meaning:tt.Translation.Annotations.BadMove},{action:An.AnnotationActions.AddAnnotation,code:zr.Nags.$3,display:Yr.$3,meaning:tt.Translation.Annotations.ExcellentMove},{action:An.AnnotationActions.AddAnnotation,code:zr.Nags.$4,display:Yr.$4,meaning:tt.Translation.Annotations.Blunder},{action:An.AnnotationActions.AddAnnotation,code:zr.Nags.$5,display:Yr.$5,meaning:tt.Translation.Annotations.SpeculativeMove},{action:An.AnnotationActions.AddAnnotation,code:zr.Nags.$6,display:Yr.$6,meaning:tt.Translation.Annotations.DubiousMove},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$9,display:Yr.$9,meaning:tt.Translation.Annotations.Miss},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$10,display:Yr.$10,meaning:tt.Translation.Annotations.Drawish},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$13,display:Yr.$13,meaning:tt.Translation.Annotations.Unclear},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$14,display:Yr.$14,meaning:tt.Translation.Annotations.WhiteHasSlightAdvantage},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$15,display:Yr.$15,meaning:tt.Translation.Annotations.BlackHasSlightAdvantage},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$16,display:Yr.$16,meaning:tt.Translation.Annotations.WhiteHasModerateAdvantage},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$17,display:Yr.$17,meaning:tt.Translation.Annotations.BlackHasModerateAdvantage},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$18,display:Yr.$18,meaning:tt.Translation.Annotations.WhiteHasDecisiveAdvantage},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$19,display:Yr.$19,meaning:tt.Translation.Annotations.BlackHasDecisiveAdvantage},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$22,display:Yr.$22,meaning:tt.Translation.Annotations.PositionInZuqZwang},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$36,display:Yr.$36,meaning:tt.Translation.Annotations.WithInitiative},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$40,display:Yr.$40,meaning:tt.Translation.Annotations.WithCompensation},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$146,display:Yr.$146,meaning:tt.Translation.Annotations.Novelty},{action:An.AnnotationActions.AddAdditionalAnnotation,code:zr.Nags.$256,display:Yr.$256,meaning:tt.Translation.Annotations.WithAttack}];function Ia(e){return!e||!Object.prototype.hasOwnProperty.call(Yr,e)&&!Object.prototype.hasOwnProperty.call(Nl,e)?e||"":Pf(e)?Yr[e]:Ia(Nl[e])}function Xu(e){let t="";return e.annotation&&(t=`${t}${Ia(e.annotation)}`),e.additionalAnnotation&&e.additionalAnnotation[0]&&(t=`${t}&nbsp;${Ia(e.additionalAnnotation[0])}`),t}function Tf(e,t){return!!(e.color===ct.ColorsAsNumbers.White||e.ids&&e.ids.move===0||t&&typeof t.comment=="string"||t&&t.lines&&t.lines.length)}function Mf({color:e,ply:t,startingMoveNumber:n=1}){let r;return e===ct.ColorsAsNumbers.White?r=Math.ceil(t/2+1):r=Math.floor(t/2+1),r+(n-1)}function xf(e,t){return!!(e.color===ct.ColorsAsNumbers.Black&&(t&&typeof t.comment=="string"||t&&t.lines&&t.lines.length||e.ids&&e.ids.move===0))}function If({node:e,previous:t,startingMoveNumber:n=1}){let r="";if(!e)return r;const i=Mf({color:e.color,ply:e.moveNumber,startingMoveNumber:n});return Tf(e,t)&&(r+=`${i}.`,xf(e,t)&&(r+="..")),r}const Ll={[ii.Keys.MoveNumber]:function({game:t,node:n}){var r;return If({node:n,previous:n?.previous&&(r=t.getNodeByIds(n.previous))!=null?r:void 0,startingMoveNumber:t.getStartingMoveNumber()})},[ii.Keys.Annotation]:function({node:t}){return Xu(t)},[ii.Keys.CustomColor]:function({node:t}){return t.customColor},[ii.Keys.San]:function({moveList:t,node:n,translations:r}){return mr({color:ts(n?.color),moveListDisplayType:t.getOptions().moveListDisplayType,san:n?.san,translations:r})}};function Rf({moveList:e,game:t,node:n,options:r,emitter:i,translations:o}){if(Ma(n))throw new hi({code:ai.BadData,data:n,message:"Invalid move ids."});const s=G1(r.target,{anchor:r.anchor,props:{annotation:Xu(n),id:h(),moveListEl:e.dom.getElement(),moveNumber:Ll[ii.Keys.MoveNumber](d()),san:Ll[ii.Keys.San](d()),selected:!1}}),l={addNodeStyles:be,destroy:s.destroy,getElement:f,getId:h,getNodeData:g,ids:n.ids,insertBeforeNode:I,insertAfterNode:D,removeNodeStyles:Ye,set:s.set,touch:S,touchNextNode:P};return m(),l;function d(){return{game:{getNodeByIds:t.getNodeByIds,getStartingMoveNumber:t.getStartingMoveNumber},moveList:{getOptions:e.api.getOptions},node:g(),translations:o}}function f(){var Se;const Ze=e.dom.getElement(),mt=`[${xr.ComponentIdentifier}="${h()}"]`,zn=(Se=Ze.querySelector(mt))!=null?Se:s.el.querySelector(mt);if(!zn)throw new hi({code:ai.ElementNotFound,data:n.ids,message:`Move node element was not found for ${n.ids.line}-${n.ids.move}.`});return zn}function h(){const Se=n.ids;return`move-node-${Se.line}-${Se.move}`}function g(){return t.getNodeByIds(n.ids)}function m(){s.on(oi.Events.Click,function(){e.api.getOptions().enabled&&t.selectNode(n.ids.line,n.ids.move)}),s.on(oi.Events.OpenContextMenu,function(){e.api.getOptions().moveListContextMenuEnabled&&(t.selectNode(n.ids.line,n.ids.move),i.emit(oi.Events.OpenContextMenu,{node:n}))})}function S(Se){s.set({[Se]:Ll[Se](d())})}function P(Se=[ii.TouchableKeys.MoveNumber]){const Ze=e.api.getMoveNode({line:n.ids.line,move:n.ids.move+1});Ze&&Se.forEach(mt=>Ze.touch(mt))}function I(Se){const Ze=f();Ze.parentNode&&Ze.parentNode.insertBefore(Se,Ze)}function D(Se){const Ze=e.dom.getElement(),mt=f();mt.nextElementSibling?Ze.insertBefore(Se,mt.nextElementSibling):Ze.appendChild(Se)}function be(Se){const Ze=f();Se&&Object.assign(Ze.style,Se)}function Ye(){f().removeAttribute("style")}}function Of(e){return function(n,r){var i;const{game:o,getComponent:s,state:l,stateMachine:d,translations:f}=e,h=n.ids;return typeof l.nodes[h.line]>"u"&&(l.nodes[h.line]={}),typeof l.nodes[h.line][h.move]<"u"&&l.nodes[h.line][h.move].destroy(),l.nodes[h.line][h.move]=Rf({emitter:d,game:o,moveList:(i=s())!=null?i:e.el,node:n,options:r,translations:f}),l.nodes[h.line][h.move]}}function Qu(e){e.preventDefault()}function Nf(e){return function(){const{dom:n,el:r,queue:i}=e;r.classList.remove(xr.ClassNames.Component),r.removeEventListener("contextmenu",Qu),n.reset(),i.clear()}}function Lf(e){const t=document.createElement("textarea");return t.innerHTML=e.replace(/&nbsp;/g," "),t.value}function Ju(e,t){if(t){const n=["br"],r=n.map(s=>`\\/${s}`),i=n.concat(r).join("|"),o=new RegExp(`<(?!${i}s*/?)[^>]+>`,"g");return e.replace(o,"")}return e.replace(/<\/?[^>]+(>|$)/g,"")}function Df(e){let t;return t=Lf(Ju(e)),t===" "&&(t=""),t}var ec=".editable-comment.svelte-1toz211{cursor:pointer;font-weight:400;margin-left:5px;outline:none;white-space:normal;color:#52b1dc;display:inline-block}.editable-comment.svelte-1toz211:first-child{margin-left:0}.editable-comment.svelte-1toz211::-moz-selection{background:#cfeaf3}.editable-comment.svelte-1toz211::selection{background:#cfeaf3}.editable-comment[contenteditable=true].svelte-1toz211:empty:before{color:#8b8987;content:attr(placeholder);display:inline}";function os(e){let t,n,r,i,o;return{c(){t=(0,w.d)("span"),n=(0,w.t)(e[2]),(0,w.h)(t,"class",(0,w.J)(Kr.Classes.Component)+" svelte-1toz211"),(0,w.h)(t,"contenteditable","true"),(0,w.h)(t,"placeholder",r=e[0]["Add Comment..."]())},m(s,l){(0,w.j)(s,t,l),(0,w.A)(t,n),e[7](t),i||(o=[(0,w.k)(t,"focusin",e[3]),(0,w.k)(t,"focusout",e[4]),(0,w.k)(t,"input",e[5])],i=!0)},p(s,[l]){l&4&&(0,w.r)(n,s[2]),l&1&&r!==(r=s[0]["Add Comment..."]())&&(0,w.h)(t,"placeholder",r)},i:w.o,o:w.o,d(s){s&&(0,w.m)(t),e[7](null),i=!1,(0,w.L)(o)}}}function tc(e,t,n){let r;const i=(0,w.M)();let{comment:o=""}=t,{translations:s}=t,l;function d(){o&&document.execCommand("selectAll",!1,null)}function f(){i(Kr.Events.FocusOut,l.innerHTML)}function h(){i(Kr.Events.CommentChanged,l.innerHTML)}(0,w.P)(()=>{l.focus()});function g(m){w.Q[m?"unshift":"push"](()=>{l=m,n(1,l)})}return e.$$set=m=>{"comment"in m&&n(6,o=m.comment),"translations"in m&&n(0,s=m.translations)},e.$$.update=()=>{e.$$.dirty&64&&n(2,r=o||"")},[s,l,r,d,f,h,o,g]}class Bf extends w.a{constructor(t){super(),(0,w.i)(this,t,tc,os,w.b,{comment:6,translations:0})}}function Ff(e,{anchor:t,props:n}){return ns({ComponentType:Bf,options:{anchor:t,props:n,target:e},replaceContainer:!1})}function Uf(e,{api:t,comment:n,moveList:r,noUIUpdates:i}){t.updateLineComment(typeof n=="string"&&n.length>0?n:void 0,e.id),!i&&e.initComment&&(e.id===0?r.dom.getElement():No(e.id,r.dom.getElement())).prepend(r.dom.addComment(e))}function nc(e,{moveList:t,api:n}){let r,i;e.id===0?i=t.dom.getElement():i=No(e.id,t.dom.getElement());const o=t.api.getMoveNode({line:e.id,move:0});return o&&(r=o.getElement()),{anchor:r,comment:e.initComment,element:i,handler:function(l,d){Uf(e,{api:n,comment:l,moveList:t,noUIUpdates:d})}}}function Hf(e,{api:t,comment:n,moveList:r,noUIUpdates:i}){t.updateNode(e.ids,{comment:typeof n=="string"&&n.length>0?n:void 0}),!i&&(e.getNodeData().comment&&e.getElement().appendChild(r.dom.addComment(e.getNodeData())),e.touchNextNode())}function rc(e,{moveList:t,api:n}){const r=t.api.getMoveNode(e.ids);if(!r)throw new hi({code:ai.ElementNotFound,data:e,message:"No move node found."});return{comment:e.comment,element:r.getElement(),handler:function(o,s){Hf(r,{api:n,comment:o,moveList:t,noUIUpdates:s})}}}function Gf(e){return function(n){const{dom:r,game:i,getComponent:o,translations:s}=e;let l,d;if(fo(n))l=rc(n,{api:i,moveList:o()});else if(Ma(n))l=nc(n,{api:i,moveList:o()});else throw new hi({code:ai.BadData,data:n,message:"No line or node found"});r.removeEditableComment(),e.editableCommentComponent=Ff(l.element,{anchor:l.anchor,props:{comment:l.comment,translations:s}}),e.editableCommentComponent.on(Kr.Events.CommentChanged,function({detail:g}){clearTimeout(d),d=window.setTimeout(()=>{f(g)},Kr.Constants.CommentUpdateDelay)}),e.editableCommentComponent.on(Kr.Events.FocusOut,function({detail:g}){clearTimeout(d);const m=Df(g);l.handler(m),e.dom.removeEditableComment()});function f(h=""){const g=Df(h);l.handler(g,!0)}}}var V1=`.comment {
  cursor: pointer;
  font-weight: 400;
  margin-left: 5px;
  outline: none;
  white-space: normal;
}
.comment:first-child {
  margin-left: 0;
}`,la;(function(e){(function(t){t.Click="click"})(e.Events||(e.Events={}))})(la||(la={}));function Dl(e){if(Ma(e))return`line-comment-${e.id}`;if(fo(e))return`move-node-comment-${e.ids.line}-${e.ids.move}`;throw new hi({code:ai.BadData,data:e,message:"No line or node found"})}function Vf(e){return e.split(" ").map(t=>Pf(t)?Ia(t):t).join(" ")}function Us({commentLinkData:e,lineOrNode:t,context:n}){const r=Dl(t);let i=!1,o,s,l;if(Ma(t))o=Vf(t.initComment),l={line:t.id,move:0};else if(fo(t))o=t.comment?Vf(t.comment):t.comment,l=t.ids;else throw new hi({code:ai.BadData,data:t,message:"No line or node found"});return d(),{deregisterClickListeners:g,destroy:f,getElement:()=>s,getId:()=>r,registerClickListeners:h};function d(){var P;const I=e?"a":"span";s=document.createElement(I),s.setAttribute(xr.ComponentIdentifier,r),s.innerHTML=Ju(((P=e?.text)!=null?P:o)||"",!0),s.classList.add(oi.Classes.Comment,oi.Classes.StaticComment),e&&(s.setAttribute("href",e.href),s.setAttribute("target","_blank")),n.editingEnabled&&!e&&h()}function f(){g(),n.removeCommentFromMoveList(r)}function h(){i||(s.addEventListener("click",m,{once:!0}),s.addEventListener("contextmenu",S),i=!0)}function g(){s.removeEventListener("click",m),s.removeEventListener("contextmenu",S),i=!1}function m(){f(),n.emitter.emit(la.Events.Click,t)}function S(P){P.preventDefault(),n.emitter.emit(oi.Events.OpenContextMenu,{node:{ids:l}})}}function z1(e){return function(n,r=!0,i){const{dom:o,options:s,state:l,stateMachine:d}=e,f=!!("isCommentEnabled"in n?n.isCommentEnabled:r),h=Us({commentLinkData:i??null,lineOrNode:n,context:{editingEnabled:s.moveListContextMenuEnabled&&f,emitter:d,removeCommentFromMoveList(){o.removeComment(n)}}});return l.comments[h.getId()]&&o.removeComment(n),l.comments[h.getId()]=h,h.getElement()}}function Bl(e){return e===0}function zf(e){return function({node:n,nodeToInsertAfter:r}){const{dom:i,el:o,placeholders:s}=e,l=s[xr.Placeholders.Moves],d=Bl(n.ids.line)?l:void 0;let f=o;if(r){const h=r.getElement();if(!h)throw new hi({code:ai.ElementNotFound,message:"Node element does not exist."});f=h.parentNode}i.addNode(n,{anchor:d,target:f})}}function Wo(e,...t){const n=document.createElement("span");return n.setAttribute(xr.ComponentIdentifier,`line-${e}`),n.classList.add(...t),n}function jf(e){return function({node:n}){const{api:r,dom:i,el:o,game:s}=e,l=n.ids,d=s.getRawLines()[l.line],f={line:d.parentId,move:d.atMoveNode},h=r.getMoveNode({line:f.line,move:f.move+1}),g=s.getNodeByIds(f);if(!g)throw new hi({code:ai.ElementNotFound,message:"Anchor node element for variation not found."});let m=o;const S=Wo(d.id,xr.ClassNames.Variation);if(g.ids.line===0&&S.classList.add(xr.ClassNames.MainLine),i.addNode(n,{target:S}),g.lines&&g.lines.length>1)m=No(g.lines[g.lines.length-2],o);else{const P=r.getMoveNode(g.ids);P&&(m=P.getElement())}m&&m.after(S),typeof h<"u"&&h.touch(ii.TouchableKeys.MoveNumber)}}function Fl(e,t){return t.lines?t.lines.reduce((n,r)=>(n.push(e[r]),n),[]):[]}function Ul({api:e,depth:t,parentLineEl:n,lines:r,line:i}){let o;t===1?o=document.createDocumentFragment():o=Wo(i.id,xr.ClassNames.Variation),i.initComment&&o.appendChild(e.addComment(i)),i.forEach(s=>{const l=e.addNode(s,{target:o});s.comment&&l.getElement().appendChild(e.addComment(s)),s.lines&&Fl(r,s).forEach(d=>{Ul({api:e,depth:t+1,line:d,lines:r,parentLineEl:o})})}),n.appendChild(o)}function qf({dom:e,game:t}){t.getRawLines().forEach(r=>{r.forEach(i=>{const o=t.getNodeByIds(i.ids);if(!o)return;const s=o.customColor;s&&e.updateMoveNodeComponent(i.ids,{customColor:s})})})}function Hl(e){return function(){const{api:n,dom:r,el:i,game:o,placeholders:s}=e,l=s[xr.Placeholders.Moves];r.reset();const d=o.getRawLines();d[0].initComment&&i.insertBefore(r.addComment(d[0]),l),d[0].forEach(h=>{var g,m;const S=r.addNode(h,{anchor:l,target:i});if(h.comment&&S.getElement().appendChild(r.addComment(h)),(g=h.commands)!=null&&g.text&&((m=h.commands)!=null&&m.href)){const{text:P,href:I}=h.commands;o.hml.addCommentLink({node:h,text:P,href:I})}h.lines&&Fl(d,h).forEach(P=>{const I=Wo(P.id,xr.ClassNames.Variation,xr.ClassNames.MainLine);Ul({api:{addComment:r.addComment,addNode:r.addNode},depth:1,line:P,lines:d,parentLineEl:I}),i.insertBefore(I,l)})});const f=o.getSelectedNode();f&&n.selectNode(f.ids),qf(e),e.state.nodeLimit&&e.game.hml.updateNodeLimits(e.state.nodeLimit)}}function Wf(e,t){const n=t.querySelector(`[${xr.ComponentIdentifier}="${Dl(e)}"`);n&&n.parentNode&&n.parentNode.removeChild(n)}function Kf(e){return function(n){const{state:r}=e,i=Dl(n),o=e.el;r.comments[i]&&(Wf(n,o),delete r.comments[i])}}function $f(e){return function(){if(typeof e.editableCommentComponent<"u"){try{e.editableCommentComponent.destroy()}catch{}e.editableCommentComponent=void 0}}}function Zf(e){return function(n){const{api:r,dom:i,el:o,state:s}=e,l=n.id;if(typeof s.nodes[l]>"u")throw new hi({code:ai.BadData,data:n,message:`No line with id ${l} found`});s.nodes[l][0]&&i.removeNode({line:l,move:0});const d=No(l,o);d&&d.parentNode.removeChild(d),delete s.nodes[l];let f;typeof n.atMoveNode<"u"&&typeof n.parentId<"u"&&(f=r.getMoveNode({line:n.parentId,move:n.atMoveNode+1})),f&&f.touch(ii.TouchableKeys.MoveNumber)}}function Lo({el:e,game:t,state:n}){const r=t.getRawLines();Object.keys(n.nodes).forEach(i=>{var o;if(r[i])return;Object.values(n.nodes[i]).forEach(l=>l.destroy()),(o=No(Number(i),e))==null||o.remove(),delete n.nodes[i]})}function Yf(e){return function({line:n,move:r}){const{api:i,state:o}=e,s=i.getMoveNode({line:n,move:r});if(!s)return;const l=Object.keys(o.nodes[s.ids.line]).length-1;if(o.nodes[s.ids.line][s.ids.move]!==o.nodes[s.ids.line][l])for(let f=l;f>s.ids.move;f--)o.nodes[s.ids.line][f].destroy(),delete o.nodes[s.ids.line][f];s.destroy(),delete o.nodes[s.ids.line][s.ids.move],Lo(e);const d=i.getMoveNode({line:s.ids.line,move:s.ids.move+1});d&&d.touch(ii.TouchableKeys.MoveNumber)}}function Xf(e){return function(){const{dom:n,el:r,state:i,placeholders:o}=e;n.removeEditableComment(),r.innerHTML="",i.comments={},i.nodes={},i.selectedNode=void 0,r.appendChild(o[xr.Placeholders.Moves]),r.appendChild(o[xr.Placeholders.GameResult])}}function j1(e){return function(n){var r;const{el:i}=e,o=i.querySelector(`.${oi.Classes.GameResultNode}`),s=e.placeholders[xr.Placeholders.GameResult];if(o&&((r=o.parentElement)==null||r.removeChild(o)),n===ct.Results.None)return;const l=document.createElement("span");l.classList.add(oi.Classes.GameResultNode),l.innerText=n,i.insertBefore(l,s)}}function q1(e){return function(n,r){var i;const{dom:o,game:s}=e,l=s.getLine(n);if(!l)return;const{initComment:d}=r;if(d!==void 0){const f=l.id===0?(i=o?.getElement())!=null?i:e.el:No(l.id,e.el);f?.prepend(o.addComment(l))}}}function Qf(e){return function(n,r){const{api:i,dom:o,game:s}=e,l=s.getNodeByIds(n),d=i.getMoveNode(n);if(!l||!d)return;const f=d?.getElement(),h=[],{additionalAnnotation:g,annotation:m,comment:S,customColor:P,isCommentEnabled:I}=r;if((g!==void 0||m!==void 0)&&h.push(ii.TouchableKeys.Annotation),S!==void 0)if(S==="")o.removeComment(l);else{const D=d.getNodeData(),be=o.addComment(D,I??!0);f.appendChild(be)}P!==void 0&&h.push(ii.TouchableKeys.CustomColor),h.forEach(D=>d.touch(D))}}function Jf(e){const{el:t,placeholders:n}=e;return t.classList.add(xr.ClassNames.Component),t.addEventListener("contextmenu",Qu),t.appendChild(n[xr.Placeholders.Moves]),t.appendChild(n[xr.Placeholders.GameResult]),{addComment:z1(e),addNode:Of(e),destroy:Nf(e),getElement:()=>t,insertEditableComment:Gf(e),insertNode:zf(e),insertVariation:jf(e),load:Hl(e),removeComment:Kf(e),removeEditableComment:$f(e),removeLine:Zf(e),removeNode:Yf(e),reset:Xf(e),setResultNode:j1(e),setScrollContainer:r=>e.scrollContainer=r,updateLineComponent:q1(e),updateMoveNodeComponent:Qf(e)}}var po;(function(e){(function(t){t.PluginAdded="PluginAdded",t.PluginRemoved="PluginRemoved",t.ContextSet="ContextSet"})(e.Events||(e.Events={}))})(po||(po={}));function ic(e=[],t,n=(0,w.H)()){const r=new Map;let i=t;return s(e),Ce(ge({add:o,addMany:s,destroy:l},n),{getAll:d,getContext:f,getOne:h,has:r.has.bind(r),remove:g,setContext:m});function o(S){var P;return S.name?(r.has(S.name)&&g(S.name),r.set(S.name,S),(P=S.create)==null||P.call(S,i),n.emit(po.Events.PluginAdded,S),!0):!1}function s(S){return!S||S.length===0?!1:(Array.isArray(S)?S:[S]).reduce(function(D,be){return o(be)||(D=!1),D},!0)}function l(){r.forEach(S=>g(S.name))}function d(){return[...r.values()]}function f(){return i}function h(S){return r.get(S)}function g(S){var P;const I=r.get(S);return I?((P=I.destroy)==null||P.call(I,i),r.delete(S),n.emit(po.Events.PluginRemoved,I),!0):!1}function m(S){i=S,n.emit(po.Events.ContextSet,i)}}function e0(e,t){return function(r,i){const o=e[r];return e[r]=i(t),function(){var l,d;(d=(l=e[r]).destroy)==null||d.call(l),e[r]=o}}}function t0(e,t,n){const r=e0(t,n),i=new Map;return e.on(po.Events.PluginAdded,function(s){if(s.api){const l=r(s.name,s.api);l&&i.set(s.name,l)}}),e.on(po.Events.PluginRemoved,function(s){const l=i.get(s.name);l?.(),i.delete(s.name)}),e}function Gl(e,t){const n=ic([],t);return t0(n,e,t)}function n0({el:e,game:t,nodeLimit:n,options:r,plugins:i=[B1()],stateMachineListeners:o,stateMachine:s,queue:l,placeholders:d,scrollContainer:f,translations:h=Pa}){const g={},m={api:g,contextMenuActions:bf,dom:{getElement:()=>e},editableCommentComponent:void 0,el:e,game:t,getComponent:Ye,options:r,queue:l,placeholders:d,scrollContainer:f,state:{comments:{},nodes:{},nodeLimit:n,selectedNode:void 0},stateMachine:s,stateMachineListeners:o,translations:h},{dom:S,game:P}=m,I=Gl(P.hml,m);I.addMany(i),Object.assign(g,ge({},Ol(m))),Object.assign(S,ge({},Jf(m))),P.extendAPI(R.Plugin.Name,{addContextMenuActions(){return L1(m)}});const D={api:g,destroy:be,dom:S,plugins:I};return D;function be(){I.destroy()}function Ye(){return D}}function r0({context:e,coreContext:t}){var n,r;const{el:i,nodeLimit:o,scrollContainer:s,translations:l}=e,{api:d}=t,f=d.getOptions();(r=(n=e.moveList)==null?void 0:n.destroy)==null||r.call(n),e.methods.destroy(),e.stateMachineListeners.push([la.Events.Click,e.methods.handleCommentClick]),e.stateMachine.on(la.Events.Click,e.methods.handleCommentClick),e.moveList=n0({el:i,game:d,nodeLimit:o,options:{enabled:f.enabled,moveListContextMenuEnabled:f.moveListContextMenuEnabled,moveListDisplayType:f.moveListDisplayType},queue:e.queue,placeholders:e.placeholders,scrollContainer:s,stateMachine:e.stateMachine,stateMachineListeners:e.stateMachineListeners,translations:l}),e.moveList.dom.load(),e.moveList.dom.setResultNode(d.getResult())}function ua({node:e,game:t,data:n,moveNodeComponent:r}){const i=Ia(n),s=r.getNodeData().annotation===i?void 0:i;t.updateNode(e.ids,{annotation:s}),r.touch(ii.TouchableKeys.Annotation)}function oc({node:e,game:t,data:n,moveNodeComponent:r}){const i=Ia(n),o=r.getNodeData().additionalAnnotation,l=o?.[0]===i?void 0:[i];t.updateNode(e.ids,{additionalAnnotation:l}),r.touch(ii.TouchableKeys.Annotation)}function ac(e,t){return function({action:r,data:i,event:o,moveNode:s}){const l=t.api.getMoveNode(s.ids);if(!l)throw new hi({code:ai.BadData,data:s.ids,message:"No move node found."});r.handler(s,{context:e,data:i,moveList:t,moveNodeComponent:l,event:o}),e.queue.flush()}}var i0=".move-node-context-menu.svelte-n9uqrg.svelte-n9uqrg{background-color:#fff;border:1px solid rgba(0, 0, 0, 0.15);border-radius:4px;box-shadow:0 6px 12px rgba(0, 0, 0, 0.175);color:#000000;font-size:1.4rem;list-style:none;margin:2px 0 0;min-width:16rem;padding:5px 0;position:fixed;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1000}.move-node-context-menu.svelte-n9uqrg .action-name.svelte-n9uqrg{padding:0.5rem 2rem}.move-node-context-menu.svelte-n9uqrg .action-name.svelte-n9uqrg,.move-node-context-menu.svelte-n9uqrg .annotation.svelte-n9uqrg{cursor:pointer;display:block}.move-node-context-menu.svelte-n9uqrg .action-name.svelte-n9uqrg:hover,.move-node-context-menu.svelte-n9uqrg .annotation.svelte-n9uqrg:hover{background-color:#f1f1f1}.move-node-context-menu.svelte-n9uqrg .annotations-container.svelte-n9uqrg{display:grid;grid-template-columns:1fr 1fr 1fr 1fr}.move-node-context-menu.svelte-n9uqrg .annotation.svelte-n9uqrg{display:inline-block;padding:3px;text-align:center}.move-node-context-menu.svelte-n9uqrg .divider.svelte-n9uqrg{background-color:#f1f1f1;height:1px}";function sc(e,t,n){const r=e.slice();return r[9]=t[n],r}function lc(e,t,n){const r=e.slice();return r[12]=t[n],r}function uc(e){let t,n=(e[1][e[12].name]?e[1][e[12].name]():e[12].name)+"",r,i,o,s;function l(...d){return e[6](e[12],...d)}return{c(){t=(0,w.d)("span"),r=(0,w.t)(n),(0,w.h)(t,"class",i=(0,w.J)(sa.Classes.ActionName)+" svelte-n9uqrg")},m(d,f){(0,w.j)(d,t,f),(0,w.A)(t,r),o||(s=(0,w.k)(t,"click",l),o=!0)},p(d,f){e=d,f&3&&n!==(n=(e[1][e[12].name]?e[1][e[12].name]():e[12].name)+"")&&(0,w.r)(r,n)},d(d){d&&(0,w.m)(t),o=!1,s()}}}function cc(e){let t,n=e[9].display+"",r,i,o,s,l,d;function f(){return e[7](e[9])}return{c(){t=(0,w.d)("span"),r=(0,w.t)(n),i=(0,w.u)(),(0,w.h)(t,"alt",o=e[1][e[9].meaning]()),(0,w.h)(t,"class",s=(0,w.J)(sa.Classes.Annotation)+" svelte-n9uqrg")},m(h,g){(0,w.j)(h,t,g),(0,w.A)(t,r),(0,w.A)(t,i),l||(d=(0,w.k)(t,"click",f),l=!0)},p(h,g){e=h,g&2&&o!==(o=e[1][e[9].meaning]())&&(0,w.h)(t,"alt",o)},d(h){h&&(0,w.m)(t),l=!1,d()}}}function o0(e){let t,n,r,i,o,s,l,d,f=e[0],h=[];for(let S=0;S<f.length;S+=1)h[S]=uc(lc(e,f,S));let g=Yu,m=[];for(let S=0;S<g.length;S+=1)m[S]=cc(sc(e,g,S));return{c(){t=(0,w.d)("div");for(let S=0;S<h.length;S+=1)h[S].c();n=(0,w.u)(),r=(0,w.d)("div"),i=(0,w.u)(),o=(0,w.d)("div");for(let S=0;S<m.length;S+=1)m[S].c();s=(0,w.u)(),(0,w.h)(r,"class",(0,w.J)(sa.Classes.Divider)+" svelte-n9uqrg"),(0,w.h)(o,"class",(0,w.J)(sa.Classes.AnnotationsContainer)+" svelte-n9uqrg"),(0,w.h)(t,"class",(0,w.J)(sa.Classes.Component)+" svelte-n9uqrg")},m(S,P){(0,w.j)(S,t,P);for(let I=0;I<h.length;I+=1)h[I].m(t,null);(0,w.A)(t,n),(0,w.A)(t,r),(0,w.A)(t,i),(0,w.A)(t,o);for(let I=0;I<m.length;I+=1)m[I].m(o,null);(0,w.A)(t,s),e[8](t),l||(d=(0,w.k)(document.body,"click",e[4]),l=!0)},p(S,[P]){if(P&11){f=S[0];let I;for(I=0;I<f.length;I+=1){const D=lc(S,f,I);h[I]?h[I].p(D,P):(h[I]=uc(D),h[I].c(),h[I].m(t,n))}for(;I<h.length;I+=1)h[I].d(1);h.length=f.length}if(P&10){g=Yu;let I;for(I=0;I<g.length;I+=1){const D=sc(S,g,I);m[I]?m[I].p(D,P):(m[I]=cc(D),m[I].c(),m[I].m(o,null))}for(;I<m.length;I+=1)m[I].d(1);m.length=g.length}},i:w.o,o:w.o,d(S){S&&(0,w.m)(t),(0,w.D)(h,S),(0,w.D)(m,S),e[8](null),l=!1,d()}}}function a0(e,t,n){let{actions:r}=t,{translations:i}=t;const o=(0,w.M)();let s;function l(){return s}function d(m){m.target.classList.contains(sa.Classes.Component)||o(An.Events.Close)}const f=(m,S)=>o(An.Events.ActionClicked,{action:m,event:S}),h=m=>o(An.Events.AnnotationClicked,{action:m.action,data:m.code});function g(m){w.Q[m?"unshift":"push"](()=>{s=m,n(2,s)})}return e.$$set=m=>{"actions"in m&&n(0,r=m.actions),"translations"in m&&n(1,i=m.translations)},[r,i,s,o,d,l,f,h,g]}class s0 extends w.a{constructor(t){super(),(0,w.i)(this,t,a0,o0,w.b,{actions:0,translations:1,getElement:5})}get getElement(){return this.$$.ctx[5]}}function l0(e,{anchor:t,props:n}){return ns({ComponentType:s0,methods:["getElement"],options:{anchor:t,props:n,target:e},replaceContainer:!1})}function u0({contextMenu:e,moveNode:t,padding:n={x:10,y:20}}){const r=t.y+n.y-window.pageYOffset,i=window.innerHeight-e.height,o={left:0,top:0};return o.top=Math.min(r,i),o.bottom=o.top+e.height,t.x>window.innerWidth-e.width?o.left=t.x+t.width-e.width:(r<i&&(n.x=0),o.left=t.x+n.x),o}function c0(e,t){let n;return function(...i){clearTimeout(n),n=setTimeout(()=>{n=null,e(...i)},t)}}function d0(e){let t;return function(...r){t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{t=null,e(...r)})}}function dc({actions:e,el:t,moveNode:n,emitter:r,translations:i}){const o=n?.getElement(),s=l0(o?.parentElement||t,{anchor:o,props:{actions:e,translations:i}});return f(),d(),{destroy:s.destroy};function l(h){return function({detail:m}){r.emit(h,{action:m.action,data:m.data,event:m.event,moveNode:n.getNodeData()})}}function d(){s.on(An.Events.ActionClicked,l(An.Events.ActionClicked)),s.on(An.Events.AnnotationClicked,l(An.Events.AnnotationClicked)),s.on(An.Events.Close,()=>r.emit(An.Events.Close)),t.addEventListener("scroll",c0(f,50))}function f(){const h=s?.getElement();if(!h)return;const{left:g,top:m}=u0({contextMenu:h.getBoundingClientRect(),moveNode:o?.getBoundingClientRect()||t.getBoundingClientRect()});h.style.left=`${g}px`,h.style.top=`${m}px`}}function f0(e){const{el:t,moveList:n,stateMachine:r,methods:{destroyContextMenu:i},translations:o}=e;e.stateMachineListeners.push([An.Events.ActionClicked,s],[An.Events.AnnotationClicked,l],[An.Events.Close,i],[oi.Events.OpenContextMenu,d]),r.on(An.Events.Close,i),r.on(An.Events.ActionClicked,s),r.on(An.Events.AnnotationClicked,l),r.on(oi.Events.OpenContextMenu,d);function s(f){i(),ac(n.api.getContext(),n)(f)}function l({action:f,data:h,moveNode:g}){i();const m=n.api.getMoveNode(g.ids);if(!m)throw new hi({code:ai.BadData,data:g.ids,message:"No move node found."});const S={data:h,game:n.api.getContext().game,moveNodeComponent:m,node:g};f===An.AnnotationActions.AddAnnotation?ua(S):f===An.AnnotationActions.AddAdditionalAnnotation&&oc(S)}function d(f){var h;n.api.selectNode(f.node.ids);const g=n.api.getContextMenuActions(f.node.ids);i(),e.contextMenu=dc({actions:g,el:(h=e.scrollContainer)!=null?h:t,emitter:r,moveNode:n.api.getMoveNode(f.node.ids),translations:o})}}const h0={condition:p0,handler:m0};function p0({context:e,event:t}){return function(){return t.type===M.InstanceEvents.Create||t.type===M.InstanceEvents.ModeChanged||!e.moveList||Object.entries(e.moveList).length===0}}function m0({context:e,coreContext:t}){r0({context:e,coreContext:t}),e.enableContextMenu&&f0(e)}function v0(e,t){return function(r){r.selectedNode=ge({},r.coreContext.api.getRelativeNode()),e.add(t,r)}}function fc({conditionParams:e,handlerContext:t}){const{queue:n}=t.context,r=[c1,f1,p1,h0,g1,fr,y1,A1,df,P1,S1].map(({condition:i,handler:o})=>[i(e),v0(n,o)]);sf(r,t),Il(function(){n.flush()})}function g0(e){return function(n){if(n){if(Ma(n)){e.moveList.api.selectLineStart(n);return}fo(n)&&e.moveList.api.selectNode(n.ids)}}}function _0(e){return function(){var n,r;e.stateMachineListeners.forEach(([i,o])=>{e.stateMachine.off({handler:o,type:i})}),e.stateMachineListeners=[],!(!e.moveList||!((r=(n=e.moveList)==null?void 0:n.dom)!=null&&r.destroy))&&(e.moveList.dom.destroy(),e.moveList.plugins.destroy())}}function hc(e){return function(){e.contextMenu&&(e.contextMenu.destroy(),e.contextMenu=void 0)}}const a=xr.VariationParenthesis.Before,u=xr.VariationParenthesis.After;function c({api:e,el:t,win:n=window}){const r=n.getSelection(),i=r?.anchorNode,o=r?.focusNode;if(!i||!o)return null;const s=e.getPGN(),l=A({moveList:t,node:i,pgn:s}),d=A({moveList:t,node:o,pgn:s});if(l===null||d===null)return null;const f=Math.min(l,d),h=Math.max(l,d),g=l<d?o:i,m=re(V(g)).length,S=h+m-f;let P=s.substr(f,S);return P=p({lastIndex:h+m,pgn:s,pgnPiece:P}),_(P),P}function p({lastIndex:e,pgn:t,pgnPiece:n}){const r=new RegExp(`\\${a}`,"g"),i=(n.match(r)||[]).length;let o=n;for(let s=0;s<i&&t[e+s]===u;s++)o+=u;return o}function _(e){const t=document.createElement("textarea");document.body.append(t),t.value=e,t.focus(),t.select(),document.execCommand("cut"),t.remove()}function A({moveList:e,pgn:t,node:n}){const r=V(n),i=re(r);let o=ue(e,r)||0;return t.split("").findIndex((s,l)=>{if(t.substr(l,i.length)===i){if(o===0)return l;o--}return!1})}function V(e){var t;return!e.parentNode||(t=e?.classList)!=null&&t.contains(oi.Classes.MoveNode)?e:V(e.parentNode)}function ue(e,t){return Array.from(e.querySelectorAll(`.${oi.Classes.MoveNode}`)).filter(i=>i.textContent===t.textContent).findIndex(i=>i===t)}function re(e){const t=e.querySelector(`.${oi.Classes.MoveNumber}`),n=e.querySelector(`.${oi.Classes.MoveText}`),r=e.querySelector(`.${oi.Classes.Comment}`);let i="";return t&&(i+=`${t.textContent} `),n&&(i+=n.textContent),r&&(i+=` {${r.textContent}}`),i}function wt({context:e,el:t}){return function(r){var i;if((i=r.target.classList)==null?void 0:i.contains(Kr.Classes.Component))return;c({api:e.api,el:t})&&r.preventDefault()}}function On(e){return function(n){e.moveList.dom.insertEditableComment(n)}}function vn({action:e,nodeLimit:t}){const n=e.includes("Set");return{action:An.Actions[e],handler:i,isVisible:r,name:tt.Translation.Actions[e]};function r({state:o}){var s,l;const d=(s=o.nodeLimit)==null?void 0:s[t],f=d?.move===((l=o.selectedNode)==null?void 0:l.getNodeData().move);return n?!d||!f:!!(d&&f)}function i(o,{moveList:s,moveNodeComponent:l}){Bt({limitType:t,isSettingNodeLimits:n,moveList:s,moveNodeComponent:l,node:o})}}const qn={[An.Actions.SetBegin]:vn({action:An.Actions.SetBegin,nodeLimit:xr.NodeLimitTypes.Begin}),[An.Actions.SetFocus]:vn({action:An.Actions.SetFocus,nodeLimit:xr.NodeLimitTypes.Focus}),[An.Actions.SetEnd]:vn({action:An.Actions.SetEnd,nodeLimit:xr.NodeLimitTypes.End}),[An.Actions.RemoveBegin]:vn({action:An.Actions.RemoveBegin,nodeLimit:xr.NodeLimitTypes.Begin}),[An.Actions.RemoveFocus]:vn({action:An.Actions.RemoveFocus,nodeLimit:xr.NodeLimitTypes.Focus}),[An.Actions.RemoveEnd]:vn({action:An.Actions.RemoveEnd,nodeLimit:xr.NodeLimitTypes.End})};function wn(e,t){const{api:n}=e;return function(){n.addContextMenuActions(qn),Or(e,t)}}function Bt({limitType:e,isSettingNodeLimits:t,moveList:n,moveNodeComponent:r,node:i}){var o,s;const l=n.api.getContext(),d=(o=l.state.nodeLimit)==null?void 0:o[e],{respond:f}=l.game.getContext();let h;d&&(h=n.api.getMoveNode({line:d.ids.line,move:d.ids.move})),t?Rr({limitType:e,moveList:n,moveNodeComponent:r,node:i}):((s=l.state.nodeLimit)==null||delete s[e],Vi({limitType:e,moveList:n,moveNodeComponent:r})),h&&Vi({limitType:e,moveList:n,moveNodeComponent:h}),f(xr.Events.UpdateNodeLimit,{isSettingNodeLimits:t,limitType:e,node:i})}function Rr({limitType:e,moveList:t,moveNodeComponent:n,node:r}){const i=t.api.getContext();if(i.state.nodeLimit&&(i.state.nodeLimit[e]=r),e===xr.NodeLimitTypes.Focus){n.addNodeStyles({fontStyle:"italic"});return}const o=document.createElement("span"),s=`diagram-${e}`,l=e===xr.NodeLimitTypes.Begin?"[[":"]]";o.classList.add(s),o.innerHTML=l,e===xr.NodeLimitTypes.Begin?n.insertBeforeNode(o):e===xr.NodeLimitTypes.End&&n.insertAfterNode(o)}function Vi({limitType:e,moveList:t,moveNodeComponent:n}){const r=t.dom.getElement().querySelector(`.diagram-${e}`);r?r.remove():n.removeNodeStyles()}function gt(e,t){return function(r){const{moveList:i}=t;e.api.getDiagramNodeLimits||Or(e,t),Object.entries(r).forEach(([o,s])=>{const l=i.api.getMoveNode({line:s.ids.line,move:s.ids.move});Bt({limitType:o,isSettingNodeLimits:!0,moveList:i,moveNodeComponent:l,node:s})})}}function Or(e,t){var n;const r=t.moveList.api.getContext();r.state.nodeLimit=(n=e.api.getDiagramNodeLimits)!=null?n:{},t.methods.destroyDiagramActions=e.api.extendAPI(R.Plugin.Name,{getDiagramNodeLimits(){var i;return(i=r?.state.nodeLimit)!=null?i:{}}})}function Xr(e,t){return function({node:r,text:i,href:o}){var s,l;const d=t.moveList.dom.addComment(r,!1,{text:i,href:o});e.api.getOptions().test&&Te(d,{[Ne.Element]:yn.CommentLink}),r.commands||(r.commands={}),e.api.updateNode(r.ids,{commands:Object.assign(r.commands,{href:`${o}`,text:`${i}`})}),r.ids.line===0?(s=t.moveList.api.getMoveNode(r.ids))==null||s.getElement().appendChild(d):(l=No(r.ids.line,t.el))==null||l.append(d)}}function ca(e){return function(n){e.scrollContainer=n,e.moveList.dom.setScrollContainer(n)}}function as(e,t){return{addDiagramActions:wn(e,t),addCommentLink:Xr(e,t),setScrollContainer:ca(t),updateNodeLimits:gt(e,t)}}function pi({el:e,enableContextMenu:t=!0,nodeLimit:n,scrollContainer:r,translations:i=Pa}){const o={[xr.Placeholders.GameResult]:document.createComment("/Game Result"),[xr.Placeholders.Moves]:document.createComment("/Moves")},s={contextMenu:void 0,el:e,enableContextMenu:t,methods:{destroy:qo,destroyContextMenu:qo,destroyDiagramActions:qo,handleCommentClick:qo,handleCopy:qo,selectCurrentPosition:qo},moveList:{},nodeLimit:n,queue:Zt(!1),placeholders:o,scrollContainer:r||e,stateMachine:u1(),stateMachineListeners:[],translations:i};return{api:S=>as(S,s),create:d,destroy:f,match:[{condition:xt([M.APIEvents.AddMove,M.APIEvents.CreateContinuation,M.APIEvents.CreateGame,M.APIEvents.DeletePosition,M.APIEvents.LineCommentUpdated,M.APIEvents.Load,M.APIEvents.Move,M.APIEvents.MoveBackward,M.APIEvents.MoveForward,M.APIEvents.MoveVariation,M.APIEvents.NodeUpdated,M.APIEvents.PromoteVariation,M.APIEvents.ResetToMainLine,M.APIEvents.SelectLineEnd,M.APIEvents.SelectLineStart,M.APIEvents.SelectNode,M.APIEvents.Undo,M.APIEvents.UpdatePGNHeaders,M.InstanceEvents.Create,M.OptionsEvents.Update]),handler:m},{condition:Je(M.InstanceEvents.ModeChanged),handler:l}],name:R.Plugin.Name};function l(S,P){f(),g(P),h(),m({data:null,type:M.InstanceEvents.ModeChanged},P)}function d(S){f(),g(S),h(),m({data:null,type:M.APIEvents.Load},S)}function f(){var S,P;s.queue.clear(),s.methods.destroy(),(P=(S=s.methods).destroyDiagramActions)==null||P.call(S),e.removeEventListener(xr.Events.Copy,s.methods.handleCopy)}function h(){e.addEventListener(xr.Events.Copy,s.methods.handleCopy)}function g(S){s.methods.destroy=_0(s),s.methods.destroyContextMenu=hc(s),s.methods.handleCommentClick=On(s),s.methods.handleCopy=wt({context:S,el:e}),s.methods.selectCurrentPosition=g0(s)}function m(S,P){fc({conditionParams:{context:s,event:S},handlerContext:{context:s,coreContext:P,event:S}})}}var da=`/* stylelint-disable */
.board-images {
  position: absolute;
  -ms-overflow-style: none;
  /* IE and Edge */
}
.board-images ::-webkit-scrollbar {
  /* Chrome */
  display: none;
}
.board-images:not(.board-images--palette) {
  z-index: 10;
}
.board-images:not(.board-images--palette) .board-images__window {
  border-radius: 1.25rem;
}
.board-images__title {
  white-space: nowrap;
  position: absolute;
  opacity: 0.8;
  font-size: small;
  pointer-events: none;
  left: 0;
  right: 0;
  width: 100%;
  top: 0;
  padding: 0.5rem 0;
  text-align: center;
  background-color: white;
  border-radius: 1.25rem;
  color: #312e2b;
}
.board-images__window {
  width: 100%;
  height: 100%;
  padding: 3%;
  background-color: white;
  box-shadow: 0 7px 9.5px 0.5px rgba(0, 0, 0, 0.2);
  overflow: scroll;
  scrollbar-width: none;
  /* hide scrollbar Firefox */
}
.board-images__window-body > div:not(:last-child) {
  border-bottom: 1px solid lightgray;
}
.board-images__hover-container {
  position: relative;
}
.board-images__effects-container {
  width: 100%;
}
.board-images__effect {
  border: 2px solid transparent;
  border-radius: 3px;
  cursor: pointer;
  padding: 3%;
  display: inline-flex;
}
.board-images__effect.selected {
  border: 2px solid #85a94e;
}
.board-images__break {
  display: inline-flex;
}
.board-images__image {
  width: 100%;
  cursor: pointer;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.board-images__hover {
  border: 2px solid #85a94e;
  border-radius: 3px;
  position: absolute;
  pointer-events: none;
}
.board-images__close-button {
  position: absolute;
  width: 15%;
  height: 0;
  padding-bottom: 15%;
  top: 0;
  pointer-events: none;
}
.board-images__close-button > div {
  pointer-events: auto;
  cursor: pointer;
  position: absolute;
  height: 100%;
  width: 100%;
  top: -50%;
}
.board-images.horizontal-overflow .board-images__close-button {
  right: 0;
}
.board-images.horizontal-overflow .board-images__close-button > div {
  right: -50%;
}
.board-images:not(.horizontal-overflow) .board-images__close-button {
  left: 0;
}
.board-images:not(.horizontal-overflow) .board-images__close-button > div {
  left: -50%;
}
.board-images--hidden {
  display: none;
}
.board .custom-item__frame {
  opacity: 1;
  overflow: hidden;
}
.board .custom-item__frame div {
  width: 115%;
  height: 115%;
  margin: -7.5%;
  filter: drop-shadow(0 0.5rem 0 rgba(0, 0, 0, 0.3));
  opacity: 1;
}
.board .custom-item__frame--animated div {
  width: 100%;
  height: 100%;
  margin: 0;
}
.board .custom-item__frame--disappear {
  transition: opacity 500ms;
  opacity: 0;
}`;function ss(e){return function(){e.boardImages.setFrames(),e.boardImages.clearMarkings(),e.boardImages.hideWindow(),e.boardImages.setWindow(),e.boardImages.setHotkeys()}}function pc(e){return function(){return[...e.values()]}}function cv(e){const{id:t,itemsPerRow:n,rows:r,itemsConfiguration:i=[]}=e;return[...Array(n*r)].map((s,l)=>{const d=i[l],{name:f,animatedImageURL:h=void 0,removalSoundBaseURL:g=void 0}=typeof d=="object"?d:{name:d??`${t}-${l}`},m=l%n,S=Math.floor(l/n);return{name:f,frameId:t,xIndex:m,yIndex:S,animatedImageURL:h,removalSoundBaseURL:g}})}function W1(e){const t=new Image;return t.src=e,t}function dv({api:e,framesMap:t,shortcuts:n}){return function(o=[]){t.clear(),n.clear(),o.forEach(s=>{t.set(s.id,s),W1(s.imageURL)}),o.map(cv).forEach(s=>{s.forEach(l=>{n.set(l),l.animatedImageURL&&W1(l.animatedImageURL)})}),r()};function r(){const i=n.getAsArray().filter(l=>l.removalSoundBaseURL);if(!i.length)return;const o=i.reduce((l,d)=>{var f;const{name:h,removalSoundBaseURL:g=""}=d,m=(f=l[g])!=null?f:[];return m.push(h),l[g]=m,l},{}),s=Object.keys(o);if(s.length){const l=e.sounds.getSoundsInstance();s.forEach(d=>{l.loadExtra({baseURL:d,codes:o[d]})})}}}function fv(e){return function(){return e.getAsArray()}}function hv(e){return function(n){return e.find({name:n})}}function mc({xIndex:e,yIndex:t,frameId:n}){return`frameId=${n}, xIndex=${e}, yIndex=${t}`}function pv(e){if("xIndex"in e){const{xIndex:t,yIndex:n,frameId:r}=e;return`Marking shortcut: '${mc({xIndex:t,yIndex:n,frameId:r})}' not found`}return`Marking shortcut: '${e.name}' not found`}function K1(e,t){return`Frame: '${e}' not found (frames available: ${t.join(", ")})`}function mv(e){return`Hotkey combination already in use: ${e.join(", ")})`}function vv({markings:e,framesMap:t,shortcuts:n}){const r=[],i=[];return e.forEach(o=>{const{model:s}=o;(Array.isArray(o.square)?o.square:[o.square]).forEach(d=>{if(typeof s=="string"){const g={data:{square:d,type:ie[s]},type:"effect",persistent:!0,node:!0};r.push({square:d,input:o,marking:g});return}const{customMarking:f,itemDisappears:h}=gv({model:s,shortcuts:n,framesMap:t,square:d});r.push({square:d,input:o,marking:f}),h&&i.push(d)})}),{resultMarkings:r,disappearingMarkingSquares:i}}function gv({model:e,shortcuts:t,framesMap:n,square:r}){var i;const o=t.find(e);if(!o)throw new Error(pv(e));const s=n.get(o.frameId);if(!s)throw new Error(K1(o.frameId,[...n.keys()]));const{xIndex:l,yIndex:d,animatedImageURL:f,removalSoundBaseURL:h,name:g}=o,{itemsPerRow:m,rows:S,imageURL:P}=s,I=f?{imageAnimated:!0,imageURL:f,positionRatioX:0,positionRatioY:0,widthRatio:1,heightRatio:1}:{imageURL:P,positionRatioX:l/m,positionRatioY:d/S,widthRatio:1/m,heightRatio:1/S};return{customMarking:{data:{square:r,type:Pt.Image,removalTimeout:2e3,removalClass:f?void 0:"custom-item__frame--disappear",removalSound:h?g:void 0,frame:I},type:"customItem",persistent:!0},itemDisappears:(i=e.autoRemove)!=null?i:!1}}function _v({api:e,markedSquares:t,framesMap:n,shortcuts:r}){return function(s){const l=Array.isArray(s)?s:[s],{resultMarkings:d,disappearingMarkingSquares:f}=vv({markings:l,framesMap:n,shortcuts:r});let h;d.length&&(h=i(d.map(g=>g.marking))),d.forEach((g,m)=>{var S;const{input:P,marking:I,square:D}=g,be=(S=h?.[m])!=null?S:"";be.length&&I.type!=="effect"&&t.set(D,{input:P,marking:Ce(ge({},I),{key:be})})}),f.length&&setTimeout(()=>{e.boardImages.unmark(f)},1500)};function i(o){var s;return o.length?o.length>1?e.markings.addMany(o).map(d=>d??""):[(s=e.markings.addOne(o[0]))!=null?s:""]:[]}}function bv(e,t){return function(r){const i=Array.isArray(r)?r:[r],o=[];i.forEach(s=>{const l=t.get(s);l&&(o.push(l.marking.key),t.delete(s))}),o.length&&(o.length>1?e.markings.removeMany(o):e.markings.removeOne(o[0]))}}function yv(e){return function(){return[...e.values()].map(n=>n.input)}}function Ev(e,t){return function(){const r=[...e.keys()];r.length&&t.boardImages.unmark(r)}}function Av(e){return function(n){return e.has(n)}}function wv(e){return function(){return e.boardImages.getFrames().length>0}}function Sv(e){return function(){return e.window}}function Cv({boardImagesDOM:e,framesMap:t,windowState:n,hotkeysMap:r,shortcuts:i,showCloseButton:o,api:s}){return function(S){var P,I;n.window=S,e.clearElement(),S&&(e.setSize(S.widthPercent/((P=S.boardContainerAspectRatio)!=null?P:1),S.heightPercent),e.setWindow({elements:l((I=S.elements)!=null?I:[]),elementClickedCallback:S.paletteMode?g:h,closeButtonCallback:o?s.boardImages.hideWindow:void 0,addTitleElement:!S.paletteMode,addHoverElement:S.paletteMode}))};function l(m){const S=new Map,P=I=>[...I,"left click"].join(" + ");return[...r.values()].forEach(I=>{const{keys:D,model:be}=I;if(typeof be=="string")S.set(be,P(D));else{const Ye=i.find(be);if(Ye){const{xIndex:Se,yIndex:Ze,frameId:mt}=Ye;S.set(mc({xIndex:Se,yIndex:Ze,frameId:mt}),P(D))}}}),m.map(I=>{if("frameId"in I)return d(I,S);{const{effects:D,id:be,emptyItemsPerRow:Ye,itemsPerRow:Se}=I,Ze=D.map(mt=>{if(typeof mt=="string"){const zn=S.get(mt);return zn?{title:zn,type:mt}:mt}else return mt});return{id:be,emptyItemsPerRow:Ye,itemsPerRow:Se,effects:Ze}}})}function d(m,S){const P=t.get(m.frameId);if(!P){const mt=K1(m.frameId,[...t.keys()]);throw new Error(mt)}const{frameId:I,emptyItemsPerRow:D,itemsAutoRemove:be}=m,{itemsPerRow:Ye,rows:Se,imageURL:Ze}=P;return{id:I,emptyItemsPerRow:D,itemsPerRow:Ye,rows:Se,imageURL:Ze,itemsAutoRemove:be,titles:f(P,S)}}function f(m,S){const{itemsPerRow:P,rows:I,id:D}=m;return[...Array(P*I)].map((be,Ye)=>{var Se;const Ze=Ye%P,mt=Math.floor(Ye/P),zn=mc({xIndex:Ze,yIndex:mt,frameId:D});return(Se=S.get(zn))!=null?Se:""})}function h(m){n.windowPosition&&("type"in m?s.boardImages.mark({square:n.windowPosition,model:m.type}):s.boardImages.mark({square:n.windowPosition,model:m}),s.boardImages.hideWindow())}function g(m){const S=s.boardImages.getSelectedMarking();if("type"in m)m.type===S?s.boardImages.selectMarking():s.boardImages.selectMarking(m.type);else{const P=S;m.frameId===P?.frameId&&m.yIndex===P?.yIndex&&m.xIndex===P?.xIndex?s.boardImages.selectMarking():s.boardImages.selectMarking(m)}}}function ls(e,t){return Math.min(Math.max(e,t.min),t.max)}function kv({squareCoords:e,heightInPercent:t,widthInPercent:n,allowOverflow:r}){let i=!1,o=e.x,s=e.y;return r||(s+t>100&&(s=ls(100-t,{min:0,max:100})),o+n>100&&(o=ls(o-n-(e.centered?0:12.5),{min:0,max:100}),i=!0)),{top:s,left:o,overflows:i}}function Pv({windowState:e,api:t,boardImagesDOM:n}){return function(i){var o;const{window:s,windowPosition:l}=e;if(!s)return;if(!i){n.showWindow();return}const{square:d,squareCoords:f,allowWindowOverflow:h=!1}=i;if(l){const P=t.markings.getAllWhere({types:[er]}).find(I=>I.data.square===l);P&&t.markings.removeOne(P.key)}e.windowPosition=d,t.markings.addOne({data:{square:d,color:pr.HighlightColors.Selected,opacity:.5},persistent:!0,type:er});const{top:g,left:m,overflows:S}=kv({squareCoords:f,heightInPercent:s.heightPercent,widthInPercent:s.widthPercent/((o=s.boardContainerAspectRatio)!=null?o:1),allowOverflow:h});n.setPosition(g,m,S),n.showWindow()}}function Tv({state:e,api:t,boardImagesDOM:n}){return function(){const{window:i,windowPosition:o}=e.windowState;if(i){if(o){const s=t.markings.getAllWhere({types:[er]}).find(l=>l.data.square===o);s&&t.markings.removeOne(s.key),e.windowState.windowPosition=void 0,n.setPosition()}e.selectedMarking&&t.boardImages.selectMarking(),n.hideWindow()}}}function Mv(e,t){return function(r){const i=t.isVisible();if(!r){i?e.boardImages.hideWindow():e.boardImages.showWindow();return}const{square:o,squareCoords:s,allowWindowOverflow:l=!1}=r,d=e.boardImages.getWindowPosition();o===d?e.boardImages.hideWindow():e.boardImages.showWindow({square:o,squareCoords:s,allowWindowOverflow:l})}}function xv(e){return function(){const{window:n,windowPosition:r}=e;if(!(!n||n.paletteMode))return r}}function Iv({imagesBaseURL:e,soundsBaseURL:t,paletteMode:n,boardContainerAspectRatio:r}){const i={heightPercent:n?100:50,widthPercent:n?100:40,boardContainerAspectRatio:r,paletteMode:n,elements:[{id:"effects",itemsPerRow:5,effects:[ie.Brilliant,ie.GreatFind,ie.BestMove,ie.Excellent,ie.Inaccuracy,ie.Mistake,ie.Miss,ie.Blunder,ie.Equal,ie.Correct,ie.Interesting,ie.Incorrect,ie.Book,ie.Warning,ie.WinnerWhite]},{frameId:"objective-markers"},{frameId:"emotive-markers",itemsAutoRemove:!0}]},o=`${e}/animated-images`,s=[{id:"objective-markers",imageURL:`${e}/objective-markers.png`,rows:1,itemsPerRow:5,itemsConfiguration:[{name:"star",animatedImageURL:`${o}/star.png`,removalSoundBaseURL:t},{name:"coin",animatedImageURL:`${o}/coin.png`,removalSoundBaseURL:t},{name:"target",animatedImageURL:`${o}/target.png`,removalSoundBaseURL:t},{name:"skull",animatedImageURL:`${o}/skull.png`,removalSoundBaseURL:t},{name:"bomb",animatedImageURL:`${o}/bomb.png`,removalSoundBaseURL:t}]},{id:"emotive-markers",imageURL:`${e}/emotive-markers.png`,rows:17,itemsPerRow:5,itemsConfiguration:["happy","sad","wut","wink","cry","cheeky","meh","bigsmile","cringe","mad","blush","shock","dead","sleepy","tongue","lol","crying","horror","love","nerd","glasses","mustache","kisses","mindblow","stareyes","sick","devil","ghost","scream","facepalm","thumbsup","thumbsdown","worship","wave","clap","knuckles","muscle","donkey","clock","fire","troll","donut","earth","panda","unicorn","shakehands","resign","gameover","bullet","blitz","skewer","fork","pin","fish","trophy","arena","puzzle","computer","scc","tt","tilt","960","doubleexclam","doublequestion","10","1","12","hype","gg","rip","present","gold","stockfish","lc0","komodo","danny","omg","robert","hikaru","anna","alexandra","andrea","levy","eric","aman"]}],l=[{keys:["B"],model:ie.Brilliant},{keys:["G"],model:ie.GreatFind},{keys:["B","E"],model:ie.BestMove},{keys:["G","D"],model:ie.Excellent},{keys:["K"],model:ie.Correct},{keys:["E","Q"],model:ie.Equal},{keys:["I"],model:ie.Interesting},{keys:["D"],model:ie.Inaccuracy},{keys:["M"],model:ie.Mistake},{keys:["L"],model:ie.Blunder},{keys:["W"],model:ie.Incorrect},{keys:["O"],model:ie.Book},{keys:["H"],model:ie.Warning},{keys:["shift","8"],model:ie.WinnerWhite},{keys:["S"],model:{name:"star"}},{keys:["C"],model:{name:"coin"}},{keys:["T"],model:{name:"target"}},{keys:["S","K"],model:{name:"skull"}},{keys:["F"],model:{name:"bomb"}},{keys:["0"],model:{name:"happy",autoRemove:!0}},{keys:["shift","S"],model:{name:"sad",autoRemove:!0}},{keys:["shift","W"],model:{name:"wut",autoRemove:!0}},{keys:["shift","0"],model:{name:"wink",autoRemove:!0}},{keys:["shift","R"],model:{name:"cry",autoRemove:!0}},{keys:["shift","Q"],model:{name:"cheeky",autoRemove:!0}},{keys:["shift","E"],model:{name:"meh",autoRemove:!0}},{keys:["shift","B"],model:{name:"bigsmile",autoRemove:!0}},{keys:["shift","C"],model:{name:"cringe",autoRemove:!0}},{keys:["shift","1"],model:{name:"mad",autoRemove:!0}},{keys:["shift","U"],model:{name:"blush",autoRemove:!0}},{keys:["shift","O"],model:{name:"shock",autoRemove:!0}},{keys:["shift","D"],model:{name:"dead",autoRemove:!0}},{keys:["S","E"],model:{name:"sleepy",autoRemove:!0}},{keys:["shift","P"],model:{name:"tongue",autoRemove:!0}},{keys:["shift","L"],model:{name:"lol",autoRemove:!0}},{keys:["shift","I"],model:{name:"crying",autoRemove:!0}},{keys:["shift","H"],model:{name:"horror",autoRemove:!0}},{keys:["shift","V"],model:{name:"love",autoRemove:!0}},{keys:["shift","N"],model:{name:"nerd",autoRemove:!0}},{keys:["shift","G"],model:{name:"glasses",autoRemove:!0}},{keys:["shift","T"],model:{name:"mustache",autoRemove:!0}},{keys:["shift","K"],model:{name:"kisses",autoRemove:!0}},{keys:["shift","M"],model:{name:"mindblow",autoRemove:!0}},{keys:["shift","Y"],model:{name:"stareyes",autoRemove:!0}},{keys:["S","I"],model:{name:"sick",autoRemove:!0}},{keys:["D","V"],model:{name:"devil",autoRemove:!0}},{keys:["G","H"],model:{name:"ghost",autoRemove:!0}},{keys:["shift","J"],model:{name:"scream",autoRemove:!0}},{keys:["shift","F"],model:{name:"facepalm",autoRemove:!0}},{keys:["arrowup"],model:{name:"thumbsup",autoRemove:!0}},{keys:["arrowdown"],model:{name:"thumbsdown",autoRemove:!0}},{keys:["I","P"],model:{name:"worship",autoRemove:!0}},{keys:["W","V"],model:{name:"wave",autoRemove:!0}},{keys:["L","P"],model:{name:"clap",autoRemove:!0}},{keys:["K","N"],model:{name:"knuckles",autoRemove:!0}},{keys:["M","U"],model:{name:"muscle",autoRemove:!0}},{keys:["D","K"],model:{name:"donkey",autoRemove:!0}},{keys:["L","K"],model:{name:"clock",autoRemove:!0}},{keys:["F","R"],model:{name:"fire",autoRemove:!0}},{keys:["T","R"],model:{name:"troll",autoRemove:!0}},{keys:["N","T"],model:{name:"donut",autoRemove:!0}},{keys:["E","T"],model:{name:"earth",autoRemove:!0}},{keys:["P","N"],model:{name:"panda",autoRemove:!0}},{keys:["U","I"],model:{name:"unicorn",autoRemove:!0}},{keys:["S","H"],model:{name:"shakehands",autoRemove:!0}},{keys:["R","E"],model:{name:"resign",autoRemove:!0}},{keys:["G","M"],model:{name:"gameover",autoRemove:!0}},{keys:["B","U"],model:{name:"bullet",autoRemove:!0}},{keys:["B","T"],model:{name:"blitz",autoRemove:!0}},{keys:["W","E"],model:{name:"skewer",autoRemove:!0}},{keys:["R","R"],model:{name:"fork",autoRemove:!0}},{keys:["I","N"],model:{name:"pin",autoRemove:!0}},{keys:["H","I"],model:{name:"fish",autoRemove:!0}},{keys:["H","Y"],model:{name:"trophy",autoRemove:!0}},{keys:["A","R"],model:{name:"arena",autoRemove:!0}},{keys:["U","L"],model:{name:"puzzle",autoRemove:!0}},{keys:["M","P"],model:{name:"computer",autoRemove:!0}},{keys:["S","C"],model:{name:"scc",autoRemove:!0}},{keys:["T","Y"],model:{name:"tt",autoRemove:!0}},{keys:["T","L"],model:{name:"tilt",autoRemove:!0}},{keys:["9"],model:{name:"960",autoRemove:!0}},{keys:["2"],model:{name:"doubleexclam",autoRemove:!0}},{keys:["3"],model:{name:"doublequestion",autoRemove:!0}},{keys:["J"],model:{name:"10",autoRemove:!0}},{keys:["Q"],model:{name:"1",autoRemove:!0}},{keys:["V"],model:{name:"12",autoRemove:!0}},{keys:["Y"],model:{name:"hype",autoRemove:!0}},{keys:["G","E"],model:{name:"gg",autoRemove:!0}},{keys:["R","I"],model:{name:"rip",autoRemove:!0}},{keys:["P"],model:{name:"present",autoRemove:!0}},{keys:["G","L"],model:{name:"gold",autoRemove:!0}},{keys:["S","T"],model:{name:"stockfish",autoRemove:!0}},{keys:["L","0"],model:{name:"lc0",autoRemove:!0}},{keys:["K","O"],model:{name:"komodo",autoRemove:!0}},{keys:["D","N"],model:{name:"danny",autoRemove:!0}},{keys:["O","M"],model:{name:"omg",autoRemove:!0}},{keys:["R","B"],model:{name:"robert",autoRemove:!0}},{keys:["H","K"],model:{name:"hikaru",autoRemove:!0}},{keys:["N","R"],model:{name:"anna",autoRemove:!0}},{keys:["D","R"],model:{name:"alexandra",autoRemove:!0}},{keys:["E","A"],model:{name:"andrea",autoRemove:!0}},{keys:["L","Y"],model:{name:"levy",autoRemove:!0}},{keys:["E","C"],model:{name:"eric",autoRemove:!0}},{keys:["M","N"],model:{name:"aman",autoRemove:!0}}];return{defaultFrames:s,defaultWindow:i,defaultHotkeys:n?[]:l}}function Rv({api:e,boardImagesDOM:t,imagesBaseURL:n,soundsBaseURL:r,paletteContainer:i}){return function(s={}){var l,d,f,h,g;const m=window.location.href.replace(window.location.search,""),S=!!i,{defaultFrames:P,defaultWindow:I,defaultHotkeys:D}=Iv({imagesBaseURL:(d=(l=s.imagesBaseURL)!=null?l:n)!=null?d:`${m}/static/test`,soundsBaseURL:(h=(f=s.soundsBaseURL)!=null?f:r)!=null?h:`${m}/static/test/sounds`,paletteMode:S,boardContainerAspectRatio:(g=s.boardContainerAspectRatio)!=null?g:1});e.boardImages.reset(),e.boardImages.setFrames(P),e.boardImages.setWindow(I),e.boardImages.setHotkeys(D),i&&(t.resetBoardElement(i),t.showWindow())}}function Ov(e,t){return function(){e.boardImages.reset(),t.getElement().remove()}}function $1(e){return[...e.map(t=>t.toLowerCase())].sort().join("-")}function Nv({hotkeysMap:e,windowState:t,api:n}){return function(i=[]){e.clear(),i.forEach(o=>{const s=$1(o.keys);if(e.has(s))throw new Error(mv(o.keys));e.set(s,o)}),n.boardImages.setWindow(t.window)}}function Lv(e){return function(){return[...e.values()]}}function Dv(e){return function(n){return e.get($1(n))}}function Bv(e,t){return function(r){e.selectedMarking=r,r||t.clearSelection()}}function Fv(e){return function(){return e.selectedMarking}}function Uv(e){return function(){return e}}const Hv=`
<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 19">
  <defs>
    <style>
      .cls-1 {
        opacity: 0.3;
      }

      .cls-2 {
        fill: #f8f8f8;
      }

      .cls-3 {
        fill: #8a8886;
      }
    </style>
  </defs>
  <g>
    <path class="cls-1" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"/>
    <circle class="cls-2" cx="9" cy="9" r="8.5"/>
    <path class="cls-2" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"/>
    <path class="cls-3" d="M13.37,12a.53.53,0,0,1,0,.78l-.59.61a.56.56,0,0,1-.4.17.54.54,0,0,1-.4-.17l-3-3-3,3a.58.58,0,0,1-.4.17.54.54,0,0,1-.39-.17l-.59-.59a.54.54,0,0,1-.17-.4.52.52,0,0,1,.17-.4l3-3-3-3a.52.52,0,0,1-.17-.4.54.54,0,0,1,.17-.4l.59-.59a.56.56,0,0,1,.8,0l3,3,3-3a.58.58,0,0,1,.4-.17.56.56,0,0,1,.4.17l.59.59a.54.54,0,0,1,.17.41.5.5,0,0,1-.17.39l-3,3,3,3Z"/>
  </g>
</svg>
`;function Gv({element:e,elements:t,addCloseButton:n,addTitleElement:r,addHoverElement:i}){const o=document.createElement("div");o.className="board-images__window";const s=document.createElement("div");s.className="board-images__window-body";const l=document.createElement("div");l.className="board-images__close-button";const d=document.createElement("div");d.innerHTML=Hv,l.appendChild(d);const f=document.createElement("div");f.className="board-images__title";const h=t.map(g=>"effects"in g?Vv(g):zv(g,i));return h.forEach(g=>{s.appendChild(g.container)}),o.appendChild(s),e.appendChild(o),r&&e.appendChild(f),n&&e.appendChild(l),{closeButton:n?l:void 0,titleElement:f,domElements:h,windowElement:o}}function Vv(e){const{id:t,effects:n,itemsPerRow:r,emptyItemsPerRow:i=0}=e,o=r+i,s=document.createElement("div");s.className="board-images__effects-container";const l=n.map((d,f)=>{const h=typeof d=="string"?d:d.type,g=document.createElement("div");if(g.className="board-images__effect",typeof d=="object"&&d.title&&g.setAttribute("custom-title",d.title),g.style.width=`${100/o}%`,g.innerHTML=kn({path:Ar[h],size:"100%"}),i>0&&f/r>0&&f%r===0){const m=document.createElement("div");m.className="board-images__break",m.style.width=`${100*(i/o)}%`,s.append(m)}return s.append(g),{container:g,type:h}});return{id:t,container:s,domEffects:l}}function zv(e,t){const{id:n,itemsPerRow:r,rows:i,imageURL:o,emptyItemsPerRow:s=0,itemsAutoRemove:l,titles:d}=e,f=r+s,h=document.createElement("div");h.className="board-images__hover-container",h.style.width=`${100*(r/f)}%`;const g=document.createElement("div");g.className="board-images__hover",g.style.width=`${100/r}%`,g.style.height=`${100/i}%`,g.style.display="none";const m=document.createElement("img");return m.className="board-images__image",m.src=o,m.draggable=!1,h.appendChild(m),t&&h.appendChild(g),{id:n,container:h,imageElement:m,hoverElement:g,itemsPerRow:r,rows:i,itemsAutoRemove:l,titles:d}}function jv({offsetX:e,offsetY:t,itemsPerRow:n,rows:r,width:i,height:o}){const s=i/n,l=o/r,d=ls(e,{min:0,max:i}),f=ls(t,{min:0,max:o});return{xIndex:ls(Math.floor(d/s),{min:0,max:n-1}),yIndex:ls(Math.floor(f/l),{min:0,max:r-1})}}const Z1=-1,Y1=-1;let X1=Z1,Q1=Y1;function J1({clientX:e,clientY:t,pointer:n,type:r,touches:i}){return(r===jr.Touchmove||r===jr.Touchstart)&&i.length>0&&(X1=i[0].clientX,Q1=i[0].clientY),r===jr.Touchend?{x:X1,y:Q1}:n?{x:n.x,y:n.y}:i&&i.length>0?{x:i[0].clientX,y:i[0].clientY}:{x:e??Z1,y:t??Y1}}function ep({itemsPerRow:e,rows:t,imageElement:n,event:r}){const{width:i,height:o}=n;let s,l;if("offsetX"in r)s=r.offsetX,l=r.offsetY;else{const{x:d,y:f}=J1(r);s=d,l=f}return jv({offsetX:s,offsetY:l,itemsPerRow:e,rows:t,width:i,height:o})}function qv({windowElement:e,titleElement:t,domElements:n,elementClickedCallback:r,allowToggling:i,closeButton:o,closeButtonCallback:s}){var l;e.addEventListener("contextmenu",m=>(m.stopPropagation(),m.preventDefault(),!1)),(l=o?.firstChild)==null||l.addEventListener(Ji,m=>{m.stopPropagation(),s?.()});let d;const f=m=>(i&&d?.xIndex===m.xIndex&&d?.yIndex===m.yIndex&&d?.frameId===m.frameId?d=void 0:d=m,d),h=()=>{n.filter(m=>"hoverElement"in m).map(m=>m.hoverElement).forEach(m=>{m&&(m.style.display="none")}),n.filter(m=>"domEffects"in m).map(m=>m.domEffects).forEach(m=>{m.forEach(S=>S.container.classList.remove("selected"))})},g=()=>{t.style.display="none",t.innerHTML=""};n.forEach(m=>{"domEffects"in m?Wv({domElement:m,titleElement:t,hideTitle:g,clearSelection:h,elementClickedCallback:r,allowToggling:i}):Kv({domElement:m,titleElement:t,hideTitle:g,clearSelection:h,elementClickedCallback:r,toggleEmoji:f})})}function Wv({domElement:e,titleElement:t,hideTitle:n,clearSelection:r,elementClickedCallback:i,allowToggling:o}){const{domEffects:s,id:l}=e;s.forEach((d,f)=>{const{container:h,type:g}=d,m=h.getAttribute("custom-title");h.addEventListener(Ji,S=>{if(S.stopPropagation(),o){const P=h.classList.contains("selected");r(),h.classList.toggle("selected",!P)}i({effectsId:l,index:f,type:g})}),m&&(h.addEventListener(Ta,()=>{t.innerHTML=m,t.style.display=""}),h.addEventListener("pointerout",n))})}function Kv({domElement:e,titleElement:t,hideTitle:n,clearSelection:r,elementClickedCallback:i,toggleEmoji:o}){const{container:s,imageElement:l,hoverElement:d,id:f,itemsPerRow:h,rows:g,itemsAutoRemove:m,titles:S=[]}=e;s.addEventListener(Ji,P=>{P.stopPropagation();const{xIndex:I,yIndex:D}=ep({itemsPerRow:h,rows:g,imageElement:l,event:P});if(i({frameId:f,xIndex:I,yIndex:D,autoRemove:m}),d){const be=o({xIndex:I,yIndex:D,frameId:f});r(),be&&(d.style.display="block",d.style.left=`${I/h*100}%`,d.style.top=`${D/g*100}%`)}}),l.addEventListener(Ta,P=>{var I;n();const{xIndex:D,yIndex:be}=ep({itemsPerRow:h,rows:g,imageElement:l,event:P});t.innerHTML=(I=S[D+be*h])!=null?I:"",t.style.display=""}),l.addEventListener("pointerout",n)}function $v(e){return function(n){const{elements:r,elementClickedCallback:i,closeButtonCallback:o,addTitleElement:s=!0,addHoverElement:l=!1}=n,{closeButton:d,titleElement:f,domElements:h,windowElement:g}=Gv({element:e,elements:r,addCloseButton:!!o,addTitleElement:s,addHoverElement:l});qv({windowElement:g,titleElement:f,domElements:h,elementClickedCallback:i,allowToggling:l,closeButton:d,closeButtonCallback:o})}}function Zv(e){return function(){e.classList.remove("board-images--hidden")}}function Yv(e){return function(){e.classList.add("board-images--hidden")}}function Xv(e){return function(n,r){e.style.width=n?`${n}%`:"",e.style.height=r?`${r}%`:""}}function Qv(e){const t="horizontal-overflow";return function(r,i,o){e.classList.contains(t)&&e.classList.remove(t),e.style.top=r?`${r}%`:"",e.style.left=i?`${i}%`:"",o&&e.classList.add(t)}}function Jv(e){return function(){e.innerHTML=""}}function eg(e){return function(n){e.remove(),n.appendChild(e)}}function tg(e){return function(){return!e.classList.contains("board-images--hidden")}}function ng(e){return function(){e.querySelectorAll(".board-images__hover").forEach(n=>{n.style.display="none"}),e.querySelectorAll(".board-images__effect.selected").forEach(n=>{n.classList.remove("selected")})}}function rg(e){const t=n();return{showWindow:Zv(t),hideWindow:Yv(t),setWindow:$v(t),setSize:Xv(t),setPosition:Qv(t),getElement:Uv(t),clearElement:Jv(t),resetBoardElement:eg(t),isVisible:tg(t),clearSelection:ng(t)};function n(){const r=document.createElement("div");return r.className="board-images",r.classList.add("board-images--hidden"),e&&r.classList.add("board-images--palette"),r.addEventListener("pointerdown",i=>{i.stopPropagation()}),r.addEventListener("wheel",i=>{i.stopPropagation()}),r}}function ig({items:e=[],keys:t=[],createKey:n}={}){if(!n&&!t.length)throw new Error("Need to specify at least one key or createKey function");const r=!t.includes("id")&&n?["id",...t]:t,i=r.map(()=>new Map);e.forEach(f=>{s(f)});function o(f){let h;const g=i.find(m=>{let S=!1;const P=r.find(D=>{const be=f[D];return be&&(S=!0),be&&m.has(be)});if(P)return h=f[P],!0;const I=n?.(f);if(!S&&!I)throw new Error("Could not find a key or create a key with passed in parameter");return I&&m.has(I)?(h=I,!0):!1});return h&&g?.get(h)}function s(f){r.forEach((h,g)=>{var m;const S=(m=f[h])!=null?m:n?.(f);S&&i[g].set(S,f)})}function l(){var f;return[...(f=i[0])==null?void 0:f.values()]}function d(){i.forEach(f=>f.clear())}return{find:o,set:s,getAsArray:l,clear:d}}function og({context:e,imagesBaseURL:t,soundsBaseURL:n,showCloseButton:r,paletteContainer:i}){const o=e.api,s=new Map,l=new Map,d=new Map,f=ig({keys:["id","name"],createKey:mc}),h={windowPosition:void 0,window:void 0},g=rg(!!i),m={framesMap:s,markedSquares:l,hotkeysMap:d,shortcuts:f,windowState:h};return S(g);function S(P){const I=Dv(d),D=Lv(d),be=pc(s),Ye=dv({api:o,framesMap:s,shortcuts:f}),Se=fv(f),Ze=hv(f),mt=bv(o,l),zn=_v({api:o,markedSquares:l,framesMap:s,shortcuts:f}),Sn=Av(l),tn=yv(l),Ct=Ev(l,o),Ft=Sv(h),Ln=Tv({state:m,api:o,boardImagesDOM:P}),Zn=wv(o),br=Cv({boardImagesDOM:P,framesMap:s,windowState:h,hotkeysMap:d,shortcuts:f,showCloseButton:r,api:o}),tr=Nv({windowState:h,hotkeysMap:d,api:o}),kr=Pv({windowState:h,api:o,boardImagesDOM:P}),Qn=xv(h),ri=Mv(o,P),Bi=ss(o),Fi=Rv({api:o,boardImagesDOM:g,imagesBaseURL:t,soundsBaseURL:n,paletteContainer:i}),ir=Ov(o,P),wr=Bv(m,P),Hr=Fv(m);return{initDefault:Fi,reset:Bi,destroy:ir,isInitialized:Zn,getFrames:be,setFrames:Ye,getAllMarkingShortcuts:Se,getMarkingShortcut:Ze,setHotkeys:tr,getHotkeys:D,getHotkey:I,mark:zn,unmark:mt,isMarked:Sn,getMarkings:tn,clearMarkings:Ct,selectMarking:wr,getSelectedMarking:Hr,getWindow:Ft,setWindow:br,showWindow:kr,hideWindow:Ln,toggleWindow:ri,getWindowPosition:Qn,dom:P}}}function Ko(e){return function(n,r){return e in n.data&&typeof n.data[e]<"u"&&n.data[e]!==null}}function b0(e){return function(n,r){return r.api.keys.getPressedKeys().includes(e)}}function tp({context:e,squares:t=[],whereOptions:n}){const r=e.api,i=Array.isArray(t)?t:[t],o=n?r.markings.getAllWhere(n):r.markings.getAll();return i.length>0?o.filter(s=>i.includes(s.data.square)):o}function np({getSquares:e,whereOptions:t}){return function(r,i){return tp({context:i,squares:e?.(r,i),whereOptions:t}).length>0}}function y0({getSquares:e,whereOptions:t}){return function(r,i){return tp({context:i,squares:e?.(r,i),whereOptions:t}).length===0}}function E0({getSquares:e}){return function(n,r){const i=e(n,r);if(!i)return!1;const o=Array.isArray(i)?i:[i],s=r.api;return!!o.find(l=>s.boardImages.isMarked(l))}}function Hs(e,t){return t.api.keys.getPressedKeys().length>0}function vc(e,t){return!Hs(e,t)}function A0(e,t){const n=t.api,r=n.keys.getPressedKeys();return!!n.boardImages.getHotkey(r)}function rp(e,t){return!!t.api.boardImages.getWindowPosition()}function ag(e,t){return!t.api.boardImages.isInitialized()}function Ao(e,t){return t.api.boardImages.isInitialized()}function gc(e,t){return!!t.api.boardImages.getSelectedMarking()}function sg({getValue:e,ignoreFirstValue:t=!1}){let n,r=!1;return function(o,s){const l=e(o,s);if(t&&!r)return r=!0,n=l,!1;const d=n!==l;return n=l,d}}function lg(e,t){const{queue:n}=t,r=t.api;return n.add(r.boardImages.hideWindow),!1}function ip({square:e,el:t,renderer:n,boardFlipped:r=!1}){if(!n)return{x:0,y:0};const i=n.getCoordsFromSquare(e,r);return n.name===v.Types.WebGL2D?{x:i.x/t.clientWidth*100+6.25,y:i.y/t.clientHeight*100-6.25}:n.name===v.Types.WebGL3D?{x:i.x/t.clientWidth*100,y:i.y/t.clientHeight*100,centered:!0}:{x:(i.x+100)/800*100,y:i.y/800*100}}function ug({getContainer:e}){return function(n,r){const i=e(n,r);if(!i)return;const{queue:o,renderer:s,options:l}=r,d=r.api,f=d.boardImages.getWindowPosition();if(!f)return;const h=ip({square:f,el:i,renderer:s,boardFlipped:l.flipped});o.add(d.boardImages.showWindow,{square:f,squareCoords:h})}}function op({getContainer:e}){return function(n,r){const i=e(n,r);if(!i)return!0;const{renderer:o}=r,s=r.api;return s.boardImages.initDefault({boardContainerAspectRatio:o?.getBoardContainerAspectRatio()}),s.boardImages.dom.resetBoardElement(i),!0}}function w0({getSquares:e}){return function(n,r){const i=e?.(n,r),{queue:o}=r,s=r.api;return i?o.add(s.boardImages.unmark,i):o.add(s.boardImages.clearMarkings),!1}}function cg({getSquare:e}){return function(n,r){const i=e(n,r);if(!i)return!0;const{queue:o}=r,s=r.api,l=s.keys.getPressedKeys(),d=s.boardImages.getHotkey(l);return d?(o.add(s.boardImages.mark,{square:i,model:d.model}),!1):!0}}function ap({getSquares:e,whereOptions:t}){return function(r,i){const o=e?.(r,i),{queue:s}=i,l=i.api,d=t?l.markings.getAllWhere(t):l.markings.getAll(),f=Array.isArray(o)?o:[o],g=(o?d.filter(m=>f.includes(m.data.square)):d).map(m=>m.key);return g.length?(g.length===1?s.add(l.markings.removeOne,g[0]):g.length>1&&s.add(l.markings.removeMany,g),!1):!0}}function dg({getContainer:e,getSquare:t}){return function(r,i){const o=e(r,i),s=t(r,i);if(!o||!s)return!0;const{queue:l,renderer:d,options:f}=i,h=i.api,g=ip({square:s,el:o,renderer:d,boardFlipped:f.flipped});return l.add(h.boardImages.toggleWindow,{square:s,squareCoords:g}),!1}}function fg({getSquares:e,getMarking:t}){return function(r,i){const o=e(r,i),s=t(r,i);if(!o||!s)return!0;const{queue:l}=i,d=i.api,f={model:s,square:o};return l.add(d.boardImages.mark,f),!1}}function hg(e,t){const{queue:n}=t,r=t.api;return n.add(r.boardImages.selectMarking),!1}function pg(e,t){return e.data}function zi(...e){return function(n,r){const o=e.map(s=>s.includes(".")?s.split(".").reduce((l,d)=>l?.[d],n.data):s.length>0?n.data[s]:n.data).filter(s=>typeof s<"u");if(o.length!==0)return o.length>1?o:o[0]}}function _c(e){return function(n,r){return e??r.el}}function mg(){return function(t,n){return n.api.boardImages.getSelectedMarking()}}const yi="square",vg="move",sp="move.to",lp="move.rookTo",gg="flipped";function _g(e){return[{condition:Wr(xt(Yi),Ko(vg),Ao,E0({getSquares:zi(sp,lp)})),handler:w0({getSquares:zi(sp,lp)})},{condition:Wr(Je(M.InstanceEvents.RendererSet),sg({getValue:pg,ignoreFirstValue:!0}),Ao),handler:op({getContainer:_c(e)})}]}function bg(e){return[{condition:Wr(Je(M.OptionsEvents.Update),Ko(gg),Ao,rp),handler:ug({getContainer:_c(e)})}]}function yg({keyToOpenWindow:e,useLeftClick:t,container:n}){const r=t?M.UserEvents.PointerdownLeft:M.UserEvents.PointerdownRight;return[{condition:Wr(Je(r),Hs,Ko(yi),ag),handler:op({getContainer:_c(n)})},{condition:Wr(Je(r),Hs,Ko(yi),Ao,y0({getSquares:zi(yi),whereOptions:{persistent:!0,types:[Bn,mn]}}),b0(e)),handler:dg({getContainer:_c(n),getSquare:zi(yi)})},{condition:Wr(xt([M.UserEvents.PointerdownLeft,M.UserEvents.PointerdownRight]),vc,Ao,rp),handler:lg}]}function Eg({keyToOpenWindow:e,useLeftClick:t}){const n=t?M.UserEvents.PointerdownLeft:M.UserEvents.PointerdownRight;return[{condition:Wr(Je(n),Hs,Ko(yi),Ao,y0({getSquares:zi(yi),whereOptions:{persistent:!0,types:[Bn,mn]}}),A0),handler:cg({getSquare:zi(yi)})},{condition:Wr(Je(n),Hs,Ko(yi),Ao,E0({getSquares:zi(yi)}),Os(b0(e),A0)),handler:w0({getSquares:zi(yi)})},{condition:Wr(Je(n),Hs,Ko(yi),Ao,np({getSquares:zi(yi),whereOptions:{persistent:!0,types:[Bn]}}),Os(b0(e),A0)),handler:ap({getSquares:zi(yi),whereOptions:{persistent:!0,types:[Bn]}})}]}function Ag(e){const t=e?M.UserEvents.PointerdownLeft:M.UserEvents.PointerdownRight,n=e?M.UserEvents.PointerdownRight:M.UserEvents.PointerdownLeft;return[{condition:Wr(Je(n),Ao,gc),handler:hg},{condition:Wr(Je(t),Ko(yi),vc,Ao,y0({getSquares:zi(yi),whereOptions:{persistent:!0,types:[Bn,mn]}}),gc),handler:fg({getSquares:zi(yi),getMarking:mg()})},{condition:Wr(Je(t),Ko(yi),vc,Ao,E0({getSquares:zi(yi)}),gc),handler:w0({getSquares:zi(yi)})},{condition:Wr(Je(t),Ko(yi),vc,Ao,np({getSquares:zi(yi),whereOptions:{persistent:!0,types:[Bn]}}),gc),handler:ap({getSquares:zi(yi),whereOptions:{persistent:!0,types:[Bn]}})}]}function up({keyToOpenWindow:e=xe.DefaultKeyToOpenWindow,imagesBaseURL:t,soundsBaseURL:n,useLeftClick:r=!0,paletteContainer:i}={}){const{commonBeforeHandlers:o,windowBeforeHandlers:s,commonHandlers:l,windowHandlers:d,paletteModeBeforeHandlers:f}=S(),h=!!i;return{api:P=>og({context:P,imagesBaseURL:t,soundsBaseURL:n,showCloseButton:!h,paletteContainer:i}),beforeState:[...h?f:s,...o],match:[...h?[]:d,...l],name:xe.Plugin.Name,requires:["keys","custom-items","effects","sounds"],create:g,destroy:m};function g(P){P.api.boardImages.dom.resetBoardElement(i??P.el)}function m(P){P.api.boardImages.destroy()}function S(){return{commonBeforeHandlers:Eg({keyToOpenWindow:e,useLeftClick:r}),windowBeforeHandlers:yg({keyToOpenWindow:e,useLeftClick:r,container:i}),commonHandlers:_g(i),windowHandlers:bg(i),paletteModeBeforeHandlers:Ag(r)}}}function cp(){return[k(),G(),Wc(),Kc()]}function bc({exclude:e}={}){const t={[bi.Plugin.Name]:ed,[De.Plugin.Name]:zt,[dr.Plugin.Name]:_i,[Jr.Plugin.Name]:wi,[dt.Plugin.Name]:Ie,[nr.Plugin.Name]:Hn,[Br.Plugin.Name]:oo,[bt.Plugin.Name]:Ea,[de.Plugin.Name]:Ka,[lr.Plugin.Name]:pt,[Xe.Plugin.Name]:C,[Ae.Plugin.Name]:cu,[Q.Plugin.Name]:pu};e&&e.forEach(i=>{delete t[i]});const n=[od,Eu,id],r=[...cp()];return Object.keys(t).forEach(i=>i===bt.Plugin.Name?r.push(t[i](n)):r.push(t[i]())),r}function dp(){return[...bc(),Ki(),di(),X(),Pr()]}function wg(){return[...dp(),yr(),_t(),Ps()]}var a5=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",createAnalysisOverlayPlugin:yr,createArrowKeysPlugin:_i,createArrowsPlugin:wi,createAssetsPlugin:k,createBlinkingHighlightPlugin:Ie,createBoardDisabledPlugin:C,createBoardSizePlugin:G,createCheatDetectionPlugin:Pr,createCoordinatesPlugin:Hn,createCustomItemsPlugin:X,createDebugPlugin:_t,createEffectsPlugin:di,createFadeSetupPlugin:Ki,createFlipBoardPlugin:oo,createHighlightsPlugin:Ea,createHoverSquarePlugin:Ka,createMoveHintsPlugin:cu,createPiecesPlugin:Wc,createRendererErrorCatcherPlugin:Kc,createSoundsPlugin:pu,createTimeControlPlugin:fl,createKeysPlugin:ed,createWebGLContextLostPlugin:Bh,createRecorderPlugin:Ps,createMinimalPlugins:cp,createStandardPlugins:bc,createPremiumPlugins:dp,createKitchenSinkPlugins:wg,createEcoPlugin:Su,createPregamePlugin:hd,createPremovesPlugin:Od,createReportingPlugin:Nd,createMoveListPlugin:n1,createVerticalMoveListPlugin:of,createHorizontalMoveListPlugin:pi,createBoardImagesPlugin:up});const fp=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*((\d|\.)+))?\)$/;function Sg(e){if(e.search("rgb")===-1)return e;const t=e.match(fp);return`#${S0(t[1])}${S0(t[2])}${S0(t[3])}`}function Cg(e){return e.search("rgba")===-1?1:parseFloat(e.match(fp)[4])}function S0(e){return`0${parseInt(e,10).toString(16)}`.slice(-2)}function kg(e,t){return window.getComputedStyle(e,t).backgroundImage}function Pg(e,t){if(!t.themeAssets){const[r,i]=e.split("/").pop().split(".")[0];return C0(r,i)}let n="?";return Object.keys(t.themeAssets.pieces.assets).forEach(r=>{var i;e===`url("${(i=t.themeAssets)==null?void 0:i.pieces.assets[r]}")`&&(n=C0(r[0],r[1]))}),n==="?"&&Object.keys(Pi).forEach(r=>{e===`url("${Pi[r]}")`&&(n=C0(r[0],r[1]))}),n}function C0(e,t){return e==="w"?t.toUpperCase():t}function Tg(e){return{file:e.toLowerCase().charCodeAt(0)-96,rank:Number(e.charAt(1))}}function Mg(e){if(!(!e||!e.file||!e.rank||e.file>8||e.rank>8))return`${String.fromCharCode(96+e.file)}${e.rank.toString()}`}function xg(e,t){return function(r){const i=Object.entries(r).map(([o,s])=>{var l;if(!s||!((l=e.overridableMethods)!=null&&l.includes(o)))return;const d=e[o];return e[o]=s(e,t),function(){e[o]=d}});return function(){i.map(s=>s?.())}}}function Ig({base:e,initialOptions:t}){return function(r){const i=Object.keys(t).reduce((f,h)=>(f[h]=t[h].default,f),{}),o=e({api:r,options:i}),s=xg(o,r);return Object.assign(o,{extendMode:s,getOptions:l,setOption:d});function l(){return i}function d(f,h){var g;if(!((g=t[f])!=null&&g.editable)){hp(f);return}i[f]=h,r.emit(M.OptionsEvents.UpdateMode,Vr(M.OptionsEvents.UpdateMode,{[f]:h}))}}}function Ra(e,t){return function(r={}){const i=Object.keys(r).reduce((o,s)=>{var l;return(l=t[s])!=null&&l.editable?Object.assign(o,{[s]:{default:r[s],editable:!0}}):hp(s),o},t);return Ig({base:e,initialOptions:i})}}function hp(e){console.warn(`${e} is not an editable option in this mode.`)}function pp({api:e,followAlternateLines:t=!1,mv:n}){const{game:r,mutateGame:i}=e.getContext(),o=i(function(){r.moveForward(t,n)});return o?.plyDiff?(r.moveBackward(),!0):!1}function Rg({canAddMovesToMainLine:e,isAtEndOfLine:t,node:n}){var r;const i=fo(n)?(r=n?.ids)==null?void 0:r.line:n?.id;return!e&&t&&i===0}function us(e,t){let n;if(typeof e=="string")n=w.R.sanToObj(e,t);else if("san"in e)if("to"in e)n=e;else{const r=e,{san:i}=r,o=Be(r,["san"]),s=w.R.sanToObj(i,t);n=s!==null?ge(ge({},s),o):null}else if("tcn"in e){const r=e,{tcn:i}=r,o=Be(r,["tcn"]);n=ge(ge({},w.R.decodeTCN(i)[0]),o)}else n=e;return n?ge({animate:!0},n):null}function Og(e){const{api:t}=e,n=t.move;return function(i){const o=us(i,t.getFEN());if(!o)return n(i);const s=t.isAtEndOfLine(),{canAddMovesToMainLine:l}=t.getMode().getOptions();if(pp({api:t,followAlternateLines:!0,mv:o}))return n(i);if(Rg({canAddMovesToMainLine:l,isAtEndOfLine:s,node:t.getRelativeNode()}))return d();return n(i);function d(){return t.createContinuation()?n(i):null}}}var k0;(function(e){(function(t){t.Name="analysis"})(e.Plugin||(e.Plugin={}))})(k0||(k0={}));function Ng(){return{apiOverrides:{move:Og},name:k0.Plugin.Name}}var wo;(function(e){(function(t){t.Analysis="analysis",t.CaptureTheStar="capture-the-star",t.Explorer="exploring",t.GuessTheMove="guess-the-move",t.PassiveObserving="passive-observing",t.Observing="observing",t.Playing="playing",t.Setup="setup"})(e.Types||(e.Types={}))})(wo||(wo={}));function Lg({api:e}){return{isAllowedToMove:t,name:wo.Types.Analysis,plugins:[Ng(),yr()]};function t(){var n;const{canAddMovesToMainLine:r}=e.getMode().getOptions();return r||!!e.getSelectedNode()||((n=e.getLine(0))==null?void 0:n.length)}}const Dg=Ra(Lg,{canAddMovesToMainLine:{default:!0,editable:!0},canInteractWithPieces:{default:!0,editable:!0},canMoveWhenGameIsOver:{default:!0,editable:!1},canModifyExistingMovesOnMainLine:{default:!0,editable:!0}});var mp=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Dg}),yc;(function(e){(function(t){t.Completed="CTSCompleted"})(e.Events||(e.Events={})),function(t){t.Name="captureTheStar"}(e.Plugin||(e.Plugin={}))})(yc||(yc={}));function Bg(e){return function(n){e.config.set("items",n)}}function Fg(e){return function(){var n;return((n=e.getHistorySANs())==null?void 0:n.length)-1||0}}function Ug(e,t){return function(){const r=e.captureTheStar;return{completed:t.status.get("completed")||!1,completedMoveCount:t.status.get("completedMoveCount"),itemsRemaining:r.getNumItemsRemaining(),moveCount:r.getCurrentMoveCount()}}}function Hg(e){return function t(n={}){const{api:r,game:i}=e,o=r.markings,{previousNode:s}=n;let l=[];if(s){const d=i.ids();i.moveBackward(),l=t(),i.selectPosition(d.move,d.line)}else l=o.getAllWhere({types:[mn]});return l}}function Gg(e){return function(){return e.captureTheStar.getItems().map(r=>r.data.square)}}const Ec={noFromSquareOnMoveObj:'Move object has no "from" square.',cannotLoadWithoutItems:"Cannot load without any items.",cannotLoadWithoutPiece:"Cannot load without a piece.",configurationMissingForItem:"Configuration missing for custom item"};function Vg(e,t){const{file:n,rank:r}=oe(e),{file:i,rank:o}=oe(t),s="abcdefgh",l="12345678";if(n===i)return Ac(r,o).map(h=>`${s.charAt(n-1)}${l.charAt(h-1)}`);if(r===o)return Ac(n,i).map(h=>`${s.charAt(h-1)}${l.charAt(r-1)}`);if(Math.abs(i-n)!==Math.abs(o-r))throw new Error("Squares are not on same file, rank, or diagonal");const d=Ac(n,i),f=Ac(r,o);return d.reduce((h,g,m)=>(h.push(`${s.charAt(g-1)}${l.charAt(f[m]-1)}`),h),[])}function Ac(e,t){const[n,r]=[e,t].sort();return Array(r-n-1).fill(void 0).map((i,o)=>n+o+1)}function zg(e){return function(n){const r=e.captureTheStar,{from:i,to:o}=n;if(!i)throw new Error(Ec.noFromSquareOnMoveObj);let s=[];return n.piece.toLowerCase()==="n"?s=[o]:s=[o,...Vg(i,o)],r.getItems({previousNode:!0}).filter(l=>!s.includes(l.data.square))}}function jg(e){return function(){const n=e.captureTheStar;return Object.keys(n.getItems()).length}}function qg(e){return function(){return!!e.status.get("completed")}}function Wg(e,t,n){const r=e?.[n];if(!Pt[n]&&!r)return null;const i={data:{square:t,type:r?Pt.Image:Pt.Star},node:!0,persistent:!0,type:mn,key:`cts-${t}`};return r&&(i.data.image={url:r}),i}function Kg(e,t){return function(r){const{items:i,piece:o}=r,{api:s,game:l,respond:d}=e,f=s.captureTheStar,h=s.markings;if(!Object.keys(i).length)throw new Error(Ec.cannotLoadWithoutItems);if(!o)throw new Error(Ec.cannotLoadWithoutPiece);return s.clearMarkings(),l.load("8/8/8/8/8/8/8/8"),l.put(o,o.square),Object.entries(i).forEach(([g,m])=>{const S=Wg(t.config.get("items"),g,m);if(!S)throw new Error(Ec.configurationMissingForItem);h.addOne(S)}),s.setPlayingAs(o.color),s.setTurn(o.color),f.resetPuzzleStatus(),d(M.APIEvents.Load,{pieces:s.getPieces()})}}function $g(e){return function(){e.status.set("completed",!1),e.status.delete("completedMoveCount")}}function Zg(e,t){return function(){const r=e.captureTheStar;r.getNumItemsRemaining()===0&&!r.isCompleted()&&(t.status.set("completed",!0),t.status.set("completedMoveCount",r.getCurrentMoveCount()),r.emit(yc.Events.Completed,r.getData()))}}function Yg(e){const{api:t}=e,n=(0,w.H)(),r=o();r.config.set("items",{});const i=$g(r);return i(),Ce(ge({configureItems:Bg(r),getCurrentMoveCount:Fg(t),getData:Ug(t,r),getItems:Hg(e),getItemSquares:Gg(t),getNextItems:zg(t),getNumItemsRemaining:jg(t)},n),{isCompleted:qg(r),load:Kg(e,r),resetPuzzleStatus:i,updatePuzzleStatus:Zg(t,r)});function o(){return{config:new Map,status:new Map}}}function Vl(e){return e===ct.ColorsAsNumbers.Black?ct.ColorsAsNumbers.White:ct.ColorsAsNumbers.Black}function Xg(e,t){const n=Vl(t.color)===ct.ColorsAsNumbers.Black?"p":"P",r=t.color===ct.ColorsAsNumbers.Black?t.type:t.type.toUpperCase(),i=new Array(8).fill(void 0).map(()=>new Array(8).fill("."));return i[8-t.rank][t.file-1]=r,e.reduce((o,s)=>{const{file:l,rank:d}=oe(s);return!l||!d||(o[8-d][l-1]=n),o},i).map(o=>o.join("").replace(/(\.+)/g,s=>s.length.toString())).join("/")}function Qg(e,t){return[...new Map(e.map(n=>[n[t],n])).values()]}function Jg(e){const{api:t,game:n}=e,r=t.getLegalMoves;return function(){const o=t.captureTheStar;if(!t.getPlayingAs())return[];const l=r(),d=n.getPieces(!1)[0];if(!d||d.type!=="p")return l;const f=Xg(o.getItemSquares(),d),h=w.R.getLegalMoves(f);return Qg([...l,...h],"san")}}function e3(e){const{api:t}=e,n=t.getMove;return function(i){var o;const s=n(i);return s||((o=t.getLegalMoves().find(l=>l.to===i.to))!=null?o:null)}}function t3(e){const{api:t,game:n}=e,r=t.move;return function(o){if(!t.isAtEndOfLine())return t.selectLineEnd();const s=us(o,t.getFEN());return!s||!s.userGenerated||!("flags"in s)||Io(s)&&s.piece==="p"&&n.put({type:"p",color:Vl(s.color)},s.to),r(o)}}function n3(e){return function(){var n;const{respond:r,game:i,mutateGame:o}=e,s=o(function(){i.moveBackward()});return!s||s.lineDiff===0&&s.plyDiff===0?r(M.APIEvents.MoveBackward,null):((n=s.move)!=null&&n.captured&&(s.move.captured=void 0),r(M.APIEvents.MoveBackward,s))}}function r3(e){return{api:Yg,apiOverrides:{getLegalMoves:Jg,getMove:e3,move:t3,moveBackward:n3},create:t,match:[{condition:xt(Yi),handler:r},{condition:Je(M.APIEvents.Move),handler:n}],name:yc.Plugin.Name};function t(i){const{api:o}=i,s=o.captureTheStar;e&&s.configureItems(e.items)}function n(i,o){const{api:s,queue:l}=o,d=s.captureTheStar,f=s.markings,h=s.getContext().game,g=d.getNextItems(i.data.move);l.add(function(){l.add(function(){f.addMany(g),h.turn(s.getPlayingAs()),d.updatePuzzleStatus()})})}function r(i,o){const{api:s,queue:l}=o,d=s.getPlayingAs();d&&l.add(s.setTurn,d)}}function P0(e){return function(){e.isAtEndOfLine()||e.selectLineEnd()}}function i3({api:e}){return{isAllowedToMove:t,handleIllegalMove:P0(e),name:wo.Types.CaptureTheStar,plugins:[r3()],usePlayingAs:!0};function t(){return!0}}const o3=Ra(i3,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var a3=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:o3});function vp(e){return fo(e)?{line:e.ids.line,move:e.ids.move+1}:{line:0,move:0}}function s3(e){const{api:t}=e,n=t.move;return function(i){if(t.isAtEndOfLine())return n(i);const{line:o,move:s}=vp(t.getRelativeNode());return t.deletePosition(s,o),n(i)}}var T0;(function(e){(function(t){t.Name="exploring"})(e.Plugin||(e.Plugin={}))})(T0||(T0={}));function l3(){return{apiOverrides:{move:s3},name:T0.Plugin.Name}}function u3(){return{isAllowedToMove:e,name:wo.Types.Explorer,plugins:[l3()]};function e(){return!0}}const c3=Ra(u3,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!0,editable:!1}});var d3=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:c3}),$o;(function(e){(function(t){t.Name="guessTheMove"})(e.Plugin||(e.Plugin={})),function(t){t.CancelGuess="CancelGuess",t.GuessConfirmed="GuessConfirmed",t.GuessMade="GuessMade"}(e.APIEvents||(e.APIEvents={})),function(t){t.Correct="#96bc4b",t.Incorrect="#c93430"}(e.Colors||(e.Colors={}))})($o||($o={}));function f3(e){let t=[];return{cancel:n,confirm:r,get:i,getActiveGuess:o,guess:l,reset:d};function n(){const{api:f,respond:h}=e,g=o();g&&(t.pop(),h(M.APIEvents.SetBoardPosition,{pieces:f.getPieces()}),h($o.APIEvents.CancelGuess,g))}function r(f){const{respond:h}=e,g=s();g&&(Object.assign(g,{confirmed:!0,correct:f}),h($o.APIEvents.GuessConfirmed,g))}function i(){return t}function o(){const f=s();return f?.confirmed?void 0:f}function s(){return t[t.length-1]}function l(f){var h,g;const{api:m,respond:S}=e,P=Ce(ge({},f),{confirmed:!1,correct:!1,ids:(g=(h=m.getSelectedNode())==null?void 0:h.ids)!=null?g:{line:0,move:0}});t.push(P),S($o.APIEvents.GuessMade,P)}function d(){t=[]}}function h3(e){const{api:t,game:n,respond:r}=e,i=t.move;return function(d){const f=us(d,t.getFEN());return f?f.userGenerated?s(f):o(f):r(M.APIEvents.IllegalMove)};function o(l){const d=ge({},l),f=t.guessTheMove.getActiveGuess(),h=t.getMove(l);if(!h||!f)return t.isAtEndOfLine()?i(l):t.addMoveToEndOfLine(d);const g=h.color===t.getPlayingAs()&&h.san===f.san;return l.animate=!g,t.reload(),i(l),t.guessTheMove.confirm(g)}function s(l){if(t.isLegalMove(l)){const d=n.move(l);if(!d)return r(M.APIEvents.IllegalMove);t.guessTheMove.guess(d);const f=ge({},t.getPieces());return n.undo(),r(M.APIEvents.SetBoardPosition,{pieces:f})}return r(M.APIEvents.IllegalMove)}}const gp="gtm";function _p(e,t){var n;const{api:r,options:i}=t,o=(n=r.guessTheMove)==null?void 0:n.getActiveGuess();if(!i||!i.allowMarkings||!o)return[];const s=[];if(o.from){const d=oa({color:i.premoveHighlightColor,opacity:i.premoveHighlightOpacity,square:o.from,type:gp});s.push(d)}const l=oa({color:i.premoveHighlightColor,opacity:i.premoveHighlightOpacity,square:o.kingTo||o.to,type:gp});return s.push(l),s}function p3(){let e=!1;return{api:f3,apiOverrides:{move:h3},beforeState:[{condition:Je(M.UserEvents.PointerdownRight),handler:n}],destroy:r,match:[{condition:xt(Yi),handler:o},{condition:xt($o.APIEvents),handler:t},{condition:Je($o.APIEvents.GuessConfirmed),handler:i}],name:$o.Plugin.Name};function t(s,l){var d,f,h;if(e)return;const{api:g}=l;(d=g.highlights)==null||d.addModule(_p),((h=(f=g.highlights)==null?void 0:f.getModules())!=null?h:[]).find(m=>m.name==="getGuessTheMoveHighlights")&&(e=!0)}function n(s,{api:l,queue:d}){return l.guessTheMove.getActiveGuess()?(d.add(l.guessTheMove.cancel),!1):!0}function r(s){var l;const{api:d}=s;(l=d.highlights)==null||l.removeModule(_p)}function i(s,l){const{api:d}=l,{correct:f,ids:h}=s.data;d.updateNode(h,{customColor:f?$o.Colors.Correct:$o.Colors.Incorrect})}function o(s,l){const{api:d,queue:f}=l;s.type===M.APIEvents.Load&&d.guessTheMove.reset();const h=d.getTurn();f.add(d.setPlayingAs,h)}}function m3({api:e}){return{isAllowedToMove:t,handleIllegalMove:P0(e),name:wo.Types.GuessTheMove,plugins:[p3()],usePlayingAs:!0};function t(){return e.guessTheMove&&e.isAtEndOfLine()&&!e.guessTheMove.getActiveGuess()}}const v3=Ra(m3,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var g3=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:v3});function _3(e){const{api:t,respond:n}=e,r=t.load;return function(o,s){const l=t.observing;return l.setCachedPGN(""),l.isAnalyzing()&&(l.clearCachedIds(),n(co.APIEvents.AnalysisEnd)),r(o,s)}}function Oa(e){return!!(e&&"san"in e&&e.san==="--")}function b3({move:e,api:t,game:n}){const r=t.observing,i=n.ids();n.selectPosition(0,0),n.createVariation(),n.move(e);const o=t.getRawLines().length-1;n.promoteVariation(o,0),n.deletePosition(0,o);const{playSounds:s}=t.getOptions();s&&t.setOptions({playSounds:!1});const l=r.getCachedIds();l&&r.clearCachedIds(),t.load({pgn:t.getPGN()}),s&&t.setOptions({playSounds:!0}),l&&r.setCachedIds(l.move,l.line),t.selectNode(i.line,i.move)}function y3(e){const{api:t,respond:n,game:r}=e,i=t.move;return function(d){const f=t.observing.getCachedPGN();f&&t.load({pgn:f});const h=us(d,t.getFEN());return h?h.userGenerated?o(h):s(h):i(d)};function o(l){var d;const f=t.observing,{move:h,line:g}=r.ids(),m=f.isAnalyzing(),S=Bl(g);((d=t.getLine(0))==null?void 0:d.length)===0&&r.move("--");const P=t.getNodeByIds({line:0,move:0});if(Oa(P)&&Oa(t.getSelectedNode())&&t.selectNode(0,-1),Oa(P)&&"san"in l){const be=w.R.sanToObj(l.san,t.getFEN());Object.assign(l,be),l.san=""}S&&!pp({api:t,followAlternateLines:!0,mv:l})&&t.isAtEndOfLine()&&t.createContinuation();const I=i(l);if(I?.type!==M.APIEvents.Move)return I;const D=Bl(r.ids().line);return S&&!D&&!m&&(f.setCachedIds(h,g),n(co.APIEvents.AnalysisStart)),I}function s(l){const d=t.observing,f=Oa(t.getNodeByIds({line:0,move:0})),h=t.getLine(0);if(f&&h?.length===1){b3({move:l,api:t,game:r});return}return d.isAnalyzing()||!t.isAtEndOfLine()?t.addMoveToEndOfLine(l,0):i(l,!1)}}function E3({api:e}){const t=e.moveForward;return function(r,i){return t(o(),i);function o(){return r??(e.observing.isAnalyzing()?void 0:!1)}}}function A3(e){const{api:t}=e;return function(r,i){const o=t.observing;if(!o.isAnalyzing())return;if(Oa(t.getNodeByIds({line:0,move:0}))){const l=t.getPGN();t.load({pgn:"*"}),o.setCachedPGN(l);return}const s=o.getCachedIds();r?t.load(r,i):t.load({pgn:t.getPGN()}),s&&t.selectNode(s.line,s.move)}}function w3(e){let t,n="";return{clearCachedIds:r,getCachedIds:i,isAnalyzing:o,restorePosition:A3(e),setCachedIds:s,setCachedPGN:l,getCachedPGN:d};function r(){t=void 0}function i(){return t}function o(){return!!t}function s(f,h){t={move:f,line:h}}function l(f){n=f}function d(){return n}}function S3({data:e}){return e.lineDiff!==void 0&&e.lineDiff!==0}function C3(e,t){return!bp(e,t)}function bp(e,{api:t}){return t.observing.isAnalyzing()}function zl(e,t){const{api:n}=t;return Oa(n.getNodeByIds({line:0,move:0}))}function M0(e,t){const{api:n}=t;return!Oa(n.getNodeByIds({line:0,move:0}))}function x0(e,t){const{api:n}=t;return Oa(n.getSelectedNode())}function yp(e,t){var n,r;const{api:i}=t,o=i.getSelectedNode();return((n=o?.ids)==null?void 0:n.line)===0&&((r=o?.ids)==null?void 0:r.move)===-1}function Ep(e,t){const{api:n}=t,r=n.getSelectedNode();return!!(r&&r.ids.line!==0)}function Ap(e,t){const{api:n}=t,r=n.getLine(1);return!r||r.length===0}function k3(e,t){var n;const{data:r}=e;return((n=r.line)==null?void 0:n.atMoveNode)===0}function I0(e,t){const{api:n,queue:r}=t;if(n.observing.isAnalyzing())return;r.add(function(){const s=i();s&&(n.observing.setCachedIds(s.move,s.line),n.getContext().respond(co.APIEvents.AnalysisStart))});function i(){var o;const s=(o=n.getSelectedNode())==null?void 0:o.ids;if(!s)return;if(s.line===0)return s;let l=n.getLine(s.line);for(;l.parentId&&l.parentId>1;)l=n.getLine(l.parentId);return{line:l.parentId,move:l.atMoveNode}}}function P3(e,t){const{api:n,queue:r}=t;r.add(function(){n.selectNode(1,0)})}function T3(e,t){const{api:n,queue:r}=t,i=n.getLine(1);if(i){const o=Math.max(...i.map(s=>s.moveNumber));r.add(function(){n.selectNode(1,o)})}}function wp(e,t){const{api:n}=t,r=n.observing;n.deletePosition(0,0),r.setCachedPGN(""),r.restorePosition()}function M3(e,t){const{api:n,queue:r}=t;r.add(function(){n.selectNode(0,-1)})}function x3(e,t){const{api:n}=t,r=n.observing,{overlayInAnalysisMode:i}=n.getOptions(),o=r.isAnalyzing();o!==i&&n.setOptions({overlayInAnalysisMode:o})}function Sp(e,t){const{api:n}=t;n.observing.restorePosition()}function I3(e,t){const{api:n,queue:r}=t;r.add(function(){n.selectNode(0,0)})}function R3(e,t){var n,r,i,o,s;const{api:l}=t,d=l.observing,f=(n=l.getSelectedNode())==null?void 0:n.ids;if(!f)return;if(f.line===0){d.setCachedIds(f.move,f.line);return}let h=(r=l.getLine(f.line))==null?void 0:r.id;if(!h)return;for(;(i=l.getLine(h))!=null&&i.parentId;){const S=(o=l.getLine(h))==null?void 0:o.parentId;if(typeof S=="number"&&(h=S),!S)break}const g=l.getLine(h);let m=(s=g?.atMoveNode)!=null?s:0;g?.[0].isContinuation||(m-=1),d.setCachedIds(m,0)}function O3(){return[{condition:xt([co.APIEvents.AnalysisStart,co.APIEvents.AnalysisEnd]),handler:x3},{condition:Wr(xt(Yi),bp),handler:R3},{condition:Wr(Je(M.APIEvents.ResetToMainLine),zl),handler:wp},{condition:Wr(Je(M.APIEvents.ResetToMainLine),M0),handler:Sp},{condition:Wr(Je(M.APIEvents.DeletePosition),zl,Ap),handler:wp},{condition:Wr(Je(M.APIEvents.DeletePosition),zl,k3),handler:I3},{condition:Wr(Je(M.APIEvents.DeletePosition),M0,Ap),handler:Sp},{condition:Wr(Je(M.APIEvents.SelectNode),x0),handler:M3},{condition:Wr(Je(M.InstanceEvents.ModeChanged),Ep),handler:I0},{condition:Wr(Je(M.APIEvents.SelectNode),M0,Ep),handler:I0},{condition:Wr(Je(M.APIEvents.MoveForward),C3,S3),handler:I0},{condition:Wr(Je(M.APIEvents.MoveForward),zl,Os(x0,yp)),handler:P3},{condition:Wr(Je(M.APIEvents.SelectLineEnd),zl,Os(x0,yp)),handler:T3}]}function N3(){return{api:w3,apiOverrides:{load:_3,move:y3,moveForward:E3},create:e,match:O3(),name:co.Plugin.Name};function e(t){const{api:n}=t;n.setOptions({overlayInAnalysisMode:!1})}}function L3(){return{isAllowedToMove:e,name:wo.Types.Observing,plugins:[yr(),N3()]};function e(){return!0}}const D3=Ra(L3,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var B3=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:D3});function F3(e){const{api:t}=e;return function(){if(!t.isAtEndOfLine())if(t.getMode().getOptions().canModifyExistingMovesOnMainLine){const{line:r,move:i}=vp(t.getRelativeNode());t.deletePosition(i,r)}else t.selectLineEnd()}}function U3(e){const{api:t}=e,n=t.move,r=F3(e);return function(o){return t.isGameOver()&&t.getMode().getOptions().canMoveWhenGameIsOver&&t.setResult(ct.Results.None),r(),n(o)}}var R0;(function(e){(function(t){t.Name="playing"})(e.Plugin||(e.Plugin={}))})(R0||(R0={}));function H3(){return{apiOverrides:{move:U3},name:R0.Plugin.Name}}function G3({api:e}){return{handleIllegalMove:P0(e),isAllowedToMove:t,name:wo.Types.Playing,plugins:[H3()],overridableMethods:["isAllowedToMove"],usePlayingAs:!0};function t(){return Pu({api:e,canMoveWhenNotPlayerTurn:!1,modeOptions:e.getMode().getOptions()})}}const V3=Ra(G3,{canAddMovesToMainLine:{default:!0,editable:!0},canMoveWhenGameIsOver:{default:!1,editable:!0},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!0}});var z3=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:V3});function j3(){return{isAllowedToMove:e,name:wo.Types.PassiveObserving};function e(){return!1}}const q3=Ra(j3,{canAddMovesToMainLine:{default:!1,editable:!1},canInteractWithPieces:{default:!1,editable:!1},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var Cp=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:q3}),O0;(function(e){(function(t){t.DropPiece="DropPiece",t.MovePiece="MovePiece",t.RemovePiece="RemovePiece"})(e.Events||(e.Events={})),function(t){t.Name="setup"}(e.Plugin||(e.Plugin={}))})(O0||(O0={}));function W3(e){return function({piece:n,square:r}){const{api:i,game:o}=e;return o.remove(r),o.put(n,r),i.setGameDetails({FEN:o.fen()}),i.reload()}}function K3(e){return function({from:n,piece:r,to:i}){const{api:o,game:s}=e;return s.remove(n),s.remove(i),s.put(r,i),o.setGameDetails({FEN:s.fen()}),o.reload()}}function $3(e){return function(n){const{api:r,game:i}=e;return i.remove(n),r.setGameDetails({FEN:i.fen()}),r.reload()}}function Z3(e){return{dropPiece:W3(e),movePiece:K3(e),removePiece:$3(e)}}function Y3(){return function(t){return t}}function X3(e){const{api:t}=e;return function(r){const i=us(r,t.getFEN());if(!i)return;const{setup:o}=t;let s;"color"in i&&i.color&&"drop"in i&&i.drop?s={color:i.color,type:i.drop}:"from"in i&&i.from&&(s=t.getPiece(i.from)),s&&("from"in i&&i.from&&i.to?o.movePiece({from:i.from,piece:s,to:i.to}):i.to?o.dropPiece({piece:s,square:i.to}):"from"in i&&i.from&&o.removePiece(i.from))}}function Q3(){return{api:Z3,apiOverrides:{getMove:Y3,isLegalMove:()=>!0,move:X3},name:O0.Plugin.Name}}function J3(){return{isAllowedToMove:e,name:wo.Types.Setup,plugins:[Q3()]};function e(){return!0}}const e_=Ra(J3,{canAddMovesToMainLine:{default:!1,editable:!1},canDropOffBoard:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1},canDropPiecesContinuously:{default:!0,editable:!0}});var kp=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:e_});function jl({move:e,startingMoveNumber:t}){if(!e)return null;const{moveNumber:n}=e,r=n%2===0&&e.color===ct.ColorsAsNumbers.Black||n%2!==0&&e.color===ct.ColorsAsNumbers.White,i=t+Math.floor(n/2)+(r&&e.color===ct.ColorsAsNumbers.White?1:0);return Ce(ge({},e),{ply:e.ids.move+1,wholeMoveNumber:i})}function Pp({baseTimeDs:e,incrementDs:t,lastTimeDs:n,currentTimeDs:r}){if(!r)return es;const i=n??e,o=r-t,s=i-o;return Math.max(s,es)}function N0({api:e,node:t}){const n=e.getLine(0),r=e.timeControl.get();if(!n||!r)return null;const i=t.time,o=Tu({api:e,node:t}),s=o?.time,{baseTime:l,increment:d}=r;return Pp({baseTimeDs:Vo(l),incrementDs:Vo(d),lastTimeDs:s,currentTimeDs:i})}function t_(e){const t=Math.floor(e%36e3/600),n=Math.floor(e%36e3%600)/10;return`${Math.floor(e/36e3)}:${t<10?"0":""}${t}:${n<10?"0":""}${n}`}function n_({api:e,node:t,clk:n}){const{line:r,move:i}=t.ids,o=e.getContext().game;t.commands||(t.commands={}),o.updateNode({commands:Object.assign(t.commands,{clk:n===null?n:t_(n)})},i,r)}function Tp({context:e,time:t}){const{api:n,game:r}=e,i=r.moveDetails();i.time=t,n_({api:n,node:i,clk:t});const o=N0({api:n,node:i});o&&Ja({api:n,node:i,timestamp:o})}function r_(e){return function(n,r=0){var i;const{api:o,game:s,mutateGame:l,respond:d}=e,{ids:f}=(i=o.getSelectedNode())!=null?i:{ids:{move:-1,line:0}},{move:h,line:g}=f;s.selectLineEnd(r);const m=us(n,o.getFEN()),S=m!==null?l(function(){s.move(m,!1),m.time&&Tp({context:e,time:m.time})}):null;return s.selectPosition(h,g),S===null?d(M.APIEvents.IllegalMove,{fen:s.fen(),move:m}):(S.move=jl({move:S.move,startingMoveNumber:s.startingMoveNumber()})||void 0,d(M.APIEvents.AddMove,{listMove:S.move}))}}function i_(e){return function(){const{api:n,respond:r}=e;return n.isGameOver()?null:(n.setResult(ct.Results.Draw),r(M.APIEvents.DrawAgreed))}}function o_(e){return function(n){const{respond:r}=e,i={data:n,type:er};return r(M.APIEvents.BlinkHighlight,[i])}}function Mp(e){const{move:t,followContinuations:n=!0,steps:r=1,context:i}=e,{mutateGame:o,game:s}=i,l=s.ids(),d=o(function(){s.moveForward(n,t)});let f=d?.plyDiff===1;if(r>1&&f)for(let g=1;g<r&&(f=s.moveForward(n),!!f);g++);const h=s.ids();return s.selectPosition(l.move,l.line),{firstStepData:d,startIds:l,endIds:h,success:f}}function a_(e){return function(n){const{move:r,followContinuations:i,steps:o}=n??{},{success:s}=Mp({context:e,move:r,followContinuations:i,steps:o});return s}}function xp(e){return e.inThreefoldRepetition()||e.in50MoveRule()}function s_(e){return function(){const{api:n,game:r}=e;return n.isGameOver()?null:xp(r)?(n.setResult(ct.Results.Draw),e.respond(M.APIEvents.DrawClaimed)):null}}const wc={ClearMarkings:Sc("clearMarkings","api.markings.removeAll/removeAllWhere/removeMany/removeOne"),Mark:Sc("mark","api.markings.addOne/addMany"),ToggleMarking:Sc("toggleMarking","api.markings.toggleOne/toggleMany"),Unmark:Sc("unmark","api.markings.removeOne/removeMany")};function Sc(e,t){return`The "${e}" method is deprecated and will be removed in v2.0.0. Please use the ${t} methods instead.`}function l_(e){return function(n,r={}){console.warn(wc.ClearMarkings);const{api:i,respond:o}=e,s=i.markings,l=n?.map(d=>d==="square"?"highlight":d);return s.removeAllWhere(Ce(ge({},r),{types:l})),o(M.APIEvents.ClearMarkings)}}function u_(e){return function(){const{api:n,game:r,respond:i}=e,o=r._getPos();if("initial"in o)return null;r.createVariation(),r.move(o);const s=n.getRelativeNode();return i(M.APIEvents.CreateContinuation,{node:s})}}function c_(e){return function(n,r){const{api:i,game:o,respond:s}=e,l=i.getRawLines()[r];return o.deletePosition(n,r),r===0&&i.getResult()!==ct.Results.None&&i.setResult(ct.Results.None),s(M.APIEvents.DeletePosition,{ids:{line:r,move:n},line:l,pieces:i.getPieces()})}}function d_(e){const t={};return function(r,i){const o=Object.entries(i).map(([s,l])=>{if(l)return t[s]||(t[s]={extensions:{},original:e.api[s]}),e.api[s]=l(e),t[s].extensions[r]=l,function(){delete t[s].extensions[r],e.api[s]=t[s].original,Object.keys(t[s].extensions).map(f=>e.api[s]=t[s].extensions[f](e))}});return function(){o.map(l=>l&&l())}}}function f_(e){return e.inCheckmate()||!!e.isVariantWin()||!!e.isBughouseWin()}function h_(e){return function(){const{api:n,game:r}=e;let i=ct.Results.None;const o=xp(r);return f_(r)?i=r.turn()===ct.ColorsAsNumbers.Black?ct.Results.White:ct.Results.Black:(o&&n.getOptions().autoClaimDraw||!o&&r.inDraw())&&(i=ct.Results.Draw),i}}function p_(e){return function(){return e}}function m_(e){return function(){const{game:n}=e;return n.history({toCurrent:!0,verbose:!0})}}function v_(e){return function(){const{game:n}=e;return n.fen()}}function g_(e){return function(){return w.R.gameFingerprints({game:e.game,analysis:!0})}}function __(e){return function(){const{game:n}=e;return n.headers()}}function L0(e){return e===-1}function b_(e){return function(n=!1){const{game:r}=e,i=r._getPos();return i.ids&&i.ids.line===0&&L0(i.ids.move)&&i.fen?[i.fen]:r.history({toCurrent:!n,verbose:!0}).map(o=>o.fen)}}function y_(e){return function(){const{game:n}=e;return n.history(!1)}}function E_(e){return function(){var n;const{api:r}=e,i=((n=r.premoves)==null?void 0:n.getQueue())||[],o=w.R.createGame({pgn:r.getPGN(),analysis:!0,timestamps:r.times.get()||r.timestamps.get()||void 0});if(!o)throw new Error("Unable to create JCE game copy");return o.premove.queue.push(...i),o}}function A_(e){return function(){const{game:n}=e;return n.history(!0).slice(-1)[0]}}function w_(e){return function(){const{game:n}=e;return w.R.getLegalMoves({game:n})}}function S_(e){return function(n){return Lr(e.api.getLegalMoves().filter(r=>typeof n>"u"||r.from===n).map(r=>r.to))}}function C_(e){function t(n){const{game:r}=e,i=r.startingMoveNumber(),o=e.api.getRawLines()[n];if(!o){if(n===0)throw new Error("Expected a main line");return}return o.forEach((s,l)=>{const d=jl({move:s,startingMoveNumber:i});o[l]=d}),o}return t}function k_(e){const t={[ct.Node.Marking.Types.Arrow]:{},[ct.Node.Marking.Types.CustomItem]:{},[ct.Node.Marking.Types.Effect]:{},[ct.Node.Marking.Types.Square]:{}};return e.map(r=>{var i;return ge({markingType:r.type==="highlight"?"square":r.type,key:(i=r.data.square)!=null?i:`${r.data.from}${r.data.to}`,color:Ti.Default},r.data)}).reduce((r,i)=>{const{key:o,markingType:s}=i;return r[s][o]=i,r},t)}function P_(e){return function(){const{api:n}=e,r=n.markings;return k_(r.getAll())}}function T_(e){return function(){const{game:n}=e;return n.material()}}function M_(e){return function(n){const{game:r}=e;if(n.to===null)return null;let i=r.getMove(n);return i===null&&(Object.assign(n,{promotion:"q"}),i=r.getMove(n)),i&&(i=r.moveDetails(i)),i}}function x_(e){return function(n){const{api:r,game:i}=e,o=r.getRawLines()[n.line];return!o||n.move===-1?null:jl({move:o[n.move],startingMoveNumber:i.startingMoveNumber()})}}function I_(e,t){return t.ids.line-e.ids.line}function Ip(e){const{moveNumber:t}=e;return typeof t<"u"?t:-1}function R_(e,t){return Ip(t)-Ip(e)}function O_(e){if(!(e.flags!==ct.Move.Flags.EPCapture||!e.from))return`${e.to.slice(0,1)}${e.from.slice(-1)}`}function D0(e){const t=Ce(ge({},e),{EPCapturedSquare:O_(e)});return e.rookFrom&&e.rookTo&&(t.rookMove={animate:!0,from:e.rookFrom,to:e.rookTo}),t}function N_(e){return function(n,r){const{api:i,game:o}=e,s=r??o._getPos(),l=n??o._getPos(-1,0),d={};return d.plyDiff=R_(l,s),d.lineDiff=I_(l,s),d.plyDiff===-1?d.move=D0(Ce(ge({},n),{animate:!0})):d.plyDiff===1?(d.animate=!0,d.move=D0(Ce(ge({},s),{animate:!0}))):d.pieces=i.getPieces(),d}}function L_(e){return function(){const{game:n}=e;return n.ids()}}function D_(e){return function(){const{game:n}=e;return Ht(n.getPieces(!0))}}function B_(e){return function(n={}){const{game:r}=e;return r.pgn(Ce(ge({},n),{useResultHeader:!0}))}}function F_(e){return function(n){const{game:r}=e;return r.get(n)}}function U_(e){return function(n,r){const{game:i}=e;return i._getPos(n,r)}}function H_(e){return function(n){const r=e.api.getPGN();return w.R.getPositionDetails({pgn:r},n)}}function G_(e){return function(n=[]){const{api:r}=e,i=ct.JCEVariantTypes[r.getVariant()],o=w.R.getPositionInfo({game:e.game,analysis:!0},n,{variant:i});return typeof o=="object"?Ce(ge({},o),{gameOver:r.isGameOver()||o.gameOver,draw:r.getResult()===ct.Results.Draw||o.draw}):!1}}function V_(e){return function(){const{game:n}=e;return n._lines()}}function z_(e){return function(n=0){const{game:r}=e,i=ge({},r.ids());i.move+=n;const o=e.api.getRawLines()[i.line];return L0(i.move)?o:jl({move:o[i.move],startingMoveNumber:r.startingMoveNumber()})}}function j_(e){return function(){const{game:n}=e;return n.headers().Result}}function q_(e){return function(){const{api:n,game:r}=e,i=r.ids();if(L0(i.move))return null;const o=n.getRawLines()[i.line];return jl({move:o[i.move],startingMoveNumber:r.startingMoveNumber()})}}function W_(e){return function(){const{game:n}=e;return w.R.encodeTCN(n.history(!0))}}function K_(e){return function(){const{game:n}=e;return n.turn()}}const $_={"3-check":ct.Variants.ThreeCheck,Bughouse:ct.Variants.Bughouse,Chess:ct.Variants.Chess,Chess960:ct.Variants.Chess960,Crazyhouse:ct.Variants.Crazyhouse,"King of the Hill":ct.Variants.KingOfTheHill};function Z_(e){return function(){var n;const{api:r}=e,i=r.getHeaders().Variant;return i&&(n=$_[i])!=null?n:ct.Variants.Chess}}function Y_(e){return function(){const{game:n}=e,r=n.ids();return e.api.getRawLines()[r.line].length-1===r.move}}function X_(e){return function(){const{game:n}=e;if(n.inCheck()){const r=e.api.getPieces();return r.keys().filter(i=>{const o=r.get(i);return o.type==="k"&&o.color===n.turn()})[0]}return!1}}function Q_(e){return function(){const{api:n}=e;return n.getResult()!=="*"}}function J_(e){return function(n){const{game:r}=e;return r.getMove(n)!==null}}function e2(e,t){if(t&&e){const n=Vo(e.baseTime),r=Vo(e.increment);return t.map((i,o)=>typeof i!="number"?i:Pp({baseTimeDs:n,incrementDs:r,lastTimeDs:o<=1?void 0:t[o-2],currentTimeDs:i}))}return t}function t2(e){let t=e;return Object.keys(Yr).reverse().forEach(n=>{t=t.replace(new RegExp(`\\${n}`,"gm"),Yr[n])}),t}function n2(e){return function({fen:n,moves:r,pgn:i,times:o,timestamps:s,timeControl:l,variant:d=ct.Variants.Chess,pieces:f},h){const{api:g,game:m,respond:S}=e;let P=!1;if(i){const Ye=t2(i);P=m.loadPgn(Ye)}else n&&(P=m.load(n,d));(r||r==="")&&(P=m.loadMoves(r,ge({autoPromote:!0},h)));const I=g.getLine(0),D=o?e2(l||g.timeControl.get(),o):s;if(D&&I&&I.forEach((Ye,Se)=>{const Ze=D[Se];Ze!==void 0&&Ja({api:g,node:Ye,timestamp:Ze})}),l&&g.timeControl.set(l),!P)throw new hi({code:ai.BadData,data:{fen:n,pgn:i},message:"Unable to load with provided data."});const be=g.getResult();return g.setResult(be===ct.Results.None?g.getCalculatedResult():be),S(M.APIEvents.Load,Ce(ge(ge({},w.R.getPositionDetails({game:m,skipValidation:!0})),w.R.getPositionInfo({analysis:!0,game:m})),{line:I,pieces:f??g.getPieces(),variant:d}))}}function B0(e,t={}){const[n,r]=Object.entries(e)[0],{node:i,persistent:o}=t;return $a(r).map(s=>{const l={data:s,node:i,persistent:o,type:n==="square"?er:n};return Ce(ge({},l),{key:N(l)})})}function r2(e){return function(n,r,i){var o,s;console.warn(wc.Mark);const{api:l}=e,d=l.markings,f=B0(n,{node:(o=i?.node)!=null?o:r,persistent:(s=i?.persistent)!=null?s:!0});return d.addMany(f),Vr(M.APIEvents.Mark,f)}}function i2(e={}){let t=s(e);return{add:n,clear:r,get:i,remove:o};function n(l,...d){let f=t;d.forEach(h=>{h in f||(f[h]={}),f=f[h]}),Object.assign(f,l)}function r(l){l?t[l]={}:t=s(e)}function i(){return s(t)}function o(...l){let d=t;const f=l.length-1;l.forEach((h,g)=>{h in d&&g!==f&&(d=d[h])}),delete d[l[f]]}function s(l){return JSON.parse(JSON.stringify(l))}}function o2(e){return function(n,r=!0){const{api:i,game:o,mutateGame:s,respond:l}=e,d=us(n,i.getFEN()),f=d!==null?s(function(){let g;if("san"in d?g=o.move(d.san||d,r):typeof n=="object"&&"tcn"in n?g=o.loadMoves(n.tcn.slice(0,2),{atCurrent:!0,method:"merge"}):g=o.move(d,r),!g)return null;d.time&&Tp({context:e,time:d.time})}):null;return f===null?l(M.APIEvents.IllegalMove,{fen:o.fen(),move:n}):(f.result&&i.setResult(f.result),f.move&&d&&(Object.assign(f.move,{animate:d.animate,userGenerated:d.userGenerated,userGeneratedDrop:d.userGeneratedDrop}),f.move=D0(f.move)),l(M.APIEvents.Move,f))}}function a2(e){return function(){const{respond:n,game:r,mutateGame:i}=e,o=i(function(){r.moveBackward()});return!o||o.lineDiff===0&&o.plyDiff===0?n(M.APIEvents.MoveBackward,null):n(M.APIEvents.MoveBackward,o)}}function s2(e){return function(n,r){const{respond:i,api:o,game:s}=e,{move:l,followContinuations:d,steps:f}=l2(n,r);if(f<1)return null;const{firstStepData:h,success:g,endIds:m}=Mp({context:e,move:l,followContinuations:d,steps:f});return f===1||h?.plyDiff!==1?(s.selectPosition(m.move,m.line),i(M.APIEvents.MoveForward,h)):g?o.selectNode(m.line,m.move):i(M.APIEvents.MoveForward,null)}}function l2(e,t){var n;let r={},i;typeof e=="object"?r=e:i=e;const{move:o,followContinuations:s,steps:l}=r;return{move:o??t,followContinuations:(n=s??i)!=null?n:!0,steps:l??1}}function u2(e){return function(n,r){const{game:i,respond:o}=e;return i.moveVariation(n,r)?o(M.APIEvents.MoveVariation):null}}function c2(e,t){return function(r){const i=e.moveDetails(),o=t.getCalculatedResult();if(r()===null)return null;const l=e.moveDetails(),d=t.getCalculatedResult(),f=t.getNodeDiffData(i,l);o!==d&&Bl(l?.ids.line)&&(f.result=d);const{line:h,move:g}=e.ids();return f.linesReordered=h!==0&&g===0&&e.reorderLines(),f}}function Rp(e){return Object.keys(e).reduce((t,n)=>(e[n]!==ct.EmptyPGNHeaders.Value&&e[n]!==ct.EmptyPGNHeaders.Date&&(t[n]=e[n]),t),{})}const d2={trans:f2,transChoice:h2};function f2(e,t,n){return e}function h2(e,t,n,r){return`${t}`}function p2(e){return function(n){const{api:r,game:i,respond:o}=e,s=Vl(n),l=(0,w.T)(ts(s)),d=r.getHeaders()[l];r.setResult(s===ct.ColorsAsNumbers.Black?ct.Results.Black:ct.Results.White),i.header({Termination:d2.trans("%username% won on time",{"%username":d})});const f=Ce(ge({},Rp(i.header())),{color:n});return o(M.APIEvents.OutOfTime,f)}}function m2(e){const t={};return function(o,s){const l=Object.entries(s);return l.forEach(([d,f])=>{let h=t[d];h||(t[d]={methodName:d,original:e.api[d],current:e.api[d],before:[],after:[],instead:[],extensions:{}},h=t[d],e.api[d]=n(d));const g=m=>{h[m.run].push(Ce(ge({id:o},m),{handler:m.handler(e)})),h[m.run].sort((S,P)=>(S.order||0)-(P.order||0))};Array.isArray(f)?f.forEach(m=>{g(m)}):typeof f=="object"?g(f):typeof f=="function"&&(h.extensions[o]=f,h.current=f(r(h)))}),function(){l.forEach(([f])=>{const h=t[f];delete h.extensions[o];const g=Object.values(h.extensions)[0];h.current=g?g(r(h)):h.original,["before","after","instead"].forEach(m=>{h[m]=h[m].filter(S=>S.id!==o)})})}};function n(i){const o=t[i],s=(l,...d)=>o[l].filter(f=>f.conditions?Array.isArray(f.conditions)?f.conditions.every(h=>!!h(e,...d)):!!f.conditions(e,...d):!0);return(...l)=>{var d;const f=s("before",...l),h=(d=s("instead",...l)[0])==null?void 0:d.handler,g=f.reduce((I,D)=>{const be=D.handler(...I);return D.changeArgs?be:I},l);let m;return h?m=h(...g):m=o.current(...g),s("after",m,...g).reduce((I,D)=>D.handler(I,...g),m)}}function r(i){return Ce(ge({},e),{api:Ce(ge({},e.api),{[i.methodName]:i.original})})}}function v2(e){return function(){const{api:n,game:r,respond:i}=e;return i(M.APIEvents.Reload,{holdSelectedPiece:!0,pieces:Ht(r.getPieces(!0)),variant:n.getVariant()})}}function g2(e){let t=ct.ColorsAsNumbers.White,n=!1;return{getPlayingAs:r,setPlayingAs:i,usePlayingAs:o};function r(){return n?t:void 0}function i(s){if(s===t)return null;const{respond:l}=e;return t=s,l(M.APIEvents.SetPlayingAs,s)}function o(s){n=s||!1}}function _2(e){return function(n,r){const{game:i,respond:o}=e;return i.promoteVariation(n,r)?o(M.APIEvents.PromoteVariation):null}}const b2="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";function y2(e){return function(){const{api:n,respond:r}=e;return n.setResult(ct.Results.None),n.load({fen:b2}),r(M.APIEvents.ResetGame)}}function E2(e){return function(n){const{api:r,respond:i}=e;if(r.isGameOver())return null;const o=n===ct.ColorsAsNumbers.White?ct.Results.Black:ct.Results.White;return r.setResult(o),i(M.APIEvents.GameResigned,o)}}function A2(e){return function(){const{api:n,game:r,respond:i}=e;return r.resetToMainLine(),i(M.APIEvents.ResetToMainLine,{pieces:n.getPieces()})}}function w2(e){return function(n,r){const i=Vr(n,r);return e.emit(n,i),i}}function S2(e){return function(n){const{api:r,game:i,mutateGame:o,respond:s}=e,l=o(function(){i.selectLineEnd(n)});return l&&(l.pieces=r.getPieces()),s(M.APIEvents.SelectLineEnd,l)}}function C2(e){return function(){const{api:n,game:r,mutateGame:i,respond:o}=e,s=i(function(){r.selectLineStart()});return s&&(s.pieces=n.getPieces()),o(M.APIEvents.SelectLineStart,s)}}function k2(e){return function(n,r){const{api:i,game:o,respond:s}=e,l=o.moveDetails();o.selectPosition(r,n);const d=o.moveDetails(),f=i.getNodeDiffData(l,d);return f.plyDiff===0&&f.lineDiff===0?null:(f.lineDiff!==0&&(f.pieces=i.getPieces()),s(M.APIEvents.SelectNode,f))}}function P2(e){return function(n){const{game:r,respond:i}=e,o=Rp(r.header(n));return i(M.APIEvents.UpdatePGNHeaders,o)}}function T2(e){return function(n){const{api:r}=e;return r.setGameDetails({Result:n})}}function M2(e){return function(n){const{game:r,respond:i}=e;return r.turn()===n?null:(r.turn(n),i(M.APIEvents.TurnSet,n))}}function x2(e){return function(n,r,i){var o,s;console.warn(wc.ToggleMarking);const{api:l}=e,d=l.markings,f=B0(n,{node:(o=i?.node)!=null?o:r,persistent:(s=i?.persistent)!=null?s:!0});return d.toggleMany(f),Vr(M.APIEvents.Mark,f)}}function I2(e){return function(){const{api:n}=e,r=n.getSelectedNode();return r?n.deletePosition(r.ids.move,r.ids.line):null}}function R2(e){return function(n,r){const{game:i,respond:o}=e;return i.updateNode(r,n.move,n.line),o(M.APIEvents.NodeUpdated,{changes:r,ids:n,node:i._getPos(n.move,n.line)})}}function O2(e){return function(n,r){const{game:i,respond:o}=e;return i.updateLineComment(n,r),o(M.APIEvents.LineCommentUpdated,{comment:n,lineId:r})}}function N2(e){return function(n,r,i){var o,s;console.warn(wc.Unmark);const{api:l}=e,d=l.markings,f=B0(n,{node:(o=i?.node)!=null?o:r,persistent:(s=i?.persistent)!=null?s:!0});return d.removeMany(f.map(h=>h.key)),Vr(M.APIEvents.Unmark,f)}}function Op(e){return Array.isArray(e)&&Array.isArray(e[0])?e[0]:e}function L2(e){return function(n){const r=w.R.createGame(Ce(ge({timestamps:n.times||n.timestamps||void 0},n),{analysis:!0,autoPromote:!0}));if(!r)return;const{api:i}=e;let{times:o,timestamps:s}=n;return n.variant===ct.Variants.Bughouse&&(o=Op(o),s=Op(s)),i.load({pgn:r.pgn({useResultHeader:!0}),variant:n.variant,times:o,timestamps:s,premoves:r.premove.queue&&r.premove.queue.length>0?r.premove.queue:void 0})}}function D2(e){return function(){const n=e.api.getHeaders().TimeControl;if(!n||n===yt.Header.Null||n.includes(yt.Header.Unset)||n.includes(yt.Header.TimePerMove))return null;const[r,i]=n.split(yt.Header.Separator).map(o=>Math.round(parseFloat(o)*1e3));return{baseTime:r,increment:i||0}}}function B2(e){const{baseTime:t,increment:n}=e;return(t+40*(n||0))/1e3}const s5={baseTime:3e5,increment:0},F2=1800,U2=6e3;function H2(e){return function(){const{api:n}=e,r=n.timeControl.get();if(r){const i=B2(r);if(i<F2)return yt.Types.Bullet;if(i>U2)return yt.Types.Rapid}return yt.Types.Blitz}}function G2(e){return function(n){const{api:r}=e;if(n===null)return r.setGameDetails({TimeControl:yt.Header.Null});const{baseTime:i,increment:o}=n,s=i/1e3,l=o/1e3;return r.setGameDetails({TimeControl:l?`${s}+${l}`:`${s}`})}}function V2(e){return{get:D2(e),getType:H2(e),set:G2(e)}}function Np(e,t){if(e===null)return null;let n;switch(t){case ht.Units.Milliseconds:n=e*100;break;case ht.Units.Seconds:n=e*10;break;case ht.Units.Deciseconds:default:n=e;break}return n}function z2(e,t){let n;switch(t){case ht.Units.Milliseconds:n=e/100;break;case ht.Units.Seconds:n=e*10;break;case ht.Units.Deciseconds:default:n=e;break}return Math.round(n)}function Lp(e,t){return e===null?null:Math.max(es,z2(e,t))}function j2(e){return{get:t,set:r,setMany:i};function t(o,{filtered:s=!0}={},l=ht.Units.Deciseconds){var d;const{api:f}=e,h=(d=f.getLine(0))==null?void 0:d.map(Sl);return o!==void 0?h[o]&&Np(h[o],l):(s?h.filter(m=>m!==void 0):h).map(m=>Np(m,l))}function n(){return t(void 0,{filtered:!1})}function r(o,s,l=ht.Units.Deciseconds){var d;const{api:f,respond:h}=e,{getLine:g}=f,m=(d=g(0))==null?void 0:d[s];if(!m)return null;const S=Lp(o,l);return S===void 0?null:(Ja({api:f,node:m,timestamp:S}),h(M.APIEvents.NodeUpdated,{changes:{timestamp:S,node:m}}))}function i(o=[],s=ht.Units.Deciseconds){const{api:l,respond:d}=e,f=o.length===0?n().map(()=>null):o;return l.getRawLines()[0].forEach((h,g)=>{if(f[g]===void 0)return;const m=Lp(f[g],s);m!==void 0&&Ja({api:l,node:h,timestamp:m})}),d(M.APIEvents.LineUpdated)}}function q2(e){return function(n){var r;const{api:i}=e,o=i.getLine(0);return n!==void 0?(r=o[n])==null?void 0:r.time:o.map(s=>s.time)}}function W2(e){return function(n=[]){const{api:r,respond:i}=e;return r.getRawLines()[0].forEach((o,s)=>{n[s]!==void 0&&(!o.time&&n[s]&&(o.time=n[s]),r.timestamps.set(N0({api:r,node:o}),s))}),i(M.APIEvents.LineUpdated)}}function K2(e){return function(n,r){var i;const{api:o,respond:s}=e,{getLine:l}=o,d=(i=l(0))==null?void 0:i[r];return d?(d.time||(d.time=n),o.timestamps.set(N0({api:o,node:d}),r),s(M.APIEvents.NodeUpdated,{changes:{time:n,node:d}})):null}}function $2(e){return{get:q2(e),set:K2(e),setMany:W2(e)}}function Z2(e=100){const t=(0,w.H)(),n=[];let r=Z.Levels.Debug;const i={[Z.Levels.None]:0,[Z.Levels.Error]:1,[Z.Levels.Debug]:2};return Ce(ge({},t),{clear:o,get:s,log:l,setLogLevel:d});function o(){n.length=0}function s(f){return f?n.filter(h=>Object.entries(f).every(([g,m])=>h[g]===m)):n}function l({code:f,data:h,level:g=Z.Levels.Debug,message:m}){if(i[g]>i[r])return;n.length===e&&n.shift();const S={code:f,data:h,level:g,message:m,timestamp:Date.now()};n.push(S),t.emit(Z.Events.EntryAdded,S)}function d(f){r=f}}function Y2({game:e,logger:t,options:n,eventEmitter:r}){const i=e||w.R.createGame(Ce(ge({},n),{analysis:!0,autoPromote:!0}));if(!i)throw new hi({code:ai.BadData,data:n,message:"Error creating game from createAPI"});const o=r||(0,w.H)(),s=i2({arrow:{},customItem:{},effect:{},square:{}}),l={},d=c2(i,l),f=w2(o),h={api:l,emitter:o,game:i,markingCache:s,mutateGame:d,respond:f};return Object.assign(h.api,g()),h.api;function g(){return Ce(ge(Ce(ge({addMoveToEndOfLine:r_(h),agreeDraw:i_(h),blinkSquare:o_(h),canMoveForward:a_(h),claimDraw:s_(h),clearMarkings:l_(h),createContinuation:u_(h),createGame:L2(h)},g2(h)),{deletePosition:c_(h)}),o),{extendAPI:d_(h),overrideAPI:m2(h),getCalculatedResult:h_(h),getContext:p_(h),getCurrentFullLine:m_(h),getFEN:v_(h),getFingerprints:g_(h),getHeaders:__(h),getHistoryFENs:b_(h),getHistorySANs:y_(h),getJCEGameCopy:E_(h),getLastMove:A_(h),getLegalMoves:w_(h),getLegalMovesForSquare:S_(h),getLine:C_(h),getMarkings:P_(h),getMaterial:T_(h),getMove:M_(h),getNodeByIds:x_(h),getNodeDiffData:N_(h),getNodeIds:L_(h),getPGN:B_(h),getPiece:F_(h),getPieces:D_(h),getPosition:U_(h),getPositionDetails:H_(h),getPositionInfo:G_(h),getRawLines:V_(h),getRelativeNode:z_(h),getResult:j_(h),getSelectedNode:q_(h),getStartingMoveNumber:h.game.startingMoveNumber,getTCN:W_(h),getTurn:K_(h),getVariant:Z_(h),isAtEndOfLine:Y_(h),isCheck:X_(h),isGameOver:Q_(h),isLegalMove:J_(h),load:n2(h),logger:t||Z2(),mark:r2(h),move:o2(h),moveBackward:a2(h),moveForward:s2(h),moveVariation:u2(h),outOfTime:p2(h),promoteVariation:_2(h),reload:v2(h),resetGame:y2(h),resetToMainLine:A2(h),resign:E2(h),selectLineEnd:S2(h),selectLineStart:C2(h),selectNode:k2(h),setGameDetails:P2(h),setResult:T2(h),setTurn:M2(h),timeControl:V2(h),times:$2(h),timestamps:j2(h),toggleMarking:x2(h),undo:I2(h),unmark:N2(h),updateLineComment:O2(h),updateNode:R2(h)})}}function Dp(e={}){const t=e;return{get:n,set:r};function n(i){return i?t[i]:t}function r(i){Object.assign(t,i)}}function X2({params:e,run:t}){const n=Zt(!1),r=ge({queue:n,reset:i,run:t,setMode:o,setRenderer:s,state:Dp()},e);return r.reset(),r;function i(){r.queue=Zt(!1),r.state=Dp()}function o(l){r.mode=l}function s(l){r.renderer=l}}function Q2(e){return Object.values(M.APIEvents).includes(e.type)}function J2(e){return[M.APIEvents.AddMove,M.APIEvents.BlinkHighlight,M.APIEvents.ClearMarkings,M.APIEvents.Mark,M.APIEvents.LineUpdated,M.APIEvents.NodeUpdated,M.APIEvents.Unmark,M.APIEvents.UpdatePGNHeaders].includes(e)}const e6={anyAPIEvent:({UpdateParams:e})=>(e.cancelMarkingStartSquare(),K.States.Idle),[M.UserEvents.PointerdownLeft]:({UpdateParams:e})=>(e.cancelMarkingStartSquare(),K.States.Idle),[M.UserEvents.Pointerup]:({context:e,data:{keyPressed:t,square:n},params:{markingStartSquare:r},UpdateParams:i})=>{const{api:{markings:o},queue:s}=e;if(n&&r){const l=r===n?o.factory.buildStandardAnalysisHighlight(n,t):o.factory.buildStandardArrow(r,n,t);s.add(o.toggleOne,l)}return i.cancelMarkingStartSquare(),K.States.Idle}};function t6(e){return{cancelMarkingStartSquare:t,cancelPromotion:n,deselectPiece:r,dragPiece:i,dropPiece:o,resetElevatedState:s,selectPiece:l,setMarkingStartSquare:d,showPromotionArea:f};function t(){e.markingStartSquare=void 0}function n(){e.promotionMove=void 0}function r(){e.selectedPiece=void 0}function i(h,g){e.draggingPiece=g,e.draggingCoords=h}function o(){e.draggingPiece=void 0,e.draggingCoords=void 0}function s(){e.draggingPiece=void 0,e.draggingCoords=void 0,e.promotionMove=void 0,e.selectedPiece=void 0}function l(h){e.selectedPiece=h}function d(h){e.markingStartSquare=h}function f(h){e.promotionMove=ge({},h)}}const n6={[M.UserEvents.PointerdownLeft]:({context:e,data:{coords:t,square:n},UpdateParams:r})=>{const{api:{getPieces:i,markings:o},mode:{getOptions:s},options:l,queue:d,renderer:f,state:h}=e;if(n&&!l.disableUserMarkings&&d.add(o.removeAllWhere,{node:!0,persistent:!1,types:[Qe,Bn,er]}),!l.enabled||!s().canInteractWithPieces||!i().isDefined(n))return K.States.Idle;if(l.moveMethod===pr.MoveMethods.Click){const S=f?.getCoordsFromSquare(n,l.flipped);if(typeof S>"u")throw new hi({code:ai.BadData,message:`getCoordsFromSquare returned undefined for ${n}`});return r.dragPiece(S,n),h.set({hideHoverSquare:!0}),f?.dragPiece({coords:S,square:n},e),K.States.PieceDragging}r.dragPiece(t,n);const m=t||f?.getCoordsFromSquare(n,l.flipped);return f?.dragPiece({coords:m,square:n},e),K.States.PieceDragging},[M.UserEvents.PointerdownRight]:({context:e,data:{square:t},UpdateParams:n})=>{const{options:r}=e;if(!(!r.enabled||r.disableUserMarkings))return n.setMarkingStartSquare(t),K.States.AddingMarkings}};function Bp({api:e,move:t,plyDiff:n,pieceSquare:r}){var i;const o=r&&((i=e.getPieces().getCollection()[r])==null?void 0:i.color);return!t||n!==1||!o||o===t.color&&!t.userGenerated?!0:t.from===r||t.to===r}const r6={anyAPIEvent:({context:e,data:{holdSelectedPiece:t,move:n,plyDiff:r},params:{draggingPiece:i},UpdateParams:o})=>{const{renderer:s}=e;return i&&!t&&Bp({api:e.api,move:n,pieceSquare:i,plyDiff:r})?(o.resetElevatedState(),s?.dropPiece(i,e),K.States.Idle):K.States.PieceDragging},[M.UserEvents.MousedownRight]:({context:e,params:{draggingPiece:t},UpdateParams:n})=>{const{renderer:r}=e;if(!t)throw new hi({code:ai.BadData,message:"Attempted to pointerdown on a dragging piece but dragging piece is null or undefined"});return n.dropPiece(),n.deselectPiece(),r?.dropPiece(t,e),K.States.Idle},[M.UserEvents.Pointermove]:({context:e,data:{coordsInsideBoard:t},params:{draggingPiece:n},UpdateParams:r})=>{const{renderer:i}=e;if(!n)throw new hi({code:ai.BadData,message:"Attempted to drag a piece but draggingPiece is null or undefined"});return r.dragPiece(t,n),i?.dragPiece({coords:t,square:n},e),K.States.PieceDragging},[M.UserEvents.Pointerup]:({context:e,data:{keyPressed:t,square:n},params:{draggingPiece:r,selectedPiece:i},UpdateParams:o})=>{var s;const{api:{getMove:l,getPiece:d,getTurn:f,isCheck:h,move:g,playSound:m},mode:S,options:P,queue:I,renderer:D}=e;if(!r)throw new hi({code:ai.BadData,message:"Attempted to pointerup on a dragging piece but dragging piece is null or undefined"});if(e.options.test){const Ze=e.el.querySelector(".dragging");Ze?.setAttribute("data-test-dragging","false"),Ze?.removeAttribute("dragging")}if(r===n)return o.dropPiece(),D?.dropPiece(r,e),i===n||P.moveMethod===pr.MoveMethods.DragOnly?(o.deselectPiece(),K.States.Idle):(o.selectPiece(r),K.States.PieceSelected);i&&o.deselectPiece();const be={from:r,to:n},Ye=l(be),Se=S.isAllowedToMove()&&Ye?Ce(ge({},Ye),{animate:!1,userGenerated:!0,userGeneratedDrop:!0}):!1;if(!Se){o.dropPiece(),S.handleIllegalMove&&I.add(S.handleIllegalMove,be);const Ze=h();let mt=!1;return((s=d(r))==null?void 0:s.color)===f()&&Ze&&(P.playSounds&&I.add(m,Q.BoardSounds.Illegal),mt=Ze),D?.illegalMove(mt,e),D?.dropPiece(r,e),P.moveMethod===pr.MoveMethods.DragOnly?(o.deselectPiece(),K.States.Idle):(o.selectPiece(r),K.States.PieceSelected)}return hu(Se)?!P.autoPromote||t==="alt"?(o.dragPiece({},r),o.showPromotionArea(Se),D?.dragPiece({square:r,toSquare:Se.to},e),D?.openPromotionWindow(Se,e),K.States.PromotionAreaShowing):(o.dropPiece(),D?.dropPiece(Se.to,e),I.add(g,Ce(ge({},Se),{promotion:ct.Piece.Types.Queen})),K.States.Idle):(o.dropPiece(),n===null&&S.getOptions().canDropOffBoard?D?.removePiece(r,e):D?.dropPiece(n,e),I.add(g,Se),K.States.Idle)}},i6={anyAPIEvent:({context:e,data:{holdSelectedPiece:t,move:n,plyDiff:r},params:{selectedPiece:i},UpdateParams:o})=>!t&&Bp({api:e.api,move:n,pieceSquare:i,plyDiff:r})?(o.resetElevatedState(),K.States.Idle):K.States.PieceSelected,[M.UserEvents.PointerdownLeft]:({context:e,data:{coords:t,keyPressed:n,square:r},params:{selectedPiece:i},UpdateParams:o})=>{const{api:{getMove:s,getPieces:l,move:d},mode:{isAllowedToMove:f},options:h,queue:g,renderer:m,state:S}=e;if(!i)throw new hi({code:ai.BadData,message:"Attempted to interact with a selectedPiece but selectedPiece is null or undefined"});if(r===i){const Ye=h.moveMethod===pr.MoveMethods.Drag||h.moveMethod===pr.MoveMethods.DragOnly?t:m?.getCoordsFromSquare(r,h.flipped)||t;return o.dragPiece(Ye,i),h.moveMethod===pr.MoveMethods.Click&&S.set({hideHoverSquare:!0}),m?.dragPiece({coords:Ye,square:i},e),K.States.PieceDragging}const P={from:i,to:r},I=l(),D=s(P),be=f()&&D?Ce(ge({},D),{userGenerated:!0}):!1;if(!be){if(o.deselectPiece(),!I.isDefined(r))return K.States.Idle;if(h.moveMethod===pr.MoveMethods.Click){const Ye=m?.getCoordsFromSquare(r,h.flipped)||t;return o.dragPiece(Ye,r),S.set({hideHoverSquare:!0}),m?.dragPiece({coords:Ye,square:r},e),K.States.PieceDragging}return o.dragPiece(t,r),m?.dragPiece({coords:t,square:r},e),K.States.PieceDragging}return hu(be)?!h.autoPromote||n==="alt"?(o.deselectPiece(),o.dragPiece({},i),o.showPromotionArea(be),m?.dragPiece({square:i,toSquare:be.to},e),m?.openPromotionWindow(be,e),K.States.PromotionAreaShowing):(o.deselectPiece(),g.add(d,be,Ce(ge({},be),{promotion:ct.Piece.Types.Queen})),K.States.Idle):(o.deselectPiece(),g.add(d,be),K.States.Idle)},[M.UserEvents.PointerdownRight]:({context:e,data:{square:t},UpdateParams:n})=>{const{options:r}=e;if(!(!r.enabled||r.disableUserMarkings))return n.deselectPiece(),n.setMarkingStartSquare(t),K.States.AddingMarkings}};function Cc({context:e,params:{draggingPiece:t},UpdateParams:n}){const{renderer:r}=e;return n.dropPiece(),n.cancelPromotion(),r?.dropPiece(t,e),r?.closePromotionWindow(e),K.States.Idle}const o6={anyAPIEvent:e=>e.type===M.APIEvents.Move?K.States.PromotionAreaShowing:Cc(e),[M.BoardEvents.PromotionPiecePointerdown]:({context:e,data:{piece:t},params:{draggingPiece:n,promotionMove:r},UpdateParams:i})=>{const{api:{move:o},queue:s,renderer:l}=e;return i.dropPiece(),i.cancelPromotion(),l?.dropPiece(n,e),l?.closePromotionWindow(e),r&&s.add(o,{animate:!1,flags:r.flags,from:r.from,piece:ct.Piece.Types.Pawn,promotion:t,to:r.to,userGenerated:!0}),K.States.Idle},[M.BoardEvents.PromotionAreaClosePointerdown]:Cc,[M.UserEvents.PointerdownLeft]:Cc,[M.UserEvents.PointerdownRight]:Cc},Gs={createUpdateParams:t6,getCurrentState:()=>K.States.Idle,getParams:()=>({draggingCoords:void 0,draggingPiece:void 0,markingStartSquare:void 0,promotionMove:void 0,selectedPiece:void 0}),states:{[K.States.AddingMarkings]:e6,[K.States.PieceDragging]:r6,[K.States.Idle]:n6,[K.States.PromotionAreaShowing]:o6,[K.States.PieceSelected]:i6}};function a6(){const e=Gs.getParams(),t=Gs.createUpdateParams(e);let n=Gs.getCurrentState();const r=[In.Events.Tick];return function(s,l){if(r.includes(s.type))return;const{state:d}=l;d.set({draggingPiece:e.draggingPiece,machineState:n,promotionMove:e.promotionMove,selectedPiece:e.selectedPiece});const f=Q2(s)&&!J2(s.type)?"anyAPIEvent":s.type;if(!Gs.states[n]||!Gs.states[n][f]){d.set({machineState:n});return}const h=Gs.states[n][f]({context:l,data:s.data,params:e,UpdateParams:t,type:s.type}),g=n;if(n=h||n,g!==n&&(n===K.States.PieceDragging?document.onselectstart=()=>!1:g===K.States.PieceDragging&&(document.onselectstart=null)),!i())throw{data:{draggingPiece:e.draggingPiece,machineState:n,oldState:g,selectedPiece:e.selectedPiece},error:new hi({code:ai.InvalidStateMachine,message:"The machine parameters and state do not match up."})};d.set({draggingPiece:e.draggingPiece,machineState:n,selectedPiece:e.selectedPiece})};function i(){return n===K.States.Idle?!e.draggingPiece&&!e.selectedPiece:n===K.States.PieceDragging?!!e.draggingPiece:n===K.States.PieceSelected?!e.draggingPiece&&!!e.selectedPiece:!0}}function s6(e,t){if(!e.beforeState)return!0;let n=!0;return e.beforeState.forEach(r=>{l6(r,t)===!1&&(n=!1)}),n}function l6(e,t){if(e.condition(...t))return e.handler(...t)}function Fp(e,t){if(!e.match)return;e.match.forEach(r=>n(r,t));function n(r,i){r.condition(...i)&&r.handler(...i)}}function u6(e){return e.reduce((t,n)=>(n.afterRender?t.afterRender.push(n):t.beforeRender.push(n),t),{beforeRender:[],afterRender:[]})}function c6({params:e,plugins:t}){const n=X2({params:e,run:s}),r=a6();return{getContext:i,getMode:o,run:s,setMode:l,setRenderer:d};function i(){return n}function o(){return n.mode}function s(h){const{api:{logger:g}}=n;g.log({code:M.LogCodes.Event,data:h}),n.reset();const m=t.get();f(h,m)&&r(h,n);const{beforeRender:P,afterRender:I}=u6(m);try{P.forEach(D=>Fp(D,[h,n])),n.queue.flush(),I.forEach(D=>Fp(D,[h,n])),n.queue.flush(),g.log({code:M.LogCodes.State,data:n.state.get()})}catch(D){throw g.log({code:M.LogCodes.State,data:Ce(ge({},D.data),{event:h,queue:n.queue,state:n.state.get()}),level:Z.Levels.Error}),D}}function l(h){n.setMode(h)}function d(h){n.setRenderer(h)}function f(h,g){return g.every(m=>s6(m,[h,n]))}}function kc(e){return e.altKey?_r.Alt:e.ctrlKey?_r.Ctrl:e.shiftKey?_r.Shift:_r.None}function Up(e){return e.touches!==void 0}function cs(e){return!Up(e)&&e.which===3}function Hp(e){setTimeout(e)}function d6({el:e,getPointerPosition:t,options:n,run:r}){const i=d0(d);return{handleDocumentPointerdown:o,handlePointerdown:s,handlePointermove:i,handlePointerup:f};function o(h){const g=cs(h)?M.UserEvents.PointerdownRight:M.UserEvents.PointerdownLeft,m=Vr(g);return m.data={square:null},r(m)}function s(h){h.stopPropagation(),document.addEventListener(Ta,i),document.addEventListener(rs,f);const g=cs(h)?M.UserEvents.PointerdownRight:M.UserEvents.PointerdownLeft,m=Vr(g);return m.data=Ce(ge({},t({el:e,event:h,flipped:n.flipped})),{keyPressed:kc(h)}),Hp(function(){document.addEventListener(jr.Mousedown,l,{once:!0})}),r(m)}function l(h){const g=cs(h)?M.UserEvents.MousedownRight:M.UserEvents.MousedownLeft,m=Vr(g);return m.data=Ce(ge({},t({el:e,event:h,flipped:n.flipped})),{keyPressed:kc(h)}),r(m)}function d(h){const g=Vr(M.UserEvents.Pointermove);g.data=Ce(ge({},t({el:e,event:h,flipped:n.flipped})),{keyPressed:kc(h)}),r(g)}function f(h){document.removeEventListener(jr.Mousedown,l),document.removeEventListener(Ta,i),document.removeEventListener(rs,f);const g=Vr(M.UserEvents.Pointerup);return g.data=Ce(ge({},t({el:e,event:h,flipped:n.flipped})),{keyPressed:kc(h)}),r(g)}}var F0;(function(e){(function(t){t.CreateFailure="CreateFailure"})(e.LogCodes||(e.LogCodes={}))})(F0||(F0={}));function Gp(e){return(Array.isArray(e)?e:[e]).map(n=>{var r;return`${n.name} (requires: ${(r=n.requires)==null?void 0:r.join(", ")})`}).join(", ")}function f6(e,t=new Map){return!e||e.every(n=>t.has(n))}function h6(e,t=new Map){return Vp(e,t,new Map)}function Vp(e,t,n){if(e.size===0)return n;const r=e.size,i=new Map([...t.entries(),...n.entries()]);return e.forEach(o=>{f6(o.requires,i)&&(n.set(o.name,o),e.delete(o.name))}),r===e.size?(n.clear(),n):Vp(e,t,n)}function p6(e,t){if(e.length===0)return[];const n=new Map(e.map(o=>[o.name,o])),r=new Map(t.map(o=>[o.name,o])),i=h6(n,r);if(i.size===0){const o=Gp(e);throw new Error(`Required plugins do not exist: ${o}`)}return[...i.values()]}function m6(e=[],t){const n=ic();return n.addMany(e),{add:i,addMany:i,get:n.getAll,has:n.has,remove:o,setCreatePluginContext:n.setContext};function r(s){const l=n.getContext();if(!l)return;const{api:d,apiOverrides:f,modeOverrides:h,name:g}=s;d&&(s.destroyAPIMethods=l.api.extendAPI(g,{[g]:d})),f&&(s.destroyAPIOverrides=l.api.overrideAPI(g,f)),h&&(s.destroyModeOverrides=l.mode.extendMode(h))}function i(s){const l=Array.isArray(s)?s:[s];p6(l,n.getAll()).forEach(f=>{if(n.has(f.name)&&n.remove(f.name),r(f),!n.add(f)){const{name:g}=f;t?.log({code:F0.LogCodes.CreateFailure,data:{currentPlugins:n.getAll().map(m=>m.name),data:Gp(s),plugin:g},level:Z.Levels.Error,message:`Could not create ${g} plugin`}),o(f.name)}})}function o(s){var l,d,f;if(!n.has(s))return;const h=n.getOne(s);n.remove(s),(l=h?.destroyAPIMethods)==null||l.call(h),(d=h?.destroyAPIOverrides)==null||d.call(h),(f=h?.destroyModeOverrides)==null||f.call(h)}}var Pc;(function(e){(function(t){t.Default="staunton_executive",t.Trigger="real3d"})(e.PieceStyles||(e.PieceStyles={})),function(t){t.CameraSettings="cameraSettings"}(e.CacheKeys||(e.CacheKeys={})),function(t){t.Board="board-webgl-3d",t.PieceDrag="piece-dragging",t.PieceHover="piece-hover",t.PromotionWindow="promotion-window-3d",t.StatisticsPanel="statistics-panel"}(e.CssClasses||(e.CssClasses={})),function(t){t[t.AnalysisOverlay=1]="AnalysisOverlay",t[t.NotationPlane=2]="NotationPlane",t[t.OverSquare=3]="OverSquare",t[t.HighligtedSquare=4]="HighligtedSquare",t[t.Hint=5]="Hint",t[t.CustomItem=6]="CustomItem",t[t.PieceShadow=7]="PieceShadow",t[t.Arrow=8]="Arrow",t[t.Effect=9]="Effect",t[t.Highest=10]="Highest"}(e.ObjectsRenderOrder||(e.ObjectsRenderOrder={})),function(t){t[t.PositionY=.005]="PositionY"}(e.Arrow||(e.Arrow={})),function(t){t[t.PositionY=.005]="PositionY"}(e.CustomItem||(e.CustomItem={})),function(t){t[t.PositionY=.005]="PositionY"}(e.Effect||(e.Effect={})),function(t){t[t.Size=10]="Size",t[t.HalfSize=5]="HalfSize",t[t.BorderSize=.5]="BorderSize",t[t.OverBorderSize=.5]="OverBorderSize",t[t.VisibleY=.005]="VisibleY",t[t.InvisibleY=-.2]="InvisibleY",t[t.InsideTolerance=.01]="InsideTolerance"}(e.Square||(e.Square={})),function(t){t[t.MarginSize=4]="MarginSize",t[t.Size=88]="Size"}(e.Board||(e.Board={})),function(t){t[t.Distance=140]="Distance",t[t.DistanceMin=50]="DistanceMin",t[t.DistanceMax=500]="DistanceMax",t[t.PanAngle=0]="PanAngle",t[t.TiltAngle=100]="TiltAngle",t[t.HorizontalPanning=0]="HorizontalPanning",t[t.VerticalPanning=-12]="VerticalPanning",t[t.ZoomIncrement=5]="ZoomIncrement"}(e.Camera||(e.Camera={}))})(Pc||(Pc={}));function v6(e){return e===v.Types.WebGL3D?Promise.all([Fe.e(525),Fe.e(2804)]).then(Fe.bind(Fe,82804)):e===v.Types.WebGL2D?Promise.all([Fe.e(525),Fe.e(2155)]).then(Fe.bind(Fe,42155)):Fe.e(8442).then(Fe.bind(Fe,18442))}function U0(e){const{Arcade:t,Natural:n}=pr.Animation.Types;return(e.themeAssets?e.themeAssets.config.perspective===Mn.Perspective.REAL_3D:e.pieceStyle===Pc.PieceStyles.Trigger)?v.Types.WebGL3D:[t,n].includes(e.animationType)?v.Types.WebGL2D:v.Types.Default}function zp(e){return v6(U0(e))}function g6(e={},t,n,r){var i;const o=U0(n),s=o!==r,l=o===v.Types.WebGL2D,d="animationType"in e,f=e.animationType!==t.animationType,h=l&&d&&f;return(e.themeAssets&&e.themeAssets.config.perspective!==((i=t.themeAssets)==null?void 0:i.config.perspective)||Object.keys(e).some(S=>v.TriggerOptions.includes(S)))&&(s||h)}function _6(e){const t=U0(e);if(!(t===v.Types.WebGL2D||t===v.Types.WebGL3D)||(typeof window.hasWebGLSupport>"u"&&(window.hasWebGLSupport=r()),window.hasWebGLSupport))return!0;return jp(e,t===v.Types.WebGL3D),!1;function r(){const i=document.createElement("canvas"),o=i.getContext("webgl")||i.getContext("experimental-webgl");return!!o&&o instanceof WebGLRenderingContext}}function jp(e,t=!1){const{pieceStyle:n,animationType:r}=z();e.animationType=r,t&&(e.pieceStyle=n,e.themeAssets&&(e.themeAssets=$t(e.themeAssets)))}function b6(e){switch(e){case"../analysis/index.ts":return Promise.resolve().then(function(){return mp});case"../capture-the-star/index.ts":return Promise.resolve().then(function(){return a3});case"../exploring/index.ts":return Promise.resolve().then(function(){return d3});case"../guess-the-move/index.ts":return Promise.resolve().then(function(){return g3});case"../observing/index.ts":return Promise.resolve().then(function(){return B3});case"../passive-observing/index.ts":return Promise.resolve().then(function(){return Cp});case"../playing/index.ts":return Promise.resolve().then(function(){return z3});case"../setup/index.ts":return Promise.resolve().then(function(){return kp});default:return new Promise(function(t,n){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+e)))})}}async function y6(e){return b6(`../${e.toLowerCase()}/index.ts`)}function E6(e){return function(){return e.state.get().machineState===K.States.PieceDragging}}const A6="1.29.0";function w6({api:e,apiOptions:t,el:n,emitter:r,init:i,logger:o,mode:s,options:l=z(),plugins:d=bc(),renderer:f}){const h=e||Y2({eventEmitter:r,logger:o,options:t||{}}),g=ge(ge({},z()),l);n.id=`board-${g.id}`;const m=m6(),S=br();let P,I;const D=c6({params:{api:h,el:n,options:g},plugins:m});m.setCreatePluginContext(D.getContext());const be=Object.assign(h,{destroy:Ze,getMode:D.getMode,getOptions:zn,getVersion:()=>A6,isDragging:E6(D.getContext()),getRenderer:()=>P,playSound:tn,plugins:m,resize:Ct,run:Sn,setMode:Ft,setOptions:Zn,setRenderer:S}),Ye=Ft(s);return"name"in Ye?Se():Ye.then(Se),be;function Se(){m.add(d),Sn(Vr(M.InstanceEvents.Create)),n.addEventListener("contextmenu",tr=>(tr.stopPropagation(),tr.preventDefault(),!1)),h.onAll(Sn),h.emit(M.InstanceEvents.Create,Vr(M.InstanceEvents.Create,D.getMode().name)),S(f).then(()=>{i&&h.load(i)})}function Ze(){mt(),h.offAll(Sn);const tr=Vr(M.InstanceEvents.Destroy);Sn(tr),h.emit(M.InstanceEvents.Destroy,tr)}function mt(){D.setRenderer(),P?.offAll(h.logger.log),P?.destroy(),P=void 0,n.removeEventListener(Ji,I?.handlePointerdown),document.removeEventListener(Ji,I?.handleDocumentPointerdown),document.removeEventListener(Ta,I?.handlePointermove),document.removeEventListener(rs,I?.handlePointerup)}function zn(){return ge({},g)}function Sn(tr){return D.run(tr),tr}function tn(tr){Sn(Vr(M.SoundEvents.Play,{sound:tr}))}function Ct(tr,kr){Sn(Vr(M.UIEvents.Resize,{height:kr,width:tr}))}function Ft(tr){return"modeType"in tr?y6(tr.modeType).then(kr=>{const Qn=kr.create(tr.options);return Ln(Qn)}):Ln(tr)}function Ln(tr){var kr,Qn;const ri=D&&D.getMode();ri&&((kr=ri.plugins)==null||kr.forEach(Fi=>m.remove(Fi.name)),m.get().forEach(Fi=>{var ir;return(ir=Fi.destroyModeOverrides)==null?void 0:ir.call(Fi)}),(Qn=ri.destroy)==null||Qn.call(ri));const Bi=tr(h);return h.usePlayingAs(Bi.usePlayingAs),Bi.plugins&&m.add(Bi.plugins),m.get().forEach(Fi=>Fi.modeOverrides&&Bi.extendMode(Fi.modeOverrides)),D&&(D.setMode(Bi),Sn(Vr(M.InstanceEvents.ModeChanged)),h.emit(M.InstanceEvents.ModeChanged,Vr(M.InstanceEvents.ModeChanged,D.getMode().name))),Bi}function Zn(tr){const kr=ge({},g);Object.assign(g||{},tr),tr&&P&&g6(tr,kr,g,P.name)&&S(),h.emit(M.OptionsEvents.Update,Vr(M.OptionsEvents.Update,tr))}function br(){const tr=Zt();return async function(ri){tr.add(kr,ri)};async function kr(Qn){if(mt(),Qn)P=Qn;else try{_6(g)||h.emit(M.InstanceEvents.RendererSetFailed,Vr(M.InstanceEvents.RendererSetFailed,{message:"WebGL is not supported by the browser. Will fallback to default.",isWebGLRenderError:!0})),P=(await zp(g)).createRenderer({el:n,options:g})}catch(ri){h.emit(M.InstanceEvents.RendererSetFailed,Vr(M.InstanceEvents.RendererSetFailed,{message:"Problem creating renderer. Will fallback to default.",error:ri})),jp(g,!0),P=(await zp(g)).createRenderer({el:n,options:g})}D.setRenderer(P),Object.assign(be,{animationComplete:P.animationComplete,getPointerPosition:P.getPointerPosition,isAnimating:P.isAnimating}),I=d6({el:n,getPointerPosition:P.getPointerPosition,options:g,run:Sn}),n.addEventListener(Ji,I.handlePointerdown),document.addEventListener(Ji,I.handleDocumentPointerdown),P.onAll(h.logger.log),P.on(M.InstanceEvents.WebGLAssetsInitialized,()=>{h.emit(M.InstanceEvents.WebGLAssetsInitialized,{type:M.InstanceEvents.WebGLAssetsInitialized})}),h.emit(M.InstanceEvents.RendererSet,Vr(M.InstanceEvents.RendererSet,P.name))}}}function H0(e){return e===ct.ColorsAsLetters.Black||e===ct.ColorsAsWords.Black?ct.ColorsAsNumbers.Black:ct.ColorsAsNumbers.White}function qp({game:e,piece:t,toSquare:n}){const[r,i]=t;if(n&&t&&e.getMode().isAllowedToMove()){const o=e.move({color:H0(r),drop:i,to:n,userGenerated:!0});return o?.type==="Move"}return!1}function S6(e,t){return typeof e.getPlayingAs()>"u"?!0:e.getPlayingAs()===H0(t)}function C6(e,t){const n=document.createElement("style");return document.head.append(n),{getPieceStyles:o,removePieceStyleElement:r,updatePieceStyle:s};function r(){n.remove()}function i(l){const{path:d,format:f,isPseudo3d:h}=t[l],g=go(d),m=h?"::after":"";return kt.reduce((S,P)=>`${S} .hand-piece.${P}${m} { background-image: url('${g}/${P}.${f}'); }`,"")}function o(l,d){if(!d)return i(l);const f=d.config.perspective===Mn.Perspective.PSEUDO_3D?"::after":"",h=d.config.perspective===Mn.Perspective.REAL_3D?Pi:d.pieces.assets;return Mn.pieceShortNames.reduce((g,m)=>`${g} .hand-piece.${m}${f} { background-image: url('${h[m]}'); }`,"")}function s(l,d){n.innerHTML=o(l,d);const f=d?d.config.perspective===Mn.Perspective.PSEUDO_3D:t[l].isPseudo3d;e(!!f)}}var So;(function(e){(function(t){t.BodyDragging="hand-pieces-dragging-body",t.Component="hand-pieces",t.Dragging="dragging",t.Flipped="flipped",t.Horizontal="horizontal",t.Piece="hand-piece",t.Pseudo3d="pseudo3d",t.Vertical="vertical",t.WithKing="with-king"})(e.Classes||(e.Classes={})),function(t){t.Horizontal="horizontal",t.Vertical="vertical"}(e.DisplayDirections||(e.DisplayDirections={}))})(So||(So={}));var $r;(function(e){e.Dragging="dragging",e.Idle="idle",e.Selected="selected"})($r||($r={}));var ji;(function(e){e.RESET="RESET",e.PLACE="PLACE",e.SELECT="SELECT",e.DESELECT="DESELECT",e.START_DRAG="START_DRAG",e.MOVE="MOVE"})(ji||(ji={}));var l5='.hand-piece.svelte-1ux6m6s.svelte-1ux6m6s{background-size:cover;cursor:-webkit-grab;cursor:grab;position:absolute}.hand-piece.dragging.svelte-1ux6m6s.svelte-1ux6m6s{cursor:-webkit-grabbing;cursor:grabbing;position:fixed;will-change:left, top;z-index:11 !important}.hand-piece.hidden.svelte-1ux6m6s.svelte-1ux6m6s{display:none}body.hand-pieces-dragging-body{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.hand-pieces.svelte-1ux6m6s.svelte-1ux6m6s{height:100%;position:relative;width:100%}.hand-pieces.horizontal.svelte-1ux6m6s.svelte-1ux6m6s{height:auto;padding-top:calc(100% * 2 / (10 / 2))}.hand-pieces.horizontal.with-king.svelte-1ux6m6s.svelte-1ux6m6s{height:auto;padding-top:calc(100% * 2 / (12 / 2))}.board .hand-pieces.svelte-1ux6m6s.svelte-1ux6m6s{left:calc(-1 * calc(100% / 10));position:absolute;width:calc(100% / 10)}.board-webgl-3d .hand-pieces.svelte-1ux6m6s.svelte-1ux6m6s{left:calc(-1 * calc(100% / 10 * 3 / 4));width:calc(100% / 10 * 3 / 4)}.board-webgl-3d .hand-pieces.with-king.svelte-1ux6m6s.svelte-1ux6m6s{left:calc(-1 * calc(100% / 12 * 3 / 4));width:calc(100% / 12 * 3 / 4)}.hand-pieces.svelte-1ux6m6s .hand-piece-count.svelte-1ux6m6s{align-items:center;background:#fff;border-radius:50%;bottom:0;color:#262421;display:flex;font-size:100%;font-weight:900;height:30%;justify-content:center;position:absolute;right:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:30%}.hand-pieces.svelte-1ux6m6s .hand-piece.svelte-1ux6m6s{height:calc(100% / 10);width:100%}.hand-pieces.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{top:calc(100% / 10 * (1 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{top:calc(100% / 10 * (2 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{top:calc(100% / 10 * (3 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{top:calc(100% / 10 * (4 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{top:calc(100% / 10 * (5 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{top:calc(100% / 10 * (6 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{top:calc(100% / 10 * (7 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{top:calc(100% / 10 * (8 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{top:calc(100% / 10 * (9 - 1))}.hand-pieces.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{top:calc(100% / 10 * (10 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{top:calc(100% / 10 * (1 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{top:calc(100% / 10 * (2 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{top:calc(100% / 10 * (3 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{top:calc(100% / 10 * (4 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{top:calc(100% / 10 * (5 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{top:calc(100% / 10 * (6 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{top:calc(100% / 10 * (7 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{top:calc(100% / 10 * (8 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{top:calc(100% / 10 * (9 - 1))}.hand-pieces.flipped.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{top:calc(100% / 10 * (10 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.svelte-1ux6m6s{height:calc(100% / 12)}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{top:calc(100% / 12 * (1 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{top:calc(100% / 12 * (2 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{top:calc(100% / 12 * (3 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{top:calc(100% / 12 * (4 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{top:calc(100% / 12 * (5 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.bk.svelte-1ux6m6s{top:calc(100% / 12 * (6 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.wk.svelte-1ux6m6s{top:calc(100% / 12 * (7 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{top:calc(100% / 12 * (8 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{top:calc(100% / 12 * (9 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{top:calc(100% / 12 * (10 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{top:calc(100% / 12 * (11 - 1))}.hand-pieces.with-king.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{top:calc(100% / 12 * (12 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{top:calc(100% / 12 * (1 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{top:calc(100% / 12 * (2 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{top:calc(100% / 12 * (3 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{top:calc(100% / 12 * (4 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{top:calc(100% / 12 * (5 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.wk.svelte-1ux6m6s{top:calc(100% / 12 * (6 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.bk.svelte-1ux6m6s{top:calc(100% / 12 * (7 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{top:calc(100% / 12 * (8 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{top:calc(100% / 12 * (9 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{top:calc(100% / 12 * (10 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{top:calc(100% / 12 * (11 - 1))}.hand-pieces.with-king.flipped.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{top:calc(100% / 12 * (12 - 1))}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.svelte-1ux6m6s{height:50%;width:calc(100% / (10 / 2))}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{left:calc(100% / 5 * (1 - 1));top:0}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{left:calc(100% / 5 * (2 - 1));top:0}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{left:calc(100% / 5 * (3 - 1));top:0}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{left:calc(100% / 5 * (4 - 1));top:0}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{left:calc(100% / 5 * (5 - 1));top:0}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{left:calc(100% / 5 * (1 - 1));top:50%}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{left:calc(100% / 5 * (2 - 1));top:50%}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{left:calc(100% / 5 * (3 - 1));top:50%}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{left:calc(100% / 5 * (4 - 1));top:50%}.hand-pieces.horizontal.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{left:calc(100% / 5 * (5 - 1));top:50%}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{left:calc(100% / 5 * (1 - 1));top:0}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{left:calc(100% / 5 * (2 - 1));top:0}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{left:calc(100% / 5 * (3 - 1));top:0}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{left:calc(100% / 5 * (4 - 1));top:0}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{left:calc(100% / 5 * (5 - 1));top:0}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{left:calc(100% / 5 * (1 - 1));top:50%}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{left:calc(100% / 5 * (2 - 1));top:50%}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{left:calc(100% / 5 * (3 - 1));top:50%}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{left:calc(100% / 5 * (4 - 1));top:50%}.hand-pieces.horizontal.flipped.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{left:calc(100% / 5 * (5 - 1));top:50%}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.svelte-1ux6m6s{width:calc(100% / (12 / 2))}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{left:calc(100% / 6 * (1 - 1));top:0}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{left:calc(100% / 6 * (2 - 1));top:0}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{left:calc(100% / 6 * (3 - 1));top:0}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{left:calc(100% / 6 * (4 - 1));top:0}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{left:calc(100% / 6 * (5 - 1));top:0}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.bk.svelte-1ux6m6s{left:calc(100% / 6 * (6 - 1));top:0}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{left:calc(100% / 6 * (1 - 1));top:50%}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{left:calc(100% / 6 * (2 - 1));top:50%}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{left:calc(100% / 6 * (3 - 1));top:50%}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{left:calc(100% / 6 * (4 - 1));top:50%}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{left:calc(100% / 6 * (5 - 1));top:50%}.hand-pieces.horizontal.with-king.svelte-1ux6m6s .hand-piece.wk.svelte-1ux6m6s{left:calc(100% / 6 * (6 - 1));top:50%}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{left:calc(100% / 6 * (1 - 1));top:0}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{left:calc(100% / 6 * (2 - 1));top:0}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{left:calc(100% / 6 * (3 - 1));top:0}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{left:calc(100% / 6 * (4 - 1));top:0}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{left:calc(100% / 6 * (5 - 1));top:0}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.wk.svelte-1ux6m6s{left:calc(100% / 6 * (6 - 1));top:0}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{left:calc(100% / 6 * (1 - 1));top:50%}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{left:calc(100% / 6 * (2 - 1));top:50%}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{left:calc(100% / 6 * (3 - 1));top:50%}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{left:calc(100% / 6 * (4 - 1));top:50%}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{left:calc(100% / 6 * (5 - 1));top:50%}.hand-pieces.horizontal.flipped.with-king.svelte-1ux6m6s .hand-piece.bk.svelte-1ux6m6s{left:calc(100% / 6 * (6 - 1));top:50%}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.svelte-1ux6m6s{overflow:visible}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.svelte-1ux6m6s::after{background-position-y:bottom;background-repeat:no-repeat;background-size:contain;bottom:0;content:" ";height:132%;left:0;position:absolute;width:100%}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{z-index:1}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{z-index:2}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{z-index:3}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{z-index:4}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{z-index:5}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{z-index:6}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{z-index:7}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{z-index:8}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{z-index:9}.hand-pieces.pseudo3d.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{z-index:10}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{z-index:1}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{z-index:2}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{z-index:3}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{z-index:4}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{z-index:5}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{z-index:6}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{z-index:7}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{z-index:8}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{z-index:9}.hand-pieces.pseudo3d.flipped.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{z-index:10}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{z-index:1}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{z-index:2}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{z-index:3}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{z-index:4}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{z-index:5}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.bk.svelte-1ux6m6s{z-index:6}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.wk.svelte-1ux6m6s{z-index:7}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{z-index:8}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{z-index:9}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{z-index:10}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{z-index:11}.hand-pieces.pseudo3d.with-king.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{z-index:12}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.wp.svelte-1ux6m6s{z-index:1}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.wb.svelte-1ux6m6s{z-index:2}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.wn.svelte-1ux6m6s{z-index:3}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.wr.svelte-1ux6m6s{z-index:4}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.wq.svelte-1ux6m6s{z-index:5}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.wk.svelte-1ux6m6s{z-index:6}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.bk.svelte-1ux6m6s{z-index:7}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.bq.svelte-1ux6m6s{z-index:8}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.br.svelte-1ux6m6s{z-index:9}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.bn.svelte-1ux6m6s{z-index:10}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.bb.svelte-1ux6m6s{z-index:11}.hand-pieces.pseudo3d.flipped.with-king.svelte-1ux6m6s .hand-piece.bp.svelte-1ux6m6s{z-index:12}.hand-pieces.pseudo3d.horizontal .piece .bp.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal .piece .bb.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal .piece .bn.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal .piece .br.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal .piece .bq.svelte-1ux6m6s.svelte-1ux6m6s{z-index:1}.hand-pieces.pseudo3d.horizontal .piece .wp.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal .piece .wb.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal .piece .wn.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal .piece .wr.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal .piece .wq.svelte-1ux6m6s.svelte-1ux6m6s{z-index:2}.hand-pieces.pseudo3d.horizontal.flipped .piece .wp.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.flipped .piece .wb.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.flipped .piece .wn.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.flipped .piece .wr.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.flipped .piece .wq.svelte-1ux6m6s.svelte-1ux6m6s{z-index:1}.hand-pieces.pseudo3d.horizontal.flipped .piece .bp.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.flipped .piece .bb.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.flipped .piece .bn.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.flipped .piece .br.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.flipped .piece .bq.svelte-1ux6m6s.svelte-1ux6m6s{z-index:2}.hand-pieces.pseudo3d.horizontal.with-king .piece .bp.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .bb.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .bn.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .br.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .bq.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .bk.svelte-1ux6m6s.svelte-1ux6m6s{z-index:1}.hand-pieces.pseudo3d.horizontal.with-king .piece .wp.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .wb.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .wn.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .wr.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .wq.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king .piece .wk.svelte-1ux6m6s.svelte-1ux6m6s{z-index:2}.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .wp.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .wb.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .wn.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .wr.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .wq.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .wk.svelte-1ux6m6s.svelte-1ux6m6s{z-index:1}.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .bp.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .bb.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .bn.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .br.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .bq.svelte-1ux6m6s.svelte-1ux6m6s,.hand-pieces.pseudo3d.horizontal.with-king.flipped .piece .bk.svelte-1ux6m6s.svelte-1ux6m6s{z-index:2}.board .hand-pieces.with-king{left:calc(-1 * calc(100% / 12));width:calc(100% / 12)}';function Wp(e,t,n){const r=e.slice();return r[29]=t[n][0],r[30]=t[n][1],r}function Kp(e){let t,n=e[30]+"",r;return{c(){t=(0,w.d)("span"),r=(0,w.t)(n),(0,w.h)(t,"class","hand-piece-count svelte-1ux6m6s")},m(i,o){(0,w.j)(i,t,o),(0,w.A)(t,r)},p(i,o){o[0]&256&&n!==(n=i[30]+"")&&(0,w.r)(r,n)},d(i){i&&(0,w.m)(t)}}}function $p(e){let t,n=Dd(e[30]),r,i,o,s,l,d,f=n&&Kp(e);function h(...g){return e[27](e[29],...g)}return{c(){t=(0,w.d)("div"),f&&f.c(),(0,w.h)(t,"class",r=(0,w.J)(`hand-piece ${e[29]} ${zo({hidden:Ld(e[30])})} `)+" svelte-1ux6m6s"),(0,w.h)(t,"style",i=`${zo({[e[22]]:Eo(e[29],e[9])})}`),(0,w.h)(t,"data-hand-piece",o=e[29]),(0,w.h)(t,"data-hand-piece-selected",s=Eo(e[3],$r.Selected)&&Eo(e[29],e[9])?e[21]:null)},m(g,m){(0,w.j)(g,t,m),f&&f.m(t,null),l||(d=(0,w.k)(t,"pointerdown",h),l=!0)},p(g,m){e=g,m[0]&256&&(n=Dd(e[30])),n?f?f.p(e,m):(f=Kp(e),f.c(),f.m(t,null)):f&&(f.d(1),f=null),m[0]&256&&r!==(r=(0,w.J)(`hand-piece ${e[29]} ${zo({hidden:Ld(e[30])})} `)+" svelte-1ux6m6s")&&(0,w.h)(t,"class",r),m[0]&768&&i!==(i=`${zo({[e[22]]:Eo(e[29],e[9])})}`)&&(0,w.h)(t,"style",i),m[0]&256&&o!==(o=e[29])&&(0,w.h)(t,"data-hand-piece",o),m[0]&776&&s!==(s=Eo(e[3],$r.Selected)&&Eo(e[29],e[9])?e[21]:null)&&(0,w.h)(t,"data-hand-piece-selected",s)},d(g){g&&(0,w.m)(t),f&&f.d(),l=!1,d()}}}function Zp(e){let t,n,r;return{c(){t=(0,w.d)("div"),(0,w.h)(t,"class",n=(0,w.J)(`hand-piece dragging ${e[10]}`)+" svelte-1ux6m6s"),(0,w.h)(t,"style",r=`${Qp(e[11].current)}; width: ${e[2]}px; height: ${e[2]}px;`),(0,w.h)(t,"data-hand-piece",e[10]),(0,w.h)(t,"data-hand-piece-dragging","true")},m(i,o){(0,w.j)(i,t,o)},p(i,o){o[0]&1024&&n!==(n=(0,w.J)(`hand-piece dragging ${i[10]}`)+" svelte-1ux6m6s")&&(0,w.h)(t,"class",n),o[0]&2052&&r!==(r=`${Qp(i[11].current)}; width: ${i[2]}px; height: ${i[2]}px;`)&&(0,w.h)(t,"style",r),o[0]&1024&&(0,w.h)(t,"data-hand-piece",i[10])},d(i){i&&(0,w.m)(t)}}}function k6(e){let t,n,r=Eo(e[3],$r.Dragging),i,o=Object.entries(e[8]),s=[];for(let d=0;d<o.length;d+=1)s[d]=$p(Wp(e,o,d));let l=r&&Zp(e);return{c(){t=(0,w.d)("div");for(let d=0;d<s.length;d+=1)s[d].c();n=(0,w.u)(),l&&l.c(),(0,w.h)(t,"class",i=(0,w.J)(`${e[4]} ${So.Classes.Component} ${zo({[So.Classes.Flipped]:e[5],[So.Classes.WithKing]:e[6],[So.Classes.Pseudo3d]:e[7]})}`)+" svelte-1ux6m6s")},m(d,f){(0,w.j)(d,t,f);for(let h=0;h<s.length;h+=1)s[h].m(t,null);(0,w.A)(t,n),l&&l.m(t,null),e[28](t)},p(d,f){if(f[0]&6292233){o=Object.entries(d[8]);let h;for(h=0;h<o.length;h+=1){const g=Wp(d,o,h);s[h]?s[h].p(g,f):(s[h]=$p(g),s[h].c(),s[h].m(t,n))}for(;h<s.length;h+=1)s[h].d(1);s.length=o.length}f[0]&8&&(r=Eo(d[3],$r.Dragging)),r?l?l.p(d,f):(l=Zp(d),l.c(),l.m(t,null)):l&&(l.d(1),l=null),f[0]&240&&i!==(i=(0,w.J)(`${d[4]} ${So.Classes.Component} ${zo({[So.Classes.Flipped]:d[5],[So.Classes.WithKing]:d[6],[So.Classes.Pseudo3d]:d[7]})}`)+" svelte-1ux6m6s")&&(0,w.h)(t,"class",i)},i:w.o,o:w.o,d(d){d&&(0,w.m)(t),(0,w.D)(s,d),l&&l.d(),e[28](null)}}}function P6(e,t,n){let r,i,o,s,l,d,f,h,g,{data:m}=t,{game:S}=t,{boardEl:P}=t,{eventHandlers:I}=t,{removePieceStyleElement:D}=t;const{handPieces:be,currentState:Ye,selectedPieceId:Se,draggingPieceId:Ze,dragCoords:mt,direction:zn,showAllPieces:Sn,flipped:tn,pseudo3d:Ct}=m;(0,w.E)(e,be,Qn=>n(8,d=Qn)),(0,w.E)(e,Ye,Qn=>n(3,r=Qn)),(0,w.E)(e,Se,Qn=>n(9,f=Qn)),(0,w.E)(e,Ze,Qn=>n(10,h=Qn)),(0,w.E)(e,mt,Qn=>n(11,g=Qn)),(0,w.E)(e,zn,Qn=>n(4,i=Qn)),(0,w.E)(e,Sn,Qn=>n(6,s=Qn)),(0,w.E)(e,tn,Qn=>n(5,o=Qn)),(0,w.E)(e,Ct,Qn=>n(7,l=Qn));let Ft,Ln,Zn=I6(S.getOptions()),br=`background-color: ${Zn};`;(0,w.U)(()=>{document.removeEventListener(jr.PointerMove,I.move),document.removeEventListener(jr.PointerUp,I.placeDrag),document.removeEventListener(jr.PointerDown,I.placeSelect),P.removeEventListener(jr.PointerDown,I.placeSelect),document.removeEventListener(jr.Mousedown,I.reset),D()});const tr=(Qn,ri)=>I.startDrag({event:ri,piece:Qn});function kr(Qn){w.Q[Qn?"unshift":"push"](()=>{Ft=Qn,n(1,Ft)})}return e.$$set=Qn=>{"data"in Qn&&n(23,m=Qn.data),"game"in Qn&&n(24,S=Qn.game),"boardEl"in Qn&&n(25,P=Qn.boardEl),"eventHandlers"in Qn&&n(0,I=Qn.eventHandlers),"removePieceStyleElement"in Qn&&n(26,D=Qn.removePieceStyleElement)},e.$$.update=()=>{e.$$.dirty[0]&15&&(r===$r.Dragging?(document.addEventListener(jr.PointerMove,I.move),document.addEventListener(jr.PointerUp,I.placeDrag),document.body.classList.add(So.Classes.BodyDragging),!Ln&&n(2,Ln=Ft.children[0].clientWidth)):(document.removeEventListener(jr.PointerMove,I.move),document.removeEventListener(jr.PointerUp,I.placeDrag),document.body.classList.remove(So.Classes.BodyDragging))),e.$$.dirty[0]&33554441&&(r===$r.Selected?(document.addEventListener(jr.PointerDown,I.placeSelect),P.addEventListener(jr.PointerDown,I.placeSelect)):(document.removeEventListener(jr.PointerDown,I.placeSelect),P.removeEventListener(jr.PointerDown,I.placeSelect))),e.$$.dirty[0]&9&&(r!==$r.Idle?document.addEventListener(jr.Mousedown,I.reset):document.removeEventListener(jr.Mousedown,I.reset))},[I,Ft,Ln,r,i,o,s,l,d,f,h,g,be,Ye,Se,Ze,mt,zn,Sn,tn,Ct,Zn,br,m,S,P,D,tr,kr]}class T6 extends w.a{constructor(t){super(),(0,w.i)(this,t,P6,k6,w.b,{data:23,game:24,boardEl:25,eventHandlers:0,removePieceStyleElement:26},null,[-1,-1])}}function M6({options:e,target:t,replaceContainer:n=!0}){return ns({ComponentType:T6,options:Ce(ge({},e),{target:t}),replaceContainer:n})}function Yp({game:e,square:t}){if(!e.getPieces().isDefined(t))return!1;const n=e.getVariant(),r=n===ct.Variants.Crazyhouse||n===ct.Variants.Bughouse,i=e.getPieces().get(t).color===e.getPlayingAs();return r&&i}function Xp({game:e,boardEl:t,coords:n}){var r;return(r=e.getPointerPosition({el:t,event:{clientX:n.x,clientY:n.y},flipped:e.getOptions().flipped}))==null?void 0:r.square}function G0(e){var t;const{game:n}=e.getContext();return((t=n?.hand)==null?void 0:t.call(n))||""}function x6(){const e=Object.values(ct.Piece.Types);return[...e,...e.map(t=>t.toUpperCase())]}function I6(e){var t,n,r,i;return(i=(r=(t=e.themeAssets)==null?void 0:t.board.config.highlightSquareHex)!=null?r:(n=$(e.boardStyle))==null?void 0:n.highlightColor)!=null?i:pr.HighlightColors.Selected}function Qp(e){return`top: ${e.y}px; left: ${e.x}px; transform: translate(-50%, -50%)`}function R6({el:e,event:t}){const{width:n,height:r}=e.getBoundingClientRect();return{height:r,width:n,x:t.clientX,y:t.clientY}}function V0({coords:e,initialCoords:t}){const{x:n,y:r}=e;if(n===0&&r===0)return!0;const{height:i,width:o,x:s,y:l}=t,d=o/2,f=i/2,h=s-d,g=s+d,m=l+f,S=l-f;return n>=h&&n<=g&&r<=m&&r>=S}function O6(e,t){const n=t.toLowerCase(),i=`${t===n?"b":"w"}${n}`;return e[i]||(e[i]=0),e[i]+=1,e}function N6(e){const{movePiece:t,selectPiece:n,deselectPiece:r,setState:i,startDrag:o,reset:s,afterPlaceAttempt:l}=e.actions,d=Rs(L6(e));return d.onTransition(function({type:h,value:g,nextState:m}){var S;const P=e.data.currentState.get();P!==m&&i(m);const I={[ji.START_DRAG]:o,[ji.MOVE]:t,[ji.DESELECT]:r,[ji.SELECT]:n,[ji.PLACE]:({coords:D})=>l({coords:D,game:e.game,oldState:P,nextState:m}),[ji.RESET]:()=>s(e.game)};(S=I[h])==null||S.call(I,g,m)}),d.on("Enter",function({nextState:h}){h===$r.Selected&&e.game.run({type:M.UserEvents.PointerdownRight,data:{}})}),d}function L6({game:e,boardEl:t,data:n}){const{draggingPieceId:r,dragCoords:i,selectedPieceId:o,continuousDrop:s}=n;return{initialState:$r.Idle,states:{[$r.Idle]:{START_DRAG:()=>$r.Dragging},[$r.Selected]:{DESELECT:()=>$r.Idle,SELECT:()=>$r.Selected,START_DRAG:()=>$r.Dragging,RESET:()=>$r.Idle,PLACE:({coords:l})=>{if(V0({coords:l,initialCoords:i.get().initial}))return $r.Idle;const d=Xp({game:e,coords:l,boardEl:t});if(d){if(e.plugins.has("premoves")&&Yp({game:e,square:d}))return e.run({data:{square:d},type:M.UserEvents.PointerdownLeft}),$r.Idle;if(!qp({game:e,piece:o.get(),toSquare:d})&&Yp({game:e,square:d}))return e.run({data:{square:d},type:M.UserEvents.PointerdownLeft}),$r.Idle;if(s.get())return e.getMode().name==="setup"&&e.run({type:M.UserEvents.MousedownRight}),$r.Selected}return $r.Idle}},[$r.Dragging]:{RESET:()=>$r.Idle,MOVE:()=>$r.Dragging,PLACE:({coords:l})=>V0({coords:l,initialCoords:i.get().initial})?$r.Selected:(qp({game:e,piece:r.get(),toSquare:Xp({game:e,coords:l,boardEl:t})}),$r.Idle)}}}}function D6({handPieces:e,continuousDrop:t,currentState:n,direction:r,dragCoords:i,draggingPieceId:o,flipped:s,pseudo3d:l,selectedPieceId:d,showAllPieces:f}){function h(Ct){n.set(Ct)}function g(Ct){t.set(Ct)}function m(Ct){l.set(Ct)}function S(Ct){s.set(Ct)}function P(Ct){r.set(Ct)}function I(Ct){f.set(Ct)}function D(Ct){d.set(Ct)}function be(){d.set("")}function Ye(Ct){o.set(Ct)}function Se(Ct){i.update(Ft=>({current:Ct,initial:Ft.initial}))}function Ze({piece:Ct,initialCoords:Ft}){Ye(Ct),D(""),i.set({current:Ft,initial:Ft}),e.update(Ln=>{const Zn=Ln[Ct];return Zn>0&&(Ln[Ct]=Zn-1),Ln})}function mt(Ct,Ft=!1){const Ln=f.get();Ft&&Ye("");const Zn=(Ln?x6():Ct.split("")).reduce(O6,{});e.set(Zn);const br=o.get();br&&Zn[br]>0&&e.update(tr=>{const kr=tr[br];return kr>0&&(tr[br]=kr-1),tr})}function zn({coords:Ct,game:Ft,oldState:Ln,nextState:Zn}){const tr=Ln===$r.Dragging?o.get():"";mt(G0(Ft),!0),V0({coords:Ct,initialCoords:i.get().initial})&&D(tr),Zn==="idle"&&tn(Ft)}function Sn(Ct){Ct.direction&&P(Ct.direction),S(!!Ct.flipped),I(!!Ct.showAllPieces),g(!!Ct.canDropPiecesContinuously)}function tn(Ct){D(""),mt(G0(Ct),!0)}return{setState:h,setContinuousDrop:g,setPseudo3d:m,setFlipped:S,setDirection:P,setShowAllPieces:I,selectPiece:D,deselectPiece:be,dragPiece:Ye,movePiece:Se,startDrag:Ze,setHand:mt,afterPlaceAttempt:zn,setInitialData:Sn,reset:tn}}function B6(){const e={handPieces:{},continuousDrop:!1,currentState:$r.Idle,direction:"vertical",dragCoords:{current:{x:0,y:0},initial:{x:0,y:0}},draggingPieceId:"",flipped:!1,isPseudo3d:!1,selectedPieceId:"",showAllPieces:!1},t={handPieces:Gi(e.handPieces),continuousDrop:Gi(e.continuousDrop),currentState:Gi(e.currentState),direction:Gi(e.direction),dragCoords:Gi(e.dragCoords),draggingPieceId:Gi(e.draggingPieceId),flipped:Gi(e.flipped),pseudo3d:Gi(e.isPseudo3d),selectedPieceId:Gi(e.selectedPieceId),showAllPieces:Gi(e.showAllPieces)};return{data:t,actions:D6(t)}}function F6(e,{game:t,data:n}){const{currentState:r,selectedPieceId:i,continuousDrop:o}=n;return{startDrag:s,move:l,placeDrag:d,placeSelect:f,reset:h};function s({piece:g,event:m}){m.stopPropagation();const[S]=g;!S6(t,S)||cs(m)||(o.get()&&i.get()===g?e(ji.DESELECT):o.get()&&r.get()===$r.Selected?e(ji.SELECT,g):e(ji.START_DRAG,{piece:g,initialCoords:R6({el:m.currentTarget,event:m})}))}function l({clientX:g,clientY:m}){e(ji.MOVE,{x:g,y:m})}function d({clientX:g,clientY:m}){e(ji.PLACE,{coords:{x:g,y:m}})}function f(g){g.stopPropagation(),!cs(g)&&e(ji.PLACE,{coords:{x:g.clientX,y:g.clientY},targetEl:g.target})}function h(g){g.stopPropagation(),cs(g)&&(document.oncontextmenu=()=>!1,Hp(()=>document.oncontextmenu=()=>!0),e(ji.RESET,{targetEl:g.target}))}}function U6({boardEl:e,containerEl:t,direction:n,showAllPieces:r=!1,canDropPiecesContinuously:i=!1,flipped:o,game:s,pieceStyles:l=fn,replaceContainer:d}){const{data:f,actions:h}=B6(),{setDirection:g,setHand:m,setFlipped:S,setInitialData:P,setPseudo3d:I,setShowAllPieces:D,setContinuousDrop:be}=h;P({direction:n,showAllPieces:r,flipped:o,canDropPiecesContinuously:i});const Ye=N6({data:f,actions:h,boardEl:e,game:s}),Se=F6(Ye.send,{data:f,game:s}),{removePieceStyleElement:Ze,updatePieceStyle:mt}=C6(I,l);return{destroy:M6({options:{props:{data:f,game:s,boardEl:e,eventHandlers:Se,removePieceStyleElement:Ze}},replaceContainer:d,target:t}).destroy,getHand:()=>G0(s),reset:()=>Ye.send(ji.RESET),setDirection:g,setFlipped:S,setHand:m,setShowAllPieces:D,setContinuousDrop:be,updatePieceStyle:mt}}function H6({direction:e,el:t,pieceStyles:n,replaceContainer:r}={}){let i;return{create:o,destroy:s,match:[{condition:xt([M.APIEvents.Load,M.OptionsEvents.Update]),handler:l},{condition:Je(M.OptionsEvents.UpdateMode),handler:h},{condition:xt([...Yi,Y.Events.SetHand]),handler:d},{condition:Je(M.InstanceEvents.ModeChanged),handler:f}],name:Y.Plugin.Name};function o(m){const{api:S,el:P,mode:I}=m,{flipped:D,pieceStyle:be,themeAssets:Ye}=m.options,{canDropPiecesContinuously:Se}=I.getOptions(),Ze=g(I.name);i=U6({boardEl:P,containerEl:t||P,direction:e,flipped:D,game:S,pieceStyles:n,canDropPiecesContinuously:Se,replaceContainer:r,showAllPieces:Ze}),i.updatePieceStyle(be,Ye),i.setHand(i.getHand())}function s(){i.destroy()}function l(m,S){m.type===M.APIEvents.Load&&i.reset();const{flipped:P,pieceStyle:I,themeAssets:D}=S.options;i.setHand(i.getHand()),i.setFlipped(P),i.updatePieceStyle(I,D)}function d(){i.setHand(i.getHand())}function f(m,S){var P;const I=g(m.data),{canDropPiecesContinuously:D}=(P=S.mode)==null?void 0:P.getOptions();i.setContinuousDrop(!!D),i.setShowAllPieces(I)}function h(m){m.data.canDropPiecesContinuously!==void 0&&i.setContinuousDrop(!!m.data.canDropPiecesContinuously)}function g(m){return m===wo.Types.Setup}}function u5(e,t){const n=t||e.getTurn(),r=e.clocks[n],i=e.timeControl.get(),o=i?.increment;return{clock:r,increment:o,moveTime:Vo(r.get().currentTime+o)}}function G6(e,t=150){return`${Mo()}/boards/${e}/${t}.png`}function V6(e){return e===ct.ColorsAsNumbers.Black?ct.ColorsAsLetters.Black:ct.ColorsAsLetters.White}function z6(e){return!e||!e.file||!e.rank||e.file>8||e.rank>8||e.file<1||e.rank<1?null:`${String.fromCharCode(96+e.file)}${e.rank.toString()}`}function j6(e){const t=[{animate:e.animate,from:e.kingTo||e.to,to:e.from}];e.rookMove&&t.push(Ce(ge({},e.rookMove),{from:e.rookMove.to,to:e.rookMove.from}));const n=e.captured&&e.capturedStr?{color:Vl(e.color),promoted:e.capturedPromotedPawn,square:e.EPCapturedSquare||e.to,type:e.capturedStr.toLowerCase()}:void 0;return{movedPieces:t,promotedSquare:e.promotion?e.from:void 0,restoredPiece:n}}function q6(e,t){var n,r;return(r=(n=e&&t[ct.Node.Marking.JCEColorsMap[e]])!=null?n:e)!=null?r:t.default}const W6={HEAD_HEIGHT:4.5,HEAD_WIDTH:6.5,TAIL_PADDING:4.5,WIDTH:2.75},K6=27.95084971874737,$6=[.5,-2],Z6=[2,.5,-.5,-2];function Jp({from:e,to:t}){return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)}function Y6({from:e,to:t}){const n=Jp({from:e,to:t}),r={x:e.x,y:e.y+n},i={x:e.x-r.x,y:e.y-r.y},o={x:e.x-t.x,y:e.y-t.y},s=Math.acos((i.x*o.x+i.y*o.y)/n**2),l=Math.floor(s*(180/Math.PI)*100)/100;return e.x<t.x?360-l:l}function X6({from:e,to:t}){const n=(e.y-t.y)/(e.x-t.x);return Number(n.toFixed(1))}function Q6({from:e,slope:t,to:n}){switch(t){case 2:return e.x>n.x?180:0;case-2:return e.x>n.x?0:180;case .5:return e.x>n.x?90:270;case-.5:return e.x>n.x?90:270;default:return 0}}const z0=/iPhone/i,em=/iPod/i,tm=/iPad/i,j0=/\bAndroid(?:.+)Mobile\b/i,nm=/Android/i,Vs=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Tc=/Silk/i,fa=/Windows Phone/i,rm=/\bWindows(?:.+)ARM\b/i,im=/BlackBerry/i,om=/BB10/i,am=/Opera Mini/i,sm=/\b(CriOS|Chrome)(?:.+)Mobile/i,lm=/Mobile(?:.+)Firefox\b/i;function Cr(e,t){return e.test(t)}function J6(e){e=e||(typeof navigator<"u"?navigator.userAgent:"");let t=e.split("[FBAN");typeof t[1]<"u"&&(e=t[0]),t=e.split("Twitter"),typeof t[1]<"u"&&(e=t[0]);const n={apple:{phone:Cr(z0,e)&&!Cr(fa,e),ipod:Cr(em,e),tablet:!Cr(z0,e)&&Cr(tm,e)&&!Cr(fa,e),device:(Cr(z0,e)||Cr(em,e)||Cr(tm,e))&&!Cr(fa,e)},amazon:{phone:Cr(Vs,e),tablet:!Cr(Vs,e)&&Cr(Tc,e),device:Cr(Vs,e)||Cr(Tc,e)},android:{phone:!Cr(fa,e)&&Cr(Vs,e)||!Cr(fa,e)&&Cr(j0,e),tablet:!Cr(fa,e)&&!Cr(Vs,e)&&!Cr(j0,e)&&(Cr(Tc,e)||Cr(nm,e)),device:!Cr(fa,e)&&(Cr(Vs,e)||Cr(Tc,e)||Cr(j0,e)||Cr(nm,e))||Cr(/\bokhttp\b/i,e)},windows:{phone:Cr(fa,e),tablet:Cr(rm,e),device:Cr(fa,e)||Cr(rm,e)},other:{blackberry:Cr(im,e),blackberry10:Cr(om,e),opera:Cr(am,e),firefox:Cr(lm,e),chrome:Cr(sm,e),device:Cr(im,e)||Cr(om,e)||Cr(am,e)||Cr(lm,e)||Cr(sm,e)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}/*!
 * @pixi/settings - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Na=J6();function e8(e){var t=!0;if(Na.tablet||Na.phone){if(t=!1,Na.apple.device){var n=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(n){var r=parseInt(n[1],10);r>=11&&(t=!0)}}if(Na.android.device){var i=navigator.userAgent.match(/Android\s([0-9.]*)/);if(i){var o=parseInt(i[1],10);o>=7&&(t=!0)}}}return t?e:4}function t8(){return!Na.apple.device}var Ir={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:e8(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:Na.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:t8(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},um={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(d,f,h){this.fn=d,this.context=f,this.once=h||!1}function o(d,f,h,g,m){if(typeof h!="function")throw new TypeError("The listener must be a function");var S=new i(h,g||d,m),P=n?n+f:f;return d._events[P]?d._events[P].fn?d._events[P]=[d._events[P],S]:d._events[P].push(S):(d._events[P]=S,d._eventsCount++),d}function s(d,f){--d._eventsCount===0?d._events=new r:delete d._events[f]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var f=[],h,g;if(this._eventsCount===0)return f;for(g in h=this._events)t.call(h,g)&&f.push(n?g.slice(1):g);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},l.prototype.listeners=function(f){var h=n?n+f:f,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var m=0,S=g.length,P=new Array(S);m<S;m++)P[m]=g[m].fn;return P},l.prototype.listenerCount=function(f){var h=n?n+f:f,g=this._events[h];return g?g.fn?1:g.length:0},l.prototype.emit=function(f,h,g,m,S,P){var I=n?n+f:f;if(!this._events[I])return!1;var D=this._events[I],be=arguments.length,Ye,Se;if(D.fn){switch(D.once&&this.removeListener(f,D.fn,void 0,!0),be){case 1:return D.fn.call(D.context),!0;case 2:return D.fn.call(D.context,h),!0;case 3:return D.fn.call(D.context,h,g),!0;case 4:return D.fn.call(D.context,h,g,m),!0;case 5:return D.fn.call(D.context,h,g,m,S),!0;case 6:return D.fn.call(D.context,h,g,m,S,P),!0}for(Se=1,Ye=new Array(be-1);Se<be;Se++)Ye[Se-1]=arguments[Se];D.fn.apply(D.context,Ye)}else{var Ze=D.length,mt;for(Se=0;Se<Ze;Se++)switch(D[Se].once&&this.removeListener(f,D[Se].fn,void 0,!0),be){case 1:D[Se].fn.call(D[Se].context);break;case 2:D[Se].fn.call(D[Se].context,h);break;case 3:D[Se].fn.call(D[Se].context,h,g);break;case 4:D[Se].fn.call(D[Se].context,h,g,m);break;default:if(!Ye)for(mt=1,Ye=new Array(be-1);mt<be;mt++)Ye[mt-1]=arguments[mt];D[Se].fn.apply(D[Se].context,Ye)}}return!0},l.prototype.on=function(f,h,g){return o(this,f,h,g,!1)},l.prototype.once=function(f,h,g){return o(this,f,h,g,!0)},l.prototype.removeListener=function(f,h,g,m){var S=n?n+f:f;if(!this._events[S])return this;if(!h)return s(this,S),this;var P=this._events[S];if(P.fn)P.fn===h&&(!m||P.once)&&(!g||P.context===g)&&s(this,S);else{for(var I=0,D=[],be=P.length;I<be;I++)(P[I].fn!==h||m&&!P[I].once||g&&P[I].context!==g)&&D.push(P[I]);D.length?this._events[S]=D.length===1?D[0]:D:s(this,S)}return this},l.prototype.removeAllListeners=function(f){var h;return f?(h=n?n+f:f,this._events[h]&&s(this,h)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,e.exports=l})(um);var ql=um.exports,q0={exports:{}};q0.exports=Mc,q0.exports.default=Mc;function Mc(e,t,n){n=n||2;var r=t&&t.length,i=r?t[0]*n:e.length,o=cm(e,0,i,n,!0),s=[];if(!o||o.next===o.prev)return s;var l,d,f,h,g,m,S;if(r&&(o=a8(e,t,o,n)),e.length>80*n){l=f=e[0],d=h=e[1];for(var P=n;P<i;P+=n)g=e[P],m=e[P+1],g<l&&(l=g),m<d&&(d=m),g>f&&(f=g),m>h&&(h=m);S=Math.max(f-l,h-d),S=S!==0?1/S:0}return Wl(o,s,n,l,d,S),s}function cm(e,t,n,r,i){var o,s;if(i===$0(e,t,n,r)>0)for(o=t;o<n;o+=r)s=hm(o,e[o],e[o+1],s);else for(o=n-r;o>=t;o-=r)s=hm(o,e[o],e[o+1],s);return s&&xc(s,s.next)&&($l(s),s=s.next),s}function La(e,t){if(!e)return e;t||(t=e);var n=e,r;do if(r=!1,!n.steiner&&(xc(n,n.next)||mi(n.prev,n,n.next)===0)){if($l(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function Wl(e,t,n,r,i,o,s){if(e){!s&&o&&d8(e,r,i,o);for(var l=e,d,f;e.prev!==e.next;){if(d=e.prev,f=e.next,o?r8(e,r,i,o):n8(e)){t.push(d.i/n),t.push(e.i/n),t.push(f.i/n),$l(e),e=f.next,l=f.next;continue}if(e=f,e===l){s?s===1?(e=i8(La(e),t,n),Wl(e,t,n,r,i,o,2)):s===2&&o8(e,t,n,r,i,o):Wl(La(e),t,n,r,i,o,1);break}}}}function n8(e){var t=e.prev,n=e,r=e.next;if(mi(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(zs(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&mi(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function r8(e,t,n,r){var i=e.prev,o=e,s=e.next;if(mi(i,o,s)>=0)return!1;for(var l=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,d=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,f=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,h=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,g=W0(l,d,t,n,r),m=W0(f,h,t,n,r),S=e.prevZ,P=e.nextZ;S&&S.z>=g&&P&&P.z<=m;){if(S!==e.prev&&S!==e.next&&zs(i.x,i.y,o.x,o.y,s.x,s.y,S.x,S.y)&&mi(S.prev,S,S.next)>=0||(S=S.prevZ,P!==e.prev&&P!==e.next&&zs(i.x,i.y,o.x,o.y,s.x,s.y,P.x,P.y)&&mi(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;S&&S.z>=g;){if(S!==e.prev&&S!==e.next&&zs(i.x,i.y,o.x,o.y,s.x,s.y,S.x,S.y)&&mi(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;P&&P.z<=m;){if(P!==e.prev&&P!==e.next&&zs(i.x,i.y,o.x,o.y,s.x,s.y,P.x,P.y)&&mi(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function i8(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!xc(i,o)&&dm(i,r,r.next,o)&&Kl(i,o)&&Kl(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),$l(r),$l(r.next),r=e=o),r=r.next}while(r!==e);return La(r)}function o8(e,t,n,r,i,o){var s=e;do{for(var l=s.next.next;l!==s.prev;){if(s.i!==l.i&&p8(s,l)){var d=fm(s,l);s=La(s,s.next),d=La(d,d.next),Wl(s,t,n,r,i,o),Wl(d,t,n,r,i,o);return}l=l.next}s=s.next}while(s!==e)}function a8(e,t,n,r){var i=[],o,s,l,d,f;for(o=0,s=t.length;o<s;o++)l=t[o]*r,d=o<s-1?t[o+1]*r:e.length,f=cm(e,l,d,r,!1),f===f.next&&(f.steiner=!0),i.push(h8(f));for(i.sort(s8),o=0;o<i.length;o++)l8(i[o],n),n=La(n,n.next);return n}function s8(e,t){return e.x-t.x}function l8(e,t){if(t=u8(e,t),t){var n=fm(t,e);La(t,t.next),La(n,n.next)}}function u8(e,t){var n=t,r=e.x,i=e.y,o=-1/0,s;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var l=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=r&&l>o){if(o=l,l===r){if(i===n.y)return n;if(i===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!s)return null;if(r===o)return s;var d=s,f=s.x,h=s.y,g=1/0,m;n=s;do r>=n.x&&n.x>=f&&r!==n.x&&zs(i<h?r:o,i,f,h,i<h?o:r,i,n.x,n.y)&&(m=Math.abs(i-n.y)/(r-n.x),Kl(n,e)&&(m<g||m===g&&(n.x>s.x||n.x===s.x&&c8(s,n)))&&(s=n,g=m)),n=n.next;while(n!==d);return s}function c8(e,t){return mi(e.prev,e,t.prev)<0&&mi(t.next,e,e.next)<0}function d8(e,t,n,r){var i=e;do i.z===null&&(i.z=W0(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,f8(i)}function f8(e){var t,n,r,i,o,s,l,d,f=1;do{for(n=e,e=null,o=null,s=0;n;){for(s++,r=n,l=0,t=0;t<f&&(l++,r=r.nextZ,!!r);t++);for(d=f;l>0||d>0&&r;)l!==0&&(d===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,l--):(i=r,r=r.nextZ,d--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,f*=2}while(s>1);return e}function W0(e,t,n,r,i){return e=32767*(e-n)*i,t=32767*(t-r)*i,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function h8(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function zs(e,t,n,r,i,o,s,l){return(i-s)*(t-l)-(e-s)*(o-l)>=0&&(e-s)*(r-l)-(n-s)*(t-l)>=0&&(n-s)*(o-l)-(i-s)*(r-l)>=0}function p8(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!m8(e,t)&&(Kl(e,t)&&Kl(t,e)&&v8(e,t)&&(mi(e.prev,e,t.prev)||mi(e,t.prev,t))||xc(e,t)&&mi(e.prev,e,e.next)>0&&mi(t.prev,t,t.next)>0)}function mi(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function xc(e,t){return e.x===t.x&&e.y===t.y}function dm(e,t,n,r){var i=Rc(mi(e,t,n)),o=Rc(mi(e,t,r)),s=Rc(mi(n,r,e)),l=Rc(mi(n,r,t));return!!(i!==o&&s!==l||i===0&&Ic(e,n,t)||o===0&&Ic(e,r,t)||s===0&&Ic(n,e,r)||l===0&&Ic(n,t,r))}function Ic(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Rc(e){return e>0?1:e<0?-1:0}function m8(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&dm(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function Kl(e,t){return mi(e.prev,e,e.next)<0?mi(e,t,e.next)>=0&&mi(e,e.prev,t)>=0:mi(e,t,e.prev)<0||mi(e,e.next,t)<0}function v8(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function fm(e,t){var n=new K0(e.i,e.x,e.y),r=new K0(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function hm(e,t,n,r){var i=new K0(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function $l(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function K0(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}Mc.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,s=Math.abs($0(e,0,o,n));if(i)for(var l=0,d=t.length;l<d;l++){var f=t[l]*n,h=l<d-1?t[l+1]*n:e.length;s-=Math.abs($0(e,f,h,n))}var g=0;for(l=0;l<r.length;l+=3){var m=r[l]*n,S=r[l+1]*n,P=r[l+2]*n;g+=Math.abs((e[m]-e[P])*(e[S+1]-e[m+1])-(e[m]-e[S])*(e[P+1]-e[m+1]))}return s===0&&g===0?0:Math.abs((g-s)/s)};function $0(e,t,n,r){for(var i=0,o=t,s=n-r;o<n;o+=r)i+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return i}Mc.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var s=0;s<t;s++)n.vertices.push(e[i][o][s]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n};var g8=q0.exports,js={},Z0={exports:{}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(e,t){(function(n){var r=t&&!t.nodeType&&t,i=e&&!e.nodeType&&e,o=typeof w.V=="object"&&w.V;(o.global===o||o.window===o||o.self===o)&&(n=o);var s,l=2147483647,d=36,f=1,h=26,g=38,m=700,S=72,P=128,I="-",D=/^xn--/,be=/[^\x20-\x7E]/,Ye=/[\x2E\u3002\uFF0E\uFF61]/g,Se={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Ze=d-f,mt=Math.floor,zn=String.fromCharCode,Sn;function tn(ir){throw RangeError(Se[ir])}function Ct(ir,wr){for(var Hr=ir.length,si=[];Hr--;)si[Hr]=wr(ir[Hr]);return si}function Ft(ir,wr){var Hr=ir.split("@"),si="";Hr.length>1&&(si=Hr[0]+"@",ir=Hr[1]),ir=ir.replace(Ye,".");var gi=ir.split("."),Ui=Ct(gi,wr).join(".");return si+Ui}function Ln(ir){for(var wr=[],Hr=0,si=ir.length,gi,Ui;Hr<si;)gi=ir.charCodeAt(Hr++),gi>=55296&&gi<=56319&&Hr<si?(Ui=ir.charCodeAt(Hr++),(Ui&64512)==56320?wr.push(((gi&1023)<<10)+(Ui&1023)+65536):(wr.push(gi),Hr--)):wr.push(gi);return wr}function Zn(ir){return Ct(ir,function(wr){var Hr="";return wr>65535&&(wr-=65536,Hr+=zn(wr>>>10&1023|55296),wr=56320|wr&1023),Hr+=zn(wr),Hr}).join("")}function br(ir){return ir-48<10?ir-22:ir-65<26?ir-65:ir-97<26?ir-97:d}function tr(ir,wr){return ir+22+75*(ir<26)-((wr!=0)<<5)}function kr(ir,wr,Hr){var si=0;for(ir=Hr?mt(ir/m):ir>>1,ir+=mt(ir/wr);ir>Ze*h>>1;si+=d)ir=mt(ir/Ze);return mt(si+(Ze+1)*ir/(ir+g))}function Qn(ir){var wr=[],Hr=ir.length,si,gi=0,Ui=P,ki=S,no,vo,Wt,bn,hr,Zr,li,ci,ti;for(no=ir.lastIndexOf(I),no<0&&(no=0),vo=0;vo<no;++vo)ir.charCodeAt(vo)>=128&&tn("not-basic"),wr.push(ir.charCodeAt(vo));for(Wt=no>0?no+1:0;Wt<Hr;){for(bn=gi,hr=1,Zr=d;Wt>=Hr&&tn("invalid-input"),li=br(ir.charCodeAt(Wt++)),(li>=d||li>mt((l-gi)/hr))&&tn("overflow"),gi+=li*hr,ci=Zr<=ki?f:Zr>=ki+h?h:Zr-ki,!(li<ci);Zr+=d)ti=d-ci,hr>mt(l/ti)&&tn("overflow"),hr*=ti;si=wr.length+1,ki=kr(gi-bn,si,bn==0),mt(gi/si)>l-Ui&&tn("overflow"),Ui+=mt(gi/si),gi%=si,wr.splice(gi++,0,Ui)}return Zn(wr)}function ri(ir){var wr,Hr,si,gi,Ui,ki,no,vo,Wt,bn,hr,Zr=[],li,ci,ti,Hi;for(ir=Ln(ir),li=ir.length,wr=P,Hr=0,Ui=S,ki=0;ki<li;++ki)hr=ir[ki],hr<128&&Zr.push(zn(hr));for(si=gi=Zr.length,gi&&Zr.push(I);si<li;){for(no=l,ki=0;ki<li;++ki)hr=ir[ki],hr>=wr&&hr<no&&(no=hr);for(ci=si+1,no-wr>mt((l-Hr)/ci)&&tn("overflow"),Hr+=(no-wr)*ci,wr=no,ki=0;ki<li;++ki)if(hr=ir[ki],hr<wr&&++Hr>l&&tn("overflow"),hr==wr){for(vo=Hr,Wt=d;bn=Wt<=Ui?f:Wt>=Ui+h?h:Wt-Ui,!(vo<bn);Wt+=d)Hi=vo-bn,ti=d-bn,Zr.push(zn(tr(bn+Hi%ti,0))),vo=mt(Hi/ti);Zr.push(zn(tr(vo,0))),Ui=kr(Hr,ci,si==gi),Hr=0,++si}++Hr,++wr}return Zr.join("")}function Bi(ir){return Ft(ir,function(wr){return D.test(wr)?Qn(wr.slice(4).toLowerCase()):wr})}function Fi(ir){return Ft(ir,function(wr){return be.test(wr)?"xn--"+ri(wr):wr})}if(s={version:"1.3.2",ucs2:{decode:Ln,encode:Zn},decode:Qn,encode:ri,toASCII:Fi,toUnicode:Bi},r&&i)if(e.exports==r)i.exports=s;else for(Sn in s)s.hasOwnProperty(Sn)&&(r[Sn]=s[Sn]);else n.punycode=s})(w.V)})(Z0,Z0.exports);var _8={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}},Zl={};function b8(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var y8=function(e,t,n,r){t=t||"&",n=n||"=";var i={};if(typeof e!="string"||e.length===0)return i;var o=/\+/g;e=e.split(t);var s=1e3;r&&typeof r.maxKeys=="number"&&(s=r.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var d=0;d<l;++d){var f=e[d].replace(o,"%20"),h=f.indexOf(n),g,m,S,P;h>=0?(g=f.substr(0,h),m=f.substr(h+1)):(g=f,m=""),S=decodeURIComponent(g),P=decodeURIComponent(m),b8(i,S)?Array.isArray(i[S])?i[S].push(P):i[S]=[i[S],P]:i[S]=P}return i},Yl=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},E8=function(e,t,n,r){return t=t||"&",n=n||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(i){var o=encodeURIComponent(Yl(i))+n;return Array.isArray(e[i])?e[i].map(function(s){return o+encodeURIComponent(Yl(s))}).join(t):o+encodeURIComponent(Yl(e[i]))}).join(t):r?encodeURIComponent(Yl(r))+n+encodeURIComponent(Yl(e)):""};Zl.decode=Zl.parse=y8,Zl.encode=Zl.stringify=E8;var A8=Z0.exports,Zo=_8,w8=js.parse=Xl;js.resolve=O8,js.resolveObject=N8,js.format=R8,js.Url=Co;function Co(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var S8=/^([a-z0-9.+-]+:)/i,C8=/:[0-9]*$/,k8=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,P8=["<",">",'"',"`"," ","\r",`
`,"	"],T8=["{","}","|","\\","^","`"].concat(P8),Y0=["'"].concat(T8),pm=["%","/","?",";","#"].concat(Y0),mm=["/","?","#"],M8=255,vm=/^[+a-z0-9A-Z_-]{0,63}$/,x8=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,I8={javascript:!0,"javascript:":!0},X0={javascript:!0,"javascript:":!0},qs={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Q0=Zl;function Xl(e,t,n){if(e&&Zo.isObject(e)&&e instanceof Co)return e;var r=new Co;return r.parse(e,t,n),r}Co.prototype.parse=function(e,t,n){if(!Zo.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),i=r!==-1&&r<e.indexOf("#")?"?":"#",o=e.split(i),s=/\\/g;o[0]=o[0].replace(s,"/"),e=o.join(i);var l=e;if(l=l.trim(),!n&&e.split("#").length===1){var d=k8.exec(l);if(d)return this.path=l,this.href=l,this.pathname=d[1],d[2]?(this.search=d[2],t?this.query=Q0.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var f=S8.exec(l);if(f){f=f[0];var h=f.toLowerCase();this.protocol=h,l=l.substr(f.length)}if(n||f||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var g=l.substr(0,2)==="//";g&&!(f&&X0[f])&&(l=l.substr(2),this.slashes=!0)}if(!X0[f]&&(g||f&&!qs[f])){for(var m=-1,S=0;S<mm.length;S++){var P=l.indexOf(mm[S]);P!==-1&&(m===-1||P<m)&&(m=P)}var I,D;m===-1?D=l.lastIndexOf("@"):D=l.lastIndexOf("@",m),D!==-1&&(I=l.slice(0,D),l=l.slice(D+1),this.auth=decodeURIComponent(I)),m=-1;for(var S=0;S<pm.length;S++){var P=l.indexOf(pm[S]);P!==-1&&(m===-1||P<m)&&(m=P)}m===-1&&(m=l.length),this.host=l.slice(0,m),l=l.slice(m),this.parseHost(),this.hostname=this.hostname||"";var be=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!be)for(var Ye=this.hostname.split(/\./),S=0,Se=Ye.length;S<Se;S++){var Ze=Ye[S];if(Ze&&!Ze.match(vm)){for(var mt="",zn=0,Sn=Ze.length;zn<Sn;zn++)Ze.charCodeAt(zn)>127?mt+="x":mt+=Ze[zn];if(!mt.match(vm)){var tn=Ye.slice(0,S),Ct=Ye.slice(S+1),Ft=Ze.match(x8);Ft&&(tn.push(Ft[1]),Ct.unshift(Ft[2])),Ct.length&&(l="/"+Ct.join(".")+l),this.hostname=tn.join(".");break}}}this.hostname.length>M8?this.hostname="":this.hostname=this.hostname.toLowerCase(),be||(this.hostname=A8.toASCII(this.hostname));var Ln=this.port?":"+this.port:"",Zn=this.hostname||"";this.host=Zn+Ln,this.href+=this.host,be&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!I8[h])for(var S=0,Se=Y0.length;S<Se;S++){var br=Y0[S];if(l.indexOf(br)!==-1){var tr=encodeURIComponent(br);tr===br&&(tr=escape(br)),l=l.split(br).join(tr)}}var kr=l.indexOf("#");kr!==-1&&(this.hash=l.substr(kr),l=l.slice(0,kr));var Qn=l.indexOf("?");if(Qn!==-1?(this.search=l.substr(Qn),this.query=l.substr(Qn+1),t&&(this.query=Q0.parse(this.query)),l=l.slice(0,Qn)):t&&(this.search="",this.query={}),l&&(this.pathname=l),qs[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Ln=this.pathname||"",ri=this.search||"";this.path=Ln+ri}return this.href=this.format(),this};function R8(e){return Zo.isString(e)&&(e=Xl(e)),e instanceof Co?e.format():Co.prototype.format.call(e)}Co.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&Zo.isObject(this.query)&&Object.keys(this.query).length&&(o=Q0.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||qs[t])&&i!==!1?(i="//"+(i||""),n&&n.charAt(0)!=="/"&&(n="/"+n)):i||(i=""),r&&r.charAt(0)!=="#"&&(r="#"+r),s&&s.charAt(0)!=="?"&&(s="?"+s),n=n.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),s=s.replace("#","%23"),t+i+n+s+r};function O8(e,t){return Xl(e,!1,!0).resolve(t)}Co.prototype.resolve=function(e){return this.resolveObject(Xl(e,!1,!0)).format()};function N8(e,t){return e?Xl(e,!1,!0).resolveObject(t):t}Co.prototype.resolveObject=function(e){if(Zo.isString(e)){var t=new Co;t.parse(e,!1,!0),e=t}for(var n=new Co,r=Object.keys(this),i=0;i<r.length;i++){var o=r[i];n[o]=this[o]}if(n.hash=e.hash,e.href==="")return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),l=0;l<s.length;l++){var d=s[l];d!=="protocol"&&(n[d]=e[d])}return qs[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!qs[e.protocol]){for(var f=Object.keys(e),h=0;h<f.length;h++){var g=f[h];n[g]=e[g]}return n.href=n.format(),n}if(n.protocol=e.protocol,!e.host&&!X0[e.protocol]){for(var Se=(e.pathname||"").split("/");Se.length&&!(e.host=Se.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),Se[0]!==""&&Se.unshift(""),Se.length<2&&Se.unshift(""),n.pathname=Se.join("/")}else n.pathname=e.pathname;if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var m=n.pathname||"",S=n.search||"";n.path=m+S}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var P=n.pathname&&n.pathname.charAt(0)==="/",I=e.host||e.pathname&&e.pathname.charAt(0)==="/",D=I||P||n.host&&e.pathname,be=D,Ye=n.pathname&&n.pathname.split("/")||[],Se=e.pathname&&e.pathname.split("/")||[],Ze=n.protocol&&!qs[n.protocol];if(Ze&&(n.hostname="",n.port=null,n.host&&(Ye[0]===""?Ye[0]=n.host:Ye.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(Se[0]===""?Se[0]=e.host:Se.unshift(e.host)),e.host=null),D=D&&(Se[0]===""||Ye[0]==="")),I)n.host=e.host||e.host===""?e.host:n.host,n.hostname=e.hostname||e.hostname===""?e.hostname:n.hostname,n.search=e.search,n.query=e.query,Ye=Se;else if(Se.length)Ye||(Ye=[]),Ye.pop(),Ye=Ye.concat(Se),n.search=e.search,n.query=e.query;else if(!Zo.isNullOrUndefined(e.search)){if(Ze){n.hostname=n.host=Ye.shift();var mt=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;mt&&(n.auth=mt.shift(),n.host=n.hostname=mt.shift())}return n.search=e.search,n.query=e.query,(!Zo.isNull(n.pathname)||!Zo.isNull(n.search))&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!Ye.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var zn=Ye.slice(-1)[0],Sn=(n.host||e.host||Ye.length>1)&&(zn==="."||zn==="..")||zn==="",tn=0,Ct=Ye.length;Ct>=0;Ct--)zn=Ye[Ct],zn==="."?Ye.splice(Ct,1):zn===".."?(Ye.splice(Ct,1),tn++):tn&&(Ye.splice(Ct,1),tn--);if(!D&&!be)for(;tn--;tn)Ye.unshift("..");D&&Ye[0]!==""&&(!Ye[0]||Ye[0].charAt(0)!=="/")&&Ye.unshift(""),Sn&&Ye.join("/").substr(-1)!=="/"&&Ye.push("");var Ft=Ye[0]===""||Ye[0]&&Ye[0].charAt(0)==="/";if(Ze){n.hostname=n.host=Ft?"":Ye.length?Ye.shift():"";var mt=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;mt&&(n.auth=mt.shift(),n.host=n.hostname=mt.shift())}return D=D||n.host&&Ye.length,D&&!Ft&&Ye.unshift(""),Ye.length?n.pathname=Ye.join("/"):(n.pathname=null,n.path=null),(!Zo.isNull(n.pathname)||!Zo.isNull(n.search))&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},Co.prototype.parseHost=function(){var e=this.host,t=C8.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};/*!
 * @pixi/constants - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ha;(function(e){e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2"})(ha||(ha={}));var Ql;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS"})(Ql||(Ql={}));var gr;(function(e){e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR"})(gr||(gr={}));var Ws;(function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(Ws||(Ws={}));var Jl;(function(e){e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(Jl||(Jl={}));var Ks;(function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(Ks||(Ks={}));var ko;(function(e){e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.FLOAT=5126]="FLOAT",e[e.HALF_FLOAT=36193]="HALF_FLOAT"})(ko||(ko={}));var Oc;(function(e){e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR"})(Oc||(Oc={}));var Nc;(function(e){e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(Nc||(Nc={}));var J0;(function(e){e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON"})(J0||(J0={}));var Da;(function(e){e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"})(Da||(Da={}));var eh;(function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"})(eh||(eh={}));var Yo;(function(e){e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp"})(Yo||(Yo={}));var mo;(function(e){e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE"})(mo||(mo={}));/*!
 * @pixi/utils - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Ir.RETINA_PREFIX=/@([0-9\.]+)x/,Ir.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var gm=!1,_m="5.2.1";function L8(e){var t;if(!gm){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=[`
 %c %c %c PixiJS `+_m+" - \u2730 "+e+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=window.console).log.apply(t,n)}else window.console&&window.console.log("PixiJS "+_m+" - "+e+" - http://www.pixijs.com/");gm=!0}}var th;function D8(){return typeof th>"u"&&(th=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:Ir.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var n=document.createElement("canvas"),r=n.getContext("webgl",t)||n.getContext("experimental-webgl",t),i=!!(r&&r.getContextAttributes().stencil);if(r){var o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,i}catch{return!1}}()),th}function bm(e,t){return t=t||[],t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t}function ym(e){var t=e.toString(16);return t="000000".substr(0,6-t.length)+t,"#"+t}function B8(e){return typeof e=="string"&&e[0]==="#"&&(e=e.substr(1)),parseInt(e,16)}function F8(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)}function U8(){for(var e=[],t=[],n=0;n<32;n++)e[n]=n,t[n]=n;e[gr.NORMAL_NPM]=gr.NORMAL,e[gr.ADD_NPM]=gr.ADD,e[gr.SCREEN_NPM]=gr.SCREEN,t[gr.NORMAL]=gr.NORMAL_NPM,t[gr.ADD]=gr.ADD_NPM,t[gr.SCREEN]=gr.SCREEN_NPM;var r=[];return r.push(t),r.push(e),r}var Em=U8();function H8(e,t){return Em[t?1:0][e]}function G8(e,t,n,r){return n=n||new Float32Array(4),r||r===void 0?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t):(n[0]=e[0],n[1]=e[1],n[2]=e[2]),n[3]=t,n}function Am(e,t){if(t===1)return(t*255<<24)+e;if(t===0)return 0;var n=e>>16&255,r=e>>8&255,i=e&255;return n=n*t+.5|0,r=r*t+.5|0,i=i*t+.5|0,(t*255<<24)+(n<<16)+(r<<8)+i}function V8(e,t,n,r){return n=n||new Float32Array(4),n[0]=(e>>16&255)/255,n[1]=(e>>8&255)/255,n[2]=(e&255)/255,(r||r===void 0)&&(n[0]*=t,n[1]*=t,n[2]*=t),n[3]=t,n}function z8(e,t){t===void 0&&(t=null);var n=e*6;if(t=t||new Uint16Array(n),t.length!==n)throw new Error("Out buffer length is incorrect, got "+t.length+" and expected "+n);for(var r=0,i=0;r<n;r+=6,i+=4)t[r+0]=i+0,t[r+1]=i+1,t[r+2]=i+2,t[r+3]=i+0,t[r+4]=i+2,t[r+5]=i+3;return t}function Lc(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function wm(e){return!(e&e-1)&&!!e}function Sm(e){var t=(e>65535?1:0)<<4;e>>>=t;var n=(e>255?1:0)<<3;return e>>>=n,t|=n,n=(e>15?1:0)<<2,e>>>=n,t|=n,n=(e>3?1:0)<<1,e>>>=n,t|=n,t|e>>1}function eu(e,t,n){var r=e.length,i;if(!(t>=r||n===0)){n=t+n>r?r-t:n;var o=r-n;for(i=t;i<o;++i)e[i]=e[i+n];e.length=o}}function j8(e){return e===0?0:e<0?-1:1}var q8=0;function tu(){return++q8}var Cm={};function km(e,t,n){if(n===void 0&&(n=3),!Cm[t]){var r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",t+`
Deprecated since v`+e):(r=r.split(`
`).splice(n).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+`
Deprecated since v`+e),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+`
Deprecated since v`+e),console.warn(r))),Cm[t]=!0}}var Pm={},pa=Object.create(null),Ba=Object.create(null),W8=function(){function e(t,n,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||Ir.RESOLUTION,this.resize(t,n)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(t,n){this.canvas.width=t*this.resolution,this.canvas.height=n*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0}),e}();function K8(e){var t=e.width,n=e.height,r=e.getContext("2d"),i=r.getImageData(0,0,t,n),o=i.data,s=o.length,l={top:null,left:null,right:null,bottom:null},d=null,f,h,g;for(f=0;f<s;f+=4)o[f+3]!==0&&(h=f/4%t,g=~~(f/4/t),l.top===null&&(l.top=g),(l.left===null||h<l.left)&&(l.left=h),(l.right===null||l.right<h)&&(l.right=h+1),(l.bottom===null||l.bottom<g)&&(l.bottom=g));return l.top!==null&&(t=l.right-l.left,n=l.bottom-l.top+1,d=r.getImageData(l.left,l.top,t,n)),{height:n,width:t,data:d}}var Dc;function $8(e,t){if(t===void 0&&(t=window.location),e.indexOf("data:")===0)return"";t=t||window.location,Dc||(Dc=document.createElement("a")),Dc.href=e;var n=w8(Dc.href),r=!n.port&&t.port===""||n.port===t.port;return n.hostname!==t.hostname||!r||n.protocol!==t.protocol?"anonymous":""}function nh(e,t){var n=Ir.RETINA_PREFIX.exec(e);return n?parseFloat(n[1]):t!==void 0?t:1}/*!
 * @pixi/math - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var $s=function(){function e(t,n){t===void 0&&(t=0),n===void 0&&(n=0),this.x=t,this.y=n}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},e.prototype.copyTo=function(t){return t.set(this.x,this.y),t},e.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},e.prototype.set=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=t),this.x=t,this.y=n,this},e}(),nu=function(){function e(t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=n}return e.prototype.clone=function(t,n){return t===void 0&&(t=this.cb),n===void 0&&(n=this.scope),new e(t,n,this._x,this._y)},e.prototype.set=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=t),(this._x!==t||this._y!==n)&&(this._x=t,this._y=n,this.cb.call(this.scope)),this},e.prototype.copyFrom=function(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},e.prototype.copyTo=function(t){return t.set(this._x,this._y),t},e.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),e}(),Tm=Math.PI*2,Z8=180/Math.PI,Mm=Math.PI/180,Fa;(function(e){e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC"})(Fa||(Fa={}));var Po=function(){function e(t,n,r,i,o,s){t===void 0&&(t=1),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=1),o===void 0&&(o=0),s===void 0&&(s=0),this.array=null,this.a=t,this.b=n,this.c=r,this.d=i,this.tx=o,this.ty=s}return e.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},e.prototype.set=function(t,n,r,i,o,s){return this.a=t,this.b=n,this.c=r,this.d=i,this.tx=o,this.ty=s,this},e.prototype.toArray=function(t,n){this.array||(this.array=new Float32Array(9));var r=n||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},e.prototype.apply=function(t,n){n=n||new $s;var r=t.x,i=t.y;return n.x=this.a*r+this.c*i+this.tx,n.y=this.b*r+this.d*i+this.ty,n},e.prototype.applyInverse=function(t,n){n=n||new $s;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,o=t.y;return n.x=this.d*r*i+-this.c*r*o+(this.ty*this.c-this.tx*this.d)*r,n.y=this.a*r*o+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,n},e.prototype.translate=function(t,n){return this.tx+=t,this.ty+=n,this},e.prototype.scale=function(t,n){return this.a*=t,this.d*=n,this.c*=t,this.b*=n,this.tx*=t,this.ty*=n,this},e.prototype.rotate=function(t){var n=Math.cos(t),r=Math.sin(t),i=this.a,o=this.c,s=this.tx;return this.a=i*n-this.b*r,this.b=i*r+this.b*n,this.c=o*n-this.d*r,this.d=o*r+this.d*n,this.tx=s*n-this.ty*r,this.ty=s*r+this.ty*n,this},e.prototype.append=function(t){var n=this.a,r=this.b,i=this.c,o=this.d;return this.a=t.a*n+t.b*i,this.b=t.a*r+t.b*o,this.c=t.c*n+t.d*i,this.d=t.c*r+t.d*o,this.tx=t.tx*n+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*o+this.ty,this},e.prototype.setTransform=function(t,n,r,i,o,s,l,d,f){return this.a=Math.cos(l+f)*o,this.b=Math.sin(l+f)*o,this.c=-Math.sin(l-d)*s,this.d=Math.cos(l-d)*s,this.tx=t-(r*this.a+i*this.c),this.ty=n-(r*this.b+i*this.d),this},e.prototype.prepend=function(t){var n=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=n*t.a+this.ty*t.c+t.tx,this.ty=n*t.b+this.ty*t.d+t.ty,this},e.prototype.decompose=function(t){var n=this.a,r=this.b,i=this.c,o=this.d,s=-Math.atan2(-i,o),l=Math.atan2(r,n),d=Math.abs(s+l);return d<1e-5||Math.abs(Tm-d)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=l),t.scale.x=Math.sqrt(n*n+r*r),t.scale.y=Math.sqrt(i*i+o*o),t.position.x=this.tx,t.position.y=this.ty,t},e.prototype.invert=function(){var t=this.a,n=this.b,r=this.c,i=this.d,o=this.tx,s=t*i-n*r;return this.a=i/s,this.b=-n/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*o)/s,this.ty=-(t*this.ty-n*o)/s,this},e.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(e,"IDENTITY",{get:function(){return new e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TEMP_MATRIX",{get:function(){return new e},enumerable:!0,configurable:!0}),e}(),ds=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],fs=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],hs=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ps=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rh=[],xm=[],Bc=Math.sign;function Y8(){for(var e=0;e<16;e++){var t=[];rh.push(t);for(var n=0;n<16;n++)for(var r=Bc(ds[e]*ds[n]+hs[e]*fs[n]),i=Bc(fs[e]*ds[n]+ps[e]*fs[n]),o=Bc(ds[e]*hs[n]+hs[e]*ps[n]),s=Bc(fs[e]*hs[n]+ps[e]*ps[n]),l=0;l<16;l++)if(ds[l]===r&&fs[l]===i&&hs[l]===o&&ps[l]===s){t.push(l);break}}for(var e=0;e<16;e++){var d=new Po;d.set(ds[e],fs[e],hs[e],ps[e],0,0),xm.push(d)}}Y8();var vi={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(e){return ds[e]},uY:function(e){return fs[e]},vX:function(e){return hs[e]},vY:function(e){return ps[e]},inv:function(e){return e&8?e&15:-e&7},add:function(e,t){return rh[e][t]},sub:function(e,t){return rh[e][vi.inv(t)]},rotate180:function(e){return e^4},isVertical:function(e){return(e&3)===2},byDirection:function(e,t){return Math.abs(e)*2<=Math.abs(t)?t>=0?vi.S:vi.N:Math.abs(t)*2<=Math.abs(e)?e>0?vi.E:vi.W:t>0?e>0?vi.SE:vi.SW:e>0?vi.NE:vi.NW},matrixAppendRotationInv:function(e,t,n,r){n===void 0&&(n=0),r===void 0&&(r=0);var i=xm[vi.inv(t)];i.tx=n,i.ty=r,e.append(i)}},X8=function(){function e(){this.worldTransform=new Po,this.localTransform=new Po,this.position=new nu(this.onChange,this,0,0),this.scale=new nu(this.onChange,this,1,1),this.pivot=new nu(this.onChange,this,0,0),this.skew=new nu(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},e.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(t){var n=this.localTransform;if(this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=n.a*r.a+n.b*r.c,i.b=n.a*r.b+n.b*r.d,i.c=n.c*r.a+n.d*r.c,i.d=n.c*r.b+n.d*r.d,i.tx=n.tx*r.a+n.ty*r.c+r.tx,i.ty=n.tx*r.b+n.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},e.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),e.IDENTITY=new e,e}(),Ni=function(){function e(t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=Number(t),this.y=Number(n),this.width=Number(r),this.height=Number(i),this.type=Fa.RECT}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EMPTY",{get:function(){return new e(0,0,0,0)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},e.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},e.prototype.contains=function(t,n){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&n>=this.y&&n<this.y+this.height},e.prototype.pad=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=t),this.x-=t,this.y-=n,this.width+=t*2,this.height+=n*2,this},e.prototype.fit=function(t){var n=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=n,this.width=Math.max(r-n,0),this.y=i,this.height=Math.max(o-i,0),this},e.prototype.ceil=function(t,n){t===void 0&&(t=1),n===void 0&&(n=.001);var r=Math.ceil((this.x+this.width-n)*t)/t,i=Math.ceil((this.y+this.height-n)*t)/t;return this.x=Math.floor((this.x+n)*t)/t,this.y=Math.floor((this.y+n)*t)/t,this.width=r-this.x,this.height=i-this.y,this},e.prototype.enlarge=function(t){var n=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=n,this.width=r-n,this.y=i,this.height=o-i,this},e}(),Q8=function(){function e(t,n,r){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),this.x=t,this.y=n,this.radius=r,this.type=Fa.CIRC}return e.prototype.clone=function(){return new e(this.x,this.y,this.radius)},e.prototype.contains=function(t,n){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,o=this.y-n;return i*=i,o*=o,i+o<=r},e.prototype.getBounds=function(){return new Ni(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},e}(),J8=function(){function e(t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=t,this.y=n,this.width=r,this.height=i,this.type=Fa.ELIP}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.contains=function(t,n){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(n-this.y)/this.height;return r*=r,i*=i,r+i<=1},e.prototype.getBounds=function(){return new Ni(this.x-this.width,this.y-this.height,this.width,this.height)},e}(),eb=function(){function e(){for(var t=arguments,n=[],r=0;r<arguments.length;r++)n[r]=t[r];if(Array.isArray(n[0])&&(n=n[0]),n[0]instanceof $s){n=n;for(var i=[],o=0,s=n.length;o<s;o++)i.push(n[o].x,n[o].y);n=i}this.points=n,this.type=Fa.POLY,this.closeStroke=!0}return e.prototype.clone=function(){var t=this.points.slice(),n=new e(t);return n.closeStroke=this.closeStroke,n},e.prototype.contains=function(t,n){for(var r=!1,i=this.points.length/2,o=0,s=i-1;o<i;s=o++){var l=this.points[o*2],d=this.points[o*2+1],f=this.points[s*2],h=this.points[s*2+1],g=d>n!=h>n&&t<(f-l)*((n-d)/(h-d))+l;g&&(r=!r)}return r},e}(),tb=function(){function e(t,n,r,i,o){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0),o===void 0&&(o=20),this.x=t,this.y=n,this.width=r,this.height=i,this.radius=o,this.type=Fa.RREC}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.radius)},e.prototype.contains=function(t,n){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){if(n>=this.y+this.radius&&n<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=n-(this.y+this.radius),o=this.radius*this.radius;if(r*r+i*i<=o||(r=t-(this.x+this.width-this.radius),r*r+i*i<=o)||(i=n-(this.y+this.height-this.radius),r*r+i*i<=o)||(r=t-(this.x+this.radius),r*r+i*i<=o))return!0}return!1},e}();/*!
 * @pixi/display - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Ir.SORTABLE_CHILDREN=!1;var Ii=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};Ii.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Ii.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Ii.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Ni.EMPTY:(t=t||new Ni(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Ii.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Ii.prototype.addQuad=function(t){var n=this.minX,r=this.minY,i=this.maxX,o=this.maxY,s=t[0],l=t[1];n=s<n?s:n,r=l<r?l:r,i=s>i?s:i,o=l>o?l:o,s=t[2],l=t[3],n=s<n?s:n,r=l<r?l:r,i=s>i?s:i,o=l>o?l:o,s=t[4],l=t[5],n=s<n?s:n,r=l<r?l:r,i=s>i?s:i,o=l>o?l:o,s=t[6],l=t[7],n=s<n?s:n,r=l<r?l:r,i=s>i?s:i,o=l>o?l:o,this.minX=n,this.minY=r,this.maxX=i,this.maxY=o},Ii.prototype.addFrame=function(t,n,r,i,o){this.addFrameMatrix(t.worldTransform,n,r,i,o)},Ii.prototype.addFrameMatrix=function(t,n,r,i,o){var s=t.a,l=t.b,d=t.c,f=t.d,h=t.tx,g=t.ty,m=this.minX,S=this.minY,P=this.maxX,I=this.maxY,D=s*n+d*r+h,be=l*n+f*r+g;m=D<m?D:m,S=be<S?be:S,P=D>P?D:P,I=be>I?be:I,D=s*i+d*r+h,be=l*i+f*r+g,m=D<m?D:m,S=be<S?be:S,P=D>P?D:P,I=be>I?be:I,D=s*n+d*o+h,be=l*n+f*o+g,m=D<m?D:m,S=be<S?be:S,P=D>P?D:P,I=be>I?be:I,D=s*i+d*o+h,be=l*i+f*o+g,m=D<m?D:m,S=be<S?be:S,P=D>P?D:P,I=be>I?be:I,this.minX=m,this.minY=S,this.maxX=P,this.maxY=I},Ii.prototype.addVertexData=function(t,n,r){for(var i=this.minX,o=this.minY,s=this.maxX,l=this.maxY,d=n;d<r;d+=2){var f=t[d],h=t[d+1];i=f<i?f:i,o=h<o?h:o,s=f>s?f:s,l=h>l?h:l}this.minX=i,this.minY=o,this.maxX=s,this.maxY=l},Ii.prototype.addVertices=function(t,n,r,i){this.addVerticesMatrix(t.worldTransform,n,r,i)},Ii.prototype.addVerticesMatrix=function(t,n,r,i,o,s){var l=t.a,d=t.b,f=t.c,h=t.d,g=t.tx,m=t.ty;o=o||0,s=s||0;for(var S=this.minX,P=this.minY,I=this.maxX,D=this.maxY,be=r;be<i;be+=2){var Ye=n[be],Se=n[be+1],Ze=l*Ye+f*Se+g,mt=h*Se+d*Ye+m;S=Math.min(S,Ze-o),I=Math.max(I,Ze+o),P=Math.min(P,mt-s),D=Math.max(D,mt+s)}this.minX=S,this.minY=P,this.maxX=I,this.maxY=D},Ii.prototype.addBounds=function(t){var n=this.minX,r=this.minY,i=this.maxX,o=this.maxY;this.minX=t.minX<n?t.minX:n,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>o?t.maxY:o},Ii.prototype.addBoundsMask=function(t,n){var r=t.minX>n.minX?t.minX:n.minX,i=t.minY>n.minY?t.minY:n.minY,o=t.maxX<n.maxX?t.maxX:n.maxX,s=t.maxY<n.maxY?t.maxY:n.maxY;if(r<=o&&i<=s){var l=this.minX,d=this.minY,f=this.maxX,h=this.maxY;this.minX=r<l?r:l,this.minY=i<d?i:d,this.maxX=o>f?o:f,this.maxY=s>h?s:h}},Ii.prototype.addBoundsMatrix=function(t,n){this.addFrameMatrix(n,t.minX,t.minY,t.maxX,t.maxY)},Ii.prototype.addBoundsArea=function(t,n){var r=t.minX>n.x?t.minX:n.x,i=t.minY>n.y?t.minY:n.y,o=t.maxX<n.x+n.width?t.maxX:n.x+n.width,s=t.maxY<n.y+n.height?t.maxY:n.y+n.height;if(r<=o&&i<=s){var l=this.minX,d=this.minY,f=this.maxX,h=this.maxY;this.minX=r<l?r:l,this.minY=i<d?i:d,this.maxX=o>f?o:f,this.maxY=s>h?s:h}},Ii.prototype.pad=function(t,n){t=t||0,n=n||(n!==0?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=n,this.maxY+=n)},Ii.prototype.addFramePad=function(t,n,r,i,o,s){t-=o,n-=s,r+=o,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<n?this.minY:n,this.maxY=this.maxY>i?this.maxY:i};var Fc=function(e){function t(){e.call(this),this.tempDisplayObjectParent=null,this.transform=new X8,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Ii,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return t.mixin=function(i){for(var o=Object.keys(i),s=0;s<o.length;++s){var l=o[s];Object.defineProperty(t.prototype,l,Object.getOwnPropertyDescriptor(i,l))}},n._tempDisplayObjectParent.get=function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new t),this.tempDisplayObjectParent},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.calculateBounds=function(){},t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.getBounds=function(i,o){return i||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),o||(this._boundsRect||(this._boundsRect=new Ni),o=this._boundsRect),this._bounds.getRectangle(o)},t.prototype.getLocalBounds=function(i){var o=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,i||(this._localBoundsRect||(this._localBoundsRect=new Ni),i=this._localBoundsRect);var l=this.getBounds(!1,i);return this.parent=s,this.transform=o,l},t.prototype.toGlobal=function(i,o,s){return s===void 0&&(s=!1),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(i,o)},t.prototype.toLocal=function(i,o,s,l){return o&&(i=o.toGlobal(i,s,l)),l||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(i,s)},t.prototype.render=function(i){},t.prototype.setParent=function(i){if(!i||!i.addChild)throw new Error("setParent: Argument must be a Container");return i.addChild(this),i},t.prototype.setTransform=function(i,o,s,l,d,f,h,g,m){return i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=1),l===void 0&&(l=1),d===void 0&&(d=0),f===void 0&&(f=0),h===void 0&&(h=0),g===void 0&&(g=0),m===void 0&&(m=0),this.position.x=i,this.position.y=o,this.scale.x=s||1,this.scale.y=l||1,this.rotation=d,this.skew.x=f,this.skew.y=h,this.pivot.x=g,this.pivot.y=m,this},t.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},n.x.get=function(){return this.position.x},n.x.set=function(r){this.transform.position.x=r},n.y.get=function(){return this.position.y},n.y.set=function(r){this.transform.position.y=r},n.worldTransform.get=function(){return this.transform.worldTransform},n.localTransform.get=function(){return this.transform.localTransform},n.position.get=function(){return this.transform.position},n.position.set=function(r){this.transform.position.copyFrom(r)},n.scale.get=function(){return this.transform.scale},n.scale.set=function(r){this.transform.scale.copyFrom(r)},n.pivot.get=function(){return this.transform.pivot},n.pivot.set=function(r){this.transform.pivot.copyFrom(r)},n.skew.get=function(){return this.transform.skew},n.skew.set=function(r){this.transform.skew.copyFrom(r)},n.rotation.get=function(){return this.transform.rotation},n.rotation.set=function(r){this.transform.rotation=r},n.angle.get=function(){return this.transform.rotation*Z8},n.angle.set=function(r){this.transform.rotation=r*Mm},n.zIndex.get=function(){return this._zIndex},n.zIndex.set=function(r){this._zIndex=r,this.parent&&(this.parent.sortDirty=!0)},n.worldVisible.get=function(){var r=this;do{if(!r.visible)return!1;r=r.parent}while(r);return!0},n.mask.get=function(){return this._mask},n.mask.set=function(r){if(this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!0,i.isMask=!1}if(this._mask=r,this._mask){var o=this._mask.maskObject||this._mask;o.renderable=!1,o.isMask=!0}},Object.defineProperties(t.prototype,n),t}(ql);Fc.prototype.displayObjectUpdateTransform=Fc.prototype.updateTransform;function nb(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}var Uc=function(e){function t(){e.call(this),this.children=[],this.sortableChildren=Ir.SORTABLE_CHILDREN,this.sortDirty=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={width:{configurable:!0},height:{configurable:!0}};return t.prototype.onChildrenChange=function(){},t.prototype.addChild=function(i){var o=arguments,s=arguments.length;if(s>1)for(var l=0;l<s;l++)this.addChild(o[l]);else i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.push(i),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",i,this,this.children.length-1),i.emit("added",this);return i},t.prototype.addChildAt=function(i,o){if(o<0||o>this.children.length)throw new Error(i+"addChildAt: The index "+o+" supplied is out of bounds "+this.children.length);return i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.splice(o,0,i),this._boundsID++,this.onChildrenChange(o),i.emit("added",this),this.emit("childAdded",i,this,o),i},t.prototype.swapChildren=function(i,o){if(i!==o){var s=this.getChildIndex(i),l=this.getChildIndex(o);this.children[s]=o,this.children[l]=i,this.onChildrenChange(s<l?s:l)}},t.prototype.getChildIndex=function(i){var o=this.children.indexOf(i);if(o===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return o},t.prototype.setChildIndex=function(i,o){if(o<0||o>=this.children.length)throw new Error("The index "+o+" supplied is out of bounds "+this.children.length);var s=this.getChildIndex(i);eu(this.children,s,1),this.children.splice(o,0,i),this.onChildrenChange(o)},t.prototype.getChildAt=function(i){if(i<0||i>=this.children.length)throw new Error("getChildAt: Index ("+i+") does not exist.");return this.children[i]},t.prototype.removeChild=function(i){var o=arguments,s=arguments.length;if(s>1)for(var l=0;l<s;l++)this.removeChild(o[l]);else{var d=this.children.indexOf(i);if(d===-1)return null;i.parent=null,i.transform._parentID=-1,eu(this.children,d,1),this._boundsID++,this.onChildrenChange(d),i.emit("removed",this),this.emit("childRemoved",i,this,d)}return i},t.prototype.removeChildAt=function(i){var o=this.getChildAt(i);return o.parent=null,o.transform._parentID=-1,eu(this.children,i,1),this._boundsID++,this.onChildrenChange(i),o.emit("removed",this),this.emit("childRemoved",o,this,i),o},t.prototype.removeChildren=function(i,o){i===void 0&&(i=0);var s=i,l=typeof o=="number"?o:this.children.length,d=l-s,f;if(d>0&&d<=l){f=this.children.splice(s,d);for(var h=0;h<f.length;++h)f[h].parent=null,f[h].transform&&(f[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(i);for(var g=0;g<f.length;++g)f[g].emit("removed",this),this.emit("childRemoved",f[g],this,g);return f}else if(d===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var i=!1,o=0,s=this.children.length;o<s;++o){var l=this.children[o];l._lastSortedIndex=o,!i&&l.zIndex!==0&&(i=!0)}i&&this.children.length>1&&this.children.sort(nb),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var i=0,o=this.children.length;i<o;++i){var s=this.children[i];s.visible&&s.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var i=0;i<this.children.length;i++){var o=this.children[i];if(!(!o.visible||!o.renderable))if(o.calculateBounds(),o._mask){var s=o._mask.maskObject||o._mask;s.calculateBounds(),this._bounds.addBoundsMask(o._bounds,s._bounds)}else o.filterArea?this._bounds.addBoundsArea(o._bounds,o.filterArea):this._bounds.addBounds(o._bounds)}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.render=function(i){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(i);else{this._render(i);for(var o=0,s=this.children.length;o<s;++o)this.children[o].render(i)}},t.prototype.renderAdvanced=function(i){i.batch.flush();var o=this.filters,s=this._mask;if(o){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var l=0;l<o.length;l++)o[l].enabled&&this._enabledFilters.push(o[l]);this._enabledFilters.length&&i.filter.push(this,this._enabledFilters)}s&&i.mask.push(this,this._mask),this._render(i);for(var d=0,f=this.children.length;d<f;d++)this.children[d].render(i);i.batch.flush(),s&&i.mask.pop(this,this._mask),o&&this._enabledFilters&&this._enabledFilters.length&&i.filter.pop()},t.prototype._render=function(i){},t.prototype.destroy=function(i){e.prototype.destroy.call(this),this.sortDirty=!1;var o=typeof i=="boolean"?i:i&&i.children,s=this.removeChildren(0,this.children.length);if(o)for(var l=0;l<s.length;++l)s[l].destroy(i)},n.width.get=function(){return this.scale.x*this.getLocalBounds().width},n.width.set=function(r){var i=this.getLocalBounds().width;i!==0?this.scale.x=r/i:this.scale.x=1,this._width=r},n.height.get=function(){return this.scale.y*this.getLocalBounds().height},n.height.set=function(r){var i=this.getLocalBounds().height;i!==0?this.scale.y=r/i:this.scale.y=1,this._height=r},Object.defineProperties(t.prototype,n),t}(Fc);Uc.prototype.containerUpdateTransform=Uc.prototype.updateTransform;/*!
 * @pixi/ticker - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Ir.TARGET_FPMS=.06;var Zs;(function(e){e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY"})(Zs||(Zs={}));var ih=function(){function e(t,n,r,i){n===void 0&&(n=null),r===void 0&&(r=0),i===void 0&&(i=!1),this.fn=t,this.context=n,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return e.prototype.match=function(t,n){return n===void 0&&(n=null),this.fn===t&&this.context===n},e.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var n=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),n},e.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},e.prototype.destroy=function(t){t===void 0&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var n=this.next;return this.next=t?null:n,this.previous=null,n},e}(),ma=function(){function e(){var t=this;this._head=new ih(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Ir.TARGET_FPMS,this.elapsedMS=1/Ir.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(n){t._requestId=null,t.started&&(t.update(n),t.started&&t._requestId===null&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return e.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(t,n,r){return r===void 0&&(r=Zs.NORMAL),this._addListener(new ih(t,n,r))},e.prototype.addOnce=function(t,n,r){return r===void 0&&(r=Zs.NORMAL),this._addListener(new ih(t,n,r,!0))},e.prototype._addListener=function(t){var n=this._head.next,r=this._head;if(!n)t.connect(r);else{for(;n;){if(t.priority>n.priority){t.connect(r);break}r=n,n=n.next}t.previous||t.connect(r)}return this._startIfPossible(),this},e.prototype.remove=function(t,n){for(var r=this._head.next;r;)r.match(t,n)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(e.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,n=this._head;n=n.next;)t++;return t},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},e.prototype.update=function(t){t===void 0&&(t=performance.now());var n;if(t>this.lastTime){if(n=this.elapsedMS=t-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*Ir.TARGET_FPMS;for(var i=this._head,o=i.next;o;)o=o.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(e.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var n=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,n)/1e3,Ir.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(t===0)this._minElapsedMS=0;else{var n=Math.max(this.minFPS,t);this._minElapsedMS=1/(n/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"shared",{get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared},enumerable:!0,configurable:!0}),Object.defineProperty(e,"system",{get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system},enumerable:!0,configurable:!0}),e}(),rb=function(){function e(){}return e.init=function(t){var n=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Zs.LOW)},get:function(){return this._ticker}}),this.stop=function(){n._ticker.stop()},this.start=function(){n._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ma.shared:new ma,t.autoStart&&this.start()},e.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},e}();/*!
 * @pixi/runner - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var qi=function(){function e(t){this.items=[],this._name=t,this._aliasCount=0}return e.prototype.emit=function(t,n,r,i,o,s,l,d){if(arguments.length>8)throw new Error("max arguments reached");var f=this,h=f.name,g=f.items;this._aliasCount++;for(var m=0,S=g.length;m<S;m++)g[m][h](t,n,r,i,o,s,l,d);return g===this.items&&this._aliasCount--,this},e.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},e.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},e.prototype.remove=function(t){var n=this.items.indexOf(t);return n!==-1&&(this.ensureNonAliasedItems(),this.items.splice(n,1)),this},e.prototype.contains=function(t){return this.items.indexOf(t)!==-1},e.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},e.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(e.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e}();Object.defineProperties(qi.prototype,{dispatch:{value:qi.prototype.emit},run:{value:qi.prototype.emit}});/*!
 * @pixi/core - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ro=function(t,n){t===void 0&&(t=0),n===void 0&&(n=0),this._width=t,this._height=n,this.destroyed=!1,this.internal=!1,this.onResize=new qi("setRealSize",2),this.onUpdate=new qi("update"),this.onError=new qi("onError",1)},Hc={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};ro.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},ro.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},ro.prototype.resize=function(t,n){(t!==this._width||n!==this._height)&&(this._width=t,this._height=n,this.onResize.run(t,n))},Hc.valid.get=function(){return!!this._width&&!!this._height},ro.prototype.update=function(){this.destroyed||this.onUpdate.run()},ro.prototype.load=function(){return Promise.resolve()},Hc.width.get=function(){return this._width},Hc.height.get=function(){return this._height},ro.prototype.upload=function(t,n,r){return!1},ro.prototype.style=function(t,n,r){return!1},ro.prototype.dispose=function(){},ro.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(ro.prototype,Hc);var ru=function(e){function t(n){var r=n.naturalWidth||n.videoWidth||n.width,i=n.naturalHeight||n.videoHeight||n.height;e.call(this,r,i),this.source=n,this.noSubImage=!1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.crossOrigin=function(r,i,o){o===void 0&&i.indexOf("data:")!==0?r.crossOrigin=$8(i):o!==!1&&(r.crossOrigin=typeof o=="string"?o:"anonymous")},t.prototype.upload=function(r,i,o,s){var l=r.gl,d=i.realWidth,f=i.realHeight;return s=s||this.source,l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===Da.UNPACK),!this.noSubImage&&i.target===l.TEXTURE_2D&&o.width===d&&o.height===f?l.texSubImage2D(l.TEXTURE_2D,0,0,0,i.format,i.type,s):(o.width=d,o.height=f,l.texImage2D(i.target,0,i.format,i.format,i.type,s)),!0},t.prototype.update=function(){if(!this.destroyed){var r=this.source.naturalWidth||this.source.videoWidth||this.source.width,i=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(r,i),e.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(ro),oh=function(e){function t(n,r){if(r=r||{},!(n instanceof HTMLImageElement)){var i=new Image;e.crossOrigin(i,n,r.crossorigin),i.src=n,n=i}e.call(this,n),!n.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=n.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap!==void 0?r.createBitmap:Ir.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,r.premultiplyAlpha!==void 0&&(this.premultiplyAlpha=r.premultiplyAlpha),this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(r){var i=this;return r!==void 0&&(this.createBitmap=r),this._load?this._load:(this._load=new Promise(function(o){i.url=i.source.src;var s=i,l=s.source,d=function(){i.destroyed||(l.onload=null,l.onerror=null,i.resize(l.width,l.height),i._load=null,i.createBitmap?o(i.process()):o(i))};l.complete&&l.src?d():(l.onload=d,l.onerror=function(f){return i.onError.run(f)})}),this._load)},t.prototype.process=function(){var r=this;return this._process!==null?this._process:this.bitmap!==null||!window.createImageBitmap?Promise.resolve(this):(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===Da.UNPACK?"premultiply":"none"}).then(function(i){return r.destroyed?Promise.reject():(r.bitmap=i,r.update(),r._process=null,Promise.resolve(r))}),this._process)},t.prototype.upload=function(r,i,o){if(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,r,i,o);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,r,i,o,this.bitmap),!this.preserveBitmap){var s=!0;for(var l in i._glTextures){var d=i._glTextures[l];if(d!==o&&d.dirtyId!==i.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(ru),ah=[];function Im(e,t){if(!e)return null;var n="";if(typeof e=="string"){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);r&&(n=r[1].toLowerCase())}for(var i=ah.length-1;i>=0;--i){var o=ah[i];if(o.test&&o.test(e,n))return new o(e,t)}return new oh(e,t)}var sh=function(e){function t(n,r){var i=r||{},o=i.width,s=i.height;if(!o||!s)throw new Error("BufferResource width or height invalid");e.call(this,o,s),this.data=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.upload=function(r,i,o){var s=r.gl;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===Da.UNPACK),o.width===i.width&&o.height===i.height?s.texSubImage2D(i.target,0,0,0,i.width,i.height,i.format,i.type,this.data):(o.width=i.width,o.height=i.height,s.texImage2D(i.target,0,o.internalFormat,i.width,i.height,0,i.format,o.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(r){return r instanceof Float32Array||r instanceof Uint8Array||r instanceof Uint32Array},t}(ro),ib={scaleMode:Oc.NEAREST,format:Jl.RGBA,alphaMode:Da.NPM},Li=function(e){function t(r,i){r===void 0&&(r=null),i===void 0&&(i=null),e.call(this),i=i||{};var o=i.alphaMode,s=i.mipmap,l=i.anisotropicLevel,d=i.scaleMode,f=i.width,h=i.height,g=i.wrapMode,m=i.format,S=i.type,P=i.target,I=i.resolution,D=i.resourceOptions;r&&!(r instanceof ro)&&(r=Im(r,D),r.internal=!0),this.width=f||0,this.height=h||0,this.resolution=I||Ir.RESOLUTION,this.mipmap=s!==void 0?s:Ir.MIPMAP_TEXTURES,this.anisotropicLevel=l!==void 0?l:Ir.ANISOTROPIC_LEVEL,this.wrapMode=g||Ir.WRAP_MODE,this.scaleMode=d!==void 0?d:Ir.SCALE_MODE,this.format=m||Jl.RGBA,this.type=S||ko.UNSIGNED_BYTE,this.target=P||Ks.TEXTURE_2D,this.alphaMode=o!==void 0?o:Da.UNPACK,i.premultiplyAlpha!==void 0&&(this.premultiplyAlpha=i.premultiplyAlpha),this.uid=tu(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=f>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={realWidth:{configurable:!0},realHeight:{configurable:!0}};return n.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},n.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},t.prototype.setStyle=function(i,o){var s;return i!==void 0&&i!==this.scaleMode&&(this.scaleMode=i,s=!0),o!==void 0&&o!==this.mipmap&&(this.mipmap=o,s=!0),s&&this.dirtyStyleId++,this},t.prototype.setSize=function(i,o,s){return this.resolution=s||this.resolution,this.width=i,this.height=o,this._refreshPOT(),this.update(),this},t.prototype.setRealSize=function(i,o,s){return this.resolution=s||this.resolution,this.width=i/this.resolution,this.height=o/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=wm(this.realWidth)&&wm(this.realHeight)},t.prototype.setResolution=function(i){var o=this.resolution;return o===i?this:(this.resolution=i,this.valid&&(this.width=this.width*o/i,this.height=this.height*o/i,this.emit("update",this)),this._refreshPOT(),this)},t.prototype.setResource=function(i){if(this.resource===i)return this;if(this.resource)throw new Error("Resource can be set only once");return i.bind(this),this.resource=i,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(i){this.emit("error",this,i)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ba[this.cacheId],delete pa[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.from=function(i,o,s){s===void 0&&(s=Ir.STRICT_TEXTURE_CACHE);var l=typeof i=="string",d=null;l?d=i:(i._pixiId||(i._pixiId="pixiid_"+tu()),d=i._pixiId);var f=Ba[d];if(l&&s&&!f)throw new Error('The cacheId "'+d+'" does not exist in BaseTextureCache.');return f||(f=new t(i,o),f.cacheId=d,t.addToCache(f,d)),f},t.fromBuffer=function(i,o,s,l){i=i||new Float32Array(o*s*4);var d=new sh(i,{width:o,height:s}),f=i instanceof Float32Array?ko.FLOAT:ko.UNSIGNED_BYTE;return new t(d,Object.assign(ib,l||{width:o,height:s,type:f}))},t.addToCache=function(i,o){o&&(i.textureCacheIds.indexOf(o)===-1&&i.textureCacheIds.push(o),Ba[o]&&console.warn("BaseTexture added to the cache with an id ["+o+"] that already had an entry"),Ba[o]=i)},t.removeFromCache=function(i){if(typeof i=="string"){var o=Ba[i];if(o){var s=o.textureCacheIds.indexOf(i);return s>-1&&o.textureCacheIds.splice(s,1),delete Ba[i],o}}else if(i&&i.textureCacheIds){for(var l=0;l<i.textureCacheIds.length;++l)delete Ba[i.textureCacheIds[l]];return i.textureCacheIds.length=0,i}return null},Object.defineProperties(t.prototype,n),t}(ql);Li._globalBatch=0;var Rm=function(e){function t(n,r){r=r||{};var i,o=n;Array.isArray(n)&&(i=n,o=n.length),e.call(this,r.width,r.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<o;s++){var l=new Li;this.items.push(l),this.itemDirtyIds.push(-1)}if(this.length=o,this._load=null,i)for(var d=0;d<o;d++)this.addResourceAt(Im(i[d],r),d)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.dispose=function(){for(var r=0,i=this.length;r<i;r++)this.items[r].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(r,i){var o=this.items[i];if(!o)throw new Error("Index "+i+" is out of bounds");return r.valid&&!this.valid&&this.resize(r.width,r.height),this.items[i].setResource(r),this},t.prototype.bind=function(r){e.prototype.bind.call(this,r),r.target=Ks.TEXTURE_2D_ARRAY;for(var i=0;i<this.length;i++)this.items[i].on("update",r.update,r)},t.prototype.unbind=function(r){e.prototype.unbind.call(this,r);for(var i=0;i<this.length;i++)this.items[i].off("update",r.update,r)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var i=this.items.map(function(s){return s.resource}),o=i.map(function(s){return s.load()});return this._load=Promise.all(o).then(function(){var s=i[0],l=s.width,d=s.height;return r.resize(l,d),Promise.resolve(r)}),this._load},t.prototype.upload=function(r,i,o){var s=this,l=s.length,d=s.itemDirtyIds,f=s.items,h=r.gl;o.dirtyId<0&&h.texImage3D(h.TEXTURE_2D_ARRAY,0,i.format,this._width,this._height,l,0,i.format,i.type,null);for(var g=0;g<l;g++){var m=f[g];d[g]<m.dirtyId&&(d[g]=m.dirtyId,m.valid&&h.texSubImage3D(h.TEXTURE_2D_ARRAY,0,0,0,g,m.resource.width,m.resource.height,1,i.format,i.type,m.resource.source))}return!0},t}(ro),Om=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.test=function(r){var i=window.OffscreenCanvas;return i&&r instanceof i?!0:r instanceof HTMLCanvasElement},t}(ru),Nm=function(e){function t(n,r){if(r=r||{},e.call(this,n,r),this.length!==t.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<t.SIDES;i++)this.items[i].target=Ks.TEXTURE_CUBE_MAP_POSITIVE_X+i;r.autoLoad!==!1&&this.load()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.bind=function(r){e.prototype.bind.call(this,r),r.target=Ks.TEXTURE_CUBE_MAP},t.prototype.upload=function(r,i,o){for(var s=this.itemDirtyIds,l=0;l<t.SIDES;l++){var d=this.items[l];s[l]<d.dirtyId&&(s[l]=d.dirtyId,d.valid&&d.resource.upload(r,d,o))}return!0},t}(Rm);Nm.SIDES=6;var Lm=function(e){function t(n,r){r=r||{},e.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=n,this.scale=r.scale||1,this._overrideWidth=r.width,this._overrideHeight=r.height,this._resolve=null,this._crossorigin=r.crossorigin,this._load=null,r.autoLoad!==!1&&this.load()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(){var r=this;return this._load?this._load:(this._load=new Promise(function(i){if(r._resolve=function(){r.resize(r.source.width,r.source.height),i(r)},/^\<svg/.test(r.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");r.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(r.svg)))}r._loadSvg()}),this._load)},t.prototype._loadSvg=function(){var r=this,i=new Image;e.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=function(o){i.onerror=null,r.onError.run(o)},i.onload=function(){var o=i.width,s=i.height;if(!o||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var l=o*r.scale,d=s*r.scale;(r._overrideWidth||r._overrideHeight)&&(l=r._overrideWidth||r._overrideHeight/s*o,d=r._overrideHeight||r._overrideWidth/o*s),l=Math.round(l),d=Math.round(d);var f=r.source;f.width=l,f.height=d,f._pixiId="canvas_"+tu(),f.getContext("2d").drawImage(i,0,0,o,s,0,0,l,d),r._resolve(),r._resolve=null}},t.getSize=function(r){var i=t.SVG_SIZE.exec(r),o={};return i&&(o[i[1]]=Math.round(parseFloat(i[3])),o[i[5]]=Math.round(parseFloat(i[7]))),o},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(r,i){return i==="svg"||typeof r=="string"&&r.indexOf("data:image/svg+xml;base64")===0||typeof r=="string"&&r.indexOf("<svg")===0},t}(ru);Lm.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Dm=function(e){function t(r,i){if(i=i||{},!(r instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),typeof r=="string"&&(r=[r]),e.crossOrigin(o,r[0].src||r[0],i.crossorigin);for(var s=0;s<r.length;++s){var l=document.createElement("source"),d=r[s],f=d.src,h=d.mime;f=f||r[s];var g=f.split("?").shift().toLowerCase(),m=g.substr(g.lastIndexOf(".")+1);h=h||"video/"+m,l.src=f,l.type=h,o.appendChild(l)}r=o}e.call(this,r),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,this._updateFPS=i.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=i.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),i.autoLoad!==!1&&this.load()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return t.prototype.update=function(i){if(i===void 0&&(i=0),!this.destroyed){var o=ma.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-o),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this,i),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var i=this;if(this._load)return this._load;var o=this.source;return(o.readyState===o.HAVE_ENOUGH_DATA||o.readyState===o.HAVE_FUTURE_DATA)&&o.width&&o.height&&(o.complete=!0),o.addEventListener("play",this._onPlayStart.bind(this)),o.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(o.addEventListener("canplay",this._onCanPlay),o.addEventListener("canplaythrough",this._onCanPlay),o.addEventListener("error",this._onError,!0)),this._load=new Promise(function(s){i.valid?s(i):(i._resolve=s,o.load())}),this._load},t.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},t.prototype._isSourcePlaying=function(){var i=this.source;return i.currentTime>0&&i.paused===!1&&i.ended===!1&&i.readyState>2},t.prototype._isSourceReady=function(){return this.source.readyState===3||this.source.readyState===4},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(ma.shared.add(this.update,this),this._isAutoUpdating=!0)},t.prototype._onPlayStop=function(){this._isAutoUpdating&&(ma.shared.remove(this.update,this),this._isAutoUpdating=!1)},t.prototype._onCanPlay=function(){var i=this,o=i.source;o.removeEventListener("canplay",this._onCanPlay),o.removeEventListener("canplaythrough",this._onCanPlay);var s=this.valid;this.resize(o.videoWidth,o.videoHeight),!s&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&o.play()},t.prototype.dispose=function(){this._isAutoUpdating&&ma.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),e.prototype.dispose.call(this)},n.autoUpdate.get=function(){return this._autoUpdate},n.autoUpdate.set=function(r){r!==this._autoUpdate&&(this._autoUpdate=r,!this._autoUpdate&&this._isAutoUpdating?(ma.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(ma.shared.add(this.update,this),this._isAutoUpdating=!0))},n.updateFPS.get=function(){return this._updateFPS},n.updateFPS.set=function(r){r!==this._updateFPS&&(this._updateFPS=r)},t.test=function(i,o){return i instanceof HTMLVideoElement||t.TYPES.indexOf(o)>-1},Object.defineProperties(t.prototype,n),t}(ru);Dm.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var ob=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.test=function(r){return!!window.createImageBitmap&&r instanceof ImageBitmap},t}(ru);ah.push(oh,ob,Om,Dm,Lm,sh,Nm,Rm);var io=function(t){this.renderer=t};io.prototype.destroy=function(){this.renderer=null};var ab=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.upload=function(r,i,o){var s=r.gl;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===Da.UNPACK),o.width===i.width&&o.height===i.height?s.texSubImage2D(i.target,0,0,0,i.width,i.height,i.format,i.type,this.data):(o.width=i.width,o.height=i.height,s.texImage2D(i.target,0,s.DEPTH_COMPONENT16,i.width,i.height,0,i.format,i.type,this.data)),!0},t}(sh),va=function(t,n){this.width=Math.ceil(t||100),this.height=Math.ceil(n||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new qi("disposeFramebuffer",2)},Bm={colorTexture:{configurable:!0}};Bm.colorTexture.get=function(){return this.colorTextures[0]},va.prototype.addColorTexture=function(t,n){return t===void 0&&(t=0),this.colorTextures[t]=n||new Li(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},va.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Li(new ab(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:Jl.DEPTH_COMPONENT,type:ko.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},va.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},va.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},va.prototype.resize=function(t,n){if(t=Math.ceil(t),n=Math.ceil(n),!(t===this.width&&n===this.height)){this.width=t,this.height=n,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],o=i.resolution;i.setSize(t/o,n/o)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,n/s)}}},va.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(va.prototype,Bm);var Gc=function(e){function t(n){if(typeof n=="number"){var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3];n={width:r,height:i,scaleMode:o,resolution:s}}e.call(this,null,n);var l=n||{},d=l.width,f=l.height;this.mipmap=!1,this.width=Math.ceil(d)||100,this.height=Math.ceil(f)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new va(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.resize=function(r,i){r=Math.ceil(r),i=Math.ceil(i),this.framebuffer.resize(r*this.resolution,i*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this.framebuffer=null},t}(Li),lh=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};lh.prototype.set=function(t,n,r){var i=n.width,o=n.height;if(r){var s=t.width/2/i,l=t.height/2/o,d=t.x/i+s,f=t.y/o+l;r=vi.add(r,vi.NW),this.x0=d+s*vi.uX(r),this.y0=f+l*vi.uY(r),r=vi.add(r,2),this.x1=d+s*vi.uX(r),this.y1=f+l*vi.uY(r),r=vi.add(r,2),this.x2=d+s*vi.uX(r),this.y2=f+l*vi.uY(r),r=vi.add(r,2),this.x3=d+s*vi.uX(r),this.y3=f+l*vi.uY(r)}else this.x0=t.x/i,this.y0=t.y/o,this.x1=(t.x+t.width)/i,this.y1=t.y/o,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/o,this.x3=t.x/i,this.y3=(t.y+t.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Fm=new lh,Xo=function(e){function t(r,i,o,s,l,d){if(e.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new Ni(0,0,1,1)),r instanceof t&&(r=r.baseTexture),this.baseTexture=r,this._frame=i,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=Fm,this.uvMatrix=null,this.orig=o||i,this._rotate=Number(l||0),l===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=d?new $s(d.x,d.y):new $s(0,0),this._updateID=0,this.textureCacheIds=[],r.valid?this.noFrame?r.valid&&this.onBaseTextureUpdated(r):this.frame=i:r.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&r.on("update",this.onBaseTextureUpdated,this)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(i){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=i.width,this._frame.height=i.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(i){if(this.baseTexture){if(i){var o=this.baseTexture,s=o.resource;s&&pa[s.url]&&t.removeFromCache(s.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},t.prototype.updateUvs=function(){this._uvs===Fm&&(this._uvs=new lh),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(i,o,s){o===void 0&&(o={}),s===void 0&&(s=Ir.STRICT_TEXTURE_CACHE);var l=typeof i=="string",d=null;l?d=i:(i._pixiId||(i._pixiId="pixiid_"+tu()),d=i._pixiId);var f=pa[d];if(l&&s&&!f)throw new Error('The cacheId "'+d+'" does not exist in TextureCache.');return f||(o.resolution||(o.resolution=nh(i)),f=new t(new Li(i,o)),f.baseTexture.cacheId=d,Li.addToCache(f.baseTexture,d),t.addToCache(f,d)),f},t.fromBuffer=function(i,o,s,l){return new t(Li.fromBuffer(i,o,s,l))},t.fromLoader=function(i,o,s){var l=new oh(i);l.url=o;var d=new Li(l,{scaleMode:Ir.SCALE_MODE,resolution:nh(o)}),f=new t(d);return s||(s=o),Li.addToCache(f.baseTexture,s),t.addToCache(f,s),s!==o&&(Li.addToCache(f.baseTexture,o),t.addToCache(f,o)),f},t.addToCache=function(i,o){o&&(i.textureCacheIds.indexOf(o)===-1&&i.textureCacheIds.push(o),pa[o]&&console.warn("Texture added to the cache with an id ["+o+"] that already had an entry"),pa[o]=i)},t.removeFromCache=function(i){if(typeof i=="string"){var o=pa[i];if(o){var s=o.textureCacheIds.indexOf(i);return s>-1&&o.textureCacheIds.splice(s,1),delete pa[i],o}}else if(i&&i.textureCacheIds){for(var l=0;l<i.textureCacheIds.length;++l)pa[i.textureCacheIds[l]]===i&&delete pa[i.textureCacheIds[l]];return i.textureCacheIds.length=0,i}return null},n.resolution.get=function(){return this.baseTexture.resolution},n.frame.get=function(){return this._frame},n.frame.set=function(r){this._frame=r,this.noFrame=!1;var i=r.x,o=r.y,s=r.width,l=r.height,d=i+s>this.baseTexture.width,f=o+l>this.baseTexture.height;if(d||f){var h=d&&f?"and":"or",g="X: "+i+" + "+s+" = "+(i+s)+" > "+this.baseTexture.width,m="Y: "+o+" + "+l+" = "+(o+l)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+g+" "+h+" "+m)}this.valid=s&&l&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=r),this.valid&&this.updateUvs()},n.rotate.get=function(){return this._rotate},n.rotate.set=function(r){this._rotate=r,this.valid&&this.updateUvs()},n.width.get=function(){return this.orig.width},n.height.get=function(){return this.orig.height},Object.defineProperties(t.prototype,n),t}(ql);function sb(){var e=document.createElement("canvas");e.width=16,e.height=16;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new Xo(new Li(new Om(e)))}function Vc(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}Xo.EMPTY=new Xo(new Li),Vc(Xo.EMPTY),Vc(Xo.EMPTY.baseTexture),Xo.WHITE=sb(),Vc(Xo.WHITE),Vc(Xo.WHITE.baseTexture);var uh=function(e){function t(n,r){var i=null;if(!(n instanceof Gc)){var o=arguments[1],s=arguments[2],l=arguments[3],d=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+s+") instead of the ctor directly."),i=arguments[0],r=null,n=new Gc({width:o,height:s,scaleMode:l,resolution:d})}e.call(this,n,r),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.resize=function(r,i,o){o===void 0&&(o=!0),r=Math.ceil(r),i=Math.ceil(i),this.valid=r>0&&i>0,this._frame.width=this.orig.width=r,this._frame.height=this.orig.height=i,o&&this.baseTexture.resize(r,i),this.updateUvs()},t.prototype.setResolution=function(r){var i=this,o=i.baseTexture;o.resolution!==r&&(o.setResolution(r),this.resize(o.width,o.height,!1))},t.create=function(r){return typeof r=="number"&&(r={width:r,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new t(new Gc(r))},t}(Xo),Do=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};Do.prototype.createTexture=function(t,n){var r=new Gc(Object.assign({width:t,height:n,resolution:1},this.textureOptions));return new uh(r)},Do.prototype.getOptimalTexture=function(t,n,r){r===void 0&&(r=1);var i=Do.SCREEN_KEY;t*=r,n*=r,(!this.enableFullScreen||t!==this._pixelsWidth||n!==this._pixelsHeight)&&(t=Lc(t),n=Lc(n),i=(t&65535)<<16|n&65535),this.texturePool[i]||(this.texturePool[i]=[]);var o=this.texturePool[i].pop();return o||(o=this.createTexture(t,n)),o.filterPoolKey=i,o.setResolution(r),o},Do.prototype.getFilterTexture=function(t,n){var r=this.getOptimalTexture(t.width,t.height,n||t.resolution);return r.filterFrame=t.filterFrame,r},Do.prototype.returnTexture=function(t){var n=t.filterPoolKey;t.filterFrame=null,this.texturePool[n].push(t)},Do.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Do.prototype.clear=function(t){if(t=t!==!1,t)for(var n in this.texturePool){var r=this.texturePool[n];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},Do.prototype.setScreenSize=function(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){var n=Do.SCREEN_KEY,r=this.texturePool[n];if(this.enableFullScreen=t.width>0&&t.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[n]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Do.SCREEN_KEY="screen";var iu=function(t,n,r,i,o,s,l){r===void 0&&(r=!1),i===void 0&&(i=5126),this.buffer=t,this.size=n,this.normalized=r,this.type=i,this.stride=o,this.start=s,this.instance=l};iu.prototype.destroy=function(){this.buffer=null},iu.from=function(t,n,r,i,o){return new iu(t,n,r,i,o)};var lb=0,eo=function(t,n,r){n===void 0&&(n=!0),r===void 0&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=n,this.id=lb++,this.disposeRunner=new qi("disposeBuffer",2)};eo.prototype.update=function(t){this.data=t||this.data,this._updateID++},eo.prototype.dispose=function(){this.disposeRunner.run(this,!1)},eo.prototype.destroy=function(){this.dispose(),this.data=null},eo.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new eo(t)};function Um(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}var ub={Float32Array,Uint32Array,Int32Array,Uint8Array};function cb(e,t){for(var n=0,r=0,i={},o=0;o<e.length;o++)r+=t[o],n+=e[o].length;for(var s=new ArrayBuffer(n*4),l=null,d=0,f=0;f<e.length;f++){var h=t[f],g=e[f],m=Um(g);i[m]||(i[m]=new ub[m](s)),l=i[m];for(var S=0;S<g.length;S++){var P=(S/h|0)*r+d,I=S%h;l[P+I]=g[S]}d+=h}return new Float32Array(s)}var Hm={5126:4,5123:2,5121:1},db=0,fb={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Di=function(t,n){t===void 0&&(t=[]),n===void 0&&(n={}),this.buffers=t,this.indexBuffer=null,this.attributes=n,this.glVertexArrayObjects={},this.id=db++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new qi("disposeGeometry",2),this.refCount=0};Di.prototype.addAttribute=function(t,n,r,i,o,s,l,d){if(i===void 0&&(i=!1),d===void 0&&(d=!1),!n)throw new Error("You must pass a buffer when creating an attribute");n.data||(n instanceof Array&&(n=new Float32Array(n)),n=new eo(n));var f=t.split("|");if(f.length>1){for(var h=0;h<f.length;h++)this.addAttribute(f[h],n,r,i,o);return this}var g=this.buffers.indexOf(n);return g===-1&&(this.buffers.push(n),g=this.buffers.length-1),this.attributes[t]=new iu(g,r,i,o,s,l,d),this.instanced=this.instanced||d,this},Di.prototype.getAttribute=function(t){return this.attributes[t]},Di.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},Di.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new eo(t)),t.index=!0,this.indexBuffer=t,this.buffers.indexOf(t)===-1&&this.buffers.push(t),this},Di.prototype.getIndex=function(){return this.indexBuffer},Di.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var t=[],n=[],r=new eo,i;for(i in this.attributes){var o=this.attributes[i],s=this.buffers[o.buffer];t.push(s.data),n.push(o.size*Hm[o.type]/4),o.buffer=0}for(r.data=cb(t,n),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Di.prototype.getSize=function(){for(var t in this.attributes){var n=this.attributes[t],r=this.buffers[n.buffer];return r.data.length/(n.stride/4||n.size)}return 0},Di.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Di.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Di.prototype.clone=function(){for(var t=new Di,n=0;n<this.buffers.length;n++)t.buffers[n]=new eo(this.buffers[n].data.slice());for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new iu(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},Di.merge=function(t){for(var n=new Di,r=[],i=[],o=[],s,l=0;l<t.length;l++){s=t[l];for(var d=0;d<s.buffers.length;d++)i[d]=i[d]||0,i[d]+=s.buffers[d].data.length,o[d]=0}for(var f=0;f<s.buffers.length;f++)r[f]=new fb[Um(s.buffers[f].data)](i[f]),n.buffers[f]=new eo(r[f]);for(var h=0;h<t.length;h++){s=t[h];for(var g=0;g<s.buffers.length;g++)r[g].set(s.buffers[g].data,o[g]),o[g]+=s.buffers[g].data.length}if(n.attributes=s.attributes,s.indexBuffer){n.indexBuffer=n.buffers[s.buffers.indexOf(s.indexBuffer)],n.indexBuffer.index=!0;for(var m=0,S=0,P=0,I=0,D=0;D<s.buffers.length;D++)if(s.buffers[D]!==s.indexBuffer){I=D;break}for(var be in s.attributes){var Ye=s.attributes[be];(Ye.buffer|0)===I&&(S+=Ye.size*Hm[Ye.type]/4)}for(var Se=0;Se<t.length;Se++){for(var Ze=t[Se].indexBuffer.data,mt=0;mt<Ze.length;mt++)n.indexBuffer.data[mt+P]+=m;m+=s.buffers[I].data.length/S,P+=Ze.length}}return n};var hb=function(e){function t(){e.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Di),Gm=function(e){function t(){e.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new eo(this.vertices),this.uvBuffer=new eo(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(r,i){var o=0,s=0;return this.uvs[0]=o,this.uvs[1]=s,this.uvs[2]=o+i.width/r.width,this.uvs[3]=s,this.uvs[4]=o+i.width/r.width,this.uvs[5]=s+i.height/r.height,this.uvs[6]=o,this.uvs[7]=s+i.height/r.height,o=i.x,s=i.y,this.vertices[0]=o,this.vertices[1]=s,this.vertices[2]=o+i.width,this.vertices[3]=s,this.vertices[4]=o+i.width,this.vertices[5]=s+i.height,this.vertices[6]=o,this.vertices[7]=s+i.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(Di),pb=0,To=function(t,n){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=pb++,this.static=!!n};To.prototype.update=function(){this.dirtyId++},To.prototype.add=function(t,n,r){this.uniforms[t]=new To(n,r)},To.from=function(t,n){return new To(t,n)};var Vm=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new Ni,this.destinationFrame=new Ni,this.filters=[]};Vm.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var mb=function(e){function t(n){e.call(this,n),this.defaultFilterStack=[{}],this.texturePool=new Do,this.texturePool.setScreenSize(n.view),this.statePool=[],this.quad=new hb,this.quadUv=new Gm,this.tempRect=new Ni,this.activeState={},this.globalUniforms=new To({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=n.view.width,this._pixelsHeight=n.view.height}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.push=function(r,i){for(var o=this.renderer,s=this.defaultFilterStack,l=this.statePool.pop()||new Vm,d=i[0].resolution,f=i[0].padding,h=i[0].autoFit,g=i[0].legacy,m=1;m<i.length;m++){var S=i[m];d=Math.min(d,S.resolution),f=Math.max(f,S.padding),h=h||S.autoFit,g=g||S.legacy}s.length===1&&(this.defaultFilterStack[0].renderTexture=o.renderTexture.current),s.push(l),l.resolution=d,l.legacy=g,l.target=r,l.sourceFrame.copyFrom(r.filterArea||r.getBounds(!0)),l.sourceFrame.pad(f),h&&l.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),l.sourceFrame.ceil(d),l.renderTexture=this.getOptimalFilterTexture(l.sourceFrame.width,l.sourceFrame.height,d),l.filters=i,l.destinationFrame.width=l.renderTexture.width,l.destinationFrame.height=l.renderTexture.height,l.renderTexture.filterFrame=l.sourceFrame,o.renderTexture.bind(l.renderTexture,l.sourceFrame),o.renderTexture.clear()},t.prototype.pop=function(){var r=this.defaultFilterStack,i=r.pop(),o=i.filters;this.activeState=i;var s=this.globalUniforms.uniforms;s.outputFrame=i.sourceFrame,s.resolution=i.resolution;var l=s.inputSize,d=s.inputPixel,f=s.inputClamp;if(l[0]=i.destinationFrame.width,l[1]=i.destinationFrame.height,l[2]=1/l[0],l[3]=1/l[1],d[0]=l[0]*i.resolution,d[1]=l[1]*i.resolution,d[2]=1/d[0],d[3]=1/d[1],f[0]=.5*d[2],f[1]=.5*d[3],f[2]=i.sourceFrame.width*l[2]-.5*d[2],f[3]=i.sourceFrame.height*l[3]-.5*d[3],i.legacy){var h=s.filterArea;h[0]=i.destinationFrame.width,h[1]=i.destinationFrame.height,h[2]=i.sourceFrame.x,h[3]=i.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();var g=r[r.length-1];if(o.length===1)o[0].apply(this,i.renderTexture,g.renderTexture,!1,i),this.returnFilterTexture(i.renderTexture);else{var m=i.renderTexture,S=this.getOptimalFilterTexture(m.width,m.height,i.resolution);S.filterFrame=m.filterFrame;var P=0;for(P=0;P<o.length-1;++P){o[P].apply(this,m,S,!0,i);var I=m;m=S,S=I}o[P].apply(this,m,g.renderTexture,!1,i),this.returnFilterTexture(m),this.returnFilterTexture(S)}i.clear(),this.statePool.push(i)},t.prototype.applyFilter=function(r,i,o,s){var l=this.renderer;l.renderTexture.bind(o,o?o.filterFrame:null),s&&l.renderTexture.clear(),r.uniforms.uSampler=i,r.uniforms.filterGlobals=this.globalUniforms,l.state.set(r.state),l.shader.bind(r),r.legacy?(this.quadUv.map(i._frame,i.filterFrame),l.geometry.bind(this.quadUv),l.geometry.draw(Ws.TRIANGLES)):(l.geometry.bind(this.quad),l.geometry.draw(Ws.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(r,i){var o=this.activeState,s=o.sourceFrame,l=o.destinationFrame,d=i._texture,f=d.orig,h=r.set(l.width,0,0,l.height,s.x,s.y),g=i.worldTransform.copyTo(Po.TEMP_MATRIX);return g.invert(),h.prepend(g),h.scale(1/f.width,1/f.height),h.translate(i.anchor.x,i.anchor.y),h},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(r,i,o){return o===void 0&&(o=1),this.texturePool.getOptimalTexture(r,i,o)},t.prototype.getFilterTexture=function(r,i){if(typeof r=="number"){var o=r;r=i,i=o}r=r||this.activeState.renderTexture;var s=this.texturePool.getOptimalTexture(r.width,r.height,i||r.resolution);return s.filterFrame=r.filterFrame,s},t.prototype.returnFilterTexture=function(r){this.texturePool.returnTexture(r)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t}(io),Ua=function(t){this.renderer=t};Ua.prototype.flush=function(){},Ua.prototype.destroy=function(){this.renderer=null},Ua.prototype.start=function(){},Ua.prototype.stop=function(){this.flush()},Ua.prototype.render=function(t){};var vb=function(e){function t(n){e.call(this,n),this.emptyRenderer=new Ua(n),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setObjectRenderer=function(r){this.currentRenderer!==r&&(this.currentRenderer.stop(),this.currentRenderer=r,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(r,i){for(var o=this.renderer.texture,s=o.boundTextures,l=i-1;l>=0;--l)r[l]=s[l]||null,r[l]&&(r[l]._batchLocation=l)},t.prototype.boundArray=function(r,i,o,s){for(var l=r.elements,d=r.ids,f=r.count,h=0,g=0;g<f;g++){var m=l[g],S=m._batchLocation;if(S>=0&&S<s&&i[S]===m){d[g]=S;continue}for(;h<s;){var P=i[h];if(P&&P._batchEnabled===o&&P._batchLocation===h){h++;continue}d[g]=h,m._batchLocation=h,i[h]=m;break}}},t}(io);Ir.PREFER_ENV=Na.any?ha.WEBGL:ha.WEBGL2,Ir.STRICT_TEXTURE_CACHE=!1;var zm=0,gb=function(e){function t(r){e.call(this,r),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),r.view.addEventListener("webglcontextlost",this.handleContextLost,!1),r.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={isLost:{configurable:!0}};return n.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(i){this.gl=i,this.renderer.gl=i,this.renderer.CONTEXT_UID=zm++,i.isContextLost()&&i.getExtension("WEBGL_lose_context")&&i.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(i){this.gl=i,this.validateContext(i),this.renderer.gl=i,this.renderer.CONTEXT_UID=zm++,this.renderer.runners.contextChange.run(i)},t.prototype.initFromOptions=function(i){var o=this.createContext(this.renderer.view,i);this.initFromContext(o)},t.prototype.createContext=function(i,o){var s;if(Ir.PREFER_ENV>=ha.WEBGL2&&(s=i.getContext("webgl2",o)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=i.getContext("webgl",o)||i.getContext("experimental-webgl",o),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),s},t.prototype.getExtensions=function(){var i=this,o=i.gl;this.webGLVersion===1?Object.assign(this.extensions,{drawBuffers:o.getExtension("WEBGL_draw_buffers"),depthTexture:o.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:o.getExtension("WEBGL_lose_context"),vertexArrayObject:o.getExtension("OES_vertex_array_object")||o.getExtension("MOZ_OES_vertex_array_object")||o.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:o.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:o.getExtension("OES_element_index_uint"),floatTexture:o.getExtension("OES_texture_float"),floatTextureLinear:o.getExtension("OES_texture_float_linear"),textureHalfFloat:o.getExtension("OES_texture_half_float"),textureHalfFloatLinear:o.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,{anisotropicFiltering:o.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:o.getExtension("EXT_color_buffer_float"),floatTextureLinear:o.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(i){i.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var i=this.renderer.view;i.removeEventListener("webglcontextlost",this.handleContextLost),i.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(i){var o=i.getContextAttributes();o.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,n),t}(io),_b=function(e){function t(r){e.call(this,r),this.managedFramebuffers=[],this.unknownFramebuffer=new va(10,10)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0}};return t.prototype.contextChange=function(){var i=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Ni,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var o=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;Ir.PREFER_ENV===ha.WEBGL_LEGACY&&(o=null,s=null),o?i.drawBuffers=function(l){return o.drawBuffersWEBGL(l)}:(this.hasMRT=!1,i.drawBuffers=function(){}),s||(this.writeDepthTexture=!1)}},t.prototype.bind=function(i,o){var s=this,l=s.gl;if(i){var d=i.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(i);this.current!==i&&(this.current=i,l.bindFramebuffer(l.FRAMEBUFFER,d.framebuffer)),d.dirtyId!==i.dirtyId&&(d.dirtyId=i.dirtyId,d.dirtyFormat!==i.dirtyFormat?(d.dirtyFormat=i.dirtyFormat,this.updateFramebuffer(i)):d.dirtySize!==i.dirtySize&&(d.dirtySize=i.dirtySize,this.resizeFramebuffer(i)));for(var f=0;f<i.colorTextures.length;f++)i.colorTextures[f].texturePart?this.renderer.texture.unbind(i.colorTextures[f].texture):this.renderer.texture.unbind(i.colorTextures[f]);i.depthTexture&&this.renderer.texture.unbind(i.depthTexture),o?this.setViewport(o.x,o.y,o.width,o.height):this.setViewport(0,0,i.width,i.height)}else this.current&&(this.current=null,l.bindFramebuffer(l.FRAMEBUFFER,null)),o?this.setViewport(o.x,o.y,o.width,o.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(i,o,s,l){var d=this.viewport;(d.width!==s||d.height!==l||d.x!==i||d.y!==o)&&(d.x=i,d.y=o,d.width=s,d.height=l,this.gl.viewport(i,o,s,l))},n.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(i,o,s,l){var d=this,f=d.gl;f.clearColor(i,o,s,l),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(i){var o=this,s=o.gl,l={framebuffer:s.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return i.glFramebuffers[this.CONTEXT_UID]=l,this.managedFramebuffers.push(i),i.disposeRunner.add(this),l},t.prototype.resizeFramebuffer=function(i){var o=this,s=o.gl,l=i.glFramebuffers[this.CONTEXT_UID];l.stencil&&(s.bindRenderbuffer(s.RENDERBUFFER,l.stencil),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i.width,i.height));for(var d=i.colorTextures,f=0;f<d.length;f++)this.renderer.texture.bind(d[f],0);i.depthTexture&&this.renderer.texture.bind(i.depthTexture,0)},t.prototype.updateFramebuffer=function(i){var o=this,s=o.gl,l=i.glFramebuffers[this.CONTEXT_UID],d=i.colorTextures,f=d.length;s.drawBuffers||(f=Math.min(f,1));for(var h=[],g=0;g<f;g++){var m=i.colorTextures[g];m.texturePart?(this.renderer.texture.bind(m.texture,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+g,s.TEXTURE_CUBE_MAP_NEGATIVE_X+m.side,m.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(m,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+g,s.TEXTURE_2D,m._glTextures[this.CONTEXT_UID].texture,0)),h.push(s.COLOR_ATTACHMENT0+g)}if(h.length>1&&s.drawBuffers(h),i.depthTexture){var S=this.writeDepthTexture;if(S){var P=i.depthTexture;this.renderer.texture.bind(P,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,P._glTextures[this.CONTEXT_UID].texture,0)}}!l.stencil&&(i.stencil||i.depth)&&(l.stencil=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,l.stencil),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i.width,i.height),i.depthTexture||s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,l.stencil))},t.prototype.disposeFramebuffer=function(i,o){var s=i.glFramebuffers[this.CONTEXT_UID],l=this.gl;if(s){delete i.glFramebuffers[this.CONTEXT_UID];var d=this.managedFramebuffers.indexOf(i);d>=0&&this.managedFramebuffers.splice(d,1),i.disposeRunner.remove(this),o||(l.deleteFramebuffer(s.framebuffer),s.stencil&&l.deleteRenderbuffer(s.stencil))}},t.prototype.disposeAll=function(i){var o=this.managedFramebuffers;this.managedFramebuffers=[];for(var s=0;s<o.length;s++)this.disposeFramebuffer(o[s],i)},t.prototype.forceStencil=function(){var i=this.current;if(i){var o=i.glFramebuffers[this.CONTEXT_UID];if(!(!o||o.stencil)){i.enableStencil();var s=i.width,l=i.height,d=this.gl,f=d.createRenderbuffer();d.bindRenderbuffer(d.RENDERBUFFER,f),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_STENCIL,s,l),o.stencil=f,d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,f)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Ni},Object.defineProperties(t.prototype,n),t}(io),bb=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},ch={5126:4,5123:2,5121:1},yb=function(e){function t(n){e.call(this,n),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contextChange=function(){this.disposeAll(!0);var r=this.gl=this.renderer.gl,i=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!r.createVertexArray){var o=this.renderer.context.extensions.vertexArrayObject;Ir.PREFER_ENV===ha.WEBGL_LEGACY&&(o=null),o?(r.createVertexArray=function(){return o.createVertexArrayOES()},r.bindVertexArray=function(l){return o.bindVertexArrayOES(l)},r.deleteVertexArray=function(l){return o.deleteVertexArrayOES(l)}):(this.hasVao=!1,r.createVertexArray=function(){},r.bindVertexArray=function(){},r.deleteVertexArray=function(){})}if(!r.vertexAttribDivisor){var s=r.getExtension("ANGLE_instanced_arrays");s?(r.vertexAttribDivisor=function(l,d){return s.vertexAttribDivisorANGLE(l,d)},r.drawElementsInstanced=function(l,d,f,h,g){return s.drawElementsInstancedANGLE(l,d,f,h,g)},r.drawArraysInstanced=function(l,d,f,h){return s.drawArraysInstancedANGLE(l,d,f,h)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=i.webGLVersion===2||!!i.extensions.uint32ElementIndex},t.prototype.bind=function(r,i){i=i||this.renderer.shader.shader;var o=this,s=o.gl,l=r.glVertexArrayObjects[this.CONTEXT_UID];l||(this.managedGeometries[r.id]=r,r.disposeRunner.add(this),r.glVertexArrayObjects[this.CONTEXT_UID]=l={});var d=l[i.program.id]||this.initGeometryVao(r,i.program);this._activeGeometry=r,this._activeVao!==d&&(this._activeVao=d,this.hasVao?s.bindVertexArray(d):this.activateVao(r,i.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var r=this._activeGeometry,i=this,o=i.gl,s=0;s<r.buffers.length;s++){var l=r.buffers[s],d=l._glBuffers[this.CONTEXT_UID];if(l._updateID!==d.updateID){d.updateID=l._updateID;var f=l.index?o.ELEMENT_ARRAY_BUFFER:o.ARRAY_BUFFER;if(o.bindBuffer(f,d.buffer),this._boundBuffer=d,d.byteLength>=l.data.byteLength)o.bufferSubData(f,0,l.data);else{var h=l.static?o.STATIC_DRAW:o.DYNAMIC_DRAW;d.byteLength=l.data.byteLength,o.bufferData(f,l.data,h)}}}},t.prototype.checkCompatibility=function(r,i){var o=r.attributes,s=i.attributeData;for(var l in s)if(!o[l])throw new Error('shader and geometry incompatible, geometry missing the "'+l+'" attribute')},t.prototype.getSignature=function(r,i){var o=r.attributes,s=i.attributeData,l=["g",r.id];for(var d in o)s[d]&&l.push(d);return l.join("-")},t.prototype.initGeometryVao=function(r,i){this.checkCompatibility(r,i);var o=this.gl,s=this.CONTEXT_UID,l=this.getSignature(r,i),d=r.glVertexArrayObjects[this.CONTEXT_UID],f=d[l];if(f)return d[i.id]=f,f;var h=r.buffers,g=r.attributes,m={},S={};for(var P in h)m[P]=0,S[P]=0;for(var I in g)!g[I].size&&i.attributeData[I]?g[I].size=i.attributeData[I].size:g[I].size||console.warn("PIXI Geometry attribute '"+I+"' size cannot be determined (likely the bound shader does not have the attribute)"),m[g[I].buffer]+=g[I].size*ch[g[I].type];for(var D in g){var be=g[D],Ye=be.size;be.stride===void 0&&(m[be.buffer]===Ye*ch[be.type]?be.stride=0:be.stride=m[be.buffer]),be.start===void 0&&(be.start=S[be.buffer],S[be.buffer]+=Ye*ch[be.type])}f=o.createVertexArray(),o.bindVertexArray(f);for(var Se=0;Se<h.length;Se++){var Ze=h[Se];Ze._glBuffers[s]||(Ze._glBuffers[s]=new bb(o.createBuffer()),this.managedBuffers[Ze.id]=Ze,Ze.disposeRunner.add(this)),Ze._glBuffers[s].refCount++}return this.activateVao(r,i),this._activeVao=f,d[i.id]=f,d[l]=f,f},t.prototype.disposeBuffer=function(r,i){if(this.managedBuffers[r.id]){delete this.managedBuffers[r.id];var o=r._glBuffers[this.CONTEXT_UID],s=this.gl;r.disposeRunner.remove(this),o&&(i||s.deleteBuffer(o.buffer),delete r._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(r,i){if(this.managedGeometries[r.id]){delete this.managedGeometries[r.id];var o=r.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,l=r.buffers;if(r.disposeRunner.remove(this),!!o){for(var d=0;d<l.length;d++){var f=l[d]._glBuffers[this.CONTEXT_UID];f.refCount--,f.refCount===0&&!i&&this.disposeBuffer(l[d],i)}if(!i){for(var h in o)if(h[0]==="g"){var g=o[h];this._activeVao===g&&this.unbind(),s.deleteVertexArray(g)}}delete r.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(r){for(var i=Object.keys(this.managedGeometries),o=0;o<i.length;o++)this.disposeGeometry(this.managedGeometries[i[o]],r);i=Object.keys(this.managedBuffers);for(var s=0;s<i.length;s++)this.disposeBuffer(this.managedBuffers[i[s]],r)},t.prototype.activateVao=function(r,i){var o=this.gl,s=this.CONTEXT_UID,l=r.buffers,d=r.attributes;r.indexBuffer&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,r.indexBuffer._glBuffers[s].buffer);var f=null;for(var h in d){var g=d[h],m=l[g.buffer],S=m._glBuffers[s];if(i.attributeData[h]){f!==S&&(o.bindBuffer(o.ARRAY_BUFFER,S.buffer),f=S);var P=i.attributeData[h].location;if(o.enableVertexAttribArray(P),o.vertexAttribPointer(P,g.size,g.type||o.FLOAT,g.normalized,g.stride,g.start),g.instance)if(this.hasInstance)o.vertexAttribDivisor(P,1);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}},t.prototype.draw=function(r,i,o,s){var l=this,d=l.gl,f=this._activeGeometry;if(f.indexBuffer){var h=f.indexBuffer.data.BYTES_PER_ELEMENT,g=h===2?d.UNSIGNED_SHORT:d.UNSIGNED_INT;h===2||h===4&&this.canUseUInt32ElementIndex?f.instanced?d.drawElementsInstanced(r,i||f.indexBuffer.data.length,g,(o||0)*h,s||1):d.drawElements(r,i||f.indexBuffer.data.length,g,(o||0)*h):console.warn("unsupported index buffer type: uint32")}else f.instanced?d.drawArraysInstanced(r,o,i||f.getSize(),s||1):d.drawArrays(r,o,i||f.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t}(io),dh=function(t){this.type=mo.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};dh.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=mo.NONE,this.autoDetect=!0),this._target=null},dh.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};function jm(e,t,n,r){var i=qm(e,e.VERTEX_SHADER,t),o=qm(e,e.FRAGMENT_SHADER,n),s=e.createProgram();if(e.attachShader(s,i),e.attachShader(s,o),r)for(var l in r)e.bindAttribLocation(s,r[l],l);return e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)||(e.getShaderParameter(i,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(i))),e.getShaderParameter(o,e.COMPILE_STATUS)||(console.warn(n),console.error(e.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(s,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),e.getProgramInfoLog(s)!==""&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(s)),e.deleteProgram(s),s=null),e.deleteShader(i),e.deleteShader(o),s}function qm(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}function Wm(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return fh(2*t);case"bvec3":return fh(3*t);case"bvec4":return fh(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function fh(e){for(var t=new Array(e),n=0;n<t.length;n++)t[n]=!1;return t}var Km={},ou=Km;function $m(){if(ou===Km||ou&&ou.isContextLost()){var e=document.createElement("canvas"),t;Ir.PREFER_ENV>=ha.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),ou=t}return ou}var zc;function Eb(){if(!zc){zc=Yo.MEDIUM;var e=$m();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);zc=t.precision?Yo.HIGH:Yo.MEDIUM}}return zc}function Zm(e,t,n){if(e.substring(0,9)!=="precision"){var r=t;return t===Yo.HIGH&&n!==Yo.HIGH&&(r=Yo.MEDIUM),"precision "+r+` float;
`+e}else if(n!==Yo.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}var Ab={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function wb(e){return Ab[e]}var jc=null,Ym={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function Xm(e,t){if(!jc){var n=Object.keys(Ym);jc={};for(var r=0;r<n.length;++r){var i=n[r];jc[e[i]]=Ym[i]}}return jc[t]}var Sb={float:`
    if(cv !== v)
    {
        cv.v = v;
        gl.uniform1f(location, v)
    }`,vec2:`
    if(cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Cb={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function kb(e,t){var n=`var v = null;
    var cv = null
    var t = 0;
    var gl = renderer.gl
    `;for(var r in e.uniforms){var i=t[r];if(!i){e.uniforms[r].group&&(n+=`
                    renderer.shader.syncUniformGroup(uv.`+r+`, syncData);
                `);continue}if(i.type==="float"&&i.size===1)n+=`
            if(uv.`+r+" !== ud."+r+`.value)
            {
                ud.`+r+".value = uv."+r+`
                gl.uniform1f(ud.`+r+".location, uv."+r+`)
            }
`;else if((i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray)n+=`

            t = syncData.textureCount++;

            renderer.texture.bind(uv.`+r+`, t);
            
            if(ud.`+r+`.value !== t)
            {
                ud.`+r+`.value = t;
                gl.uniform1i(ud.`+r+`.location, t);
; // eslint-disable-line max-len
            }
`;else if(i.type==="mat3"&&i.size===1)e.uniforms[r].a!==void 0?n+=`
                gl.uniformMatrix3fv(ud.`+r+".location, false, uv."+r+`.toArray(true));
                
`:n+=`
                gl.uniformMatrix3fv(ud.`+r+".location, false, uv."+r+`);
                
`;else if(i.type==="vec2"&&i.size===1)e.uniforms[r].x!==void 0?n+=`
                cv = ud.`+r+`.value;
                v = uv.`+r+`;

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud.`+r+`.location, v.x, v.y);
                }
`:n+=`
                cv = ud.`+r+`.value;
                v = uv.`+r+`;

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud.`+r+`.location, v[0], v[1]);
                }
                
`;else if(i.type==="vec4"&&i.size===1)e.uniforms[r].width!==void 0?n+=`
                cv = ud.`+r+`.value;
                v = uv.`+r+`;

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud.`+r+`.location, v.x, v.y, v.width, v.height)
                }
`:n+=`
                cv = ud.`+r+`.value;
                v = uv.`+r+`;

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud.`+r+`.location, v[0], v[1], v[2], v[3])
                }
                
`;else{var o=i.size===1?Sb:Cb,s=o[i.type].replace("location","ud."+r+".location");n+=`
            cv = ud.`+r+`.value;
            v = uv.`+r+`;
            `+s+`;
`}}return new Function("ud","uv","renderer","syncData",n)}var Pb=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Tb(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=t.createShader(t.FRAGMENT_SHADER);;){var r=Pb.replace(/%forloop%/gi,Mb(e));if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))e=e/2|0;else break}return e}function Mb(e){for(var t="",n=0;n<e;++n)n>0&&(t+=`
else `),n<e-1&&(t+="if(test == "+n+".0){}");return t}var au;function xb(){if(typeof au=="boolean")return au;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");au=e({a:"b"},"a","b")===!0}catch{au=!1}return au}var Ib=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Rb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,Ob=0,qc={},Qo=function e(t,n,r){r===void 0&&(r="pixi-shader"),this.id=Ob++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=n||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),qc[r]?(qc[r]++,r+="-"+qc[r]):qc[r]=1,this.vertexSrc="#define SHADER_NAME "+r+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+`
`+this.fragmentSrc,this.vertexSrc=Zm(this.vertexSrc,Ir.PRECISION_VERTEX,Yo.HIGH),this.fragmentSrc=Zm(this.fragmentSrc,Ir.PRECISION_FRAGMENT,Eb())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},hh={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Qo.prototype.extractData=function(t,n){var r=$m();if(r){var i=jm(r,t,n);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},Qo.prototype.getAttributeData=function(t,n){for(var r={},i=[],o=n.getProgramParameter(t,n.ACTIVE_ATTRIBUTES),s=0;s<o;s++){var l=n.getActiveAttrib(t,s),d=Xm(n,l.type),f={type:d,name:l.name,size:wb(d),location:0};r[l.name]=f,i.push(f)}i.sort(function(g,m){return g.name>m.name?1:-1});for(var h=0;h<i.length;h++)i[h].location=h;return r},Qo.prototype.getUniformData=function(t,n){for(var r={},i=n.getProgramParameter(t,n.ACTIVE_UNIFORMS),o=0;o<i;o++){var s=n.getActiveUniform(t,o),l=s.name.replace(/\[.*?\]/,""),d=s.name.match(/\[.*?\]/,""),f=Xm(n,s.type);r[l]={type:f,size:s.size,isArray:d,value:Wm(f,s.size)}}return r},hh.defaultVertexSrc.get=function(){return Rb},hh.defaultFragmentSrc.get=function(){return Ib},Qo.from=function(t,n,r){var i=t+n,o=Pm[i];return o||(Pm[i]=o=new Qo(t,n,r)),o},Object.defineProperties(Qo,hh);var Ha=function(t,n){this.program=t,n?n instanceof To?this.uniformGroup=n:this.uniformGroup=new To(n):this.uniformGroup=new To({});for(var r in t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))},Qm={uniforms:{configurable:!0}};Ha.prototype.checkUniformExists=function(t,n){if(n.uniforms[t])return!0;for(var r in n.uniforms){var i=n.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},Ha.prototype.destroy=function(){this.uniformGroup=null},Qm.uniforms.get=function(){return this.uniformGroup.uniforms},Ha.from=function(t,n,r){var i=Qo.from(t,n);return new Ha(i,r)},Object.defineProperties(Ha.prototype,Qm);var ph=0,mh=1,vh=2,gh=3,_h=4,ms=function(){this.data=0,this.blendMode=gr.NORMAL,this.polygonOffset=0,this.blend=!0},to={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};to.blend.get=function(){return!!(this.data&1<<ph)},to.blend.set=function(e){!!(this.data&1<<ph)!==e&&(this.data^=1<<ph)},to.offsets.get=function(){return!!(this.data&1<<mh)},to.offsets.set=function(e){!!(this.data&1<<mh)!==e&&(this.data^=1<<mh)},to.culling.get=function(){return!!(this.data&1<<vh)},to.culling.set=function(e){!!(this.data&1<<vh)!==e&&(this.data^=1<<vh)},to.depthTest.get=function(){return!!(this.data&1<<gh)},to.depthTest.set=function(e){!!(this.data&1<<gh)!==e&&(this.data^=1<<gh)},to.clockwiseFrontFace.get=function(){return!!(this.data&1<<_h)},to.clockwiseFrontFace.set=function(e){!!(this.data&1<<_h)!==e&&(this.data^=1<<_h)},to.blendMode.get=function(){return this._blendMode},to.blendMode.set=function(e){this.blend=e!==gr.NONE,this._blendMode=e},to.polygonOffset.get=function(){return this._polygonOffset},to.polygonOffset.set=function(e){this.offsets=!!e,this._polygonOffset=e},ms.for2d=function(){var t=new ms;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(ms.prototype,to);var Nb=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Lb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,bh=function(e){function t(i,o,s){var l=Qo.from(i||t.defaultVertexSrc,o||t.defaultFragmentSrc);e.call(this,l,s),this.padding=0,this.resolution=Ir.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new ms}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={blendMode:{configurable:!0}},r={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return t.prototype.apply=function(o,s,l,d,f){o.applyFilter(this,s,l,d,f)},n.blendMode.get=function(){return this.state.blendMode},n.blendMode.set=function(i){this.state.blendMode=i},r.defaultVertexSrc.get=function(){return Nb},r.defaultFragmentSrc.get=function(){return Lb},Object.defineProperties(t.prototype,n),Object.defineProperties(t,r),t}(Ha);bh.SOURCE_KEY_MAP={};var Db=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,Bb=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Jm=new Po,su=function(t,n){this._texture=t,this.mapCoord=new Po,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=typeof n>"u"?.5:n,this.isSimple=!1},yh={texture:{configurable:!0}};yh.texture.get=function(){return this._texture},yh.texture.set=function(e){this._texture=e,this._updateID=-1},su.prototype.multiplyUvs=function(t,n){n===void 0&&(n=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var o=t[i],s=t[i+1];n[i]=o*r.a+s*r.c+r.tx,n[i+1]=o*r.b+s*r.d+r.ty}return n},su.prototype.update=function(t){var n=this._texture;if(!n||!n.valid||!t&&this._updateID===n._updateID)return!1;this._updateID=n._updateID;var r=n._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=n.orig,o=n.trim;o&&(Jm.set(i.width/o.width,0,0,i.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(Jm));var s=n.baseTexture,l=this.uClampFrame,d=this.clampMargin/s.resolution,f=this.clampOffset;return l[0]=(n._frame.x+d+f)/s.width,l[1]=(n._frame.y+d+f)/s.height,l[2]=(n._frame.x+n._frame.width-d+f)/s.width,l[3]=(n._frame.y+n._frame.height-d+f)/s.height,this.uClampOffset[0]=f/s.realWidth,this.uClampOffset[1]=f/s.realHeight,this.isSimple=n._frame.width===s.width&&n._frame.height===s.height&&n.rotate===0,!0},Object.defineProperties(su.prototype,yh);var Fb=function(e){function t(n){var r=new Po;e.call(this,Db,Bb),n.renderable=!1,this.maskSprite=n,this.maskMatrix=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r,i,o,s){var l=this.maskSprite,d=this.maskSprite.texture;d.valid&&(d.transform||(d.transform=new su(d,0)),d.transform.update(),this.uniforms.npmAlpha=d.baseTexture.alphaMode?0:1,this.uniforms.mask=d,this.uniforms.otherMatrix=r.calculateSpriteMatrix(this.maskMatrix,l).prepend(d.transform.mapCoord),this.uniforms.alpha=l.worldAlpha,this.uniforms.maskClamp=d.transform.uClampFrame,r.applyFilter(this,i,o,s))},t}(bh),Ub=function(e){function t(n){e.call(this,n),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setMaskStack=function(r){this.maskStack=r,this.renderer.scissor.setMaskStack(r),this.renderer.stencil.setMaskStack(r)},t.prototype.push=function(r,i){if(!i.isMaskData){var o=this.maskDataPool.pop()||new dh;o.pooled=!0,o.maskObject=i,i=o}switch(i.autoDetect&&this.detect(i),i.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),i._target=r,i.type){case mo.SCISSOR:this.maskStack.push(i),this.renderer.scissor.push(i);break;case mo.STENCIL:this.maskStack.push(i),this.renderer.stencil.push(i);break;case mo.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i),this.maskStack.push(i);break}},t.prototype.pop=function(r){var i=this.maskStack.pop();if(!(!i||i._target!==r)){switch(i.type){case mo.SCISSOR:this.renderer.scissor.pop();break;case mo.STENCIL:this.renderer.stencil.pop(i.maskObject);break;case mo.SPRITE:this.popSpriteMask();break}i.reset(),i.pooled&&this.maskDataPool.push(i)}},t.prototype.detect=function(r){var i=r.maskObject;if(i.isSprite){r.type=mo.SPRITE;return}if(r.type=mo.STENCIL,this.enableScissor&&i.isFastRect&&i.isFastRect()){var o=i.worldTransform,s=Math.atan2(o.b,o.a),l=Math.atan2(o.d,o.c);s=Math.round(s*(180/Math.PI)*100),l=Math.round(l*(180/Math.PI)*100)-s,s=(s%9e3+9e3)%9e3,l=(l%18e3+18e3)%18e3,s===0&&l===9e3&&(r.type=mo.SCISSOR)}},t.prototype.pushSpriteMask=function(r){var i=r.maskObject,o=r._target,s=this.alphaMaskPool[this.alphaMaskIndex];s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new Fb(i)]),s[0].resolution=this.renderer.resolution,s[0].maskSprite=i;var l=o.filterArea;o.filterArea=i.getBounds(!0),this.renderer.filter.push(o,s),o.filterArea=l,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(io),ev=function(e){function t(n){e.call(this,n),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(r){var i=this.renderer,o=i.gl,s=this.getStackLength();this.maskStack=r;var l=this.getStackLength();l!==s&&(l===0?o.disable(this.glConst):(o.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(io),Hb=function(e){function t(n){e.call(this,n),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getStackLength=function(){var r=this.maskStack[this.maskStack.length-1];return r?r._scissorCounter:0},t.prototype.push=function(r){var i=r.maskObject;i.renderable=!0;var o=r._scissorRect,s=i.getBounds(!0),l=this.renderer,d=l.gl;i.renderable=!1,o?s.fit(o):d.enable(d.SCISSOR_TEST),r._scissorCounter++,r._scissorRect=s,this._useCurrent()},t.prototype.pop=function(){var r=this.renderer,i=r.gl;this.getStackLength()>0?this._useCurrent():i.disable(i.SCISSOR_TEST)},t.prototype._useCurrent=function(){var r=this.maskStack[this.maskStack.length-1]._scissorRect,i=this.renderer.renderTexture.current,o=this.renderer.projection,s=o.transform,l=o.sourceFrame,d=o.destinationFrame,f=i?i.resolution:this.renderer.resolution,h=(r.x-l.x)*f+d.x,g=(r.y-l.y)*f+d.y,m=r.width*f,S=r.height*f;s&&(h+=s.tx*f,g+=s.ty*f),i||(g=this.renderer.height-S-g),this.renderer.gl.scissor(h,g,m,S)},t}(ev),Gb=function(e){function t(n){e.call(this,n),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getStackLength=function(){var r=this.maskStack[this.maskStack.length-1];return r?r._stencilCounter:0},t.prototype.push=function(r){var i=r.maskObject,o=this.renderer,s=o.gl,l=r._stencilCounter;l===0&&(this.renderer.framebuffer.forceStencil(),s.enable(s.STENCIL_TEST)),r._stencilCounter++,s.colorMask(!1,!1,!1,!1),s.stencilFunc(s.EQUAL,l,this._getBitwiseMask()),s.stencilOp(s.KEEP,s.KEEP,s.INCR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,this._useCurrent()},t.prototype.pop=function(r){var i=this.renderer.gl;this.getStackLength()===0?(i.disable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),i.clearStencil(0)):(i.colorMask(!1,!1,!1,!1),i.stencilOp(i.KEEP,i.KEEP,i.DECR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var r=this.renderer.gl;r.colorMask(!0,!0,!0,!0),r.stencilFunc(r.EQUAL,this.getStackLength(),this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(ev),Vb=function(e){function t(n){e.call(this,n),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Po,this.transform=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(r,i,o,s){this.destinationFrame=r||this.destinationFrame||this.defaultFrame,this.sourceFrame=i||this.sourceFrame||r,this.calculateProjection(this.destinationFrame,this.sourceFrame,o,s),this.transform&&this.projectionMatrix.append(this.transform);var l=this.renderer;l.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,l.globalUniforms.update(),l.shader.shader&&l.shader.syncUniformGroup(l.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(r,i,o,s){var l=this.projectionMatrix;s?(l.a=1/r.width*2*o,l.d=-1/r.height*2*o,l.tx=-1-i.x*l.a,l.ty=1-i.y*l.d):(l.a=1/r.width*2*o,l.d=1/r.height*2*o,l.tx=-1-i.x*l.a,l.ty=-1-i.y*l.d)},t.prototype.setTransform=function(){},t}(io),Ys=new Ni,zb=function(e){function t(n){e.call(this,n),this.clearColor=n._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Ni,this.destinationFrame=new Ni}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.bind=function(r,i,o){r===void 0&&(r=null),this.current=r;var s=this.renderer,l;if(r){var d=r.baseTexture;l=d.resolution,o||(Ys.width=d.realWidth,Ys.height=d.realHeight,o=Ys),i||(i=o),this.renderer.framebuffer.bind(d.framebuffer,o),this.renderer.projection.update(o,i,l,!1),this.renderer.mask.setMaskStack(d.maskStack)}else l=this.renderer.resolution,o||(Ys.width=s.width,Ys.height=s.height,o=Ys),i||(i=o),s.framebuffer.bind(null,o),this.renderer.projection.update(o,i,l,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(i),this.destinationFrame.x=o.x/l,this.destinationFrame.y=o.y/l,this.destinationFrame.width=o.width/l,this.destinationFrame.height=o.height/l,i===o&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(r){this.current?r=r||this.current.baseTexture.clearColor:r=r||this.clearColor,this.renderer.framebuffer.clear(r[0],r[1],r[2],r[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(io),tv=function(t,n){this.program=t,this.uniformData=n,this.uniformGroups={}};tv.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var jb=0,nv={textureCount:0},qb=function(e){function t(n){e.call(this,n),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=jb++}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.systemCheck=function(){if(!xb())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(r){this.gl=r,this.reset()},t.prototype.bind=function(r,i){r.uniforms.globals=this.renderer.globalUniforms;var o=r.program,s=o.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(r);return this.shader=r,this.program!==o&&(this.program=o,this.gl.useProgram(s.program)),i||(nv.textureCount=0,this.syncUniformGroup(r.uniformGroup,nv)),s},t.prototype.setUniforms=function(r){var i=this.shader.program,o=i.glPrograms[this.renderer.CONTEXT_UID];i.syncUniforms(o.uniformData,r,this.renderer)},t.prototype.syncUniformGroup=function(r,i){var o=this.getglProgram();(!r.static||r.dirtyId!==o.uniformGroups[r.id])&&(o.uniformGroups[r.id]=r.dirtyId,this.syncUniforms(r,o,i))},t.prototype.syncUniforms=function(r,i,o){var s=r.syncUniforms[this.shader.program.id]||this.createSyncGroups(r);s(i.uniformData,r.uniforms,this.renderer,o)},t.prototype.createSyncGroups=function(r){var i=this.getSignature(r,this.shader.program.uniformData);return this.cache[i]||(this.cache[i]=kb(r,this.shader.program.uniformData)),r.syncUniforms[this.shader.program.id]=this.cache[i],r.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(r,i){var o=r.uniforms,s=[];for(var l in o)s.push(l),i[l]&&s.push(i[l].type);return s.join("-")},t.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(r){var i=this.gl,o=r.program,s={};for(var l in o.attributeData)s[l]=o.attributeData[l].location;var d=jm(i,o.vertexSrc,o.fragmentSrc,s),f={};for(var h in o.uniformData){var g=o.uniformData[h];f[h]={location:i.getUniformLocation(d,h),value:Wm(g.type,g.size)}}var m=new tv(d,f);return o.glPrograms[this.renderer.CONTEXT_UID]=m,m},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(io);function Wb(e,t){return t===void 0&&(t=[]),t[gr.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.ADD]=[e.ONE,e.ONE],t[gr.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.NONE]=[0,0],t[gr.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[gr.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[gr.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[gr.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[gr.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[gr.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[gr.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[gr.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[gr.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[gr.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[gr.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var Kb=0,$b=1,Zb=2,Yb=3,Xb=4,Qb=function(e){function t(n){e.call(this,n),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=gr.NONE,this._blendEq=!1,this.map=[],this.map[Kb]=this.setBlend,this.map[$b]=this.setOffset,this.map[Zb]=this.setCullFace,this.map[Yb]=this.setDepthTest,this.map[Xb]=this.setFrontFace,this.checks=[],this.defaultState=new ms,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contextChange=function(r){this.gl=r,this.blendModes=Wb(r),this.set(this.defaultState),this.reset()},t.prototype.set=function(r){if(r=r||this.defaultState,this.stateId!==r.data){for(var i=this.stateId^r.data,o=0;i;)i&1&&this.map[o].call(this,!!(r.data&1<<o)),i=i>>1,o++;this.stateId=r.data}for(var s=0;s<this.checks.length;s++)this.checks[s](this,r)},t.prototype.forceState=function(r){r=r||this.defaultState;for(var i=0;i<this.map.length;i++)this.map[i].call(this,!!(r.data&1<<i));for(var o=0;o<this.checks.length;o++)this.checks[o](this,r);this.stateId=r.data},t.prototype.setBlend=function(r){this.updateCheck(t.checkBlendMode,r),this.gl[r?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(r){this.updateCheck(t.checkPolygonOffset,r),this.gl[r?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(r){this.gl[r?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setCullFace=function(r){this.gl[r?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(r){this.gl.frontFace(this.gl[r?"CW":"CCW"])},t.prototype.setBlendMode=function(r){if(r!==this.blendMode){this.blendMode=r;var i=this.blendModes[r],o=this.gl;i.length===2?o.blendFunc(i[0],i[1]):o.blendFuncSeparate(i[0],i[1],i[2],i[3]),i.length===6?(this._blendEq=!0,o.blendEquationSeparate(i[4],i[5])):this._blendEq&&(this._blendEq=!1,o.blendEquationSeparate(o.FUNC_ADD,o.FUNC_ADD))}},t.prototype.setPolygonOffset=function(r,i){this.gl.polygonOffset(r,i)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(r,i){var o=this.checks.indexOf(r);i&&o===-1?this.checks.push(r):!i&&o!==-1&&this.checks.splice(o,1)},t.checkBlendMode=function(r,i){r.setBlendMode(i.blendMode)},t.checkPolygonOffset=function(r,i){r.setPolygonOffset(i.polygonOffset,0)},t}(io),Jb=function(e){function t(n){e.call(this,n),this.count=0,this.checkCount=0,this.maxIdle=Ir.GC_MAX_IDLE,this.checkCountMax=Ir.GC_MAX_CHECK_COUNT,this.mode=Ir.GC_MODE}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==eh.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var r=this.renderer.texture,i=r.managedTextures,o=!1,s=0;s<i.length;s++){var l=i[s];!l.framebuffer&&this.count-l.touched>this.maxIdle&&(r.destroyTexture(l,!0),i[s]=null,o=!0)}if(o){for(var d=0,f=0;f<i.length;f++)i[f]!==null&&(i[d++]=i[f]);i.length=d}},t.prototype.unload=function(r){var i=this.renderer.textureSystem;r._texture&&r._texture._glRenderTargets&&i.destroyTexture(r._texture);for(var o=r.children.length-1;o>=0;o--)this.unload(r.children[o])},t}(io),Eh=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},e5=function(e){function t(n){e.call(this,n),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Li}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contextChange=function(){var r=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var i=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=i;for(var o=0;o<i;o++)this.boundTextures[o]=null;this.emptyTextures={};var s=new Eh(r.createTexture());r.bindTexture(r.TEXTURE_2D,s.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[r.TEXTURE_2D]=s,this.emptyTextures[r.TEXTURE_CUBE_MAP]=new Eh(r.createTexture()),r.bindTexture(r.TEXTURE_CUBE_MAP,this.emptyTextures[r.TEXTURE_CUBE_MAP].texture);for(var l=0;l<6;l++)r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+l,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,null);r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MIN_FILTER,r.LINEAR);for(var d=0;d<this.boundTextures.length;d++)this.bind(null,d)},t.prototype.bind=function(r,i){i===void 0&&(i=0);var o=this,s=o.gl;if(r){if(r=r.baseTexture||r,r.valid){r.touched=this.renderer.textureGC.count;var l=r._glTextures[this.CONTEXT_UID]||this.initTexture(r);this.boundTextures[i]!==r&&(this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),s.bindTexture(r.target,l.texture)),l.dirtyId!==r.dirtyId&&(this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),this.updateTexture(r)),this.boundTextures[i]=r}}else this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[i]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var r=0;r<this.boundTextures.length;r++)this.boundTextures[r]=this.unknownTexture},t.prototype.unbind=function(r){var i=this,o=i.gl,s=i.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var l=0;l<s.length;l++)s[l]===this.unknownTexture&&this.bind(null,l)}for(var d=0;d<s.length;d++)s[d]===r&&(this.currentLocation!==d&&(o.activeTexture(o.TEXTURE0+d),this.currentLocation=d),o.bindTexture(o.TEXTURE_2D,this.emptyTextures[r.target].texture),s[d]=null)},t.prototype.initTexture=function(r){var i=new Eh(this.gl.createTexture());return i.dirtyId=-1,r._glTextures[this.CONTEXT_UID]=i,this.managedTextures.push(r),r.on("dispose",this.destroyTexture,this),i},t.prototype.initTextureType=function(r,i){if(i.internalFormat=r.format,i.type=r.type,this.webGLVersion===2){var o=this.renderer.gl;r.type===o.FLOAT&&r.format===o.RGBA&&(i.internalFormat=o.RGBA32F),r.type===ko.HALF_FLOAT&&(i.type=o.HALF_FLOAT),i.type===o.HALF_FLOAT&&r.format===o.RGBA&&(i.internalFormat=o.RGBA16F)}},t.prototype.updateTexture=function(r){var i=r._glTextures[this.CONTEXT_UID];if(i){var o=this.renderer;if(this.initTextureType(r,i),!(r.resource&&r.resource.upload(o,r,i))){var s=r.realWidth,l=r.realHeight,d=o.gl;(i.width!==s||i.height!==l||i.dirtyId<0)&&(i.width=s,i.height=l,d.texImage2D(r.target,0,i.internalFormat,s,l,0,r.format,i.type,null))}r.dirtyStyleId!==i.dirtyStyleId&&this.updateTextureStyle(r),i.dirtyId=r.dirtyId}},t.prototype.destroyTexture=function(r,i){var o=this,s=o.gl;if(r=r.baseTexture||r,r._glTextures[this.CONTEXT_UID]&&(this.unbind(r),s.deleteTexture(r._glTextures[this.CONTEXT_UID].texture),r.off("dispose",this.destroyTexture,this),delete r._glTextures[this.CONTEXT_UID],!i)){var l=this.managedTextures.indexOf(r);l!==-1&&eu(this.managedTextures,l,1)}},t.prototype.updateTextureStyle=function(r){var i=r._glTextures[this.CONTEXT_UID];i&&((r.mipmap===J0.POW2||this.webGLVersion!==2)&&!r.isPowerOfTwo?i.mipmap=0:i.mipmap=r.mipmap>=1,this.webGLVersion!==2&&!r.isPowerOfTwo?i.wrapMode=Nc.CLAMP:i.wrapMode=r.wrapMode,r.resource&&r.resource.style(this.renderer,r,i)||this.setStyle(r,i),i.dirtyStyleId=r.dirtyStyleId)},t.prototype.setStyle=function(r,i){var o=this.gl;if(i.mipmap&&o.generateMipmap(r.target),o.texParameteri(r.target,o.TEXTURE_WRAP_S,i.wrapMode),o.texParameteri(r.target,o.TEXTURE_WRAP_T,i.wrapMode),i.mipmap){o.texParameteri(r.target,o.TEXTURE_MIN_FILTER,r.scaleMode?o.LINEAR_MIPMAP_LINEAR:o.NEAREST_MIPMAP_NEAREST);var s=this.renderer.context.extensions.anisotropicFiltering;if(s&&r.anisotropicLevel>0&&r.scaleMode===Oc.LINEAR){var l=Math.min(r.anisotropicLevel,o.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));o.texParameterf(r.target,s.TEXTURE_MAX_ANISOTROPY_EXT,l)}}else o.texParameteri(r.target,o.TEXTURE_MIN_FILTER,r.scaleMode?o.LINEAR:o.NEAREST);o.texParameteri(r.target,o.TEXTURE_MAG_FILTER,r.scaleMode?o.LINEAR:o.NEAREST)},t}(io),Ah=new Po,t5=function(e){function t(r,i){e.call(this),i=Object.assign({},Ir.RENDER_OPTIONS,i),i.roundPixels&&(Ir.ROUND_PIXELS=i.roundPixels,km("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=i,this.type=Ql.UNKNOWN,this.screen=new Ni(0,0,i.width,i.height),this.view=i.view||document.createElement("canvas"),this.resolution=i.resolution||Ir.RESOLUTION,this.transparent=i.transparent,this.autoDensity=i.autoDensity||i.autoResize||!1,this.preserveDrawingBuffer=i.preserveDrawingBuffer,this.clearBeforeRender=i.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=i.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new Uc,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return t.prototype.initPlugins=function(i){for(var o in i)this.plugins[o]=new i[o](this)},n.width.get=function(){return this.view.width},n.height.get=function(){return this.view.height},t.prototype.resize=function(i,o){this.screen.width=i,this.screen.height=o,this.view.width=i*this.resolution,this.view.height=o*this.resolution,this.autoDensity&&(this.view.style.width=i+"px",this.view.style.height=o+"px")},t.prototype.generateTexture=function(i,o,s,l){l=l||i.getLocalBounds(),l.width===0&&(l.width=1),l.height===0&&(l.height=1);var d=uh.create(l.width|0,l.height|0,o,s);return Ah.tx=-l.x,Ah.ty=-l.y,this.render(i,d,!1,Ah,!!i.parent),d},t.prototype.destroy=function(i){for(var o in this.plugins)this.plugins[o].destroy(),this.plugins[o]=null;i&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=Ql.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},n.backgroundColor.get=function(){return this._backgroundColor},n.backgroundColor.set=function(r){this._backgroundColor=r,this._backgroundColorString=ym(r),bm(r,this._backgroundColorRgba)},Object.defineProperties(t.prototype,n),t}(ql),rv=function(e){function t(n){n===void 0&&(n={}),e.call(this,"WebGL",n),n=this.options,this.type=Ql.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new qi("destroy"),contextChange:new qi("contextChange",1),reset:new qi("reset"),update:new qi("update"),postrender:new qi("postrender"),prerender:new qi("prerender"),resize:new qi("resize",2)},this.globalUniforms=new To({projectionMatrix:new Po},!0),this.addSystem(Ub,"mask").addSystem(gb,"context").addSystem(Qb,"state").addSystem(qb,"shader").addSystem(e5,"texture").addSystem(yb,"geometry").addSystem(_b,"framebuffer").addSystem(Hb,"scissor").addSystem(Gb,"stencil").addSystem(Vb,"projection").addSystem(Jb,"textureGC").addSystem(mb,"filter").addSystem(zb,"renderTexture").addSystem(vb,"batch"),this.initPlugins(t.__plugins),n.context?this.context.initFromContext(n.context):this.context.initFromOptions({alpha:this.transparent,antialias:n.antialias,premultipliedAlpha:this.transparent&&this.transparent!=="notMultiplied",stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,L8(this.context.webGLVersion===2?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(r){if(D8())return new t(r);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},t.prototype.addSystem=function(r,i){i||(i=r.name);var o=new r(this);if(this[i])throw new Error('Whoops! The name "'+i+'" is already in use');this[i]=o;for(var s in this.runners)this.runners[s].add(o);return this},t.prototype.render=function(r,i,o,s,l){if(this.renderingToScreen=!i,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=s,!this.context.isLost){if(i||(this._lastObjectRendered=r),!l){var d=r.parent;r.parent=this._tempDisplayObjectParent,r.updateTransform(),r.parent=d}this.renderTexture.bind(i),this.batch.currentRenderer.start(),(o!==void 0?o:this.clearBeforeRender)&&this.renderTexture.clear(),r.render(this),this.batch.currentRenderer.flush(),i&&i.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit("postrender")}},t.prototype.resize=function(r,i){e.prototype.resize.call(this,r,i),this.runners.resize.run(r,i)},t.prototype.reset=function(){return this.runners.reset.run(),this},t.prototype.clear=function(){this.framebuffer.bind(),this.framebuffer.clear()},t.prototype.destroy=function(r){this.runners.destroy.run();for(var i in this.runners)this.runners[i].destroy();e.prototype.destroy.call(this,r),this.gl=null},t.registerPlugin=function(r,i){t.__plugins=t.__plugins||{},t.__plugins[r]=i},t}(t5);function n5(e){return rv.create(e)}var iv=function(){this.texArray=null,this.blend=0,this.type=Ws.TRIANGLES,this.start=0,this.size=0,this.data=null},wh=function(){this.elements=[],this.ids=[],this.count=0};wh.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var lu=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},Xs={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Xs.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Xs.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Xs.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Xs.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Xs.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},lu.prototype.view=function(t){return this[t+"View"]},lu.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},lu.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(lu.prototype,Xs);var Sh=function(e){function t(n){e.call(this,n),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=ms.for2d(),this.size=Ir.SPRITE_BATCH_SIZE*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),n.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contextChange=function(){var r=this.renderer.gl;Ir.PREFER_ENV===ha.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),Ir.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Tb(this.MAX_TEXTURES,r)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var r=t._drawCallPool,i=t._textureArrayPool,o=this.size/4,s=Math.floor(o/this.MAX_TEXTURES)+1;r.length<o;)r.push(new iv);for(;i.length<s;)i.push(new wh);for(var l=0;l<this.MAX_TEXTURES;l++)this._tempBoundTextures[l]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(r){r._texture.valid&&(this._vertexCount+r.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=r.vertexData.length/2,this._indexCount+=r.indices.length,this._bufferedTextures[this._bufferSize]=r._texture.baseTexture,this._bufferedElements[this._bufferSize++]=r)},t.prototype.buildTexturesAndDrawCalls=function(){var r=this,i=r._bufferedTextures,o=r.MAX_TEXTURES,s=t._textureArrayPool,l=this.renderer.batch,d=this._tempBoundTextures,f=this.renderer.textureGC.count,h=++Li._globalBatch,g=0,m=s[0],S=0;l.copyBoundTextures(d,o);for(var P=0;P<this._bufferSize;++P){var I=i[P];i[P]=null,I._batchEnabled!==h&&(m.count>=o&&(l.boundArray(m,d,h,o),this.buildDrawCalls(m,S,P),S=P,m=s[++g],++h),I._batchEnabled=h,I.touched=f,m.elements[m.count++]=I)}m.count>0&&(l.boundArray(m,d,h,o),this.buildDrawCalls(m,S,this._bufferSize),++g,++h);for(var D=0;D<d.length;D++)d[D]=null;Li._globalBatch=h},t.prototype.buildDrawCalls=function(r,i,o){var s=this,l=s._bufferedElements,d=s._attributeBuffer,f=s._indexBuffer,h=s.vertexSize,g=t._drawCallPool,m=this._dcIndex,S=this._aIndex,P=this._iIndex,I=g[m];I.start=this._iIndex,I.texArray=r;for(var D=i;D<o;++D){var be=l[D],Ye=be._texture.baseTexture,Se=Em[Ye.alphaMode?1:0][be.blendMode];l[D]=null,i<D&&I.blend!==Se&&(I.size=P-I.start,i=D,I=g[++m],I.texArray=r,I.start=P),this.packInterleavedGeometry(be,d,f,S,P),S+=be.vertexData.length/2*h,P+=be.indices.length,I.blend=Se}i<o&&(I.size=P-I.start,++m),this._dcIndex=m,this._aIndex=S,this._iIndex=P},t.prototype.bindAndClearTexArray=function(r){for(var i=this.renderer.texture,o=0;o<r.count;o++)i.bind(r.elements[o],r.ids[o]),r.elements[o]=null;r.count=0},t.prototype.updateGeometry=function(){var r=this,i=r._packedGeometries,o=r._attributeBuffer,s=r._indexBuffer;Ir.CAN_UPLOAD_SAME_BUFFER?(i[this._flushId]._buffer.update(o.rawBinaryData),i[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(o.rawBinaryData),i[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var r=this._dcIndex,i=this.renderer,o=i.gl,s=i.state,l=t._drawCallPool,d=null,f=0;f<r;f++){var h=l[f],g=h.texArray,m=h.type,S=h.size,P=h.start,I=h.blend;d!==g&&(d=g,this.bindAndClearTexArray(g)),this.state.blendMode=I,s.set(this.state),o.drawElements(m,S,o.UNSIGNED_SHORT,P*2)}},t.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Ir.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]&&this._packedGeometries[r].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(r){var i=Lc(Math.ceil(r/8)),o=Sm(i),s=i*8;this._aBuffers.length<=o&&(this._iBuffers.length=o+1);var l=this._aBuffers[s];return l||(this._aBuffers[s]=l=new lu(s*this.vertexSize*4)),l},t.prototype.getIndexBuffer=function(r){var i=Lc(Math.ceil(r/12)),o=Sm(i),s=i*12;this._iBuffers.length<=o&&(this._iBuffers.length=o+1);var l=this._iBuffers[o];return l||(this._iBuffers[o]=l=new Uint16Array(s)),l},t.prototype.packInterleavedGeometry=function(r,i,o,s,l){for(var d=i.uint32View,f=i.float32View,h=s/this.vertexSize,g=r.uvs,m=r.indices,S=r.vertexData,P=r._texture.baseTexture._batchLocation,I=Math.min(r.worldAlpha,1),D=I<1&&r._texture.baseTexture.alphaMode?Am(r._tintRGB,I):r._tintRGB+(I*255<<24),be=0;be<S.length;be+=2)f[s++]=S[be],f[s++]=S[be+1],f[s++]=g[be],f[s++]=g[be+1],d[s++]=D,f[s++]=P;for(var Ye=0;Ye<m.length;Ye++)o[l++]=h+m[Ye]},t}(Ua);Sh._drawCallPool=[],Sh._textureArrayPool=[];var Ch=function(t,n){if(this.vertexSrc=t,this.fragTemplate=n,this.programCache={},this.defaultGroupCache={},n.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(n.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};Ch.prototype.generateShader=function(t){if(!this.programCache[t]){for(var n=new Int32Array(t),r=0;r<t;r++)n[r]=r;this.defaultGroupCache[t]=To.from({uSamplers:n},!0);var i=this.fragTemplate;i=i.replace(/%count%/gi,""+t),i=i.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Qo(this.vertexSrc,i)}var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Po,default:this.defaultGroupCache[t]};return new Ha(this.programCache[t],o)},Ch.prototype.generateSampleSrc=function(t){var n="";n+=`
`,n+=`
`;for(var r=0;r<t;r++)r>0&&(n+=`
else `),r<t-1&&(n+="if(vTextureId < "+r+".5)"),n+=`
{`,n+=`
	color = texture2D(uSamplers[`+r+"], vTextureCoord);",n+=`
}`;return n+=`
`,n+=`
`,n};var ov=function(e){function t(n){n===void 0&&(n=!1),e.call(this),this._buffer=new eo(null,n,!1),this._indexBuffer=new eo(null,n,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,ko.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,ko.FLOAT).addAttribute("aColor",this._buffer,4,!0,ko.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,ko.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Di),av=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,sv=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,kh=function(){},Ph={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};kh.create=function(t){var n=Object.assign({vertex:av,fragment:sv,geometryClass:ov,vertexSize:6},t),r=n.vertex,i=n.fragment,o=n.vertexSize,s=n.geometryClass;return function(l){function d(f){l.call(this,f),this.shaderGenerator=new Ch(r,i),this.geometryClass=s,this.vertexSize=o}return l&&(d.__proto__=l),d.prototype=Object.create(l&&l.prototype),d.prototype.constructor=d,d}(Sh)},Ph.defaultVertexSrc.get=function(){return av},Ph.defaultFragmentTemplate.get=function(){return sv},Object.defineProperties(kh,Ph);var r5=kh.create()},95653:function(lt,nn,Fe){"use strict";Fe.d(nn,{A:function(){return R},B:function(){return ta},C:function(){return vs},D:function(){return me},E:function(){return E},F:function(){return _e},G:function(){return Yt},H:function(){return He},I:function(){return kt},J:function(){return Y},K:function(){return In},L:function(){return ft},M:function(){return Ur},N:function(){return Fr},O:function(){return at},P:function(){return Ei},Q:function(){return Ut},R:function(){return q},S:function(){return gn},T:function(){return fn},U:function(){return Jo},V:function(){return w},a:function(){return Mn},b:function(){return Dn},c:function(){return Le},d:function(){return on},e:function(){return We},f:function(){return te},g:function(){return nr},h:function(){return Q},i:function(){return Kt},j:function(){return de},k:function(){return ke},l:function(){return ot},m:function(){return Ae},n:function(){return ye},o:function(){return mn},p:function(){return xe},q:function(){return ie},r:function(){return yt},s:function(){return Tr},t:function(){return L},u:function(){return pe},v:function(){return za},w:function(){return Uo},x:function(){return xo},y:function(){return Va},z:function(){return Ho}});var w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Fe.g<"u"?Fe.g:typeof self<"u"?self:{},ne={exports:{}};(function($){/*!
 * Chess.com (c) 2020 | all rights reserved
 *//*!
 * A distant fork of chess.js - BSD (c) 2014, Jeff Hlywa (jhlywa@gmail.com)
 */(function(){var W=function(){var U=[[2637767806,863464769],[720845184,95069639],[1155203408,610415943],[2618685246,1655139042],[1971536997,1218186377],[848342074,540017087],[263957791,1627660921],[3896152207,4076560586],[226391645,1484086288],[436746274,3467632685],[2516964848,3797861296],[3491888988,3510251221],[1086189917,1248276018],[18044180,1876255637],[1572111136,1190386149],[597658413,2146900428],[97624494,2243205793],[1738507407,1854916977],[1950989311,2149575947],[2098318769,3283594736],[2194108574,2015279052],[4079062812,2500884588],[856979699,2941369318],[1270058469,3877737539],[2858720366,3170717948],[2378012835,1387254795],[2278688587,2178388503],[435406673,3555273441],[3031118064,1655806655],[2063925420,1107589828],[3376753832,436852829],[615148625,1302492416],[1285502018,1963045959],[346460119,1016137793],[2803604355,1176288659],[55085973,2968618255],[1669016372,4287873088],[164740250,1037634196],[896886403,883023163],[1935551383,2764331555],[410153072,4055711755],[533441746,1505690343],[3541084098,3466290517],[3214426080,4267541060],[2675233103,1951705124],[1374411850,3115986997],[1552073989,3684348154],[4244110986,875606593],[844343081,3115990494],[2356462440,135999605],[3116133511,377238503],[2129956651,2197966368],[299173332,3276914047],[1701379241,745972291],[1306570996,254977976],[2530644806,214138461],[1122123979,1667800879],[1831591130,3801192033],[1116211970,920967505],[1594837592,2551651254],[972591349,2046373768],[2479207924,1935030411],[1675376029,2367888248],[3960916618,3935874422],[1398143232,3265801671],[133930885,1520005442],[1351827834,2829577566],[2076951437,2723839804],[435980918,2364847828],[1668970368,3738157273],[2185864314,3993911799],[2041407829,31969768],[346864372,2004703094],[4047877822,3437142421],[3669961416,538399484],[616810829,4190688246],[3144558884,4030272234],[216165387,2513010905],[2761740594,3216997572],[3919406634,4096014649],[669429112,2434161727],[2234904640,3111407601],[1421079802,1598085235],[1924213810,310373675],[4002762044,2067865415],[2592451728,2586110625],[1890340057,4031717877],[4189625662,2577429954],[2276713138,3049850801],[2741429688,3310307512],[2924122950,3426712818],[421576781,1193704381],[2277442246,3030264553],[153237420,595540057],[4278711886,4176286928],[2380848297,4030514510],[2618700582,1303682185],[3018992701,185284845],[957243316,1291916363],[1543415220,1898408169],[504378001,531073412],[2591337657,1692896435],[1333852064,903543556],[1661259930,188168388],[561112646,2197961224],[1536910315,2632972300],[1349168372,2307429186],[411152329,2745631190],[1694697476,1081411140],[3755185459,2631660711],[4019355068,4027326706],[2066937809,3761668332],[3120395808,3878773315],[94890149,2109283191],[3045629038,358812277],[1249184265,3465901047],[3477490924,2308583306],[4114113436,3875911716],[1014604031,1434513279],[3991324799,2222416029],[2040431088,1539915569],[2253613964,4081224332],[2547464012,1611168627],[2722521980,4281500978],[71289574,213969824],[2450408597,903689630],[1894451515,364024012],[1939968537,374938813],[1447259295,3785468557],[4021046128,1664847745],[3139524504,3562928047],[1173487682,4065269608],[2467266804,3907744866],[4284945151,3486998177],[2925674454,1953016432],[3710671816,1271453948],[2129465869,1422863833],[587093076,18243356],[3373793513,2411305257],[2156648078,1791034213],[3737413652,1534461430],[468575139,2935304962],[1129551363,3603256834],[2861996892,1763494778],[2826449619,2465197654],[1704209531,1014895022],[3738359347,3402630390],[569410928,4095796581],[3021312909,2108247612],[2444777957,2664129360],[282063667,3773661258],[682545472,3188439005],[3318488457,1917822038],[1447622272,4045023041],[757420137,4038580915],[2613420942,4146703316],[4012836163,150381244],[2938127093,3428591704],[1208226490,3086335530],[2935205706,1446903363],[430957978,3830532479],[1381578755,3757172800],[4109399782,1596778224],[288855589,1954372339],[3169178148,2256716053],[2644780093,3895892303],[107966643,1071681559],[1304747544,2607225372],[1359190711,1898207171],[3229237120,3273634996],[3027167685,3863637628],[3011615298,2883984519],[564135827,978463264],[770797430,362326607],[1983662611,1907583229],[4153656423,48268960],[3609759233,720080177],[3727911466,1270989899],[200708787,2366086947],[744508026,393422515],[1213261630,65757284],[3485747185,3845951003],[2958861301,1680248217],[2598470344,3163845864],[2767997908,4233451722],[3881113485,1492930166],[1773764017,2764062206],[4189435844,2898689174],[4234838742,1267095035],[2624081078,3302114327],[2395569449,390426320],[1728307101,690284926],[3309827454,1118258254],[2028172868,3888829086],[4271523049,909051386],[146617804,942892565],[2467685867,974297806],[2483428231,503635829],[3743260573,2018222096],[1002067894,2289153437],[3535252974,3738302271],[4154611160,1002664952],[3623154244,2349656961],[3646679180,3524329383],[862933752,4282853607],[2806008282,3272780913],[2734037942,3828874677],[1328176304,2137666995],[2278785213,2780788825],[381286368,1816476193],[2074232908,2316293454],[4087773386,3651330956],[967884669,3728964514],[4239349185,3213509668],[419231360,1463788948],[1275421624,2672384707],[1088456595,436245261],[2365565249,783696577],[1758083333,845223583],[2048846183,3530914274],[2635948261,124738415],[940630937,3069598626],[839474029,1253439921],[902477345,165479306],[2836079689,2681188273],[2007115168,2093139645],[1363041891,1282466609],[1130479818,1063857938],[3644959908,1260430427],[1385135238,46497915],[1386975934,3110156681],[2635987502,4233461619],[1915744629,4117939016],[487743653,285736599],[2049219159,3960249250],[69242857,3908563670],[1511066720,1488527520],[215590039,1703564952],[1459430344,4184955468],[676103291,2642967214],[83799035,3182827979],[1949179493,476101251],[2593534694,1493478716],[2283504289,995211746],[1349412676,3449243940],[2954378677,1878813305],[249149717,3329151870],[1578231917,1483986052],[4135085182,890874990],[461755528,3505523909],[3669622373,634949665],[219487622,2914465301],[2825233742,3703631897],[2479105382,2935590907],[2582097898,3187672881],[1221328648,1843341402],[2140891889,3958868911],[1482849818,345750049],[751922730,3178831411],[3546542069,4036458902],[216179596,877293293],[444615341,3117393729],[2424254530,494454238],[1344234989,3003337991],[929188581,2760877801],[2507911009,1879899982],[980166547,1311840394],[3566535507,1790747461],[143525013,2311336672],[4181962471,4273938872],[1815842366,862009811],[911175674,1179575598],[3591335374,3694215714],[1452686093,3393294272],[385158879,2447709103],[4011414929,1264623507],[1448477120,911094312],[3971299641,2289992053],[3133647265,2234591563],[3007628400,964409938],[1708345684,3673411261],[3031964479,2843021794],[3022128657,2480338599],[118850112,473449293],[2048127371,3202109429],[3158349745,382018770],[1505327237,3807570472],[2568424029,3272693060],[1866609495,3888556537],[844703982,1852802964],[3504617058,682636099],[1448882679,3733580327],[821387540,2215744532],[3631471417,311618895],[2077838877,2383929020],[3352949096,1688694420],[2491080787,3998672444],[3368630402,4182204255],[983299419,2837414346],[3651215291,1033373924],[265429091,3988955082],[3019003608,2896212153],[2955948456,3025235588],[903690197,2266253487],[3925215275,89402958],[3959093811,3609545561],[2455088053,223552128],[3115011301,2133669107],[1765081558,673805649],[3324795129,2111392191],[3443871631,432345706],[3152559950,3425427147],[3699649406,672784944],[3129545774,7668664],[2747044893,173040075],[3925243406,852328481],[164095314,3161868591],[2234471571,1302682825],[2164784335,105893718],[159995093,536831360],[599199451,425051327],[3274759746,1680930461],[1192619331,3903085578],[2832721114,3078660237],[91404660,4030521531],[3044880024,1578375623],[3906596030,754177855],[803516785,1894094672],[288455592,2030430096],[2143232492,2317305324],[388352703,3406060288],[2521731420,3588403719],[1043041227,4028028525],[3195290851,2468913324],[4166724431,3168683191],[1228226538,968516529],[500177583,3444787306],[533367442,4252082053],[4236023256,657816314],[413575568,3367198397],[3435884549,3334062733],[1004255532,1135705894],[2859513268,4170618274],[3914086821,1251487871],[3080761716,3489067886],[3571165255,699353261],[773372954,3648014952],[769693293,2939128604],[3116440923,507748478],[1687629160,3739431776],[2489486648,3502376324],[3686847158,2878383449],[3530767427,902211375],[2121652637,2493976397],[1827477891,930064171],[2549918411,4029725732],[2071415163,844118802],[2236083679,3088894868],[2040110303,4144562891],[3489536313,1133419300],[2190878435,2301466071],[2465915458,2448602097],[1675766804,2073834499],[3329799896,1613253148],[1483966600,1348836071],[159505618,2527621997],[2674227354,1695130688],[2683539437,1927873839],[3833196123,2570082188],[3891433165,759819981],[1455453349,2179602430],[1430583255,1957776111],[2067726741,4235143439],[303380021,2998980439],[2136024795,3126725799],[2054591852,1051702291],[1029141665,489794361],[2317027384,569642164],[2068461795,624418658],[2499875684,1830645251],[1302894490,4319401],[1002663431,2406815191],[1560941298,2060652753],[2141002286,515773223],[3661248027,475092913],[3705503008,2419919909],[914567990,3496539911],[3462935583,2039034761],[2878378006,2379243316],[1133857586,1390159333],[3023618742,2140726761],[282908558,944874642],[3686955701,1148723903],[2604456805,4163675010],[3061545110,377179268],[3218002352,76459088],[2836503392,916455101],[536836808,151306053],[2886925079,404221671],[2936593041,2011015485],[453815187,1852163908],[3042568989,82176306],[3279635891,4174836410],[3282689058,2360003049],[4088968807,1516570623],[2680453086,1322680794],[1731693966,3438253771],[1842894553,1294307894],[2736377365,2964642609],[121205621,521330014],[2324595870,3005710757],[3784465521,676493813],[1958759409,2030833406],[1306150933,1016370058],[2636541290,482366508],[1950415745,1695073534],[322077955,3746046623],[3602873262,3829181504],[1211684447,1861645455],[504701736,4080111082],[2407799203,1223857855],[1925743434,1498920209],[3617596327,845198428],[2498480299,3484773806],[2680229135,2560201696],[3731399221,1536412390],[2756509305,2924710846],[2635957500,3459716133],[1372762539,769635894],[802677945,3878474636],[1707760534,3075809808],[3714687192,2872792173],[1615679922,1606381794],[1940556374,1337437342],[445390489,731124040],[2864974375,64601760],[1984806574,2141516710],[513390958,1890172555],[744398315,1475299139],[982749166,852662657],[652663695,4260736510],[1184061125,82616221],[3363191899,147951756],[1064069880,1507328085],[2138882964,547595589],[2616926846,3186935246],[2298715513,3606862940],[2414381911,811477686],[2694745228,900437726],[4202576185,2201114451],[3602305260,3323446937],[3756663274,2658490339],[3061587876,2171079416],[3390977925,2850497765],[486312941,224925241],[3515712841,3510684394],[1322319486,2647200565],[3839619171,1148450258],[392296762,1154854654],[1401523788,957405781],[1934485528,527352730],[645968162,3131215255],[696971825,3361451947],[2038689491,1946699733],[1723966113,2785859721],[2652365974,1118037185],[3988018407,3134982149],[1354171594,3053634345],[1287854075,2631782435],[1723106141,2662328866],[563845090,1878819261],[639520332,171129501],[534957223,1696062352],[3612364282,2283204027],[3109494688,1304463816],[500957989,630925278],[3477030536,2149497258],[4109750364,281719363],[951472732,564407054],[922095147,2767874048],[3946156928,829677774],[2622281253,2086286851],[2936811901,850242186],[630086272,3340782667],[2340986210,1296336989],[4107355543,3865114709],[3560210278,3968418243],[3868847493,2967450637],[611513888,2083325060],[3265390517,3025776309],[2874106961,3424470508],[1668707698,2923258228],[2778598353,24320552],[292356118,3415510793],[754567370,86994591],[185141877,1621715171],[2884558258,3722473457],[1492107531,111281805],[3336927864,4225337056],[782994598,1021838039],[346133860,18281270],[2080909533,1649329040],[3612065399,3859901127],[2151962287,284556115],[3957975594,3745718727],[52533817,3998775856],[1232633839,397383972],[2716413964,3629253960],[1531307298,3836851439],[3030137657,2500401718],[3561556693,653345841],[313061910,2945718466],[2065276,3342140708],[410498334,1470588117],[2726640512,4051654894],[2570984935,758567696],[3008987264,3462702678],[623860175,228525243],[3527183895,1829844480],[467272850,3890501742],[568376656,650516927],[990477018,4035508558],[2366955227,817792110],[4183621538,989198068],[946958343,1639184195],[3395758993,3924097558],[1690887473,3220519765],[605184237,1255270525],[275515833,1926424610],[2142902612,283494960],[2021972412,1823828440],[105373677,3448326697],[1666662384,1042433908],[1338566998,261206307],[498685668,1344755577],[3101233780,3119109371],[2733370951,3808165089],[3656512268,3449289481],[4025308119,1607880299],[778896067,1612183167],[2846510368,3674754715],[3058428120,2991822529],[1892379383,3268787440],[2565895844,4154602030],[3213117192,98999135],[2495816991,116985075],[1040203361,1785041385],[3106252493,69316595],[1639829808,2087117568],[3213709576,3799911752],[604681594,2340981536],[4236730699,2938666503],[4009938384,1878897714],[2701667332,1725918218],[2182473079,1258184],[3550198211,2760750799],[657991062,875584532],[1640976276,3380476221],[460041378,2924352091],[1972323596,2287414795],[2510248061,1350206297],[2959337826,3762681165],[1625877874,3235902929],[2070189957,1429368735],[4245163299,1839731898],[2358312347,138364248],[275739390,2179122576],[2037777210,972544338],[2766930226,1984733259],[1933485829,4209310327],[3034118011,3286589799],[2653025529,62078937],[2641780289,2679545709],[3540781195,2787026415],[1569993599,3215949659],[441337890,3947723353],[1878946792,459505587],[3724105660,920173002],[1691411102,3934795955],[148741087,3647709027],[142506469,2776440083],[3811107376,3823285243],[472209891,252266174],[1913386482,1867329194],[2960608550,482740699],[1145005292,1513558421],[1091751784,1687823886],[3625186042,3086337482],[1712140887,940065262],[1504455800,1945702563],[3896940088,2003245591],[2478191531,4197739e3],[3233871270,250924495],[3404865229,1131917964],[1462204167,429621621],[1349259705,3641608989],[3627860584,2048468319],[1244251718,1513180369],[3979211282,371413143],[3043187861,4285699810],[581894202,3060983825],[1390895705,1811317301],[2599134010,3337406128],[2488233440,2436161462],[1816641224,2208816697],[1792034756,815866116],[2779893723,2695577703],[2084952115,2951772258],[1351806869,169269771],[2469979804,86740603],[1163545420,4264616949],[1795352113,2511146232],[1796715044,3134635815],[3521170642,1538900329],[3725363621,1455009392],[1342594643,1512127734],[2618386938,662157428],[2028859350,2494504685],[1841905045,648351336],[4002935891,4033319405],[850071259,1768358867],[979915719,3876018087],[830889197,1629549437],[1744763229,2455795856],[522919199,368499868],[3063822504,2522639205],[2861636095,407686388],[4097602344,1945259027],[4215946617,1251639506],[894485042,534122652],[924809191,1807237502],[1811585710,1589663609],[3439653887,1722232],[3810997538,105152714],[2677100683,4291805514],[77233985,102407776],[4239834691,2851274395],[148802076,2006440603],[2409138150,126301601],[3048474397,3217504870],[588133437,4221603123],[1139638106,263087485],[982032635,3165674595],[562514827,1294842959],[467575086,905357513],[1405117894,3370530088],[3813285157,242912619],[3601878331,1985076606],[1586505598,2092146221],[738488098,103663229],[2970334297,321718822],[1068097019,1742926233],[235518094,420804527],[283685722,4092504887],[2666392744,3799169331],[3569817788,1256762975],[2169728352,292617248],[2444571896,2239859206],[3967907832,1066404216],[420376911,2913277294],[3046293305,2956347747],[2311278792,2477686209],[2885955184,4172514290],[3030078181,2275536480],[4212469731,4280736393],[1046900335,1773022229],[995380926,1414273529],[3892683234,2429494358],[615726237,2127712535],[3880203074,2071130305],[176180504,3070850165],[1474506861,2283723599],[1256707747,1857412043],[764236850,359687368],[3521530334,511649419],[2318567964,3992868140],[128167623,2518992858],[2220129756,1042300052],[2567608573,1349636707],[441446694,384760969],[4143447316,829506048],[817912603,2738025500],[2368091832,357934982],[1187643061,1561463042],[3438021235,3030161697],[1318922279,895468690],[434876457,1130220303],[1180291767,1132759596],[2520707785,1798553137],[1962430872,2958700157],[1510954061,3534879512],[57831539,3269538993],[3354831405,3852135009],[891783098,2698494511],[2555636406,996018997],[2881342935,3982231648],[3473267445,2894952368],[1238029452,3958679326],[2051805420,559465638],[3655936674,1186951582],[330209165,167662935],[1929681327,2450868735],[1313566811,2458925988],[4283920930,3243182650],[1438004300,4185567150],[3093439067,89876832],[3401620219,3721579956],[3673745794,2682874719],[3053321309,825410712],[822915968,3681514755],[3900685126,561657358],[553823814,1857753416],[4166295066,983949325],[128359165,3426887194],[3300989119,3884968622],[4193552686,3647722552],[452189154,1569670618],[4122259632,3537825460],[2519387887,2821594244],[74333898,2940550377],[4032631446,2173999692],[2521268686,1934310532],[2620314688,2177785789],[1378755571,2455646622],[394133753,4231198609],[734399075,2800989170],[573292462,1634883078],[1214417373,3426576256],[2110224475,2399009920],[2331215665,3224086912],[531326186,698539511],[3839443603,583861850],[2644531398,2017784332],[616620850,3070237104],[590349237,2798642861],[3582377217,3317831670],[1582708616,1596570667],[2126148205,2358511947],[173450736,3219362418],[3616831144,1323437318],[2655785577,3131359031],[401600069,2967397952],[496349349,4244179910],[2479612086,2579650653],[1710903074,2049666425],[3589924952,690291925],[3266682943,1900485231],[1496318498,3025542656],[3459221058,3389461212],[2091479615,3140389256],[663040899,1207089672],[3323704225,1105530508],[353318429,2879253542],[2674540957,941987316],[1688550857,620657353],[338551967,4286217277],[204689992,2239736295],[178008789,3940832005],[3871613304,3300636974],[1911672356,2429684487],[4055679954,1974461722],[3878217928,1009991796],[2533095482,310920740],[2174833823,3596041637],[1604814460,2939543881],[1452830254,4092397851],[2441027029,4169690209],[3524103304,3372213855]],Pe=[[836181454,1689436944],[2776523577,3710710688],[4049974663,3750330768],[519497435,2979405513]],Ie=[[1892447193,197291556],[3793382197,3742120663],[3838936,2994760034],[479846099,1018728609],[3476112862,182272649],[3504620154,1427438450],[2009473484,2679350403],[1738755500,1129731339]],jt=[4174784170,2938602761],Xe={p:0,P:1,n:2,N:3,b:4,B:5,r:6,R:7,q:8,Q:9,k:10,K:11},it=[];it[5]=1,it[6]=0,it[9]=3,it[10]=2,it[17]=5,it[18]=4,it[33]=7,it[34]=6,it[65]=9,it[66]=8,it[129]=11,it[130]=10;var ln=[2,5,10,20,40,80,160,64],v="nbrq",C=["","0000000","000000","00000","0000","000","00","0",""],G=16;function ae(Hn){var Vt=Hn.toString(16);return C[Vt.length]+Vt}function je(Hn){return ae(Hn[0])+ae(Hn[1])}function Ve(Hn){return[parseInt(Hn.substr(0,8),16),parseInt(Hn.substr(8),16)]}function K(Hn,Vt){var et,Re,Xt=Hn.split(" "),un=Xt[0].split("/"),cr,or,ar,Nn,Er,Mr,vr,en,qt=Xt[1]==="w",Rn=0,$e,It,Ht=Number(qt),b=Ht?3:4;for(cr=7;cr>=0;cr-=1)for(or=0,ar=un[cr],Er=ar.length,Nn=0;Nn<Er;Nn+=1)Mr=ar[Nn],$e=Xe[Mr],$e>=0&&(vr=U[64*$e+8*(7-cr)+or],et=(et^vr[0])>>>0,Re=(Re^vr[1])>>>0,$e===Ht&&cr===b&&(Rn|=1<<or)),or+=Number(Mr)||1;return Xt[2]!=="-"&&(en=Xt[2],en.indexOf("K")>-1&&(vr=Pe[0],et=(et^vr[0])>>>0,Re=(Re^vr[1])>>>0),en.indexOf("Q")>-1&&(vr=Pe[2],et=(et^vr[0])>>>0,Re=(Re^vr[1])>>>0),en.indexOf("k")>-1&&(vr=Pe[1],et=(et^vr[0])>>>0,Re=(Re^vr[1])>>>0),en.indexOf("q")>-1&&(vr=Pe[3],et=(et^vr[0])>>>0,Re=(Re^vr[1])>>>0)),Xt[3]&&Xt[3]!=="-"&&(It=Xt[3].charCodeAt(0)-97,ln[It]&Rn&&(vr=Ie[It],et=(et^vr[0])>>>0,Re=(Re^vr[1])>>>0)),qt&&(et=(et^jt[0])>>>0,Re=(Re^jt[1])>>>0),Vt&&Vt==="hex"?je([et,Re]):[et,Re]}function Et(Hn,Vt){var et=new XMLHttpRequest,Re=Hn.toLowerCase().indexOf(".json")>-1;function Xt(){var un;if(et.status>=200&&et.status<300||et.status===304||et.status===0||et.status===1223)if(Re)try{Vt(null,JSON.parse(et.response))}catch(cr){Vt(cr)}else un=new DataView(et.response),Vt(null,un);else Vt(new Error("Error code: "+et.status))}et.open("GET",Hn,!0),Re||(et.responseType="arraybuffer"),et.onload=Xt,et.onerror=Xt,et.send()}function Gn(Hn){var Vt,et={},Re,Xt,un;function cr(en,qt){var Rn=Re.getUint16(en+8),$e=Re.getUint16(en+10),It,Ht,b,se,oe,fe;return Ht=Rn>>9&7,b=Rn>>6&7,se=Rn>>3&7,oe=Rn&7,fe=Rn>>12&7,b===4&&qt&&Ht===se&&qt!=="-"&&(oe===7&&(Ht===0&&qt.indexOf("K")>-1||Ht===7&&qt.indexOf("k")>-1)?oe-=1:oe===0&&(Ht===0&&qt.indexOf("Q")>-1||Ht===7&&qt.indexOf("q")>-1)&&(oe+=2)),It=String.fromCharCode(b+97)+(Ht+1)+String.fromCharCode(oe+97)+(se+1),fe&&(It+=v[fe-1]),{move:It,weight:$e}}function or(en){en.sort(function(Rn,$e){return $e.weight-Rn.weight})}function ar(en){return typeof en=="string"&&(en={fen:en}),Vt(en)}function Nn(en){var qt,Rn,$e,It,Ht,b=0;if(en=en||{},qt=en.moves||ar(en),or(qt),$e=qt.length,$e){if(!en.type||$e===1||en.type==="best")return qt[0].move;if(en.type==="random"){for(It=Math.floor(Math.random()*qt.sum)+1,Ht=0;Ht<$e-1&&(b+=qt[Ht].weight,!(It<=b));Ht+=1);return qt[Ht].move}else return en.type==="randomDisregardWeight"?qt[Math.floor(Math.random()*$e)].move:en.type==="worst"?qt[$e-1].move:(Rn=parseInt(en.type)||1,Rn<0&&(Rn=$e+Rn+1),Rn<1?Rn=1:Rn>$e&&(Rn=$e),qt[Rn-1].move)}}function Er(en){var qt=Re.length||Re.byteLength||0,Rn=en.offset||0,$e,It=en.fen,Ht=en.chess960,b=en.checkAll,se,oe=[],fe=0,Te,Ne,yn;for(en.hash?($e=en.hash,typeof $e=="string"&&($e=Ve($e))):$e=K(It),!Ht&&It&&(yn=It.split(" ")[2]),Rn=0;Rn<qt;Rn+=G)if(Re.getUint32(Rn)===$e[0]&&Re.getUint32(Rn+4)===$e[1])Te=cr(Rn,yn),oe[oe.length]=Te,fe+=Te.weight,se=!0;else if(se&&!b)break;if(oe.sum=fe,en.relative)for(Ne=oe.length-1;Ne>=0;Ne-=1)oe[Ne].relative=Math.round(oe[Ne].weight/fe*1e4);return oe}function Mr(en){var qt=[],Rn,$e=en.b.length;for(Rn=0;Rn<$e;++Rn)qt.push({move:en.b[Rn],weight:en.w[Rn]});return qt}function vr(en){var qt,Rn,$e=0,It,Ht,b,se=en.fen,oe;if(et.useFen)It=se.replace(/ \d+ \d+$/,""),qt=Xt[It],qt||(Ht=It.replace(/[a-h][1-8]$/,"-"),Ht!==It&&(qt=Xt[Ht]));else if(en.hash||(en.hash=K(se,"hex")),qt=Xt[en.hash],qt){if(qt[0]&&qt[0].n&&(qt=qt[0]),qt.n&&!qt.b)return[];if(qt.b)qt=Mr(qt);else if(!en.chess960&&se)for(oe=se.split(" ")[2],Rn=qt.length-1;Rn>=0;Rn-=1)b=qt[Rn].move.match(/e([18])([ah])\1/),b&&(b[2]==="h"&&(b[1]==="1"&&oe.indexOf("K")>-1||b[1]==="8"&&oe.indexOf("k")>-1)?qt[Rn]={move:"e"+b[1]+"g"+b[1],weight:qt[Rn].weight}:b[2]==="a"&&(b[1]==="1"&&oe.indexOf("Q")>-1||b[1]==="8"&&oe.indexOf("q")>-1)&&(qt[Rn]={move:"e"+b[1]+"c"+b[1],weight:qt[Rn].weight}))}if(qt)for(Rn=qt.length-1;Rn>=0;Rn-=1)$e+=Number(qt[Rn].weight);else qt=[];return qt.sum=$e,qt}if(et={query:ar,pick:Nn},Hn.getUint32)Vt=Er,Re=Hn,et.buffer=Re;else{Vt=vr,Xt=Hn,et.json=Xt;for(un in Xt){et.useFen=un.indexOf(" ")>-1;break}}return et}function ur(Hn,Vt){function et(Re,Xt){var un;if(Xt&&(un=Gn(Xt)),Vt)return Vt(Re,un);if(Re)throw Re;return un}Et(Hn,et)}var Pr=function(){var Hn={};return function(et,Re){if(Hn[et]){Hn[et].book?setTimeout(function(){Re(null,Hn[et].book)},0):Hn[et].cbs.push(Re);return}Hn[et]={cbs:[Re]},ur(et,function(un,cr){var or=Hn[et].cbs;un?delete Hn[et]:(Hn[et].book=cr,Hn[et].cbs=void 0),or.forEach(function(ar){setTimeout(function(){ar(un,cr)},0)})})}}();return{hash:K,loadBook:Pr,to64BitHex:je,zobristPiece:U,zobristCastle:Pe,zobristEnPassant:Ie,zobristTurn:jt,zobristPieceValue:Xe,zobristPieceValueNumbers:it}}();/*!
 * Chess.com (c) 2020
 *
 * A distant fork of chess.js - BSD (c) 2014, Jeff Hlywa (jhlywa@gmail.com)
 */var z=function(){var Pe={Chess:0,Chess960:1,Crazyhouse:2,"3-check":3,"King of the Hill":4,Bughouse:5,chess960:1,fischerandom:1,fischerrandom:1,fischer:1,chess9lx:1,960:1,crazyhouse:2,"three-check":3,threecheck:3,"3check":3,kingofthehill:4,koth:4,bughouse:5},Ie=["Chess","Chess960","Crazyhouse","3-check","King of the Hill","Bughouse"],jt={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Xe,it,ln,v,C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],G=0,ae=0,je=0,Ve=-1,K=1,Et=2,Gn=4,ur=8,Pr=16,Hn=32,Vt=64,et=128,Re=3,Xt=252,un=255,cr=256,or=512,ar=112,Nn=1,Er=2,Mr=4,vr=3,en=7,qt=14,Rn=21,$e=127,It="pnbrqkPNBRQK",Ht="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",b=[];b[5]=[-16,-17,-15],b[6]=[16,17,15],b[8]=[-18,-33,-31,-14,18,33,31,14],b[16]=[-17,-15,17,15],b[32]=[-16,1,16,-1],b[64]=[-17,-16,-15,1,17,16,15,-1],b[128]=[-17,-16,-15,1,17,16,15,-1];var se={P:5,p:6,N:9,n:10,B:17,b:18,R:33,r:34,Q:65,q:66,K:129,k:130},oe={P:4,p:4,N:8,n:8,B:16,b:16,R:32,r:32,Q:64,q:64,K:128,k:128},fe={5:"P",6:"p",9:"N",10:"n",17:"B",18:"b",33:"R",34:"r",65:"Q",66:"q",129:"K",130:"k"},Te={9:"N",10:"N",17:"B",18:"B",33:"R",34:"R",65:"Q",66:"Q",129:"K",130:"K"},Ne=[80,0,0,0,0,0,0,96,0,0,0,0,0,0,80,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,96,96,96,96,96,96,224,0,224,96,96,96,96,96,96,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,80,0,0,0,0,0,0,96,0,0,0,0,0,0,80],yn=[336,80,80,0,0,0,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,360,508,252,0,252,508,360,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,0,0,0,80,80,336],F=[336,80,80,0,0,0,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,360,508,252,0,252,508,488,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,96,0,0,80,80,336],he=[336,80,80,0,0,96,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,488,508,252,0,252,508,360,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,0,0,0,80,80,336],we=[336,80,80,0,0,96,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,488,508,252,0,252,508,488,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,96,0,0,80,80,336],Oe=[336,80,80,112,112,112,96,352,96,96,112,112,112,80,336,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,352,352,480,480,488,508,252,0,252,508,488,480,480,480,352,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,336,80,80,112,112,112,96,352,96,96,112,112,112,80,336],y=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,33,16,31,15,0,0,0,0,0,0,0,0,0,0,0,18,17,16,15,14,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,-14,-15,-16,-17,-18,0,0,0,0,0,0,0,0,0,0,0,-15,-31,-16,-33,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],T=[0,5,8,11,14],x=[31,7,7,7,63],H={P:0,p:0,N:5,n:5,B:8,b:8,R:11,r:11,Q:14,q:14},O=[Gn,ur,Pr,Hn,Vt],X=["","N","B","R","Q"],Z={CAPTURE:1,BIG_PAWN:2,EP_CAPTURE:4,ANY_CAPTURE:5,PROMOTION:8,KSIDE_CASTLE:16,QSIDE_CASTLE:32,KQSIDE_CASTLE:48,DROP:64,DROP_OR_PROMOTE:72},_t=[0,6,1],nt={K:119,Q:112,k:7,q:0,A:112,B:113,C:114,D:115,E:116,F:117,G:118,H:119,a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},Ue=["Event","Site","Date","Round","White","Black","Result"],j=["Event","Site","Date","Round","White","Black","Result","Variant","SetUp","FEN","WhiteA","WhiteB","BlackA","BlackB"];function qe(dn){return dn>>4}function Qt(dn){return dn&7}function Fn(dn){return String.fromCharCode(Qt(dn)+97)+(8-qe(dn))}function Vn(dn){return 3-dn}function Un(dn,$n){dn[0]=(dn[0]^$n[0])>>>0,dn[1]=(dn[1]^$n[1])>>>0}function an(dn,$n,st){return $n<1?dn:($n=typeof $n=="number"?$n:80,dn.replace(new RegExp("(.{1,"+$n+`})(?: |$|\r?
)`,"g"),"$1"+st).slice(0,-st.length))}function gs(dn){var $n,st;return dn=dn.trim(),st=dn.split(" "),$n=[""," w - - 0 1"," - - 0 1"," - 0 1"," 0 1"," 1"][st.length],$n&&dn?dn+=$n:st[5]==="0"&&(st[5]=1,dn=st.join(" ")),dn}function na(dn){var $n=Math.floor(dn%36e3/600),st=Math.floor(dn%36e3%600)/10;return Math.floor(dn/36e3)+":"+($n<10?"0":"")+$n+":"+(st<10?"0":"")+st}function Qs(dn){var $n=dn.split(":");return($n[0]*3600+$n[1]*60+$n[2]*1)*10}function _s(){W.zobristCheck=[[441249556,340005552],[1040760204,311043682],[1621584863,1749286446],[1006868636,1625552915],[1953853171,24921145],[161251506,1935545265]]}function Js(dn,$n){var st=dn.length,Ee,Rt=0,rn=0,sn=$n&&($n===Pe.Crazyhouse||$n===Pe.Bughouse),Ot;for(Ee=0;Ee<st;++Ee)if(Ot=dn[Ee],+Ot!=+Ot)if(Ot==="/"){if(rn!==8&&(dn=dn.substr(0,Ee)+(8-rn)+dn.substr(Ee),++Ee,++st),rn=0,++Rt>7){if(!sn&&Ee<st-1||!/^[pnbrq]{0,63}$/i.test(dn.substr(Ee+1)))return!1;break}}else if(se[Ot]){if(++rn>8)return!1}else if(Ot==="~")(!sn||!Ee||!/[nbrq]/i.test(dn[Ee-1]))&&(dn=dn.substr(0,Ee)+dn.substr(Ee+1),--Ee,--st);else return!1;else rn+=Ot*1,rn>8&&(dn=dn.substr(0,Ee)+(Ot-(rn-8))+dn.substr(Ee+1),rn=8);return dn}function ja(dn,$n){var st,Ee,Rt,rn=/^(?:[A-H]{1,2}[a-h]{0,2}|[A-H]{0,2}[a-h]{1,2}|KQ?k?q?|Qk?q?|kq?|q|-)$/,sn=Pe[$n]||$n*1||Pe[String($n).replace(/\s/g,"").toLowerCase()],Ot=sn===Pe.Crazyhouse||sn===Pe.Bughouse,Nt,_n,Cn,Nr=0,En=0,Mt,Ar=!0,kn="",Wn={0:0,7:0},St={0:0,7:0},qr={0:"k",7:"K"},Gr={0:"r",7:"R"},ui,di,Ki=sn===Pe.Chess960,Br,bi,oo,Ai,Qr,fi,$i,ya,Zi,Si,ao;if(!dn)return 1;if(sn===Pe.Bughouse&&(_n=dn.split(" | "),_n.length===2))return Cn=ja(_n[0],$n),Cn===0&&(Cn=ja(_n[1],$n)),Cn;if(_n=dn.split(/\s+/),sn===Pe["3-check"]&&_n.length===7&&(Nt=_n.pop(),!/^\+[0-3]\+[0-3]$/.test(Nt)||Nt==="+3+3"))return 14;if(_n.length!==6)return 1;if(/\D|.{7,}|^0|^$/.test(_n[5]))return 2;if(/\D|.{7,}|^0.|^$/.test(_n[4]))return 3;if(!/^(?:-|[abcdefgh][36])$/.test(_n[3]))return 4;if(Br=_n[2],Ki){if(!rn.test(Br))return 12}else if(!/^(?:KQ?k?q?|Qk?q?|kq?|q|-)$/.test(Br)){if(typeof $n<"u"||!rn.test(Br))return 5;Ki=!0}if(_n[1]!=="w"&&_n[1]!=="b")return 6;if(Ot&&(_n[0]=_n[0].replace(/~(?=.*\/)/g,"")),Ee=_n[0].split("/"),Ot&&Ee.length===9&&(Nt=Ee.pop(),!/^[pnbrq]{0,63}$/i.test(Nt)))return 13;if(Ee.length!==8)return 7;if(_n[3][1]==="3"&&_n[1]==="w"||_n[3][1]==="6"&&_n[1]==="b")return 11;for(_n[3]!=="-"&&(En=_n[3][1]==="3"?4:3,Mt=En===4?5:2,Nr=_n[3].charCodeAt(0)-97,Ar=!1,kn=En===4?"P":"p"),st=0;st<Ee.length;++st){for(Zi=0,Si=!1,ao=0;ao<Ee[st].length;ao++)if(Rt=Ee[st][ao],+Rt==+Rt){if(Si)return 8;Zi+=Rt*1,Si=!0}else{if(It.indexOf(Rt)===-1)return 9;if(!Ar&&En===st&&Nr===Zi&&kn===Rt&&(Ar=!0),Mt===st&&Nr===Zi)return 11;st%7===0&&(Rt===qr[st]?St[st]=1<<Zi:Rt===Gr[st]&&(Wn[st]|=1<<Zi)),++Zi,Si=!1}if(Zi!==8)return 10}if(!Ar)return 11;if(Br!=="-"){if(Ki){for(oo={0:0,1:0,2:252,4:248,8:240,16:224,32:192,64:128,128:0},bi={0:0,1:0,2:1,4:3,8:7,16:15,32:31,64:63,128:0},ya={0:[0,0],7:[0,0]},st=Br.length-1;st>=0;--st)if(fi=Br.charCodeAt(st),$i&&$i>fi&&$i-fi<8||(fi===75?(Qr=7,Ai=Wn[Qr]&oo[St[Qr]]):fi===81?(Qr=7,Ai=Wn[Qr]&bi[St[Qr]]):fi===107?(Qr=0,Ai=Wn[Qr]&oo[St[Qr]]):fi===113?(Qr=0,Ai=Wn[Qr]&bi[St[Qr]]):(Qr=fi>=97?0:7,Ai=1<<fi-(Qr?65:97),$i=fi),!Ai||Ai&Ai-1)||St[Qr]<2||St[Qr]>64||(Ai&Wn[Qr])!==Ai||++ya[Qr][(St[Qr]<Ai)*1]>1)return 15}else if(ui=(Br.indexOf("K")>-1?128:0)|(Br.indexOf("Q")>-1?1:0),ui&&(St[7]!==16||(ui&Wn[7])!==ui)||(di=(Br.indexOf("k")>-1?128:0)|(Br.indexOf("q")>-1?1:0),di&&(St[0]!==16||(di&Wn[0])!==di)))return 15}return 0}function _a(dn,$n){var st="",Ee=0,Rt,rn,sn=$n?6:0;if(dn)for(;Ee<5;){for(Rt=dn>>T[Ee]&x[Ee],rn=0;rn<Rt;++rn)st+=It[Ee+sn];++Ee}return st}function el(dn,$n){$n[K]&&Un(dn,W.zobristCheck[$n[K]-1]),$n[Et]&&Un(dn,W.zobristCheck[$n[Et]+2])}function tl(dn,$n){var st,Ee,Rt,rn,sn=0,Ot,Nt,_n;for(st=1;st<3;++st){if(Ee=$n[st],Ee)for(Rt=0;Rt<5;){for(Ot=sn+Rt*63,rn=Ee>>T[Rt]&x[Rt],Nt=0;Nt<rn;++Nt)_n=W.zobristPiece[Ot++],Un(dn,[_n[0]*31>>>0,_n[1]*17>>>0]);++Rt}sn=315}}function ba(dn,$n,st,Ee){(dn[st+1]===Ee||dn[st-1]===Ee)&&Un($n,W.zobristEnPassant[Qt(st)])}function bs(dn,$n){var st=[],Ee,Rt;for(Ee=0;Ee<120;++Ee)if(Ee&136&&(Ee+=8),Rt=dn[Ee],Rt&&(Rt&$n)===$n){st.push(Ee);continue}return st}function qa(dn,$n,st,Ee){var Rt;(it===0||dn[st+8]&Er)&&(qe(st)%7===0?(Rt=Ee|Z.PROMOTION|$n<<en|st<<qt,C[ae++]=Rt|4<<Rn,C[ae++]=Rt|3<<Rn,C[ae++]=Rt|2<<Rn,C[ae++]=Rt|1<<Rn):C[ae++]=Ee|$n<<en|st<<qt)}function ys(dn){switch(dn){case 67:case 68:case 51:case 52:return!0}return!1}function nl(dn,$n,st,Ee){var Rt=$n+(st-$n%8),rn=st>$n%8?1:-1,sn,Ot,Nt;for(Nt=$n+rn;Nt!==Rt;Nt+=rn)if(dn[Nt])return!1;if(Ee===K?sn=rn===1?118:114:sn=rn===1?6:2,Ot=sn-rn,dn[sn+8]||dn[sn]&&sn!==$n&&sn!==Rt||dn[Ot]&&Ot!==$n&&Ot!==Rt)return!1;if(sn!==$n){for(rn=sn>$n?1:-1,Nt=$n+rn;Nt!==sn;Nt+=rn)if(Nt!==Rt&&dn[Nt]||dn[Nt+8])return!1}return!0}var rl=function(){function dn(Ee,Rt,rn,sn,Ot,Nt,_n){var Cn=[],Nr="",En=!0,Mt,Ar,kn,Wn,St,qr,Gr=Rt[rn],ui=Gr.length,di,Ki,Br="";if(Gr.commands)for(Wn in Gr.commands)(!Nt||Nt.indexOf(Wn)>-1)&&(Br+="[%"+Wn+" "+Gr.commands[Wn]+"]");for(Gr.initComment&&!_n&&(Br=(Br+" "+Gr.initComment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),Br&&Cn.push("{"+Br+"}"),Ar=0;Ar<ui;++Ar){if(Mt=Gr[Ar],qr=Mt.color===K,Nr="",Br="",sn!==Pe.Bughouse?(En&&!qr?Nr=Ee+"...":qr&&(Nr=Ee+"."),Ot&&(qr||En)&&(Nr+=" ")):(Cn.bughouseOrder||(Cn.bughouseOrder=[]),Cn.bughouseOrder.push(Mt.bughouseOrder),Ar||(Cn.blackCountOffset=Gr[0].color===Et?1:0)),Nr+=Mt.san,Mt.annotation&&(Nr+=Mt.annotation),Mt.additionalAnnotation&&(Nr+=" "+Mt.additionalAnnotation.join(" ")),En=!1,typeof Mt.time<"u"&&!Mt.commands&&(Mt.commands={clk:na(Mt.time)}),Mt.commands)for(Wn in Mt.commands)(!Nt||Nt.indexOf(Wn)>-1)&&(Br+="[%"+Wn+" "+Mt.commands[Wn]+"]");if(Mt.comment&&!_n&&(Br=(Br+" "+Mt.comment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),Br&&(Nr+=" {"+Br+"}",En=!0),Cn.push(Nr),Mt.lines)for(di=Mt.lines.length,kn=0;kn<di;++kn)Ki=Mt.lines[kn],Rt[Ki].length&&(St=dn(Ee,Rt,Ki,sn,Ot,Nt,_n),St[0]="("+St[0],St[St.length-1]+=")",Cn=Cn.concat(St),En=!0);qr||Ee++}return Cn}function $n(Ee,Rt,rn){var sn=Rt,Ot=Ee.siblingGame.pgn(),Nt=0,_n=0,Cn=[];for(Rt.bughouseOrder=Rt.bughouseOrder||[],Ot.bughouseOrder=Ot.bughouseOrder||[];Rt.bughouseOrder.length||Ot.bughouseOrder.length;)!Rt.bughouseOrder.length||Ot.bughouseOrder.length&&Rt.bughouseOrder[0]>Ot.bughouseOrder[0]?(Ot.bughouseOrder.shift(),Cn.push("B")):(Rt.bughouseOrder.shift(),Cn.push("A"));return Rt=[],Cn.forEach(function(Nr){var En,Mt,Ar="",kn;Nr==="A"?(En=sn,++Nt,Mt=Nt,kn=Ee.startingMoveNumber()):(En=Ot,++_n,Mt=_n,kn=Ee.siblingGame.startingMoveNumber()),Ar=String(Math.floor((Mt+1)/2)+kn-1),(En.blackCountOffset+Mt)%2?Ar+=Nr:Ar+=Nr.toLowerCase(),Ar+="."+(rn?" ":"")+En.shift(),Rt.push(Ar)}),Rt}function st(Ee,Rt){return"["+Ee+' "'+String(Rt).replace(/(\"|\\)/g,"\\$1")+'"]'}return function(Rt,rn,sn,Ot,Nt,_n){var Cn=typeof Rt.newline=="string"?Rt.newline:`
`,Nr=typeof Rt.spaceAfterPeriods>"u"?!0:Rt.spaceAfterPeriods,En="",Mt,Ar;En+=st("Event",rn.Event)+Cn,En+=st("Site",rn.Site)+Cn,En+=st("Date",rn.Date)+Cn,En+=st("Round",rn.Round)+Cn,Nt===Pe.Bughouse?(En+=st("WhiteA",rn.WhiteA||"?")+Cn,En+=st("BlackA",rn.BlackA||"?")+Cn,En+=st("WhiteB",rn.WhiteB||"?")+Cn,En+=st("BlackB",rn.BlackB||"?")+Cn):(En+=st("White",rn.White)+Cn,En+=st("Black",rn.Black)+Cn),En+=st("Result",rn.Result)+Cn,Nt&&(En+=st("Variant",rn.Variant)+Cn),rn.FEN&&rn.FEN!==Ht&&(En+=st("SetUp","1")+Cn,En+=st("FEN",rn.FEN)+Cn);for(Mt in rn)j.indexOf(Mt)===-1&&(En+=st(Mt,rn[Mt])+Cn);if(En+=Cn,Ar=dn(Ot,sn,0,Nt,Nr,Rt.hideCommands?[]:Rt.restrictCommands,Rt.hideComments),Nt===Pe.Bughouse){if(_n.isDependent)return Ar;Ar=$n(_n,Ar,Nr)}return Ar.push(rn.Result),En+an(Ar.join(" "),Rt.maxWidth,Cn)}}(),il=function(){var dn="!?\u203C\u2047\u2049\u2048\u25A1\u2207\u0394\u221E\u2A72\u2A71\xB1\u2213\u2A00\u27F3\u2192\u2191\u21C6\u2206\u2313\u21D4\u21D7\u27EB\u27EA\u2715\u22A5\u2295\u25CB\u21C4\u21BB\u2299\u2612~",$n=/\[%(\S+)\s([^\]]+)\]/,st=/^(?:[+=~\/\-\u2212]+|T?N|RR|D)$/;function Ee(rn){for(var sn,Ot=rn.commands||{};sn=$n.exec(rn.value);)rn.value=rn.value.replace(sn[0],"").trim(),Ot[sn[1]]=sn[2],rn.commands=Ot}function Rt(rn,sn,Ot,Nt){for(var _n;++sn<Ot;)if((_n=rn[sn].trim())&&_n[0]!=="%")return _n[0]==="["&&(!Nt||/^\[\S+\s+".*"\]$/.test(_n))}return function(sn,Ot){var Nt,_n,Cn,Nr,En="tags",Mt,Ar,kn,Wn=[],St={type:En,value:""},qr=0,Gr=[],ui=!0;Ot=Ot||{},Nt=sn.split(/\r?\n/),Nr=Nt.length;e:for(_n=0;_n<Nr;++_n)if(Cn=Nt[_n].trim(),Cn[0]!=="%")if(!Cn)Wn.length&&(En==="tags"?(En="san",ui=!1):En!=="tagValueStart"&&Rt(Nt,_n,Nr,qr||En==="comment")&&(En==="comment"&&Wn.push(St),Wn[Wn.length-1].type!=="tagValue"&&(Gr.push(Wn),Wn=[]),En="tags",ui=!0,qr=0));else{if(Cn=" "+Cn+" ",Ar=Cn.length,Mt=0,ui)for(;Mt<Ar;++Mt)if(kn=Cn[Mt],En==="tags"){if(kn==="[")En="tagName",St={type:En,value:""};else if(kn.trim()){En="san",St={type:En,value:""},ui=!1;break}}else if(En==="tagName")St.value&&kn.trim()===""?(Wn.push(St),En="tagValueStart"):kn!==" "&&(St.value+=kn);else if(En==="tagValueStart"){if(kn==='"'||kn==="\u201C")En="tagValue",St={type:En,value:""};else if(kn.trim()){Wn.push({type:"tagValue",value:Cn.slice(Mt,-1).match(/(.*?)"?\]?$/)[1]}),En="tags",St={type:En,value:""};continue e}}else if(En==="tagValue")if(kn==='"'||kn==="\u201D")if(Wn.push(St),Cn[Mt+1]==="]")En="tags",St={type:En,value:""},++Mt;else if(Cn.slice(-2,-1)==="]"){St.value+=Cn.substr(Mt).match(/(.*?)"?\s*\] $/)[1],En="tags",St={type:En,value:""};continue e}else En="tagEnd";else kn==="\\"&&Mt+2<Ar&&(++Mt,kn=Cn[Mt]),Mt>0&&(St.value+=kn);else{if(kn!=="]"){if(!kn.trim())continue;--Mt}En="tags",St={type:En,value:""}}for(;Mt<Ar;++Mt)if(kn=Cn[Mt],En==="san"){if(dn.indexOf(kn)>-1)kn==="!"||kn==="?"||dn.indexOf(kn)<6&&(kn=["!!","??","!?","?!"][dn.indexOf(kn)-2])?(St.value&&Wn.push(St),St={type:"a",value:kn},(Cn[Mt+1]==="!"||Cn[Mt+1]==="?")&&(St.value+=Cn[++Mt]),Wn.push(St),St={type:"san",value:""}):(kn==="\u221E"&&St.value==="=/"?(St.type="aa",St.value+=kn):(St.value&&(st.test(St.value)&&(St.value!=="--"||Ot.rejectNullMoves)&&(St.type="aa"),Wn.push(St)),St={type:"aa",value:kn},kn==="\u2191"&&Cn[Mt+1]==="\u2191"&&(St.value="\u21BB",++Mt)),Wn.push(St),St={type:"san",value:""});else if(kn===" "||kn==="	"||kn==="\r"||kn==="{"||kn==="("||kn===")"){if(St.value){if(St.value[0]==="$")St.type="nag";else if(St.value==="*"||St.value==="1-0"||St.value==="0-1"||St.value==="1/2-1/2"||St.value==="\xBD-\xBD")if(qr||Mt+1<Ar)St.type=St.value==="*"?"cont":"comment";else{if(St.type="result",St.value==="\xBD-\xBD"&&(St.value="1/2-1/2"),Wn.push(St),Gr.push(Wn),_n+1===Nr||_n+2===Nr&&!Nt[_n+1])return Gr;En="tags",ui=!0,St={type:En,value:""},Wn=[];break}st.test(St.value)&&(St.value!=="--"||Ot.rejectNullMoves)&&(St.type="aa"),Wn.push(St),St={type:En,value:""}}if(kn===" "||kn==="	"||kn==="\r")En="san";else if(kn==="{")En="comment",Wn.length&&Wn[Wn.length-1].type==="comment"&&(St=Wn.pop(),St.value+=" ");else if(kn==="(")En="san",Wn.push({type:"variationStart",value:++qr});else{if(qr<1){if(!Ot.commentErrors)return!1}else Wn.push({type:"variationEnd",value:qr--});En="san"}St.type=En}else if(kn!=="."&&(St.value||+kn!=+kn||Cn[Mt+1]==="-"||Cn[Mt+1]==="/"))St.value+=kn;else if(+kn==+kn)switch(St.number||(St.number=""),St.number+=kn,Cn[Mt+1]){case"A":case"a":case"B":case"b":St.number+=Cn[++Mt],Wn.push({type:"number",value:St.number}),delete St.number}}else Mt===0&&(St.value=St.value.trim()),kn!=="}"?(kn==="\\"&&Mt+2<Ar&&(kn=Cn[++Mt]),St.value+=kn):(St.value=St.value.trim(),St.value.indexOf("[")>-1&&Ee(St),Wn.push(St),En="san",St={type:En,value:""})}return St.value&&Wn.push(St),(Wn.length||!Gr.length)&&Gr.push(Wn),Gr}}();function Wa(dn,$n){var st,Ee,Rt=0,rn=!0,sn=[],Ot=K,Nt=[],_n=Ve,Cn=0,Nr=1,En=1,Mt=[],Ar=[Mt],kn=0;Mt.id=kn;var Wn={},St=[],qr=!1,Gr=!1,ui=Xa,di=function(N,J){var B="",ce,ee,le,rt,Lt,ut;return N&Z.KQSIDE_CASTLE?N&Z.KSIDE_CASTLE?B="O-O":B="O-O-O":N&Z.DROP?(le=N>>qt&$e,ce=N>>Rn,ce&&(B+=X[ce]),B+="@"+Fn(le)):(le=N>>qt&$e,ee=N>>en&$e,rt=Ee[ee],rt&Gn?(N&Z.ANY_CAPTURE&&(B+=String.fromCharCode(Qt(ee)+97)+"x"),B+=Fn(le),N&Z.PROMOTION&&(ce=N>>Rn,B+="="+X[ce])):(B+=Te[rt&un],je>1&&(B+=ll(rt,ee,le)),N&Z.ANY_CAPTURE&&(B+="x"),B+=Fn(le))),J||(N&Z.KQSIDE_CASTLE?(ee=N>>en&$e,le=N>>qt&$e):N&Z.DROP_OR_PROMOTE&&(rt=O[ce]+Ot),Es(rt,ee,le,N)&&(ui(N,ee,le,ce),Lt=G,G=ae,ut=je,Rt&&bo()||Ri()===G?B+="#":B+="+",ae=G,G=Lt,je=ut,Go(Mt.pop()))),B};function Ki(){var N=Ot===K?[4174784170,2938602761]:[0,0],J,B,ce;for(ce=0;ce<120;++ce)ce&136&&(ce+=8),J=Ee[ce],J&&Un(N,W.zobristPiece[64*W.zobristPieceValueNumbers[J&un]+8*(7-qe(ce))+Qt(ce)]);if(Gr)for(B=1;B<3;++B)Nt[B]&&(Nt[B]&Nt[B]-1?(Un(N,W.zobristCastle[B-1]),Un(N,W.zobristCastle[B+1])):Nt[B]>1<<Qt(sn[B])?Un(N,W.zobristCastle[B-1]):Un(N,W.zobristCastle[B+1]));else{for(B=1;B<3;++B)Nt[B]&&(Nt[B]&Z.KSIDE_CASTLE&&Un(N,W.zobristCastle[B-1]),Nt[B]&Z.QSIDE_CASTLE&&Un(N,W.zobristCastle[B+1]));qr?tl(N,st._hand):Rt===Pe["3-check"]&&el(N,St)}return _n!==Ve&&ba(Ee,N,_n+(Ot===K?16:-16),Gn|Ot),N}function Br(){var N;return Mt.length?N=Mt[Mt.length-1].hash:(Mt.hash||(Mt.hash=Ki()),N=Mt.hash),[N[0],N[1]]}function bi(N){function J(ce){return/#/.test(ce)&&As()&&(ce=ce.replace("#","+")),ce}function B(ce,ee){var le=N(ce,ee);return le&&(typeof le=="string"?le=J(le):(le.san=J(le.san),Mt[Mt.length-1].san=le.san)),le}return B._isBughouseified=!0,B._orig=N,B}function oo(N,J){var B=Rt;N?Rt=Pe[N]||N*1||Pe[String(N).replace(/\s/g,"").toLowerCase()]||Pe.Chess:Rt=0,B!==Rt&&(Rt===Pe.Bughouse?(qr=!0,st.isDependent||(st.siblingGame=Wa(),st.siblingGame.hashing(rn),st.siblingGame.isDependent=!0,st.siblingGame.siblingGame=st,st.siblingGame.header({Variant:"Bughouse"})),_s(),ui=Yi,di=bi(di),st.move=bi(st.move)):(delete st.siblingGame,qr=Rt===Pe.Crazyhouse,Gr=Rt===Pe.Chess960,Rt?(_s(),ui=Yi):ui=Xa,di._isBughouseified&&(di=di._orig,st.move=st.move._orig)),J||Ea(Si()))}function Ai(N,J){for(var B=N>7?K:Et,ce,ee;!(N&136);){if(ce=Ee[N],ce&B){if(ce&Hn){if(ee)return;ee=N%8+(B===K?65:97)}else if(ce&et)return ee}N+=J}}function Qr(N,J,B){Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ot=K,sn[K]=Ve,sn[Et]=Ve,Nt[K]=0,Nt[Et]=0,st._hand[K]=0,st._hand[Et]=0,St[K]=0,St[Et]=0,_n=Ve,Cn=0,Nr=1,J||(Mt=[],Ar=[Mt],kn=0,Mt.id=kn,Wn={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},N?ao(["Variant",N]):oo(!1,B),B||Ea(Si()))}function fi(){Qr(0,!1,!0),Mt.hash=[1178310168,378666140],Ee=[34,10,18,66,130,18,10,34,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,33,9,17,65,129,17,9,33,0,0,0,0,0,0,0,0],En=1,sn[K]=116,sn[Et]=4,Nt[K]=48,Nt[Et]=48}function $i(N,J,B,ce){var ee=0,le,rt,Lt,ut,ze,xn,Yn,lr,pt,Lr,ct,hn;if(ce?(le=N.split(" "),hn=le[3],ct=le[2]):(le=N.trim().split(/\s+/),hn=le[3]||"-",ct=le[2]||"-"),typeof J>"u"?(ct.charCodeAt(0)&31)<9&&oo(Pe.Chess960,!0):oo(J,!0),rt=le[0],!ce&&!(rt=Js(rt,Rt)))return!1;if(ut=rt.length,Qr(Ie[Rt],B,!0),qr){if(Rt===Pe.Bughouse&&!st.isDependent&&(xn=N.split(" | "),!st.siblingGame.load(xn.length===1?N:xn[1],J,B,ce)))return fi(),!1;for(ze=0;ze<ut;++ze)if(Yn=rt[ze],+Yn!=+Yn)if(Yn==="/")if(ee>111){for(++ze;ze<ut;++ze)Yn=rt[ze],st._hand[Yn<"a"?K:Et]+=1<<H[Yn]>>>0;break}else ee+=8;else Ee[ee]=se[Yn],rt[ze+1]==="~"&&(++ze,Ee[ee]|=or),Ee[ee]&et&&(sn[Ee[ee]&Re]=ee),++ee;else ee+=Yn*1}else for(ze=0;ze<ut;++ze)Yn=rt[ze],+Yn!=+Yn?Yn==="/"?ee+=8:(Ee[ee]=se[Yn],Ee[ee]&et&&(sn[Ee[ee]&Re]=ee),++ee):ee+=Yn*1;if(Ot=le[1]==="b"?Et:K,ct!=="-")if(Gr){for(pt={1:[0,0],2:[0,0]},ze=ct.length-1;ze>=0;--ze)Lt=ct.charCodeAt(ze),Lt===75?Lt=Ai(119,-1):Lt===81?Lt=Ai(112,1):Lt===107?Lt=Ai(7,-1):Lt===113&&(Lt=Ai(0,1)),lr=Lt<97?K:Et,Lr=nt[String.fromCharCode(Lt)],(ce||Ee[Lr]===(Hn|lr))&&(Lt>=97?sn[lr]>=1&&sn[lr]<=6&&(Nt[lr]|=1<<Lr):sn[lr]>=113&&sn[lr]<=118&&(Nt[lr]|=1<<Lr-112),++pt[lr][(sn[lr]<Lr)*1]);(pt[K][0]>1||pt[K][1]>1)&&(Nt[K]=0),(pt[Et][0]>1||pt[Et][1]>1)&&(Nt[Et]=0)}else{if(!ce)for(ze=ct.length-1;ze>=0;--ze)lr=ct.charCodeAt(ze)<97?K:Et,(Ee[nt[ct[ze]]]!==(Hn|lr)||sn[lr]!==(lr===K?116:4))&&(ct=ct.substr(0,ze)+ct.substr(ze+1));for(ze=ct.length-1;ze>=0;--ze)switch(ct[ze]){case"K":Nt[K]|=Z.KSIDE_CASTLE;break;case"Q":Nt[K]|=Z.QSIDE_CASTLE;break;case"k":Nt[Et]|=Z.KSIDE_CASTLE;break;case"q":Nt[Et]|=Z.QSIDE_CASTLE;break}}return!ce&&(hn.length!==2||Ot===K&&hn[1]!=="6"||Ot===Et&&hn[1]!=="3"||Ee[hn.charCodeAt(0)-97+(8-(hn[1]==="3"?4:5))*16]!==(Gn|Vn(Ot))||Ee[jt[hn]])&&(hn="-"),_n=hn==="-"?Ve:jt[hn],Cn=le[4]*1||0,Nr=le[5]*1||1,Rt===Pe["3-check"]&&(le[6]&&le[6]!=="+3+3"&&(xn=le[6].match(/^\+([0-3])\+([0-3])$/)),xn=xn||[0,0,0],St[K]=xn[1]*1,St[Et]=xn[2]*1),B||(En=Nr,Ea(Si())),!0}function ya(){var N=0,J="",B,ce="",ee;for(B=0;B<120;++B)B&136&&(N&&(J+=N),J+="/",N=0,B+=8),ee=Ee[B],ee?(N&&(J+=N,N=0),J+=fe[ee&un]):++N;return N&&(J+=N),Nt[K]&Z.KSIDE_CASTLE&&(ce+="K"),Nt[K]&Z.QSIDE_CASTLE&&(ce+="Q"),Nt[Et]&Z.KSIDE_CASTLE&&(ce+="k"),Nt[Et]&Z.QSIDE_CASTLE&&(ce+="q"),J+=" "+(Ot===K?"w":"b")+" "+(ce||"-")+" "+(_n===Ve?"-":Fn(_n))+" "+Cn+" "+Nr,J}function Zi(){var N=0,J="",B,ce,ee="",le;for(B=0;B<120;++B)B&136&&(N&&(J+=N),J+="/",N=0,B+=8),le=Ee[B],le?(N&&(J+=N,N=0),J+=fe[le&un],qr&&le&or&&(J+="~")):++N;if(N&&(J+=N),qr&&(J+="/"+_a(st._hand[K],!0)+_a(st._hand[Et])),Gr){for(ce=Nt[Et],B=0;ce;)ce&1&&(ee=String.fromCharCode(B+97)+ee),ce>>=1,++B;for(ce=Nt[K],B=0;ce;)ce&1&&(ee=String.fromCharCode(B+65)+ee),ce>>=1,++B}else Nt[K]&Z.KSIDE_CASTLE&&(ee+="K"),Nt[K]&Z.QSIDE_CASTLE&&(ee+="Q"),Nt[Et]&Z.KSIDE_CASTLE&&(ee+="k"),Nt[Et]&Z.QSIDE_CASTLE&&(ee+="q");return J+=" "+(Ot===K?"w":"b")+" "+(ee||"-")+" "+(_n===Ve?"-":Fn(_n))+" "+Cn+" "+Nr,Rt===Pe["3-check"]?J+=" +"+St[K]+"+"+St[Et]:Rt===Pe.Bughouse&&!st.isDependent&&(J+=" | "+st.siblingGame.fen()),J}function Si(){return Rt?Zi():ya()}function ao(N){var J,B,ce;for(J=0;J<N.length;J+=2)B=N[J],ce=N[J+1],B&&(B==="Variant"&&(oo(ce),Rt?ce=Ie[Rt]:ce=void 0),B==="Result"&&ce!=="*"&&ce!=="1-0"&&ce!=="0-1"&&ce!=="1/2-1/2"&&(ce="*"),ce!==void 0?Wn[B]=String(ce):Ue.indexOf(B)>-1?B==="Date"?Wn[B]="????.??.??":Wn[B]="?":delete Wn[B]);return Wn}function Ea(N){Mt.length>0||kn||(N!==Ht?(Wn.SetUp="1",Wn.FEN=N,Mt.hash=null):(delete Wn.SetUp,delete Wn.FEN,Mt.hash=[1178310168,378666140]))}function Wr(N){var J=Ee[jt[N]];return J?{type:fe[J&Xt|Et],color:J&Re,promoted:(J&or)!==0}:null}function ol(N,J){return Gr&&Nt[N]?Oe:Nt[N]&Z.KSIDE_CASTLE&&!Ee[J+1]&&!Ee[J+2]?Nt[N]&Z.QSIDE_CASTLE&&!Ee[J-1]&&!Ee[J-2]&&!Ee[J-3]?(v=Z.KQSIDE_CASTLE,we):(v=Z.KSIDE_CASTLE,F):Nt[N]&Z.QSIDE_CASTLE&&!Ee[J-1]&&!Ee[J-2]&&!Ee[J-3]?(v=Z.QSIDE_CASTLE,he):yn}function Ka(N,J){var B,ce,ee,le=Ot,rt,Lt,ut,ze,xn,Yn,lr,pt,Lr,ct,hn=Ee;if(Xe=[],it=0,ln=0,v=0,hn[8]=hn[9]=hn[10]=hn[11]=hn[12]=hn[13]=hn[14]=hn[15]=hn[24]=hn[25]=hn[26]=hn[27]=hn[28]=hn[29]=hn[30]=hn[31]=hn[40]=hn[41]=hn[42]=hn[43]=hn[44]=hn[45]=hn[46]=hn[47]=hn[56]=hn[57]=hn[58]=hn[59]=hn[60]=hn[61]=hn[62]=hn[63]=hn[72]=hn[73]=hn[74]=hn[75]=hn[76]=hn[77]=hn[78]=hn[79]=hn[88]=hn[89]=hn[90]=hn[91]=hn[92]=hn[93]=hn[94]=hn[95]=hn[104]=hn[105]=hn[106]=hn[107]=hn[108]=hn[109]=hn[110]=hn[111]=hn[120]=hn[121]=hn[122]=hn[123]=hn[124]=hn[125]=hn[126]=hn[127]=0,J===Ve){Xe=bs(Ee,le|N);return}for(Lr=ol(le,J),B=0;B<120;++B)if(B&136&&(B+=8),rt=Ee[B],!!rt){if(rt&le){(!N||(rt|0)&N)&&Xe.push(B);continue}if(ct=Lr[B-J+119],!!(ct&rt))if(rt&Gn)for(Yn=b[rt],ce=1;ce<3;++ce)ze=B+Yn[ce],!(ze&136)&&(hn[ze+8]|=Nn,ze===J&&(++it,hn[B+8]|=Er));else{Yn=b[rt&Xt],xn=Yn.length,pt=rt&ar;e:for(ce=0;ce<xn;++ce)if(lr=Yn[ce],ze=B,!(J>ze&&lr<0&&J-ze>16||J<ze&&lr>0&&ze-J>16))for(;!((ze+=lr)&136);){if(hn[ze+8]|=Nn,Lt=Ee[ze],Lt){if(Lt&le){if(ze===J){for(ee=ze-lr;ee!==B;ee-=lr)hn[ee+8]|=Er;hn[B+8]|=Er,++it,pt&&(ze+=lr,ze&136||(hn[ze+8]|=Nn))}else if(pt&&ct&cr){for(ut=ze;(ut+=lr)!==J;)if(ut&136||Ee[ut])continue e;hn[ze+8]|=Mr+(Math.abs(lr)<<vr),++ln}}break}if(!pt)break}}}it>1&&(Xe=[J])}function $a(N,J){var B,ce,ee=J+16*(Ot===K?1:-1),le;return it===1&&!(Ee[J+8]&Er)&&!(Ee[ee+8]&Er)?!1:(B=Ee[N],Ee[J]=B,Ee[N]=0,ce=Ee[ee],Ee[ee]=0,le=ra(),Ee[N]=B,Ee[J]=0,Ee[ee]=ce,!le)}function al(N){var J,B,ce;if(Gr){if(Nt[N])for(J=sn[N],B=J%8,ce=0;ce<8;++ce)Nt[N]&1<<ce&&nl(Ee,J,ce,N)&&(C[ae++]=(ce>B?Z.KSIDE_CASTLE:Z.QSIDE_CASTLE)+(J<<en)+(J+(ce-B)<<qt),++ce)}else v&Z.KSIDE_CASTLE&&(J=sn[N],B=J+2,Ee[J+9]===0&&Ee[J+10]===0&&(C[ae++]=Z.KSIDE_CASTLE+(J<<en)+(B<<qt))),v&Z.QSIDE_CASTLE&&(J=sn[N],B=J-2,Ee[J+7]===0&&Ee[J+6]===0&&(C[ae++]=Z.QSIDE_CASTLE+(J<<en)+(B<<qt)))}function Ti(N,J,B){var ce,ee,le,rt,Lt;if(!N){for(J&&(J>>=26),rt=0;rt<5;++rt)if((!J||(J|0)===1<<rt)&&st._hand[B]&x[rt]<<T[rt]){for(rt===0?(ce=16,ee=103,le=Z.DROP):(ce=0,ee=119,le=Z.DROP|rt<<Rn),Lt=ce;Lt<=ee;++Lt)Lt&136&&(Lt+=8),Ee[Lt]||(it===0||it===1&&Ee[Lt+8]&Er)&&(C[ae++]=le|Lt<<qt);if(J)return}}}function Ri(N,J){var B,ce,ee,le=Ot,rt=Vn(le),Lt,ut,ze,xn,Yn,lr=sn[le],pt,Lr;for(Ka(N,lr),je=Xe.length,ae=G,pt=0;pt<je;++pt)if(B=Xe[pt],Lt=Ee[B],!(it&&ln&&Ee[B+8]&Mr))if(Lt&Gn)for(ze=b[Lt],(ln===0||!(Ee[B+8]&Mr)||Ee[B+8]>>vr===16)&&(ut=B+ze[0],Ee[ut]===0&&(qa(Ee,B,ut,0),_t[le]===qe(B)&&(ut+=ze[0],Ee[ut]||qa(Ee,B,ut,Z.BIG_PAWN)))),ce=1;ce<3;++ce)xn=ze[ce],ut=B+xn,!(ut&136||ln&&Ee[B+8]&Mr&&Ee[B+8]>>vr!==Math.abs(xn))&&(Ee[ut]&rt?qa(Ee,B,ut,Z.CAPTURE):ut===_n&&$a(B,ut)&&(C[ae++]=Z.EP_CAPTURE|B<<en|ut<<qt));else{if(ln&&Ee[B+8]&Mr){if(Lt&ur)continue;if(Ne[B-sn[le]+119]&Lt)xn=Ee[B+8]>>vr,ze=[xn,-xn];else continue}else ze=b[Lt&Xt];if(Lr=B<<en,B===lr){for(ce=0;ce<8;++ce)xn=ze[ce],ut=B+xn,ut&136||(Ee[ut]?Ee[ut]&rt&&(Ee[ut+8]&Nn||(C[ae++]=Z.CAPTURE|Lr|ut<<qt)):Ee[ut+8]&Nn||(C[ae++]=Lr|ut<<qt));it===0&&al(le)}else for(ee=ze.length,Yn=Lt&ar,ce=0;ce<ee;++ce)for(xn=ze[ce],ut=B;ut+=xn,!(ut&136);){if(Ee[ut]){Ee[ut]&rt&&(it===0||Ee[ut+8]&Er)&&(C[ae++]=Z.CAPTURE|Lr|ut<<qt);break}else(it===0||Ee[ut+8]&Er)&&(C[ae++]=Lr|ut<<qt);if(!Yn)break}}return Rt&&(qr?Ti(J,N,le):!Gr&&bo()&&(ae=G)),ae}function Es(N,J,B,ce){var ee,le,rt,Lt,ut,ze,xn,Yn,lr;if(Rt===Pe["King of the Hill"]&&N&et&&ys(B))return!0;if(ce&Z.KQSIDE_CASTLE&&(Ot===K?B=ce&Z.KSIDE_CASTLE?117:115:B=ce&Z.KSIDE_CASTLE?5:3,N=Hn,lr=!0),ee=sn[Vn(Ot)],ee===Ve)return!1;if(!(N&et)&&(le=Ne[B-ee+119],le&N))for(Lt=y[B-ee+119],ze=N&ar,ut=B+Lt;!(ut&136);){if(ut===ee){if(N&Gn){if((N&Re)===K?ee-B<0:ee-B>0)return!0;break}return!0}if(ut!==J&&Ee[ut]||!ze)break;ut+=Lt}if(!lr){if(rt=Ne[J-ee+119],rt&ar&&(Lt=y[J-ee+119],Lt!==y[B-ee+119]))for(ut=ee-Lt;!(ut&136);){if(ut!==J&&(xn=Ee[ut],xn)){if(xn&Ot&&rt&xn&&xn&ar)return!0;break}ut-=Lt}if(ce&Z.EP_CAPTURE&&(Yn=B+16*(Ot===K?1:-1),rt=Ne[Yn-ee+119],rt&ar))for(Lt=y[Yn-ee+119],ut=ee-Lt;!(ut&136);){if(ut!==J&&ut!==Yn){if(ut===B)break;if(xn=Ee[ut],xn){if(xn&Ot&&rt&xn&&xn&ar)return!0;break}}ut-=Lt}}return!1}function Aa(N,J){var B,ce,ee,le=b[ur],rt,Lt=ur|N;for(B=0;B<8;++B)if(ee=J+le[B],!(ee&136)&&(ce=Ee[ee],(ce&Lt)===Lt))return!0;for(le=b[et],B=0;B<8;++B)for(rt=le[B],ee=J+rt;!(ee&136);){if(ce=Ee[ee],ce){if(ce&N&&Ne[J-ee+119]&ce)if(ce&Gn){if(N===K?J-ee<0:J-ee>0)return!0}else return!0;break}ee+=rt}return!1}function wa(N){return sn[N]!==Ve&&Aa(Vn(N),sn[N])}function ra(){return wa(Ot)}function As(){var N,J,B,ce=1<<T[4];return st._hand[Ot]+=ce,N=G,G=ae,J=je,B=Ri()!==G,ae=G,G=N,je=J,st._hand[Ot]-=ce,B}function Za(){return ra()&&(C[0]=0)===Ri()&&!C[0]&&(Rt!==Pe.Bughouse||!As())}function Ya(){var N=!ra()&&(C[0]=0)===Ri()&&!C[0];return N&&Rt===Pe.Bughouse&&!st.isDependent&&(N=st.siblingGame.inStalemate()),N&&sn[Ot]!==Ve}function ws(N){var J,B,ce=100,ee=0,le=0,rt=0;for(B=0;B<120;++B)if(B&136&&(B+=8),J=Ee[B],J){if(N&&!(J&N))continue;if(ce&J)return!1;if(J&ur){if(le||ee++)return!1}else if(J&Pr&&(ee||(++le,(qe(B)+B)%2&&++rt,rt&&le!==rt)))return!1}return sn[K]!==Ve&&sn[Et]!==Ve}function Ss(){if(Cn<8)return!1;for(var N=Br(),J=!1,B,ce=Cn,ee=!1,le=Mt,rt=le.length-1;;){if(rt-=2,rt<0){if(le.id){rt=le.atMoveNode+rt+2,le=Ar[le.parentId];continue}if(rt===-2)return!1;B=le.hash,ee=!0}else B=le[rt].hash,le[rt].halfMoves>ce||ce<2?ee=!0:ce=le[rt].halfMoves;if(B[0]===N[0]&&B[1]===N[1]){if(J)return!0;J=!0}if(ee)return!1}}function zr(N){var J=N.move,B,ce,ee,le,rt,Lt,ut,ze,xn,Yn;if(Rt===Pe.Crazyhouse||J&Z.DROP?(ce=st._hand,Lt=N.hash,Yn=N.color):(ce=st.siblingGame._hand,N.handSibling=!0,rn&&(ut=st.siblingGame._history(),ut.length?Lt=ut[ut.length-1].hash:(ut.hash||(ut.hash=st.siblingGame._hashPosition()),Lt=ut.hash)),Yn=Vn(N.color)),N.captured){switch(N.captured&or?ee=Gn:ee=N.captured&Xt,ee&Xt){case Gn:ze=0;break;case ur:ze=1;break;case Pr:ze=2;break;case Hn:ze=3;break;default:ze=4}B=1<<T[ze],rn&&(rt=ce[Yn]>>T[ze]&x[ze],xn=W.zobristPiece[rt+63*ze+(Yn===K?0:315)])}else le=J>>Rn,B=-1<<T[le],rn&&(rt=ce[Yn]>>T[le]&x[le],xn=W.zobristPiece[rt-1+63*le+(Yn===K?0:315)]);ce[Yn]+=B,N.handChange=B,rn&&Un(Lt,[xn[0]*31>>>0,xn[1]*17>>>0])}function Xa(N,J,B,ce){var ee=Ot,le=Vn(ee),rt,Lt,ut,ze,xn={move:N,epSquare:_n,halfMoves:Cn,castlingW:Nt[K],castlingB:Nt[Et],color:ee},Yn,lr,pt=ee===K,Lr,ct;rn&&(ze=Br(),xn.hash=ze,Un(ze,W.zobristTurn),_n!==Ve&&ba(Ee,ze,_n+(pt?16:-16),Gn|ee)),N&Z.KQSIDE_CASTLE?Lr=et:qr&&N&Z.DROP?(Ee[B]=O[ce]|ee,rn&&Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Ee[B]]+8*(7-qe(B))+Qt(B)]),zr(xn),Lr=0):(Lr=Ee[J],ct=Ee[B],ct&&(xn.captured=ct,rn&&Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Ee[B]&un]+8*(7-qe(B))+Qt(B)]),ct&Hn&&Nt[le]&&(Gr?qe(B)===(pt?0:7)&&(ut=1<<Qt(B),Nt[le]&ut&&(Nt[le]^=ut,rn&&(ut>1<<Qt(sn[ee])?Un(ze,W.zobristCastle[le-1]):Un(ze,W.zobristCastle[le+1])))):B===(pt?7:119)?Nt[le]&Z.KSIDE_CASTLE&&(Nt[le]^=Z.KSIDE_CASTLE,rn&&Un(ze,W.zobristCastle[le-1])):B===(pt?0:112)&&Nt[le]&Z.QSIDE_CASTLE&&(Nt[le]^=Z.QSIDE_CASTLE,rn&&Un(ze,W.zobristCastle[le+1])))),N&Z.PROMOTION?Ee[B]=O[ce]|ee|or:Ee[B]=Ee[J],Ee[J]=0,rn&&(Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Lr&un]+8*(7-qe(J))+Qt(J)]),Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Ee[B]&un]+8*(7-qe(B))+Qt(B)]))),N&Z.EP_CAPTURE?(pt?(lr=B+16,Yn=6):(lr=B-16,Yn=8),xn.captured=Gn|le,Ee[lr]=0,rn&&Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Gn|le]+8*(Yn-qe(B))+Qt(B)])):Lr&et?(Gr?(N&Z.KQSIDE_CASTLE&&(Ee[B]=0,Ee[J]=0,N&Z.KSIDE_CASTLE?pt?(rt=118,Lt=117):(rt=6,Lt=5):pt?(rt=114,Lt=115):(rt=2,Lt=3),Ee[rt]=ee|et,Ee[Lt]=ee|Hn,rn&&(Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[et|ee]+8*(7-qe(J))+Qt(J)]),Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Hn|ee]+8*(7-qe(B))+Qt(B)]),Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[et|ee]+8*(7-qe(rt))+Qt(rt)]),Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Hn|ee]+8*(7-qe(Lt))+Qt(Lt)]))),rn&&(Nt[ee]&Nt[ee]-1?(Un(ze,W.zobristCastle[ee-1]),Un(ze,W.zobristCastle[ee+1])):Nt[ee]>1<<Qt(sn[ee])?Un(ze,W.zobristCastle[ee-1]):Un(ze,W.zobristCastle[ee+1])),sn[ee]=rt||B):(N&Z.KQSIDE_CASTLE&&(Ee[B]=Ee[J],Ee[J]=0,N&Z.KSIDE_CASTLE?(rt=B-1,Lt=B+1):(rt=B+1,Lt=B-2),Ee[rt]=Ee[Lt],Ee[Lt]=0,rn&&(Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[et|ee]+8*(7-qe(J))+Qt(J)]),Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Hn|ee]+8*(7-qe(Lt))+Qt(Lt)]),Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[et|ee]+8*(7-qe(B))+Qt(B)]),Un(ze,W.zobristPiece[64*W.zobristPieceValueNumbers[Hn|ee]+8*(7-qe(rt))+Qt(rt)]))),rn&&(Nt[ee]&Z.KSIDE_CASTLE&&Un(ze,W.zobristCastle[ee-1]),Nt[ee]&Z.QSIDE_CASTLE&&Un(ze,W.zobristCastle[ee+1])),sn[ee]=B),Nt[ee]=0):Lr&Hn&&Nt[ee]&&(Gr?qe(J)===(pt?7:0)&&(ut=1<<Qt(J),Nt[ee]&ut&&(Nt[ee]^=ut,rn&&(ut>1<<Qt(sn[ee])?Un(ze,W.zobristCastle[ee-1]):Un(ze,W.zobristCastle[ee+1])))):J===(pt?119:7)?Nt[ee]&Z.KSIDE_CASTLE&&(Nt[ee]^=Z.KSIDE_CASTLE,rn&&Un(ze,W.zobristCastle[ee-1])):J===(pt?112:0)&&Nt[ee]&Z.QSIDE_CASTLE&&(Nt[ee]^=Z.QSIDE_CASTLE,rn&&Un(ze,W.zobristCastle[ee+1]))),N&Z.BIG_PAWN?(pt?_n=B+16:_n=B-16,rn&&ba(Ee,ze,B,Gn|le)):_n=Ve,Lr&Gn||N&Z.ANY_CAPTURE?Cn=0:Cn++,Ot=le,Mt.push(xn)}function sl(){var N={color:Ot,san:"--",epSquare:_n},J={color:Ot,san:"--"},B;return rn&&(B=Br(),N.hash=B,Un(B,W.zobristTurn),_n!==Ve&&ba(Ee,B,_n+(Ot===K?16:-16),Gn|Ot)),_n=Ve,Cn++,Ot=Vn(Ot),Ot===K&&++Nr,Mt.push(N),J}function Yi(N,J,B,ce){var ee,le=Ot;Xa(N,J,B,ce),ee=Mt[Mt.length-1],qr?(Cn=ee.halfMoves+1,ee.captured&&zr(ee),Rt===Pe.Bughouse&&(ee.bughouseOrder=st.moveCount()-1+st.siblingGame.moveCount())):Rt===Pe["3-check"]&&wa(Ot)&&(ee.checked=!0,rn&&St[le]&&Un(ee.hash,W.zobristCheck[St[le]+(le===K?-1:2)]),++St[le],rn&&Un(ee.hash,W.zobristCheck[St[le]+(le===K?-1:2)]))}function Go(N){var J,B,ce=Ot,ee=Vn(ce),le=N.move,rt=le>>qt&$e,Lt=le>>en&$e;if(Ot=ee,Nt[Et]=N.castlingB,Nt[K]=N.castlingW,_n=N.epSquare,Cn=N.halfMoves,Rt){if(Gr&&le&Z.KQSIDE_CASTLE){le&Z.KSIDE_CASTLE?ee===K?(B=118,J=117):(B=6,J=5):ee===K?(B=114,J=115):(B=2,J=3),Ee[B]=0,Ee[J]=0,Ee[Lt]=ee|et,Ee[rt]=ee|Hn,sn[ee]=Lt;return}if(N.handChange&&(Rt===Pe.Crazyhouse||!N.handSibling?st._hand[ee]-=N.handChange:st.siblingGame._hand[Vn(ee)]-=N.handChange),le&Z.DROP){Ee[rt]=0;return}N.checked&&--St[ee]}le&Z.PROMOTION?(Ee[Lt]=Gn|ee,le&Z.CAPTURE?Ee[rt]=N.captured:Ee[rt]=0):(Ee[Lt]=Ee[rt],le&Z.KQSIDE_CASTLE?(Ee[rt]=0,le&Z.KSIDE_CASTLE?(J=rt+1,B=rt-1):(J=rt-2,B=rt+1),Ee[J]=ee|Hn,Ee[B]=0,sn[ee]=Lt):(rt===sn[ee]&&(sn[ee]=Lt),le&Z.CAPTURE?Ee[rt]=N.captured:(Ee[rt]=0,le&Z.EP_CAPTURE&&(Ee[rt-(ee===K?-16:16)]=Gn|ce))))}function ll(N,J,B){var ce,ee,le,rt,Lt,ut,ze,xn;if(ae<2)return"";for(N=N&Xt,xn=0;xn<ae;++xn)if(ce=C[xn],ze=ce>>qt,B===ze&&(rt=ce>>en&$e,rt!==J&&(ee=Ee[rt],ee&N))){if(le=!0,qe(J)===qe(rt)){if(Lt)return Fn(J);ut=!0}if(Qt(J)===Qt(rt)){if(ut)return Fn(J);Lt=!0}}return le?Lt?String(8-qe(J)):String.fromCharCode(Qt(J)+97):""}function ia(N,J,B){var ce,ee,le=N>>qt&$e,rt={color:Ot,to:Fn(le),flags:N&$e};return!qr||!(N&Z.DROP)?(ce=N>>en&$e,rt.from=Fn(ce),rt.piece=Ee[ce],N&Z.PROMOTION&&(ee=N>>Rn,rt.promotion=O[ee]+Ot),N&Z.CAPTURE?rt.captured=Ee[le]:N&Z.EP_CAPTURE&&(rt.captured=Gn|Vn(Ot))):(ee=N>>Rn,rt.drop=ee,rt.piece=O[ee]+Ot),J?rt.san=J:rt.san=di(N,B),rt}function bo(){if(Rt===Pe["3-check"])return St[Vn(Ot)]===3;if(Rt===Pe["King of the Hill"])return ys(sn[Vn(Ot)])}function Qa(){if(Rt===Pe.Bughouse)return st.siblingGame.inCheckmate()}function ul(){if(Rt===Pe.Bughouse)return st.siblingGame.in50MoveRule()||st.siblingGame.inThreefoldRepetition()}function Mi(){var N=[],J=Si(),B=Mt.length-1,ce=Mt[B];return ce?(N.parentId=kn,N.id=Ar.length,Mt.curFen=J,ce.lines||(ce.lines=[]),ce.lines.push(N.id),ce.move?Go(ce):(_n=ce.epSquare,--Cn,Ot=Vn(Ot)),Ot===Et&&--Nr,N.atMoveNode=B,B?N.hash=Mt[B-1].hash:N.hash=Mt.hash,kn=N.id,Ar.push(N),Mt=N,!0):!1}function Cs(N){var J=Si();Mt.curFen=J,Mt=Ar[N],kn=N,$i(Mt.curFen,Rt,!0,!0)}return st={WHITE:K,BLACK:Et,PAWN:Gn,KNIGHT:ur,BISHOP:Pr,ROOK:Hn,QUEEN:Vt,KING:et,FLAGS:Z,load:$i,reset:fi,moves:function(N){var J=[],B,ce=di,ee,le;for(N&&(N.verbose&&(ce=ia),N.type&&(ee=N.type|N.type<<24),le=N.noDrop),Ri(ee,le),B=0;B<ae;++B)J.push(ce(C[B]));return J},inCheck:ra,inCheckmate:Za,inStalemate:Ya,isBughouseWin:Qa,in50MoveRule:function(){return Cn>=100},inDraw:function(){return Cn>=100||Ya()||ws()||Ss()||!!ul()},insufficientMaterial:ws,inThreefoldRepetition:Ss,isVariantWin:bo,gameOver:function(){return st.inDraw()||Za()||!!bo()||!!Qa()},isPositionValid:function(N){var J,B,ce=0,ee;if(N=N||{},N.pawns!==!1)for(J=0;J<=119;){if(ee=Ee[J],ee&Gn)return!1;++J===8&&(J=112)}if(N.kings!==!1){for(J=0;J<=119;++J)if(J&136&&(J+=8),ee=Ee[J],ee&et){if(++ce>2||B&&B&ee)return!1;B=ee&Re}if(ce!==2)return!1}return!(N.check!==!1&&!(N.kings===!1&&sn[Vn(Ot)]===Ve)&&wa(Vn(Ot)))},validateFen:ja,fen:Si,pgn:function(N){return N=N||{},!N.useResultHeader&&!kn&&(bo()||Za()?Wn.Result=Ot===Et?"1-0":"0-1":st.inStalemate()?Wn.Result="1/2-1/2":Qa()&&(Wn.Result=st.siblingGame.turn()===K?"1-0":"0-1")),rl(N,Wn,Ar,En,Rt,st)},loadPgn:function(N,J,B){var ce,ee,le,rt,Lt={},ut,ze,xn=0,Yn;if(typeof J!="number"&&(B=B||J,J=0),B=B||{},typeof N=="string"&&(B.singleGame&&(N=N.replace(/(?:\r?\n\s*){2,}/g,`
`)),N=st.tokenizePgn(N,B)),J<0&&(J=N.length+J),rt=N[J],!rt)return!1;for(fi(),ee=rt.length,ce=0;ce<ee&&(le=rt[ce],le.type==="tagName");++ce){if(!rt[ce+1]||rt[ce+1].type!=="tagValue")return!1;++ce,le.value==="FEN"?Yn=gs(rt[ce].value):Lt[le.value]=rt[ce].value}if(B.variant&&(Lt.Variant=B.variant),Lt.Variant&&!Yn&&(Yn=Ht),Yn||Lt.SetUp==="1"){if(Lt.SetUp==="0")Lt.FEN=Yn;else if(!Yn||!$i(Yn,Lt.Variant))return!1}for(st.header(Lt),ut=st,ze=ut._history();ce<ee;++ce)if(le=rt[ce],le.type==="san"&&xn===0){if(!ut.move(le.value)&&(le.value!=="Z0"&&le.value!=="<>"||B.rejectNullMoves||!ut.move("--")))if(B.commentErrors)ze.length?ze[ze.length-1].comment=((ze[ze.length-1].comment||"")+" "+le.value).trim():ze.initComment=((ze.initComment||"")+" "+le.value).trim();else if(B.skipBadLines&&(kn!==0||Mt.length&&B.allowBadMainLine))xn=1;else return fi(),!1}else if(le.type==="result"&&Wn.Result==="*")ao(["Result",le.value]);else if(le.type==="a"&&xn===0&&ze[ze.length-1])ze[ze.length-1].annotation=le.value;else if((le.type==="nag"||le.type==="aa")&&xn===0&&ze[ze.length-1])ze[ze.length-1].additionalAnnotation||(ze[ze.length-1].additionalAnnotation=[]),ze[ze.length-1].additionalAnnotation.indexOf(le.value)===-1&&ze[ze.length-1].additionalAnnotation.push(le.value);else if(le.type==="comment"&&xn===0)ze.length?(le.value&&(ze[ze.length-1].comment=le.value),le.commands&&(ze[ze.length-1].commands=le.commands,le.commands.clk&&(ze[ze.length-1].time=Qs(le.commands.clk)))):(ze.initComment=String(le.value),le.commands&&(ze.commands=le.commands));else if(le.type==="variationStart"){if(xn>0)++xn;else if(!Mi())return fi(),!1;ze=ut._history()}else if(le.type==="variationEnd")xn>0&&--xn,xn===0&&(Cs(ze.parentId),ze=ut._history());else if(le.type==="number"){if(/b/i.test(le.value.slice(-1))?ut=st.siblingGame:ut=st,!ut)return!1;ze=ut._history()}else le.type==="cont"&&kn&&!ze.length&&ut.move(ut._lines()[ze.parentId][ze.atMoveNode].san);return!0},header:function(N){return Array.isArray(N)?ao(N):(typeof N=="object"&&Object.keys(N).forEach(function(J){ao([J,N[J]])}),Wn)},turn:function(N){return(N===K||N===Et)&&(Ot=N),Ot},move:function N(J){var B,ce,ee,le,rt,Lt,ut,ze,xn,Yn,lr,pt,Lr;if(typeof J=="string"){switch(le=J.length-1,J[le]){case"+":case"#":J=J.substr(0,le)}for(It.indexOf(J[0])>6?xn=oe[J[0]]:J[0]==="O"?xn=et:xn=Gn,qr&&(J.indexOf("@")===-1?Yn=!0:(Yn=!1,xn<<=24)),Ri(xn,Yn),le=0;le<ae;++le)if(Lt=di(C[le],!0),J===Lt){ce=C[le];break}if(ce)ut=ce>>en&$e,ze=ce>>qt&$e,ee=ce>>Rn;else{if(J==="--")return sl();if(J=st.fixMove(J))try{return N(J)}catch{}return null}}else{if(J.drop){switch(J.drop){case"p":ee=0;break;case"n":ee=1;break;case"b":ee=2;break;case"r":ee=3;break;case"q":ee=4;break;default:return null}xn=1<<26+ee}else{if(J.promotion)switch(J.promotion){case"q":ee=4;break;case"n":ee=1;break;case"r":ee=3;break;case"b":ee=2;break;default:return null}ut=jt[J.from],Yn=!0,xn=Ee[ut]&Xt}for(ze=jt[J.to],B=((ee?ee<<Rn:0)|ze<<qt)>>en|ut,Ri(xn,Yn),le=0;le<ae;++le)if(C[le]>>en===B){ce=C[le];break}if(!ce)return(J=st.fixMove(J))?N(J):null}return ce&Z.DROP_OR_PROMOTE?Lr=O[ee]+Ot:Lr=Ee[ut],rt=ia(ce,Lt,!0),lr=Es(Lr,ut,ze,ce),ui(ce,ut,ze,ee),lr&&(Rt&&bo()||Ri()===0?rt.san+="#":rt.san+="+"),pt=Mt[Mt.length-1],pt.san=rt.san,rt.piece&or&&(pt.promoted=!0),Ot===K&&++Nr,rt},undo:function(N){var J=Mt.pop();return J?(Ot===K&&--Nr,J.move?(Go(J),N?!0:ia(J.move,J.san)):(_n=J.epSquare,--Cn,Ot=Vn(Ot),N?!0:{san:"--",color:J.color})):null},clear:function(N){Qr(N)},put:function(N,J,B){var ce=jt[J],ee=!1,le,rt=Ee[ce],Lt=rt&Re,ut=N.color;if(isNaN(ce)||!N.type||!ut||It.indexOf(N.type)===-1)return!1;if(Ee[ce]=oe[N.type]|ut|(N.promoted?or:0),Ee[ce]&et&&(sn[ut]=ce),rt&&Ee[sn[Lt]]&&Ee[sn[Lt]]!==(et|Lt)){for(le=0;le<120;++le)le&136&&(le+=8),Ee[le]===(et|Lt)&&(sn[Lt]=le,ee=!0);ee||(sn[Lt]=Ve)}return B||$i(Si(),Rt,!1,!1),!0},get:Wr,remove:function(N,J){var B=Ee[jt[N]],ce=Wr(N),ee=B&Re,le;if(Ee[jt[N]]=0,B&et){for(sn[ee]=Ve,Nt[ee]=0,le=0;le<120;++le)if(le&136&&(le+=8),Ee[le]===(et|ee)){sn[B.color]=le;break}}return J||$i(Si(),Rt,!0,!1),ce},history:function(N,J){for(var B=[],ce,ee=Mt,le=ee.length;;){if(--le===-1)if(ee.id&&!J){le=ee.atMoveNode,ee=Ar[ee.parentId];continue}else break;N?(ce=ia(ee[le].move,ee[le].san),ce.color=ee[le].color,!le&&ee.initComment&&(ce.firstComment=ee.initComment),ee[le].comment!==void 0&&(ce.comment=ee[le].comment),ee[le].time!==void 0&&(ce.time=ee[le].time),ee[le].annotation!==void 0&&(ce.annotation=ee[le].annotation),ee[le].additionalAnnotation!==void 0&&(ce.additionalAnnotation=ee[le].additionalAnnotation),ee[le].commands!==void 0&&(ce.commands=ee[le].commands),ee[le].captured!==void 0&&(ce.captured=ee[le].captured),ee[le].promoted!==void 0&&(ce.promoted=ee[le].promoted),ee[le].lines!==void 0&&(ce.lines=ee[le].lines),ee[le].bughouseOrder!==void 0&&(ce.bughouseOrder=ee[le].bughouseOrder),It.indexOf(ee[le].san[0])>6?ce.piece=oe[ee[le].san[0]]:ee[le].san[0]==="O"?ce.piece=et:ce.piece=Gn,ce.piece|=ce.color,B.unshift(ce)):B.unshift(ee[le].san)}return B},hashes:function(){for(var N=[],J=Mt,B=J.length;;){if(--B===-1)if(J.id){B=J.atMoveNode,J=Ar[J.parentId];continue}else{J.hash||Br(),N.unshift(J.hash);break}N.unshift(J[B].hash)}return N},moveCount:function(){return Mt.length},startingMoveNumber:function(){return En},completeFen:gs,createVariation:Mi,selectLine:Cs,hash:function(){var N=Br();return Rt===Pe.Bughouse&&!st.isDependent?[N,st.siblingGame.hash()]:N},hashing:function(N){rn=N,Rt===Pe.Bughouse&&!st.isDependent&&st.siblingGame.hashing(rn)},hand:function(){if(qr)return _a(st._hand[K],!0)+_a(st._hand[Et])},checks:function(){if(Rt===Pe["3-check"])return[St[K],St[Et]]},threats:function(){var N=Ot,J=Vn(N),B=[],ce=[],ee=[],le=[],rt=[],Lt=_n,ut,ze,xn,Yn,lr,pt,Lr;if(Ka(0,sn[N]),it||ln)for(ut=0;ut<120;++ut)ut&136&&(ut+=8),Ee[ut+8]&Er&&Ee[ut]?ee.push(Fn(ut)):Ee[ut+8]&Mr&&B.push(Fn(ut));for(Ot=J,_n=Ve,Ri(),ut=ae;ut--;){if(ze=C[ut],lr=ze>>qt&$e,pt=ze>>en&$e,ze&Z.DROP_OR_PROMOTE){if(Lr=ze>>Rn,Yn=O[Lr]|J,ze&Z.PROMOTION&&Lr%3!==1)continue}else Yn=Ee[pt],Lr=0;if(Es(Yn,pt,lr,ze)&&(ui(ze,pt,lr,Lr),G=ut,(Rt&&bo()||Ri()===ut)&&ce.push((ze&Z.DROP?fe[Yn].toLowerCase()+"@":Fn(pt))+Fn(lr)),Go(Mt.pop()),ze&Z.CAPTURE)){for(xn=0,ut=ae;ut>G;)if((C[--ut]>>qt&$e)===lr){xn=1,ut=G;break}if(!xn){le.push(Fn(pt)+Fn(lr));continue}}ze&Z.CAPTURE&&Lr!==1&&(xn=Ee[lr]&124)&&(Aa(N,lr)?(Yn=Ee[pt]&Xt,xn>Yn&&xn-Yn!==8&&rt.push(Fn(pt)+Fn(lr))):le.push(Fn(pt)+Fn(lr)))}return G=0,Ot=N,_n=Lt,{pins:B,checkers:ee,mates:ce,undefended:le,underdefended:rt}},tokenizePgn:il,fixMove:function(N){var J,B,ce;if(typeof N=="string"){if(/0|[?!+#]$|[18][QNRB]$|^P/i.test(N))return N.replace(/[?!+#]+$/,"").replace(/0/g,"O").replace(/([18])([QNRB])$/i,"$1=$2").replace(/^P+/i,"");if(B=N.indexOf("=")>0?-4:-2,J=jt[N.substr(B,2)],typeof J=="number"){if(Ee[J]&Vn(Ot)||/^[a-h]x?[a-h][36]$/.test(N)){if(N.indexOf("x")===-1)return N.slice(0,B)+"x"+N.substr(B)}else if(N.indexOf("x")>-1)return N.replace(/x/g,"");if(ce=N.match(/^([KQNRB]?)([a-h][1-8]?|[1-8])x?([a-h][1-8])=?(.?)$/)){if(Ee[jt[ce[2]]])return{from:ce[2],to:ce[3],promotion:ce[4].toLowerCase()};if(/^\d$/.test(ce[2])){for(N=0,Ri(oe[ce[1]],!0),B=0;B<ae;++B)if(C[B]>>qt===J&&qe(C[B]>>en&$e)===8-ce[2]){if(N)return;N=C[B]}if(N)return di(N,!0)}return ce[1]+ce[3]+ce[4]}}}else if(Ee[jt[N.from]]===(et|Ot)&&N.to&&N.from[1]===N.to[1]){if(N.from<N.to)return"O-O";if(N.from>N.to)return"O-O-O"}},_hand:[],_history:function(N){return N&&(Mt=N,kn=Mt.id),Mt},_lines:function(){return Ar},_hashPosition:Ki,_board:function(){return Ee}},dn&&$i(dn,$n)||fi(),st}return Wa.variants=Ie,Wa}(),k=function(U){var Pe="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Ie=["bench","d","eval","flip","isready","ponderhit","stop","uci","ucinewgame"],jt=[{cmd:"position",args:["fen","startpos","moves","continuation"]},{cmd:"go",args:["binc","btime","confidence","depth","infinite","mate","mindepth","mintime","maxdepth","maxtime","movestogo","movetime","ponder","searchmoves","shallow","winc","wtime"]}],Xe=["moves","searchmoves"],it=["ponder","infinite","startpos"],ln={depth:1,seldepth:1,time:1,nodes:1,multipv:1,cp:1,mate:1,currmovenumber:1,hashfull:1,nps:1,tbhits:1,sbhits:1,cpuload:1,bmc:1,score:2,lowerbound:2,upperbound:2,bestmove:3,ponder:3,baseTurn:3,bestmoveSan:3,ponderSan:3,pv:4,pvSan:4,string:4,refutation:4,currline:4},v=/(?:Total|Final) Evaluation[\s\S]+\n$/i;function C(Vt,et,Re){var Xt=new Worker(Vt||"stockfish.js"),un={terminate:or,postMessage:cr};function cr(Nn){Xt.postMessage(Nn)}function or(){Xt.terminate()}function ar(Nn){var Er=Nn.concat();Nn.length=0,Er.forEach(function(Mr){Mr.cmd?Mr.cmd.substr(0,2)!=="go"&&Re.send(Mr.cmd,Mr.cb,Mr.stream):(clearTimeout(Mr.timer),Re.getBestMove(Mr.args,Mr.cb,Mr.stream))})}return Xt.onmessage=function(Nn){typeof Nn.data=="string"&&un.onmessage(Nn.data)},Xt.onerror=function(Nn){if(Re.fallbackPath&&Re.fallbackPath!==Vt){try{Nn.preventDefault()}catch{}try{Xt.terminate()}catch{}return Xt=C(Re.fallbackPath,et,Re),Xt.onmessage=function(Er){un.onmessage(Er)},ar(Re._activeCommands()),ar(Re._bestMoveQueue()),!1}if(et.onError)return et.onError(Nn)},un}function G(Vt,et){et.fallbackPath=Vt.pathToNonWasmEngine,et.path=Vt.enginePath||Vt.pathToEngineWorker,et.wasmPath=Vt.pathToWasmEngine,Vt.engines&&(Vt.engines.multiThreaded&&U.supportsMultithreading()?(et.path=Vt.engines.multiThreaded.loader,et.wasmPath=Vt.engines.multiThreaded.engine):Vt.engines.singleThreaded&&(et.path=Vt.engines.singleThreaded.loader,et.wasmPath=Vt.engines.singleThreaded.engine),et.fallbackPath=Vt.engines.asm||et.fallbackPath)}function ae(Vt,et){var Re;return G(Vt,et),Re=et.path,(et.fallbackPath&&typeof WebAssembly>"u"||!Re)&&(Re=et.fallbackPath),et.wasmPath&&(Re+="#"+et.wasmPath),C(Re,Vt,et)}function je(Vt){for(var et=Vt.split(" "),Re=et.length,Xt=et[0]==="info"?1:0,un={mtype:et[0]},cr,or;Xt<Re;++Xt)if(or=et[Xt],or)if(cr=ln[or],cr===1){for(;!et[++Xt]&&Xt<Re;);un[or]=Number(et[Xt])}else if(cr===2)un[or]=!0;else if(cr===3){for(;!et[++Xt]&&Xt<Re;);un[or]=et[Xt]}else for(un[or]=[],++Xt;Xt<Re;++Xt)if(!ln[et[Xt]])et[Xt]&&un[or].push(et[Xt]);else{--Xt;break}return(un.bestmove==="(none)"||un.bestmove==="0000")&&(un.bestmove=void 0,un.bestmoveSan=void 0),(un.ponder==="(none)"||un.ponder==="0000")&&(un.ponder=void 0,un.ponderSan=void 0),un}function Ve(Vt){var et=Vt.indexOf(" ");return et===-1?Vt:Vt.substr(0,et)}function K(Vt){return(Vt+"").replace(/^([^/]+)((?:\/[^/]+){7})\/([qrbnp]*)/i,"$1$2[$3]").replace(/( \d+ \d+) \+([0-3])\+([0-3])/,function(et,Re,Xt,un){return" "+(3-Xt)+"+"+(3-un)+Re})}function Et(Vt){return(Vt+"").replace(/\[([qrbnp]*)\]/i,"/$1").replace(/([0-3])\+([0-3]) (\d+ \d+)/,function(et,Re,Xt,un){return un+" +"+(3-Re)+"+"+(3-Xt)})}function Gn(Vt,et){var Re,Xt=Ve(Vt),un,cr,or;for(Xt==="uciok"||Xt==="option"?Re="uci":Xt==="readyok"||Xt==="ready"?Re="isready":Xt==="json"||Vt.indexOf("info string CEEError")>=0?Re="fetch":Xt==="bestmove"||Xt==="info"?Re="go":Re="other",or=et.length,cr=0;cr<or;cr+=1)if(un=Ve(et[cr].cmd),un===Re||Re==="other"&&(un==="d"||un==="eval"))return cr;return 0}function ur(Vt){var et=Vt.match(/id name ((\S+) ([\d.a-z]+).*)/i);if(et)return{all:et[1].trim(),short:et[2],version:et[3],full:et[2]+" "+et[3],wasm:/ wasm/i.test(Vt),multithreaded:/ multithreaded/i.test(Vt)}}function Pr(Vt,et){var Re={},Xt,un=[],cr,or=[],ar,Nn=null;function Er($e){var It,Ht=0,b,se,oe;if($e.indexOf(`
`)>-1){for(se=$e.split(`
`),oe=0;oe<se.length;oe+=1)Er(se[oe]);return}if(U.log&&console.log("debug (onmessage): "+$e),Re.stream&&Re.stream($e),!un.length||$e.indexOf("No such option")===0||$e.indexOf("Stockfish")===0||$e.indexOf("Komodo")===0||$e.indexOf("Explanation Engine")===0||$e.indexOf("info string variant")===0){if(Vt.ceeMode&&$e.indexOf("Explanation Engine")===0){var fe=$e.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)\s*\(C\)/);fe?Nn={date:fe[1],increment:fe[2]}:(fe=$e.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)\.([0-9]+)/),Nn={major:fe[1],minor:fe[2],patch:fe[3]})}return}if(Ht=Gn($e,un),b=un[Ht],b.stream&&!b.discard&&b.stream($e),typeof b.message>"u"?b.message="":b.message!==""&&(b.message+=`
`),b.message+=$e,$e.indexOf("uciok")===0)Re.name=ur(b.message),It=!0;else if($e.indexOf("ready")===0)It=!0;else if(($e.indexOf("bestmove")===0||Ve($e)==="bestmove")&&b.cmd!=="bench")It=!0,b.message=$e;else if(b.cmd==="d")($e.indexOf("Legal uci moves")===0||$e.indexOf("Key is")===0)&&(b.done=!0,It=!0);else if(b.cmd.indexOf("fetch")===0)try{var Te=b.message.split(`
`).filter(function(Ne){return Ne.includes("json")}).join(`
`);Te&&(b.message=JSON.parse(Te.replace(/^json /mg,"").replace(/\n/g,"")),It=!0)}catch{}else b.cmd==="eval"?v.test(b.message)&&(It=!0):($e.indexOf("pawn key")===0||$e.indexOf("Nodes/second")===0||$e.indexOf("Unknown command")===0)&&(It=!0);It&&(un.splice(Ht,1),b.cb&&!b.discard?b.cb(b.message):b.ondiscard&&b.ondiscard())}function Mr($e){return $e!=="ucinewgame"&&$e!=="flip"&&$e!=="stop"&&$e!=="ponderhit"&&$e.indexOf("position")!==0&&$e.indexOf("setoption")!==0&&$e.indexOf("variation")!==0&&$e.indexOf("threat-variation")!==0&&$e.indexOf("push")!==0&&$e.indexOf("pop")!==0&&$e.indexOf("serve")!==0&&$e.indexOf("speech")!==0}Re.send=function($e,It,Ht){var b;$e=String($e).trim(),Mr($e)?un[un.length]={cmd:$e,cb:It,stream:Ht}:b=!0,Xt&&(U.log&&console.log("stdin: "+$e),Xt.postMessage($e),b&&It&&setTimeout(It,0))},Re._activeCommands=function(){return un},Re._bestMoveQueue=function(){return or},Re.quit=function(){if(Xt&&Xt.terminate){try{Re.send("quit")}catch{}Xt.terminate(),Xt=null,Re.ready=void 0}clearTimeout(cr)},Ie.forEach(function(It){Re[It]=function(b,se){Re.send(It,b,se)}}),jt.forEach(function(It){Re[It.cmd]=function(b,se,oe){var fe=[It.cmd];ar&&b.fen&&(b.fen=K(b.fen)),It.args.forEach(function(Ne){if(b[Ne]||b[Ne]===0){if(Xe.indexOf(Ne)>-1){if(!b[Ne]||!b[Ne].length)return;Array.isArray(b[Ne])&&(b[Ne]=b[Ne].join(" "))}fe.push(Ne),it.indexOf(Ne)===-1&&fe.push(b[Ne])}}),Re.send(fe.join(" "),se,oe)}}),Re.setoption=function($e,It){Re.send("setoption name "+$e+" value "+It)},Re.setVariant=function($e){var It;$e!==ar&&(It=String($e).toLowerCase().replace(/ |-/g,""),!$e||It==="chess"?(It=void 0,Re.setoption("UCI_Variant","chess"),Re.setoption("UCI_Chess960","false")):It==="chess960"?(Re.setoption("UCI_Variant","chess"),Re.setoption("UCI_Chess960","true")):(It==="threecheck"&&(It="3check"),Re.setoption("UCI_Variant",It),Re.setoption("UCI_Chess960","false")),ar=It)},Re.loadBook=function($e,It){Re.pathToBook=$e,W.loadBook($e,function(b,se){Re.book=se,Re.bookLoaded=!0,b&&(console.error("Error loading opening book."),console.error(b),Re.pathToBook=null,Re.bookLoaded=!1),It()})},Re.getBookMove=function($e){var It=U.createGame($e),Ht=Re.book.pick({fen:It.fen(),type:typeof $e.bookPick<"u"?$e.bookPick:"random",chess960:It.header().Variant==="Chess960"}),b=Ht&&It.move(Ht);if(b)return{moveSan:b.san,moveLan:Ht,move:{from:b.from,to:b.to,promotion:b.promotion||null},baseTurn:It.turn()===1?"b":"w",pv:[{moveSan:b.san,moveLan:Ht}],depth:null,score:null,mateIn:null,isBookMove:!0}};function vr(){var $e=1,It=[],Ht=[],b,se,oe=null,fe=or[0].args,Te=or[0].cb,Ne=or[0].stream,yn,F=1,he,we=[],Oe=14,y=Pr._previousCP;or[0].started=!0,Pr._previousCP=null;function T(j){var qe=[],Qt=Ht[j]||_t(It[j]);return It[j].forEach(function(Vn,Un){qe.push({moveSan:Qt[Un],moveLan:Vn})}),qe}function x(j,qe,Qt,Fn){var Vn;for(Vn=It.length-1;Vn>=0;Vn-=1)if(It[Vn][0]===j)return T(Vn);return Qt?[{moveSan:qe,moveLan:j},{moveSan:Fn,moveLan:Qt}]:qe?[{moveSan:qe,moveLan:j}]:[]}function H(j){var qe=.03*Math.pow(32,j.depth/Oe);j.cp=y+(j.cp-y)*qe}function O(j){j.mate===0?(j.mateIn=0,j.cp=-31800*F):(j.mateIn=Number(j.mate*F)||null,typeof j.mateIn=="number"&&!isNaN(j.mateIn)&&typeof j.cp!="number"?j.cp=31800*F*(j.mate/Math.abs(j.mate)):(j.cp*=F,Math.abs(j.cp)===9&&(j.cp=0),fe.normalize&&j.depth<=Oe&&typeof y=="number"&&j.multipv===1&&H(j))),j.score=j.cp/100}function X(j){var qe=je(j);if(Z(qe),$e>Oe&&b<5e3&&b>-5e3&&(Pr._previousCP=b),qe.pv=x(qe.moveLan,qe.moveSan),qe.pv.length===1&&qe.ponder&&(qe.pv=x(qe.moveLan,qe.moveSan,qe.ponder,qe.ponderSan)),we.length>1)we.splice(we.indexOf(qe.moveLan),1),fe.searchmoves=we,fe.getNextBest=0,en(fe,function(){Te(qe)},function(Fn){Ne&&(Fn.multipv=2,Ne(Fn))});else if(Te)try{Te(qe)}catch(Qt){console.error(Qt)}or.shift(),clearTimeout(cr),or.length>0&&vr()}function Z(j){var qe;j.baseTurn=yn,j.cp=b,j.score=b/100,j.mate=se,j.mateIn=oe,j.depth=$e,j.moveLan=j.bestmove,j.moveLan&&(j.move=U.uciToObj(j.moveLan)[0],qe=he.move(j.move),qe&&(j.moveSan=j.bestmoveSan=qe.san,j.ponder&&(qe=he.move(U.uciToObj(j.ponder)[0]),qe&&(j.ponderSan=qe.san,he.undo(!0))),he.undo(!0)))}function _t(j){var qe,Qt=j.length,Fn=[],Vn;for(qe=0;qe<Qt&&(Vn=he.move(U.uciToObj(j[qe])[0]),!!Vn);++qe)Fn.push(Vn.san);for(;qe>0;--qe)he.undo(!0);return Fn}function nt(j){var qe=je(j);qe.score&&(qe.baseTurn=yn,O(qe),!qe.multipv&&qe.depth&&(qe.multipv=1),(qe.multipv===1||qe.depth===0)&&(b=qe.cp,se=qe.mate,oe=qe.mateIn)),qe.pv&&Ne&&(qe.pvSan=_t(qe.pv)),qe.pv&&!(qe.lowerbound||qe.upperbound)&&(It.push(qe.pv),Ne&&Ht.push(qe.pvSan)),qe.depth>$e?$e=qe.depth:qe.mtype==="bestmove"&&Z(qe),Ne&&!(qe.mateIn===0&&qe.pv)&&Ne(qe),Ue()}function Ue(){fe.timeout&&(clearTimeout(cr),or[0].timer=cr=setTimeout(function(){Re.stop(),Te&&(Te(),Te=void 0)},fe.timeout))}fe.difficulty>=0&&fe.difficulty<20?(Re.setoption("Skill Level",fe.difficulty),fe.maximumError>=0&&fe.maximumError<=4999&&Re.setoption("Skill Level Maximum Error",fe.maximumError),fe.errorProbability>=1&&fe.errorProbability<=128&&Re.setoption("Skill Level Probability",fe.errorProbability)):Re.setoption("Skill Level",20),fe.contempt!==void 0?Re.setoption("Contempt",fe.contempt):Re.setoption("Contempt","0"),fe.multiPv>1?Re.setoption("MultiPV",fe.multiPv):Re.setoption("MultiPV",1),!fe.movetime&&(!fe.wtime||!fe.btime)&&!fe.depth&&(fe.btime=fe.btime||72e3,fe.wtime=fe.wtime||72e3),(fe.startpos||!fe.fen)&&!fe.moves&&!fe.variant?(yn="w",he=U.createGame({disableHashing:!0})):(he=U.createGame({fen:fe.fen?Et(fe.fen):Pe,moves:fe.moves,variant:fe.variant,disableHashing:!0}),he.turn()===he.WHITE?yn="w":(yn="b",F=-1)),Re.setVariant(fe.variant),Re.position(fe),Re.go(fe,X,nt),fe.getNextBest&&Te&&he.moves({verbose:!0}).forEach(function(qe){qe=U.normalizeMoveObj(qe),we.push(qe.from+qe.to+(qe.promotion||""))}),Ue()}function en($e,It,Ht){or.push({args:$e,cb:It,stream:Ht}),or.length===1&&vr()}Re.getBestMove=function($e,It,Ht){var b;if($e=$e||{},$e.fen=$e.fen||$e.baseFen,$e.is960&&($e.variant="Chess960"),Re.bookLoaded&&$e.useBook&&(b=Re.getBookMove($e),b))return setTimeout(function(){b.mtype="bestmove",It(b)},0);en($e,It,Ht)},Re.stopAll=function($e){var It,Ht=un.length,b=0;function se(){b-=1,b===0&&$e()}for(or=[],It=0;It<Ht;It+=1)U.log&&console.log("debug (stop_moves): "+It,Ve(un[It].cmd)),Ve(un[It].cmd)==="go"&&!un[It].discard&&(Re.stop(),un[It].discard=!0,$e&&(b+=1,un[It].ondiscard=se));$e&&!b&&Re.isready($e)},Re.restartEngine=function($e){return Re.stopAll(),Re.quit(),un=[],or=[],Re.bookLoaded&&!Vt.book&&(Vt=JSON.parse(JSON.stringify(Vt)),Vt.book=Re.book),Pr(Vt,$e)},Re.stopFast=function($e,It){var Ht;Re.stopAll(function(){clearTimeout(Ht),$e(Re)}),Ht=setTimeout(function(){Re.restartEngine($e)},It||5e3)};function qt(){Re.uci(function(){Vt.settings&&Object.keys(Vt.settings).forEach(function(Ht){Re.setoption(Ht,Vt.settings[Ht])}),Re.ready=!0,Rn()})}function Rn(){Re.ready&&(Re.bookLoaded||!Re.pathToBook)&&et&&et(Re)}return typeof Worker>"u"?!1:(Vt.ceeMode&&(Hn(Re,Vt),Re.ceeVersion=function(){return JSON.parse(JSON.stringify(Nn))}),Xt=ae(Vt,Re),Xt.onmessage=Er,Vt.book&&(Re.book=Vt.book,Re.bookLoaded=!0,Re.pathToBook=Vt.pathToBook),Re.getFenFromMoves=U.getFenFromMoves,Re.getLegalMoves=U.getLegalMoves,Re.getPositionInfo=U.getPositionInfo,Re.isFenValid=U.isFenValid,Re.ready=!1,qt(),!Re.book&&Vt.pathToBook&&Re.loadBook(Vt.pathToBook,Rn),Re)}function Hn(Vt,et){var Re=1e3,Xt=0,un,cr;function or(Nn){function Er(Mr){var vr=Er.callbacks;Er.callbacks={},Er.original&&Er.original(Mr);for(var en in vr)vr[en](Mr)}return Er.callbacks={},Er.original=Nn,Er}et.onError=un=or(et.onError),et.onSignal=cr=or(et.onSignal);function ar(Nn,Er,Mr,vr){var en,qt=Date.now(),Rn=!1,$e=++Xt;function It(){clearTimeout(en),delete un.callbacks[$e],delete cr.callbacks[$e],Rn=!0}function Ht(oe){Rn||(It(),vr({data:oe,action:Er,uci:Nn},Nn))}function b(oe){Ht({msg:"CEE process crashed unexpectedly",code:U.ERROR_CODES.CRASH,exitCode:oe,err:new Error("CEE process exited with "+oe)})}un.callbacks[$e]=b,cr.callbacks[$e]=b,en=setTimeout(function(){Ht({msg:"CEE timed out",code:U.ERROR_CODES.TIMEOUT,timeout:Re,duration:Date.now()-qt,err:new Error("CEE timed out")})},Re);for(var se=0;se<Nn.length;++se)Vt.send(Nn[se]);Vt.send("fetch "+Er,function(fe){Rn||(It(),Mr(fe,Nn))},function(fe){fe.indexOf("info string CEEError")>=0?Ht({msg:"CEE crashed with error code",code:U.ERROR_CODES.ERROR,log:fe.match(/info string CEEError\s*(.*)/)[1],err:new Error(fe.match(/info string CEEError\s*(.*)/)[1])}):Vt.ceeDebug&&fe.indexOf("not recognized")>=0&&Ht({msg:"CEE received unknown UCI option (engine.ceeDebug mode on)",option:fe,code:U.ERROR_CODES.NONFATAL_ERROR,err:new Error(fe)})})}Vt.fetch=function(Nn,Er,Mr){var vr,en;Nn=Nn||[],vr=Nn.action||"analysis",Array.isArray(Nn)?en=Nn:(en=Nn.uciCommands?Nn.uciCommands.map(function(qt){return qt}):[],Nn.startFen&&(Nn.options=Nn.options||{},typeof Nn.options.ScoreWhiteToMove>"u"&&(Nn.options.ScoreWhiteToMove=!0),typeof Nn.options.SerializeLikeCEAC>"u"&&(Nn.options.SerializeLikeCEAC=!0),U.CEE_LIB.addOptions(en,Nn.options),U.CEE_LIB.addVariant(en,Nn.variant),U.CEE_LIB.addPosition(en,Nn.startFen)),U.CEE_LIB.addVariations(en,Nn.evals&&Nn.evals[0]),U.CEE_LIB.addVariations(en,Nn.threats&&Nn.threats[0],"threat-variation"),(Nn.moves||[]).forEach(function(qt,Rn){var $e=Rn+1;U.CEE_LIB.addPush(en,qt),U.CEE_LIB.addVariations(en,Nn.evals&&Nn.evals[$e]),U.CEE_LIB.addVariations(en,Nn.threats&&Nn.threats[$e],"threat-variation")})),ar(en,vr,Er,Mr)},Vt.fetch.setTimeout=function(Nn){Re=Nn},U.ERROR_CODES={TIMEOUT:1,CRASH:2,ERROR:3,NONFATAL_ERROR:4}}return Pr},ve=function(){var U=z(),Pe,Ie="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",jt=252,Xe=255,it={4:"p",5:"P",6:"p",8:"n",9:"N",10:"n",16:"b",17:"B",18:"b",32:"r",33:"R",34:"r",64:"q",65:"Q",66:"q",128:"k",129:"K",130:"k"},ln="pnbrq",v=512,C="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?{~}(^)[_]@#$,./&-*++=",G="qnrbkp";function ae(b){var se,oe=b.length,fe=[],Te,Ne,yn;for(se=0;se<oe;se+=2)yn={},Te=C.indexOf(b[se]),Ne=C.indexOf(b[se+1]),Ne>63&&(yn.promotion=G[Math.floor((Ne-64)/3)],Ne=Te+(Te<16?-8:8)+(Ne-1)%3-1),Te>75?yn.drop=G[Te-79]:yn.from=C[Te%8]+(Math.floor(Te/8)+1),yn.to=C[Ne%8]+(Math.floor(Ne/8)+1),fe.push(yn);return fe}function je(b){var se,oe,fe="",Te,Ne;for(Array.isArray(b)||(b=[b]),oe=b.length,se=0;se<oe;se+=1)b[se].drop?Te=79+G.indexOf(b[se].drop):Te=C.indexOf(b[se].from[0])+(b[se].from[1]-1)*8,Ne=C.indexOf(b[se].to[0])+(b[se].to[1]-1)*8,b[se].promotion&&(Ne=G.indexOf(b[se].promotion)*3+64+(Ne<Te?9+Ne-Te:Ne-Te-7)),fe+=C[Te]+C[Ne];return fe}function Ve(b){var se=b.split(" "),oe,fe=se.length,Te=[],Ne;if(b)for(oe=0;oe<fe;++oe)Ne=se[oe],Ne.length===4?Ne[1]==="@"?Te.push({drop:Ne[0].toLowerCase(),to:Ne.substr(2,2)}):Te.push({from:Ne.substr(0,2),to:Ne.substr(2,2)}):Te.push({from:Ne.substr(0,2),to:Ne.substr(2,2),promotion:Ne[4]});return Te}function K(b,se){return b.san===se.san||b.to===se.to&&(b.from===se.from||!b.from&&!se.from)&&(b.promotion===se.promotion||!b.promotion&&!se.promotion)&&(b.drop===se.drop||!b.drop&&!se.drop)}function Et(b,se,oe){var fe=[],Te,Ne,yn,F,he,we,Oe,y,T,x,H=1,O=8,X=1,Z=8,_t={verbose:!0};for(x=b.turn(),T=3-x,F=z("/",se),F.turn(T),oe&&(H=O=+oe[1],X=Z=oe.charCodeAt(0)-96),Te=H;Te<=O;++Te)for(Ne=X;Ne<=Z;++Ne)he=String.fromCharCode(Ne+96)+Te,yn=b.get(he),yn&&yn.color===T&&(F.put(yn,he,!0),yn.type==="p"?(we=String.fromCharCode(Ne-1+96)+(Te+(T===1?1:-1)),Oe=String.fromCharCode(Ne+1+96)+(Te+(T===1?1:-1)),F.put({type:"n",color:x},we,!0),F.put({type:"n",color:x},Oe,!0)):yn.type==="k"&&(y=b.fen().split(" ")[2],y!=="-"&&F.load(F.fen().replace(/^(\S+\s\S\s)(\S+)/,"$1"+y),se,!0,!0)),fe=fe.concat(F.moves(_t)),F.remove(he,!0),yn.type==="p"&&(F.remove(we,!0),F.remove(Oe,!0)));return se&&b.hand()&&(F._hand[T]=18721,fe=fe.concat(F.moves({verbose:!0}).filter(function(nt){return!oe||nt.to===oe}))),fe.forEach(function(nt){ar(nt)}),fe}function Gn(b,se){var oe=b.header().Variant,fe=Et(b,oe,se.from),Te,Ne,yn,F,he,we=3-b.turn();for(Te=fe.length-1;Te>=0;--Te)if(Ne=fe[Te],K(Ne,se)){yn=!0;break}if(yn)return Ne.drop?b.put({type:Ne.drop,color:we},Ne.to):(F=b.remove(Ne.from,!0),Ne.flags===U.FLAGS.KSIDE_CASTLE?(he=b.remove(oe==="Chess960"?Ne.to:"h"+Ne.from[1],!0),b.put(F,"g"+Ne.from[1],!0),b.put(he,"f"+Ne.from[1])):Ne.flags===U.FLAGS.QSIDE_CASTLE?(he=b.remove(oe==="Chess960"?Ne.to:"a"+Ne.from[1],!0),b.put(F,"c"+Ne.from[1],!0),b.put(he,"d"+Ne.from[1])):(Ne.promotion&&(F.type=Ne.promotion,F.promoted=!0),he=b.get(Ne.to),b.put(F,Ne.to,F.type!=="k"&&F.type!=="r"&&(!he||he.color!==we||he.type!=="r")))),Ne;if(se.from&&(b.turn(we),se=b.fixMove(se),b.turn(3-we),se))return Gn(b,{san:se,from:se.from})}function ur(b,se){var oe=se?{}:[],fe=b._board(),Te,Ne,yn;if(se)for(Te=112;Te>=0;++Te)Te&136&&(Te-=24),(Ne=fe[Te])&&(yn=C[Te&7]+(8-(Te>>4)),oe[yn]={type:it[Ne&jt],color:Ne&3,promoted:(Ne&v)!==0,square:yn});else for(Te=112;Te>=0;++Te)Te&136&&(Te-=24),(Ne=fe[Te])&&oe.push({type:it[Ne&jt],color:Ne&3,promoted:(Ne&v)!==0,rank:8-(Te>>4),file:(Te&7)+1});return oe}function Pr(b,se){var oe=Math.min(Math.max(.20773843*Math.atan(2.49085889*b/100-2.47841945*se/100)+.02262979*b/100-.02256839*se/100+.52239679,0),1),fe=Math.min(Math.max(-.20720905*Math.atan(2.49626837*b/100-2.48220286*se/100)+-.02352551*b/100+.02172627*se/100+.49443923,0),1),Te=Math.min(Math.max(Math.exp(.037043456*b/100+.178106427*se/100+-8.069742932)+.004823544*Math.exp(-1.364136591*Math.pow(b/100-se/100,2))+-.001625539,0),1),Ne=oe+fe+Te;return{w:oe/Ne,b:fe/Ne,d:Te/Ne}}function Hn(b,se){var oe,fe,Te,Ne;if(b=b||{},b.disableHashing=!0,oe=un(b),!oe)return null;if(se){if(Te=oe.move(se),!Te)return null;oe.extended||ar(Te)}return Ne=oe.fen(),!b.skipValidation&&!oe.isPositionValid(b)?null:(fe=Ne.split(" "),{fen:Ne,pieces:ur(oe),sideToMove:oe.turn(),castling:fe[2],epSquare:fe[3]==="-"?null:fe[3],halfMoves:+fe[4],moveNumber:+fe[5],move:Te,hand:oe.hand(),checks:oe.checks()})}function Vt(b){var se=un(b),oe,fe,Te,Ne,yn,F,he=[""],we=[],Oe,y,T;if(!se)return!1;for(y=se.header(),T=y.Variant||"",F=se.hashes(),oe=typeof se.origHistory=="function"?se.origHistory(!0):se.history(!0),yn=F.length,fe=[F[0][0],F[0][1]],we.push(W.to64BitHex(fe)+T),F[0]=W.to64BitHex(F[0]),Te=1;Te<yn;++Te)fe[0]=(fe[0]^F[Te][0]*(Te+58465))>>>0,fe[1]=(fe[1]^F[Te][1]*(Te+984))>>>0,F[Te]=W.to64BitHex(F[Te]),we.push(W.to64BitHex(fe)+T),Ne=Te-1,ar(oe[Ne]),Oe=(oe[Ne].from?oe[Ne].from:oe[Ne].drop.toUpperCase()+"@")+oe[Ne].to+(oe[Ne].promotion||""),Ne&&(Oe=he[Ne]+" "+Oe),he.push(Oe);return{startingFen:y.FEN||Ie,hashes:F,fingerprints:we,moves:he,variant:y.Variant}}function et(b,se,oe,fe){var Te,Ne,yn,F,he,we,Oe,y,T,x,H;for(oe=oe||{},typeof se=="string"&&(se=se.trim().split(" ")),yn=se.length,Te=0;Te<yn;Te+=1){if(se[Te].board==="b"||se[Te].board==="B"?he=b.siblingGame:he=b,typeof se[Te].moveLan=="string"?we=Ve(se[Te].moveLan)[0]:typeof se[Te]=="string"?we=Ve(se[Te])[0]:se[Te].san?we=se[Te].san:we=se[Te],!he.move(we))if(oe.autoPromote){if(oe.autoPromote===!0?we.promotion="q":we.promotion=oe.autoPromote,!he.move(we)){if(oe.skipBadLines)break;return!1}}else{if(oe.skipBadLines)break;return!1}if(Oe=he._history(),y=Oe[Oe.length-1],fe&&(T=parseInt(fe[Te],10)),(typeof T!="number"||isNaN(T))&&(T=parseInt(se[Te].time,10)),typeof T=="number"&&!isNaN(T)&&(y.time=T,T=void 0),se[Te].firstComment&&(Oe.initComment=se[Te].firstComment),se[Te].comment&&(y.comment=se[Te].comment),se[Te].annotation&&(y.annotation=se[Te].annotation),se[Te].additionalAnnotation&&(y.additionalAnnotation=se[Te].additionalAnnotation),se[Te].commands&&(y.commands=se[Te].commands),se[Te].lines)for(F=se[Te].lines.length,Ne=0;Ne<F;++Ne){if(x=b._history().id,b.createVariation(),H=et(b,se[Te].lines[Ne],oe),!H&&!oe.skipBadLines)return!1;b.selectLine(x)}}return!0}function Re(b,se,oe){var fe=[ae(se[0]),ae(se[1])],Te=[0,0],Ne=[0,0],yn=fe[0].length+fe[1].length,F=Math.max(oe[0][0]|0,oe[0][1]|0,oe[1][0]|0,oe[1][1]|0),he,we=[0,0],Oe=[0,0],y,T;for(F+=600-F%600,he=[[F,F],[F,F]];yn--;){if(Oe[0]=we[0]+he[0][Ne[0]]-oe[0][Te[0]]||0,Oe[1]=we[1]+he[1][Ne[1]]-oe[1][Te[1]]||0,y=Oe[0]<=Oe[1]?0:1,fe[y][Te[y]]||(y^=1),T=y?b.siblingGame:b,(!T.move(fe[y][Te[y]])||yn&&T.inCheckmate()&&T.undo(!0))&&(y^=1,T=y?b.siblingGame:b,!T.move(fe[y][Te[y]])))return!1;T._history()[Te[y]].time=oe[y][Te[y]],he[y][Ne[y]]=oe[y][Te[y]],we[y]=Oe[y],Ne[y]^=1,++Te[y]}return!0}function Xt(b){var se,oe=-1,fe=0,Te;function Ne(F,he,we){for(var Oe=F[he],y;typeof(y=Oe.parentId)=="number";){if(y===we)return Oe.atMoveNode;Oe=F[y]}return!1}function yn(F,he){var we={moveTime:F.moveTime,firstComment:F.firstComment,comment:F.comment,annotation:F.annotation,additionalAnnotation:F.additionalAnnotation,commands:F.commands};Object.keys(we).forEach(function(Oe){F[Oe]=he[Oe],he[Oe]=we[Oe]})}b.extended||(b.extended=!0,se={header:b.header,load:b.load,loadPgn:b.loadPgn,createVariation:b.createVariation,undo:b.undo,pgn:b.pgn},b._move=b.move,b.undo=function(){return b.siblingGame?b.deleteBughouseMove(b.curBughouseMove()):b.deletePosition(oe,fe)},b.getMove=function(F){return F&&(typeof F=="string"||F.to&&(F.from||F.drop))&&b._move(F)&&ar(se.undo())||null},b.premove=function(){var F,he=[];return{queue:he,move:function(we){var Oe;return F=F||z(b.fen(),b.header().Variant),Oe=Gn(F,we),!Oe||fe||oe!==b._history().length-1?(he.length||(F=void 0),null):(he.push(Oe),Oe)},consume:function(){var we=he.shift(),Oe,y,T;if(we){if(Oe=b.move(we),Oe){if(F=void 0,y=he.length,y)for(F=z(b.fen(),b.header().Variant),T=0;T<y;++T)Gn(F,he[T]);return Oe}b.premove.cancel()}},moves:function(we){return!fe&&oe===b._history().length-1&&Et(F||b,b.header().Variant,we)},getPieces:function(we){return ur(F||b,we)},fen:function(){return(F||b).fen()},cancel:function(){he.length=0,F=void 0}}}(),b.getPieces=function(F){return ur(b,F)},b.material=function(){var F=b.getPieces(),he={imbalance:0,white:{p:8,n:2,b:2,r:2,q:1,count:0},black:{p:8,n:2,b:2,r:2,q:1,count:0}},we,Oe={p:1,n:3,b:3,r:5,q:9,k:0},y,T;for(we=F.length-1;we>=0;--we)F[we].color===1?(y=he.white,T=he.black):(y=he.black,T=he.white),T[F[we].type]&&--T[F[we].type],y.count+=Oe[F[we].type];return he.imbalance=he.white.count-he.black.count,he},b.origHistory=b.history,b.history=function(F,he){var we=[],Oe,y=b._history(),T=y.length,x=b._lines(),H,O;for(typeof F=="boolean"&&(F={verbose:F}),F=F||{},he&&(F.noParentLines=he),F.toCurrent&&(T=b.ids().move+1);;){if(--T===-1)if(y.id&&!F.noParentLines){T=y.atMoveNode,y=x[y.parentId];continue}else break;if(F.verbose){Oe={};for(H in y[T])if(y[T][H]&&typeof y[T][H]=="object"){Oe[H]=y[T][H].constructor===Array?[]:{};for(O in y[T][H])Oe[H][O]=y[T][H][O]}else Oe[H]=y[T][H];we.unshift(Oe)}else we.unshift(y[T].san)}return we},b._getPos=function(F,he){var we,Oe,y;return typeof F!="number"&&(F=oe),typeof he!="number"&&(he=fe),Oe=b._lines(),we=Oe[he],F>=0?we[F]:we.id?we.atMoveNode?Oe[we.parentId][we.atMoveNode-1]:b._getPos(we.atMoveNode-1,we.parentId):(y={fen:se.header().FEN||Ie,hash:we.hash,initial:!0,ids:{move:-1,line:0}},b.siblingGame&&(y.bughouseOrder=-1),y)},b.move=function(F,he){var we,Oe=b._history(),y,T,x;if(F&&(typeof F=="string"||F.to&&(F.from||F.drop))){if(fe===Oe.id&&oe<Oe.length-1||he){if(b.moveForward(he,F))return!0;oe<Oe.length-1&&(b.selectPosition(oe+1),b.createVariation(),Oe=b._history())}b.siblingGame&&(T=b.isDependent?b.siblingGame.fen():b.fen()),we=b._move(F),we&&(ar(we),fe=Oe.id,oe=Oe.length-1,y=Oe[oe],x=b._getPos(oe-1),b.siblingGame?(y.fen=b.isDependent?b.siblingGame.fen():b.fen(),y.beforeFen=T,y.siblingIds=b.siblingGame.ids()):(y.fen=b.fen(),y.beforeFen=x.fen),x.initial?(y.moveNumber=0,y.previous=null):(y.moveNumber=x.moveNumber+1,y.previous=x.ids),fe&&oe===0&&b._lines()[Oe.parentId][Oe.atMoveNode].move===y.move&&(y.isContinuation=!0),y.flags=we.flags,y.to=we.to,y.from=we.from,y.drop=we.drop,y.capturedStr=we.captured,y.promotion=we.promotion,y.piece=we.piece,we.promoted&&(y.promoted=!0),we.capturedPromotedPawn&&(y.capturedPromotedPawn=!0),y.ids={move:oe,line:fe})}return we},b.moveDetails=function(F){return F=F||b._history()[oe],F&&(F.lines=F.lines||null,F.flags===U.FLAGS.KSIDE_CASTLE?(F.rookFrom=b.header().Variant==="Chess960"?F.to:"h"+F.to[1],F.rookTo="f"+F.to[1],F.kingTo="g"+F.to[1]):F.flags===U.FLAGS.QSIDE_CASTLE?(F.rookFrom=b.header().Variant==="Chess960"?F.to:"a"+F.to[1],F.rookTo="d"+F.to[1],F.kingTo="c"+F.to[1]):F.flags===U.FLAGS.EP_CAPTURE&&(F.epCapture=F.to[0]+F.from[1])),F},b.header=b.headers=function(F){var he=se.header(F);return b.siblingGame&&Xt(b.siblingGame),he},b.load=function(F,he,we,Oe){var y=se.load(F,he,we,Oe);return b.siblingGame&&Xt(b.siblingGame),y&&!we&&(oe=-1,fe=0),y},b.removeEmptyLines=function(){var F=b._lines(),he,we;for(he=F.length-1;he>0;--he)F[he].length||(F[he]=void 0,we=!0);we&&b.reorderLines()},b.loadPgn=function(F,he,we){var Oe=se.loadPgn(F,he,we),y=b._history();return b.removeEmptyLines(),oe=y.length-1,fe=y.id,fe&&b.selectLine(0),Oe},b.ids=function(){return{move:oe,line:fe}},b.selectLine=function(F){b.selectPosition(null,F)},b.curBughouseMove=function(){return Math.max(b._getPos().bughouseOrder,b.siblingGame._getPos().bughouseOrder)},b.deleteBughouseMove=function(F){var he=b.curBughouseMove(),we=!1,Oe=b,y,T,x;if(F>=0)for(he>=F&&b.selectBughouseMove(F-1);;){for(y=Oe._history(),T=y.length,x=0;x<T;++x)if(y[x].bughouseOrder>=F){y.length=x,we=!0;break}if(Oe===b.siblingGame)break;Oe=b.siblingGame}return we},b.selectBughouseMove=function(F){var he=b.isDependent?b.siblingGame:b,we=he,Oe,y;if(F===-1)return we.selectPosition(-1,0,!0),we.siblingGame.selectPosition(-1,0,!0),he.load(he.header().FEN,"Bughouse",!0,!0);for(;;){for(Oe=we._history(),y=Oe.length-1;y>=0;--y)if(Oe[y].bughouseOrder===F)return we.selectPosition(Oe[y].ids.move,0,!0),we.siblingGame.selectPosition(Oe[y].siblingIds.move,0,!0),he.load(Oe[y].fen,"Bughouse",!0,!0);if(we===he.siblingGame)return!1;we=he.siblingGame}},b.moveBackward=function(F){var he;if(b.siblingGame)return b.selectBughouseMove(b.curBughouseMove()-1);if(oe<=1)if(fe===0){if(oe===-1)return!1;b.selectPosition(oe-1)}else he=b._getPos(oe-1,fe),he.isContinuation&&!F&&(he=b._getPos(he.ids.move-1,he.ids.line),he=b._getPos(he.ids.move+1,he.ids.line)),b.selectPosition(he.ids.move,he.ids.line);else b.selectPosition(oe-1);return!0},b.moveForward=function(F,he){var we=b._lines(),Oe,y,T,x,H,O;if(b.siblingGame)return b.selectBughouseMove(b.curBughouseMove()+1);if(Oe=we[fe][oe+1],typeof he=="string"&&(he={san:he}),!Oe||he&&!K(he,Oe)){if(he&&Oe&&Oe.lines){for(H=Oe.lines.length,x=0;x<H;++x)if(T=we[Oe.lines[x]][0],T&&K(he,T)){Oe=T,O=!0;break}}if(!O&&F&&(y=we[fe][oe],y&&y.lines)){for(H=y.lines.length,x=0;x<H;++x)if(T=we[y.lines[x]][0],T&&T.isContinuation&&(T=we[y.lines[x]][1],T&&(!he||K(he,T)))){Oe=T,O=!0;break}}if(!O){try{if(he&&he.san&&(he=b.fixMove(he.san))||he&&he.to&&he.from&&Math.abs(he.to.charCodeAt(0)-he.from.charCodeAt(0))>1&&(he=b.fixMove(he)))return b.moveForward(F,he)}catch{}return!1}}return b.selectPosition(Oe.ids.move,Oe.ids.line)},b.moveVariation=function(F,he){var we=b._lines(),Oe=we[F],y,T,x;if(Oe&&Oe.id){for(y=we[Oe.parentId][Oe.atMoveNode].lines,T=y.length-1;T>=0;--T)if(y[T]===F&&(x=T-(he?1:-1),y[x]))return y[T]=y[x],y[x]=F,b.reorderLines(),!0}return!1},b.promoteVariation=function(F,he){for(var we=b._lines(),Oe=we[F],y,T,x,H,O,X;Oe&&Oe[0]&&Oe.id&&(he!==-1||Oe.parentId);){for(x=Oe.parentId,y=we[x],H=Oe.atMoveNode,Oe[0].lines=y[H].lines.concat(Oe[0].lines||[]),y[H].lines=void 0,X=y.length-H,T=y.splice(H,X),O=0;O<X;++O)T[O].ids.line=F,T[O].ids.move=O;for(T.id=F,T.parentId=x,T.atMoveNode=H,T.hash=Oe.hash,H===0?(T.initComment=y.initComment,y.initComment=Oe.initComment):Oe.initComment&&(y[H-1].comment=((y[H-1].comment||"")+" "+Oe.initComment).trim()),we[F]=T,X=Oe.length,O=0;O<X;++O)Oe[O].ids.line=x,Oe[O].ids.move=O+H,y.push(Oe[O]);for(T[0].isContinuation=!!Oe[0].isContinuation,y[H].isContinuation=!H&&typeof y.parentId=="number"&&we[y.parentId][y.atMoveNode].move===y[0].move,X=y[H].lines.length,O=0;O<X;++O)we[y[H].lines[O]].atMoveNode=H,we[y[H].lines[O]][0]&&(we[y[H].lines[O]][0].isContinuation=we[y[H].lines[O]][0].move===y[H].move);if(fe===F?(fe=x,oe+=H):fe===x&&oe>=H&&(fe=F,oe-=H),he===1)break;F=x,Oe=we[F]}return y!==void 0?(b._history(we[fe]),b.reorderLines(),!oe&&we[fe][0].isContinuation&&b.selectPosition(we[fe].atMoveNode,we[fe].parentId),!0):!1},b.reorderLines=function(F,he){var we=b._lines(),Oe,y,T,x,H,O,X,Z,_t,nt,Ue=!1;for(F?_t=he.length-1:(F=0,he=[we[0]],_t=0,Te=!1),Oe=we[F],T=Oe.length,y=0;y<T;++y)if(x=Oe[y],x.ids.line!==_t&&(Ue=!0,x.ids.line=_t),x.lines)for(H=x.lines.length,O=0;O<H;++O)X=x.lines[O],Z=we[X],Z?(Z.atMoveNode=y,nt=he.length,x.lines[O]=nt,Z.parentId=_t,!Te&&X===fe&&(Te=!0,fe=nt),he.push(Z),Ue=b.reorderLines(X,he)||Ue):(x.lines.length===1?delete x.lines:x.lines.splice(O,1),--O,--H);return F||b.saveLines(he,!0),Ue},b.createVariation=function(){var F=b._history(),he=b._lines(),we,Oe,y;return oe===F.length-1?(we=se.createVariation(),F=b._history(),oe=F.length-1,fe=F.id,we):oe===-1?!1:(Oe=[],y=F[oe],Oe.parentId=F.id,Oe.id=he.length,y.lines||(y.lines=[]),y.lines.push(Oe.id),Oe.hash=b._getPos(oe-1).hash,Oe.atMoveNode=oe,he.push(Oe),b.selectPosition(-1,Oe.id))},b.selectLineEnd=function(F){return b.siblingGame?b.selectBughouseMove(b._history().length+b.siblingGame._history().length-1):(typeof F!="number"&&(F=fe),F!==fe||oe<b._history().length-1?b.selectPosition(null,F,!0):!1)},b.selectLineStart=function(){var F,he;return b.siblingGame?b.selectBughouseMove(-1):fe?(oe>1||oe===1&&!b._getPos(0).isContinuation?F=b._history():(he=b._getPos(-1),F=b._lines()[he.ids.line]),b.selectPosition(F.id?F[1]&&F[0].isContinuation?1:0:-1,F.id)):oe===-1?!1:b.selectPosition(-1,0)},b.selectPosition=function(F,he,we){var Oe=b._lines(),y=b._history();if(typeof he=="number"&&(he!==fe||we)){if(he<0||he>=Oe.length)return!1;if(y=Oe[he],typeof F!="number")F=y.length-1;else if(F<-1||F>=y.length)return!1;fe=he,b._history(y),we=!0}if(typeof F=="number"&&(F!==oe||we)){if(F<-1||F>=y.length)return!1;se.load(b._getPos(F).fen,se.header().Variant,!0,!0),oe=F}return!0},b.resetToMainLine=function(){var F=b._lines();b.selectLineEnd(0),F.length>1&&(F.length=1,b.reorderLines())},b.updateNode=function(F,he,we){var Oe=b._lines(),y,T;we=typeof we=="number"?we:fe,he=typeof he=="number"?he:oe,y=Oe[we][he]||Oe[we];for(T in F)y[T]=F[T]},b.updateLineComment=function(F,he){b.updateNode({initComment:F},-1,he)},b.saveLines=function(F,he){var we=b._lines(),Oe,y=F.length,T,x;for(F!==we&&(we.length=0),T=0;T<y;++T){if(Oe=F[T],T&&typeof Oe.parentId!="number")return!1;F!==we&&we.push(Oe),Oe.id=T}return b._history(b._history()),he||(x=b.ids(),b.selectPosition(-1,0,!0),b.selectPosition(x.move,x.line)),!0},b.deletePosition=function(F,he){var we=b._lines(),Oe,y;return!we[he]||!we[he][F]&&(F!==-1||he===0)?!1:(he&&(F===0||F===1&&we[he][0].isContinuation)&&(F=-1),fe>0&&he!==fe?(Oe=Ne(we,fe,he),y=Oe!==!1&&Oe>=F):y=he===fe&&F<=oe,y&&(F>1?b.selectPosition(F-1,he):(b.selectPosition((we[he][0].isContinuation||F===1)&&we[he][1]?1:0,he),b.moveBackward())),F>0?we[he].length=F:he?we[he]=null:we[0].length=0,b.reorderLines(),b.ids())},b.mark=function(F,he){var we=oe<0?b._lines()[fe]:b._lines()[fe][oe],Oe=F.type,y=1;F.color&&(Oe==="arrow"?b.mark({key:F.color+F.key,type:"cal"},he):Oe==="square"&&b.mark({key:F.color+F.key,type:"csl"},he)),Oe!=="cal"&&Oe!=="csl"&&(Oe="c_"+Oe,y=0),we.commands&&we.commands[Oe]&&(we.commands[Oe]=we.commands[Oe].split(",").filter(function(x){return x.slice(y).split(";")[0]!==F.key.slice(y)}).join(","),we.commands[Oe]||delete we.commands[Oe]),he||(we.commands||(we.commands={}),we.commands[Oe]=(we.commands[Oe]?we.commands[Oe]+",":"")+F.key+(F.data?";"+F.data.join(";"):""))},b.markings=function(){var F={},he=oe<0?b._lines()[fe]:b._lines()[fe][oe],we,Oe,y,T={cal:"arrow",csl:"square"},x,H,O,X,Z;for(Oe in he.commands){if(y=he.commands[Oe],T[Oe])Oe=T[Oe],x=0;else if(Oe.substr(0,2)==="c_")Oe=Oe.slice(2),x=1;else continue;for(F[Oe]=F[Oe]||{},H=y.split(","),O=H.length,we=0;we<O;++we)x?(X=H[we].split(";"),Z=X.shift(),F[Oe][Z]=F[Oe][Z]||{type:Oe,key:Z},F[Oe][Z].data=X):(Z=H[we].slice(1),F[Oe][Z]=F[Oe][Z]||{type:Oe,key:Z},F[Oe][Z].color=H[we][0])}return F},b.clearMarkings=function(){var F=oe<0?b._lines()[fe]:b._lines()[fe][oe],he;for(he in F.commands)/^c[sa]l$|^c_/.test(he)&&delete F.commands[he]},b.pgn=function(F){var he=b.ids(),we;return b.selectLineEnd(0),we=se.pgn(F),b.selectPosition(he.move,he.line),we},b.loadMoves=function(F,he){var we,Oe,y,T,x;if(he=he||{},typeof F=="string"&&(F=ae(F)),F){for(he.atCurrent||b.selectPosition(-1,0),y=fe,Oe=F.length,we=0;we<Oe;++we){if(T=b.move(F[we],!0),!T&&(F[we].promotion=he.autoPromote===!0?"q":he.autoPromote,T=b.move(F[we],!0),!T))return!1;fe!==y&&he.method!=="merge"&&(b.promoteVariation(fe,1),he.method!=="promote"&&(b._history()[oe].lines=void 0,b.reorderLines()),y=fe)}if(he.method==="promote"){if(Oe){for(b._history()[oe+1]&&(T=b._history()[oe],b.createVariation(),b.move(T),yn(b._history()[0],T),b.promoteVariation(fe,1)),x=b._lines(),we=x.length-1;we>=0;--we)x[we].length===1&&x[we][0].isContinuation&&(yn(x[we][0],x[x[we].parentId][x[we].atMoveNode]),x[we].length=0);b.removeEmptyLines()}}else he.method!=="merge"&&b.deletePosition(oe+1,fe)}return!0})}function un(b){var se,oe;if(b=b||{},b.game)return b.game;if(se=z(),b.analysis&&Xt(se),b.disableHashing&&se.hashing(!1),b.pgn){if(!se.loadPgn(b.pgn,b.index,b.options)&&(b.variant!=="detect"||!z.variants.some(function(fe){return b.options=b.options||{},b.options.variant=fe,se.loadPgn(b.pgn,b.index,b.options)})))return!1}else{if(b.headers&&(b.variant=b.headers.Variant||b.variant,b.fen||(b.fen=b.headers.FEN)),b.variant==="detect"&&b.fen&&(b.fen.indexOf("|")>-1?b.variant="Bughouse":b.fen.split("/").length===9?b.variant="Crazyhouse":b.fen.indexOf("+")>-1?b.variant="3-check":b.variant=void 0),(b.fen||b.variant)&&!se.load(b.fen||Ie,b.variant))return!1;b.headers&&typeof b.headers=="object"&&!Array.isArray(b.headers)&&se.header(b.headers)}if(b.tcn)if(typeof b.tcn=="object"){if(!Re(se,b.tcn,b.timestamps||[[],[]]))return!1}else oe=ae(b.tcn);else oe=b.moves;return oe&&!et(se,oe,b,b.timestamps)?!1:se}function cr(b){var se;return b=b||{},b.disableHashing=!0,se=un(b),se?se.pgn(b):!1}function or(b,se){var oe,fe=[],Te;if(U.reset(),!U.loadPgn(b))return!1;if(oe=U.moveCount(),typeof se=="number"){for(se<0&&(se=oe+se+1),Te=oe-1;Te>=se&&Te>=0;Te-=1)U.undo();return U.fen()}for(Te=0;Te<=oe;Te+=1)fe.unshift(U.fen()),U.undo();return fe}function ar(b){return b&&(b.piece&v&&(b.promoted=!0),b.piece=it[b.piece&jt],b.captured&&(b.captured&v&&(b.capturedPromotedPawn=!0),b.captured=it[b.captured&Xe]),b.promotion&&(b.promotion=it[b.promotion&jt]),b.drop!==void 0&&(b.drop=ln[b.drop])),b}function Nn(b){var se=b.history(!0,!0),oe,fe,Te,Ne,yn,F,he;if(b.siblingGame){for(oe=b.siblingGame.history(!0,!0),Te=se.length+oe.length,fe=[],Ne=0;Ne<Te;++Ne)!se.length||oe.length&&oe[0].bughouseOrder<se[0].bughouseOrder?(yn=oe.shift(),yn.board="b"):(yn=se.shift(),yn.board="a"),fe.push(yn);se=fe}for(Te=se.length,Ne=0;Ne<Te;++Ne)if(F=se[Ne],F.fen||ar(F),F.lines)for(he=F.lines.length-1;he>=0;--he)b.selectLine(F.lines[he]),F.lines[he]=Nn(b).moves;return{moves:se}}function Er(b,se,oe){var fe=[],Te,Ne=U;return typeof se!="number"&&(oe=se,se=void 0),Te=Ne.tokenizePgn(b,oe),se<0&&(se=Te.length+se),Te?(oe&&oe.includeFen&&(Ne=un({analysis:!0})),Te.forEach(function(yn,F){var he,we;F===se||se===void 0?Ne.loadPgn([yn],0,oe)?(we=Nn(Ne),he=Ne.header(),fe.push({headers:he,moves:we.moves})):fe.push(!1):fe.push(void 0)}),typeof se=="number"?fe[se]:fe):!1}function Mr(b,se,oe){return U.reset(),U.load(se,oe)?ar(U.move(b)):!1}function vr(b,se){return U.completeFen(b).split(" ").slice(0,se||4).join(" ")}function en(b,se,oe){return U.reset(),U.load(b,oe),se&&!et(U,se)?!1:U.fen()}function qt(b,se){var oe,fe,Te,Ne;if(typeof b=="string"){if(fe=U,fe.reset(),!fe.load(b,se))return null}else fe=un(b);for(oe=fe.moves({verbose:!0}),Ne=oe.length,Te=0;Te<Ne;++Te)ar(oe[Te]);return oe}function Rn(b,se,oe){var fe,Te={gameOver:!1,check:!1,checkmate:!1,draw:!1,stalemate:!1,threefold:!1,insufficient:!1},Ne;if(Array.isArray(se)||(oe=se,se=null),typeof oe=="boolean"?(fe=oe,oe={}):(oe=oe||{},fe=oe.variant),typeof b=="string"){if(Ne=U,Ne.reset(),Ne.validateFen(b,fe)!==0||!Ne.load(b,fe))return!1}else Ne=un(b);return se&&!et(Ne,se)?!1:(oe.getLegalMoves&&(Te.legalMoves=qt({game:Ne})),Ne.inCheck()?(Te.check=!0,Te.checkmate=Ne.inCheckmate()):Te.stalemate=Ne.inStalemate(),Te.threefold=Ne.inThreefoldRepetition(),Te.insufficient=Ne.insufficientMaterial(oe.color),Te.fiftyMoveRule=Ne.in50MoveRule(),Te.draw=Te.stalemate||Te.threefold||Te.insufficient||Te.fiftyMoveRule||Ne.inDraw(),oe.skipValidation||(Te.isValid=Ne.isPositionValid(oe)),fe&&(Te.variantWin=Ne.isVariantWin(),Te.variantWin===void 0&&(Te.variantWin=Ne.isBughouseWin())),Te.gameOver=Te.checkmate||Te.draw||!!Te.variantWin,Te)}function $e(b,se){return U.validateFen(b,se)===0}function It(b,se){W.loadBook(b,function(fe,Te){if(!Te||!Te.json)return se(fe||new Error("Invalid book"));se(fe,function(yn){var F,he,we,Oe,y,T,x,H,O;if(yn.hash)typeof yn.hash=="string"?he=[W.hex64ToDec(yn.hash)]:he=[yn.hash],Oe=1;else{if(F=un(yn),!F)return!1;he=F.hashes(),Oe=he.length}for(we=0;we<Oe;++we)if(y=Te.json[W.to64BitHex(he[we])],y){if(y.constructor===Array)if(T&&y[0].m.indexOf(T.m)===-1){for(H=y.length-1;H>=0;--H)if(!H||y[H].m.indexOf(T.m)!==-1){O=y[H],O.e=y[0].e,O.s=y[0].s,O.mate=y[0].mate,O.v=y[0].v,O.h=y[0].h,O.n=O.n||y[0].n,O.u=O.u||y[0].u,O.c=O.c||y[0].c;break}}else O=y[0];else O=y;(O.n||yn.allowNameless)&&(T=O)}else yn.mustEndInBook&&(T=void 0);if(T)return x={name:T.n},T.m&&(x.moves=T.m),T.d!==void 0&&(x.sdiff=T.d/100),T.c&&(x.code=T.c,x.url=T.u||T.n.replace(/[\u00e1-\u00e5]/g,"a").replace(/[\u0107\u010d]/g,"c").replace(/[\u00e9\u00e8\u0117\u0113]/g,"e").replace(/[\u00f3\u00f6\u00f8]/g,"o").replace(/[\u016f\u00fc]/g,"u").replace(/['+,]/g,"").replace(/[^a-z0-9.]+/ig,"-").replace(/(with-\d|St)\.+-?/,"$1-")),T.e?(x.eval=T.e,x.depth=T.h,x.score=T.e[0].cp/100,T.e[0].mate!==void 0&&(x.mate=T.e[0].mate)):(x.score=T.s/100,T.mate!==void 0&&(x.mate=T.mate)),T.v&&(x.bad=!0),x},Te.json)})}function Ht(b,se){return Pe=Pe||k(Ht),Pe(b,se)}return Ht.supportsMultithreading=function(){var b,se=!!Ht._hasThreads;if(typeof Ht._hasThreads!="boolean"){try{b=new Worker("data:application/javascript,"),b.postMessage(new SharedArrayBuffer(1)),se=!0}catch{}try{b.terminate()}catch{}Ht._hasThreads=se}return se},Ht.gameFingerprints=Vt,Ht.getFenFromMoves=en,Ht.getLegalMoves=qt,Ht.getPositionInfo=Rn,Ht.isFenValid=$e,Ht.encodeTCN=je,Ht.decodeTCN=ae,Ht.uciToObj=Ve,Ht.generatePgn=cr,Ht.pgnToFen=or,Ht.pgnToJson=Er,Ht.sanToObj=Mr,Ht.completeFen=U.completeFen,Ht.shortenFen=vr,Ht.createGame=un,Ht.getPositionDetails=Hn,Ht.predict=Pr,Ht.normalizeMoveObj=ar,Ht.FLAGS=U.FLAGS,Ht.loadECO=It,Ht.CEE_LIB=function(){var b={};return b.addOptions=function(se,oe){for(var fe in oe)oe[fe]!==void 0&&se.push("setoption name "+fe+" value "+oe[fe]);return se},b.addVariations=function(se,oe,fe){var Te,Ne;oe=oe||[],fe=fe||"variation";for(var yn=0;yn<oe.length;++yn)Te=oe[yn],Te.pv=Array.isArray(Te.pv)&&Te.pv.join(" ")||Te.pv||"",Ne=fe+" "+Te.pv,typeof Te.mateIn=="number"?Ne+=" mate "+Te.mateIn:typeof Te.mate=="number"?Ne+=" mate "+Te.mate:Ne+=" cp "+Math.round(Te.cp),typeof Te.depth=="number"&&(Ne+=" depth "+Te.depth),se.push(Ne);return se},b.addPush=function(se,oe){var fe;return typeof oe=="string"&&(oe={moveLan:oe}),fe="push "+oe.moveLan,oe.isBook&&(fe+=" isBook"),oe.isRetry&&(fe+=" isRetry"),se.push(fe),se},b.addPosition=function(se,oe){return se.push("position fen "+oe),se},b.addVariant=function(se,oe){return String(oe).toLowerCase().replace(/ |-/g,"")==="chess960"?(se.push("setoption name UCI_Variant value chess"),se.push("setoption name UCI_Chess960 value "+!0)):(se.push("setoption name UCI_Variant value chess"),se.push("setoption name UCI_Chess960 value "+!1)),se},b}(),Ht}();return $.exports=ve,ve})()})(ne);var q=ne.exports,te=function $(W,z){if(W===z)return!0;if(W&&z&&typeof W=="object"&&typeof z=="object"){if(W.constructor!==z.constructor)return!1;var k,ve,U;if(Array.isArray(W)){if(k=W.length,k!=z.length)return!1;for(ve=k;ve--!==0;)if(!$(W[ve],z[ve]))return!1;return!0}if(W.constructor===RegExp)return W.source===z.source&&W.flags===z.flags;if(W.valueOf!==Object.prototype.valueOf)return W.valueOf()===z.valueOf();if(W.toString!==Object.prototype.toString)return W.toString()===z.toString();if(U=Object.keys(W),k=U.length,k!==Object.keys(z).length)return!1;for(ve=k;ve--!==0;)if(!Object.prototype.hasOwnProperty.call(z,U[ve]))return!1;for(ve=k;ve--!==0;){var Pe=U[ve];if(!$(W[Pe],z[Pe]))return!1}return!0}return W!==W&&z!==z};function He(){const $=[];return{emit:W,listeners:$,off:z,offAll:k,offMany:ve,on:U,onAll:Pe,onMany:Ie,once:jt};function W(Xe,it){let ln;for(ln of $)ln.type!==Xe&&ln.type!=="all"||ln.handler(it)}function z(Xe){const it=$.findIndex(ln=>Xe.type===ln.type&&Xe.handler===ln.handler);it!==-1&&$.splice(it,1)}function k(Xe){return z({handler:Xe,type:"all"})}function ve(Xe=[]){Xe.forEach(it=>z(it))}function U(Xe,it){const ln={handler:it,type:Xe};$.push(ln)}function Pe(Xe){U("all",Xe)}function Ie(Xe=[],it){Xe.forEach(ln=>U(ln,it))}function jt(Xe,it){const ln={handler:(...v)=>{z(ln),it(...v)},type:Xe};$.push(ln)}}var Ge;(function($){(function(W){(function(z){z.NoTransition="NoTransition",z.OnEnter="Enter",z.OnExit="Exit",z.OnReEnter="ReEnter"})(W.Types||(W.Types={}))})($.Event||($.Event={}))})(Ge||(Ge={}));function Le({data:$,initialState:W,states:z},k=He()){let ve=W;return Object.assign(Object.assign({},k),{getCurrentState:U,getData:Pe,transition:Ie});function U(){return ve}function Pe(){return Object.assign({},$)}function Ie(jt,Xe){if(!z[ve][jt])return k.emit(Ge.Event.Types.NoTransition,{action:jt,data:$,state:ve}),!1;const it=z[ve][jt](Xe),ln=typeof it=="string"?it:it.nextState,v=C=>({action:jt,currentState:ve,data:$,event:C,nextState:ln,params:Xe});return ve!==ln&&k.emit(Ge.Event.Types.OnExit,v(Ge.Event.Types.OnExit)),it.data&&Object.assign($,it.data),ve!==ln&&k.emit(Ge.Event.Types.OnEnter,v(Ge.Event.Types.OnEnter)),ve===ln?k.emit(Ge.Event.Types.OnReEnter,v(Ge.Event.Types.OnReEnter)):ve=ln,!0}}const Me=["mousedown","keydown","touchstart","touchend"];let ge=!1;function Ce($){ge||(ge=!0,Me.forEach(W=>window.addEventListener(W,$)))}function Be($){ge&&(ge=!1,Me.forEach(W=>window.removeEventListener(W,$)))}function De($,W){function z(k){var ve;((ve=k?.data)===null||ve===void 0?void 0:ve.key)===$&&(W(),window.removeEventListener("message",z))}window.addEventListener("message",z)}const M=window.chesscom||{},Je=window.AudioContext||window.webkitAudioContext;let zt=!!Je;function cn(){try{return new Je}catch{return null}}function xt(){return zt}function yr($){if(Je){if(M.audioContext||(M.audioContext=cn()),!M.audioContext||!M.audioContext.resume){zt=!1,$();return}M.audioContext.resume().then(()=>{zt=!1,$()})}}var Kn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Fe.g<"u"?Fe.g:typeof self<"u"?self:{};function ht($){var W={exports:{}};return $(W,W.exports),W.exports}/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var bt=ht(function($,W){(function(){var z=function(){this.init()};z.prototype={init:function(){var v=this||k;return v._counter=1e3,v._html5AudioPool=[],v.html5PoolSize=10,v._codecs={},v._howls=[],v._muted=!1,v._volume=1,v._canPlayEvent="canplaythrough",v._navigator=typeof window<"u"&&window.navigator?window.navigator:null,v.masterGain=null,v.noAudio=!1,v.usingWebAudio=!0,v.autoSuspend=!0,v.ctx=null,v.autoUnlock=!0,v._setup(),v},volume:function(v){var C=this||k;if(v=parseFloat(v),C.ctx||ln(),typeof v<"u"&&v>=0&&v<=1){if(C._volume=v,C._muted)return C;C.usingWebAudio&&C.masterGain.gain.setValueAtTime(v,k.ctx.currentTime);for(var G=0;G<C._howls.length;G++)if(!C._howls[G]._webAudio)for(var ae=C._howls[G]._getSoundIds(),je=0;je<ae.length;je++){var Ve=C._howls[G]._soundById(ae[je]);Ve&&Ve._node&&(Ve._node.volume=Ve._volume*v)}return C}return C._volume},mute:function(v){var C=this||k;C.ctx||ln(),C._muted=v,C.usingWebAudio&&C.masterGain.gain.setValueAtTime(v?0:C._volume,k.ctx.currentTime);for(var G=0;G<C._howls.length;G++)if(!C._howls[G]._webAudio)for(var ae=C._howls[G]._getSoundIds(),je=0;je<ae.length;je++){var Ve=C._howls[G]._soundById(ae[je]);Ve&&Ve._node&&(Ve._node.muted=v?!0:Ve._muted)}return C},stop:function(){for(var v=this||k,C=0;C<v._howls.length;C++)v._howls[C].stop();return v},unload:function(){for(var v=this||k,C=v._howls.length-1;C>=0;C--)v._howls[C].unload();return v.usingWebAudio&&v.ctx&&typeof v.ctx.close<"u"&&(v.ctx.close(),v.ctx=null,ln()),v},codecs:function(v){return(this||k)._codecs[v.replace(/^x-/,"")]},_setup:function(){var v=this||k;if(v.state=v.ctx&&v.ctx.state||"suspended",v._autoSuspend(),!v.usingWebAudio)if(typeof Audio<"u")try{var C=new Audio;typeof C.oncanplaythrough>"u"&&(v._canPlayEvent="canplay")}catch{v.noAudio=!0}else v.noAudio=!0;try{var C=new Audio;C.muted&&(v.noAudio=!0)}catch{}return v.noAudio||v._setupCodecs(),v},_setupCodecs:function(){var v=this||k,C=null;try{C=typeof Audio<"u"?new Audio:null}catch{return v}if(!C||typeof C.canPlayType!="function")return v;var G=C.canPlayType("audio/mpeg;").replace(/^no$/,""),ae=v._navigator?v._navigator.userAgent:"",je=ae.match(/OPR\/([0-6].)/g),Ve=je&&parseInt(je[0].split("/")[1],10)<33,K=ae.indexOf("Safari")!==-1&&ae.indexOf("Chrome")===-1,Et=ae.match(/Version\/(.*?) /),Gn=K&&Et&&parseInt(Et[1],10)<15;return v._codecs={mp3:!!(!Ve&&(G||C.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!G,opus:!!C.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!C.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!C.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(C.canPlayType('audio/wav; codecs="1"')||C.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!C.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!C.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(C.canPlayType("audio/x-m4a;")||C.canPlayType("audio/m4a;")||C.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(C.canPlayType("audio/x-m4b;")||C.canPlayType("audio/m4b;")||C.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(C.canPlayType("audio/x-mp4;")||C.canPlayType("audio/mp4;")||C.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!Gn&&C.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!Gn&&C.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!C.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(C.canPlayType("audio/x-flac;")||C.canPlayType("audio/flac;")).replace(/^no$/,"")},v},_unlockAudio:function(){var v=this||k;if(!(v._audioUnlocked||!v.ctx)){v._audioUnlocked=!1,v.autoUnlock=!1,!v._mobileUnloaded&&v.ctx.sampleRate!==44100&&(v._mobileUnloaded=!0,v.unload()),v._scratchBuffer=v.ctx.createBuffer(1,1,22050);var C=function(G){for(;v._html5AudioPool.length<v.html5PoolSize;)try{var ae=new Audio;ae._unlocked=!0,v._releaseHtml5Audio(ae)}catch{v.noAudio=!0;break}for(var je=0;je<v._howls.length;je++)if(!v._howls[je]._webAudio)for(var Ve=v._howls[je]._getSoundIds(),K=0;K<Ve.length;K++){var Et=v._howls[je]._soundById(Ve[K]);Et&&Et._node&&!Et._node._unlocked&&(Et._node._unlocked=!0,Et._node.load())}v._autoResume();var Gn=v.ctx.createBufferSource();Gn.buffer=v._scratchBuffer,Gn.connect(v.ctx.destination),typeof Gn.start>"u"?Gn.noteOn(0):Gn.start(0),typeof v.ctx.resume=="function"&&v.ctx.resume(),Gn.onended=function(){Gn.disconnect(0),v._audioUnlocked=!0,document.removeEventListener("touchstart",C,!0),document.removeEventListener("touchend",C,!0),document.removeEventListener("click",C,!0),document.removeEventListener("keydown",C,!0);for(var ur=0;ur<v._howls.length;ur++)v._howls[ur]._emit("unlock")}};return document.addEventListener("touchstart",C,!0),document.addEventListener("touchend",C,!0),document.addEventListener("click",C,!0),document.addEventListener("keydown",C,!0),v}},_obtainHtml5Audio:function(){var v=this||k;if(v._html5AudioPool.length)return v._html5AudioPool.pop();var C=new Audio().play();return C&&typeof Promise<"u"&&(C instanceof Promise||typeof C.then=="function")&&C.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(v){var C=this||k;return v._unlocked&&C._html5AudioPool.push(v),C},_autoSuspend:function(){var v=this;if(!(!v.autoSuspend||!v.ctx||typeof v.ctx.suspend>"u"||!k.usingWebAudio)){for(var C=0;C<v._howls.length;C++)if(v._howls[C]._webAudio){for(var G=0;G<v._howls[C]._sounds.length;G++)if(!v._howls[C]._sounds[G]._paused)return v}return v._suspendTimer&&clearTimeout(v._suspendTimer),v._suspendTimer=setTimeout(function(){if(v.autoSuspend){v._suspendTimer=null,v.state="suspending";var ae=function(){v.state="suspended",v._resumeAfterSuspend&&(delete v._resumeAfterSuspend,v._autoResume())};v.ctx.suspend().then(ae,ae)}},3e4),v}},_autoResume:function(){var v=this;if(!(!v.ctx||typeof v.ctx.resume>"u"||!k.usingWebAudio))return v.state==="running"&&v.ctx.state!=="interrupted"&&v._suspendTimer?(clearTimeout(v._suspendTimer),v._suspendTimer=null):v.state==="suspended"||v.state==="running"&&v.ctx.state==="interrupted"?(v.ctx.resume().then(function(){v.state="running";for(var C=0;C<v._howls.length;C++)v._howls[C]._emit("resume")}),v._suspendTimer&&(clearTimeout(v._suspendTimer),v._suspendTimer=null)):v.state==="suspending"&&(v._resumeAfterSuspend=!0),v}};var k=new z,ve=function(v){var C=this;if(!v.src||v.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}C.init(v)};ve.prototype={init:function(v){var C=this;return k.ctx||ln(),C._autoplay=v.autoplay||!1,C._format=typeof v.format!="string"?v.format:[v.format],C._html5=v.html5||!1,C._muted=v.mute||!1,C._loop=v.loop||!1,C._pool=v.pool||5,C._preload=typeof v.preload=="boolean"||v.preload==="metadata"?v.preload:!0,C._rate=v.rate||1,C._sprite=v.sprite||{},C._src=typeof v.src!="string"?v.src:[v.src],C._volume=v.volume!==void 0?v.volume:1,C._xhr={method:v.xhr&&v.xhr.method?v.xhr.method:"GET",headers:v.xhr&&v.xhr.headers?v.xhr.headers:null,withCredentials:v.xhr&&v.xhr.withCredentials?v.xhr.withCredentials:!1},C._duration=0,C._state="unloaded",C._sounds=[],C._endTimers={},C._queue=[],C._playLock=!1,C._onend=v.onend?[{fn:v.onend}]:[],C._onfade=v.onfade?[{fn:v.onfade}]:[],C._onload=v.onload?[{fn:v.onload}]:[],C._onloaderror=v.onloaderror?[{fn:v.onloaderror}]:[],C._onplayerror=v.onplayerror?[{fn:v.onplayerror}]:[],C._onpause=v.onpause?[{fn:v.onpause}]:[],C._onplay=v.onplay?[{fn:v.onplay}]:[],C._onstop=v.onstop?[{fn:v.onstop}]:[],C._onmute=v.onmute?[{fn:v.onmute}]:[],C._onvolume=v.onvolume?[{fn:v.onvolume}]:[],C._onrate=v.onrate?[{fn:v.onrate}]:[],C._onseek=v.onseek?[{fn:v.onseek}]:[],C._onunlock=v.onunlock?[{fn:v.onunlock}]:[],C._onresume=[],C._webAudio=k.usingWebAudio&&!C._html5,typeof k.ctx<"u"&&k.ctx&&k.autoUnlock&&k._unlockAudio(),k._howls.push(C),C._autoplay&&C._queue.push({event:"play",action:function(){C.play()}}),C._preload&&C._preload!=="none"&&C.load(),C},load:function(){var v=this,C=null;if(k.noAudio){v._emit("loaderror",null,"No audio support.");return}typeof v._src=="string"&&(v._src=[v._src]);for(var G=0;G<v._src.length;G++){var ae,je;if(v._format&&v._format[G])ae=v._format[G];else{if(je=v._src[G],typeof je!="string"){v._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}ae=/^data:audio\/([^;,]+);/i.exec(je),ae||(ae=/\.([^.]+)$/.exec(je.split("?",1)[0])),ae&&(ae=ae[1].toLowerCase())}if(ae||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),ae&&k.codecs(ae)){C=v._src[G];break}}if(!C){v._emit("loaderror",null,"No codec support for selected audio sources.");return}return v._src=C,v._state="loading",window.location.protocol==="https:"&&C.slice(0,5)==="http:"&&(v._html5=!0,v._webAudio=!1),new U(v),v._webAudio&&Ie(v),v},play:function(v,C){var G=this,ae=null;if(typeof v=="number")ae=v,v=null;else{if(typeof v=="string"&&G._state==="loaded"&&!G._sprite[v])return null;if(typeof v>"u"&&(v="__default",!G._playLock)){for(var je=0,Ve=0;Ve<G._sounds.length;Ve++)G._sounds[Ve]._paused&&!G._sounds[Ve]._ended&&(je++,ae=G._sounds[Ve]._id);je===1?v=null:ae=null}}var K=ae?G._soundById(ae):G._inactiveSound();if(!K)return null;if(ae&&!v&&(v=K._sprite||"__default"),G._state!=="loaded"){K._sprite=v,K._ended=!1;var Et=K._id;return G._queue.push({event:"play",action:function(){G.play(Et)}}),Et}if(ae&&!K._paused)return C||G._loadQueue("play"),K._id;G._webAudio&&k._autoResume();var Gn=Math.max(0,K._seek>0?K._seek:G._sprite[v][0]/1e3),ur=Math.max(0,(G._sprite[v][0]+G._sprite[v][1])/1e3-Gn),Pr=ur*1e3/Math.abs(K._rate),Hn=G._sprite[v][0]/1e3,Vt=(G._sprite[v][0]+G._sprite[v][1])/1e3;K._sprite=v,K._ended=!1;var et=function(){K._paused=!1,K._seek=Gn,K._start=Hn,K._stop=Vt,K._loop=!!(K._loop||G._sprite[v][2])};if(Gn>=Vt){G._ended(K);return}var Re=K._node;if(G._webAudio){var Xt=function(){G._playLock=!1,et(),G._refreshBuffer(K);var ar=K._muted||G._muted?0:K._volume;Re.gain.setValueAtTime(ar,k.ctx.currentTime),K._playStart=k.ctx.currentTime,typeof Re.bufferSource.start>"u"?K._loop?Re.bufferSource.noteGrainOn(0,Gn,86400):Re.bufferSource.noteGrainOn(0,Gn,ur):K._loop?Re.bufferSource.start(0,Gn,86400):Re.bufferSource.start(0,Gn,ur),Pr!==1/0&&(G._endTimers[K._id]=setTimeout(G._ended.bind(G,K),Pr)),C||setTimeout(function(){G._emit("play",K._id),G._loadQueue()},0)};k.state==="running"&&k.ctx.state!=="interrupted"?Xt():(G._playLock=!0,G.once("resume",Xt),G._clearTimer(K._id))}else{var un=function(){Re.currentTime=Gn,Re.muted=K._muted||G._muted||k._muted||Re.muted,Re.volume=K._volume*k.volume(),Re.playbackRate=K._rate;try{var ar=Re.play();if(ar&&typeof Promise<"u"&&(ar instanceof Promise||typeof ar.then=="function")?(G._playLock=!0,et(),ar.then(function(){G._playLock=!1,Re._unlocked=!0,C?G._loadQueue():G._emit("play",K._id)}).catch(function(){G._playLock=!1,G._emit("playerror",K._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),K._ended=!0,K._paused=!0})):C||(G._playLock=!1,et(),G._emit("play",K._id)),Re.playbackRate=K._rate,Re.paused){G._emit("playerror",K._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}v!=="__default"||K._loop?G._endTimers[K._id]=setTimeout(G._ended.bind(G,K),Pr):(G._endTimers[K._id]=function(){G._ended(K),Re.removeEventListener("ended",G._endTimers[K._id],!1)},Re.addEventListener("ended",G._endTimers[K._id],!1))}catch(Nn){G._emit("playerror",K._id,Nn)}};Re.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(Re.src=G._src,Re.load());var cr=window&&window.ejecta||!Re.readyState&&k._navigator.isCocoonJS;if(Re.readyState>=3||cr)un();else{G._playLock=!0,G._state="loading";var or=function(){G._state="loaded",un(),Re.removeEventListener(k._canPlayEvent,or,!1)};Re.addEventListener(k._canPlayEvent,or,!1),G._clearTimer(K._id)}}return K._id},pause:function(v){var C=this;if(C._state!=="loaded"||C._playLock)return C._queue.push({event:"pause",action:function(){C.pause(v)}}),C;for(var G=C._getSoundIds(v),ae=0;ae<G.length;ae++){C._clearTimer(G[ae]);var je=C._soundById(G[ae]);if(je&&!je._paused&&(je._seek=C.seek(G[ae]),je._rateSeek=0,je._paused=!0,C._stopFade(G[ae]),je._node))if(C._webAudio){if(!je._node.bufferSource)continue;typeof je._node.bufferSource.stop>"u"?je._node.bufferSource.noteOff(0):je._node.bufferSource.stop(0),C._cleanBuffer(je._node)}else(!isNaN(je._node.duration)||je._node.duration===1/0)&&je._node.pause();arguments[1]||C._emit("pause",je?je._id:null)}return C},stop:function(v,C){var G=this;if(G._state!=="loaded"||G._playLock)return G._queue.push({event:"stop",action:function(){G.stop(v)}}),G;for(var ae=G._getSoundIds(v),je=0;je<ae.length;je++){G._clearTimer(ae[je]);var Ve=G._soundById(ae[je]);Ve&&(Ve._seek=Ve._start||0,Ve._rateSeek=0,Ve._paused=!0,Ve._ended=!0,G._stopFade(ae[je]),Ve._node&&(G._webAudio?Ve._node.bufferSource&&(typeof Ve._node.bufferSource.stop>"u"?Ve._node.bufferSource.noteOff(0):Ve._node.bufferSource.stop(0),G._cleanBuffer(Ve._node)):(!isNaN(Ve._node.duration)||Ve._node.duration===1/0)&&(Ve._node.currentTime=Ve._start||0,Ve._node.pause(),Ve._node.duration===1/0&&G._clearSound(Ve._node))),C||G._emit("stop",Ve._id))}return G},mute:function(v,C){var G=this;if(G._state!=="loaded"||G._playLock)return G._queue.push({event:"mute",action:function(){G.mute(v,C)}}),G;if(typeof C>"u")if(typeof v=="boolean")G._muted=v;else return G._muted;for(var ae=G._getSoundIds(C),je=0;je<ae.length;je++){var Ve=G._soundById(ae[je]);Ve&&(Ve._muted=v,Ve._interval&&G._stopFade(Ve._id),G._webAudio&&Ve._node?Ve._node.gain.setValueAtTime(v?0:Ve._volume,k.ctx.currentTime):Ve._node&&(Ve._node.muted=k._muted?!0:v),G._emit("mute",Ve._id))}return G},volume:function(){var v=this,C=arguments,G,ae;if(C.length===0)return v._volume;if(C.length===1||C.length===2&&typeof C[1]>"u"){var je=v._getSoundIds(),Ve=je.indexOf(C[0]);Ve>=0?ae=parseInt(C[0],10):G=parseFloat(C[0])}else C.length>=2&&(G=parseFloat(C[0]),ae=parseInt(C[1],10));var K;if(typeof G<"u"&&G>=0&&G<=1){if(v._state!=="loaded"||v._playLock)return v._queue.push({event:"volume",action:function(){v.volume.apply(v,C)}}),v;typeof ae>"u"&&(v._volume=G),ae=v._getSoundIds(ae);for(var Et=0;Et<ae.length;Et++)K=v._soundById(ae[Et]),K&&(K._volume=G,C[2]||v._stopFade(ae[Et]),v._webAudio&&K._node&&!K._muted?K._node.gain.setValueAtTime(G,k.ctx.currentTime):K._node&&!K._muted&&(K._node.volume=G*k.volume()),v._emit("volume",K._id))}else return K=ae?v._soundById(ae):v._sounds[0],K?K._volume:0;return v},fade:function(v,C,G,ae){var je=this;if(je._state!=="loaded"||je._playLock)return je._queue.push({event:"fade",action:function(){je.fade(v,C,G,ae)}}),je;v=Math.min(Math.max(0,parseFloat(v)),1),C=Math.min(Math.max(0,parseFloat(C)),1),G=parseFloat(G),je.volume(v,ae);for(var Ve=je._getSoundIds(ae),K=0;K<Ve.length;K++){var Et=je._soundById(Ve[K]);if(Et){if(ae||je._stopFade(Ve[K]),je._webAudio&&!Et._muted){var Gn=k.ctx.currentTime,ur=Gn+G/1e3;Et._volume=v,Et._node.gain.setValueAtTime(v,Gn),Et._node.gain.linearRampToValueAtTime(C,ur)}je._startFadeInterval(Et,v,C,G,Ve[K],typeof ae>"u")}}return je},_startFadeInterval:function(v,C,G,ae,je,Ve){var K=this,Et=C,Gn=G-C,ur=Math.abs(Gn/.01),Pr=Math.max(4,ur>0?ae/ur:ae),Hn=Date.now();v._fadeTo=G,v._interval=setInterval(function(){var Vt=(Date.now()-Hn)/ae;Hn=Date.now(),Et+=Gn*Vt,Et=Math.round(Et*100)/100,Gn<0?Et=Math.max(G,Et):Et=Math.min(G,Et),K._webAudio?v._volume=Et:K.volume(Et,v._id,!0),Ve&&(K._volume=Et),(G<C&&Et<=G||G>C&&Et>=G)&&(clearInterval(v._interval),v._interval=null,v._fadeTo=null,K.volume(G,v._id),K._emit("fade",v._id))},Pr)},_stopFade:function(v){var C=this,G=C._soundById(v);return G&&G._interval&&(C._webAudio&&G._node.gain.cancelScheduledValues(k.ctx.currentTime),clearInterval(G._interval),G._interval=null,C.volume(G._fadeTo,v),G._fadeTo=null,C._emit("fade",v)),C},loop:function(){var v=this,C=arguments,G,ae,je;if(C.length===0)return v._loop;if(C.length===1)if(typeof C[0]=="boolean")G=C[0],v._loop=G;else return je=v._soundById(parseInt(C[0],10)),je?je._loop:!1;else C.length===2&&(G=C[0],ae=parseInt(C[1],10));for(var Ve=v._getSoundIds(ae),K=0;K<Ve.length;K++)je=v._soundById(Ve[K]),je&&(je._loop=G,v._webAudio&&je._node&&je._node.bufferSource&&(je._node.bufferSource.loop=G,G&&(je._node.bufferSource.loopStart=je._start||0,je._node.bufferSource.loopEnd=je._stop,v.playing(Ve[K])&&(v.pause(Ve[K],!0),v.play(Ve[K],!0)))));return v},rate:function(){var v=this,C=arguments,G,ae;if(C.length===0)ae=v._sounds[0]._id;else if(C.length===1){var je=v._getSoundIds(),Ve=je.indexOf(C[0]);Ve>=0?ae=parseInt(C[0],10):G=parseFloat(C[0])}else C.length===2&&(G=parseFloat(C[0]),ae=parseInt(C[1],10));var K;if(typeof G=="number"){if(v._state!=="loaded"||v._playLock)return v._queue.push({event:"rate",action:function(){v.rate.apply(v,C)}}),v;typeof ae>"u"&&(v._rate=G),ae=v._getSoundIds(ae);for(var Et=0;Et<ae.length;Et++)if(K=v._soundById(ae[Et]),K){v.playing(ae[Et])&&(K._rateSeek=v.seek(ae[Et]),K._playStart=v._webAudio?k.ctx.currentTime:K._playStart),K._rate=G,v._webAudio&&K._node&&K._node.bufferSource?K._node.bufferSource.playbackRate.setValueAtTime(G,k.ctx.currentTime):K._node&&(K._node.playbackRate=G);var Gn=v.seek(ae[Et]),ur=(v._sprite[K._sprite][0]+v._sprite[K._sprite][1])/1e3-Gn,Pr=ur*1e3/Math.abs(K._rate);(v._endTimers[ae[Et]]||!K._paused)&&(v._clearTimer(ae[Et]),v._endTimers[ae[Et]]=setTimeout(v._ended.bind(v,K),Pr)),v._emit("rate",K._id)}}else return K=v._soundById(ae),K?K._rate:v._rate;return v},seek:function(){var v=this,C=arguments,G,ae;if(C.length===0)v._sounds.length&&(ae=v._sounds[0]._id);else if(C.length===1){var je=v._getSoundIds(),Ve=je.indexOf(C[0]);Ve>=0?ae=parseInt(C[0],10):v._sounds.length&&(ae=v._sounds[0]._id,G=parseFloat(C[0]))}else C.length===2&&(G=parseFloat(C[0]),ae=parseInt(C[1],10));if(typeof ae>"u")return 0;if(typeof G=="number"&&(v._state!=="loaded"||v._playLock))return v._queue.push({event:"seek",action:function(){v.seek.apply(v,C)}}),v;var K=v._soundById(ae);if(K)if(typeof G=="number"&&G>=0){var Et=v.playing(ae);Et&&v.pause(ae,!0),K._seek=G,K._ended=!1,v._clearTimer(ae),!v._webAudio&&K._node&&!isNaN(K._node.duration)&&(K._node.currentTime=G);var Gn=function(){Et&&v.play(ae,!0),v._emit("seek",ae)};if(Et&&!v._webAudio){var ur=function(){v._playLock?setTimeout(ur,0):Gn()};setTimeout(ur,0)}else Gn()}else if(v._webAudio){var Pr=v.playing(ae)?k.ctx.currentTime-K._playStart:0,Hn=K._rateSeek?K._rateSeek-K._seek:0;return K._seek+(Hn+Pr*Math.abs(K._rate))}else return K._node.currentTime;return v},playing:function(v){var C=this;if(typeof v=="number"){var G=C._soundById(v);return G?!G._paused:!1}for(var ae=0;ae<C._sounds.length;ae++)if(!C._sounds[ae]._paused)return!0;return!1},duration:function(v){var C=this,G=C._duration,ae=C._soundById(v);return ae&&(G=C._sprite[ae._sprite][1]/1e3),G},state:function(){return this._state},unload:function(){for(var v=this,C=v._sounds,G=0;G<C.length;G++)C[G]._paused||v.stop(C[G]._id),v._webAudio||(v._clearSound(C[G]._node),C[G]._node.removeEventListener("error",C[G]._errorFn,!1),C[G]._node.removeEventListener(k._canPlayEvent,C[G]._loadFn,!1),C[G]._node.removeEventListener("ended",C[G]._endFn,!1),k._releaseHtml5Audio(C[G]._node)),delete C[G]._node,v._clearTimer(C[G]._id);var ae=k._howls.indexOf(v);ae>=0&&k._howls.splice(ae,1);var je=!0;for(G=0;G<k._howls.length;G++)if(k._howls[G]._src===v._src||v._src.indexOf(k._howls[G]._src)>=0){je=!1;break}return Pe&&je&&delete Pe[v._src],k.noAudio=!1,v._state="unloaded",v._sounds=[],v=null,null},on:function(v,C,G,ae){var je=this,Ve=je["_on"+v];return typeof C=="function"&&Ve.push(ae?{id:G,fn:C,once:ae}:{id:G,fn:C}),je},off:function(v,C,G){var ae=this,je=ae["_on"+v],Ve=0;if(typeof C=="number"&&(G=C,C=null),C||G)for(Ve=0;Ve<je.length;Ve++){var K=G===je[Ve].id;if(C===je[Ve].fn&&K||!C&&K){je.splice(Ve,1);break}}else if(v)ae["_on"+v]=[];else{var Et=Object.keys(ae);for(Ve=0;Ve<Et.length;Ve++)Et[Ve].indexOf("_on")===0&&Array.isArray(ae[Et[Ve]])&&(ae[Et[Ve]]=[])}return ae},once:function(v,C,G){var ae=this;return ae.on(v,C,G,1),ae},_emit:function(v,C,G){for(var ae=this,je=ae["_on"+v],Ve=je.length-1;Ve>=0;Ve--)(!je[Ve].id||je[Ve].id===C||v==="load")&&(setTimeout(function(K){K.call(this,C,G)}.bind(ae,je[Ve].fn),0),je[Ve].once&&ae.off(v,je[Ve].fn,je[Ve].id));return ae._loadQueue(v),ae},_loadQueue:function(v){var C=this;if(C._queue.length>0){var G=C._queue[0];G.event===v&&(C._queue.shift(),C._loadQueue()),v||G.action()}return C},_ended:function(v){var C=this,G=v._sprite;if(!C._webAudio&&v._node&&!v._node.paused&&!v._node.ended&&v._node.currentTime<v._stop)return setTimeout(C._ended.bind(C,v),100),C;var ae=!!(v._loop||C._sprite[G][2]);if(C._emit("end",v._id),!C._webAudio&&ae&&C.stop(v._id,!0).play(v._id),C._webAudio&&ae){C._emit("play",v._id),v._seek=v._start||0,v._rateSeek=0,v._playStart=k.ctx.currentTime;var je=(v._stop-v._start)*1e3/Math.abs(v._rate);C._endTimers[v._id]=setTimeout(C._ended.bind(C,v),je)}return C._webAudio&&!ae&&(v._paused=!0,v._ended=!0,v._seek=v._start||0,v._rateSeek=0,C._clearTimer(v._id),C._cleanBuffer(v._node),k._autoSuspend()),!C._webAudio&&!ae&&C.stop(v._id,!0),C},_clearTimer:function(v){var C=this;if(C._endTimers[v]){if(typeof C._endTimers[v]!="function")clearTimeout(C._endTimers[v]);else{var G=C._soundById(v);G&&G._node&&G._node.removeEventListener("ended",C._endTimers[v],!1)}delete C._endTimers[v]}return C},_soundById:function(v){for(var C=this,G=0;G<C._sounds.length;G++)if(v===C._sounds[G]._id)return C._sounds[G];return null},_inactiveSound:function(){var v=this;v._drain();for(var C=0;C<v._sounds.length;C++)if(v._sounds[C]._ended)return v._sounds[C].reset();return new U(v)},_drain:function(){var v=this,C=v._pool,G=0,ae=0;if(!(v._sounds.length<C)){for(ae=0;ae<v._sounds.length;ae++)v._sounds[ae]._ended&&G++;for(ae=v._sounds.length-1;ae>=0;ae--){if(G<=C)return;v._sounds[ae]._ended&&(v._webAudio&&v._sounds[ae]._node&&v._sounds[ae]._node.disconnect(0),v._sounds.splice(ae,1),G--)}}},_getSoundIds:function(v){var C=this;if(typeof v>"u"){for(var G=[],ae=0;ae<C._sounds.length;ae++)G.push(C._sounds[ae]._id);return G}else return[v]},_refreshBuffer:function(v){var C=this;return v._node.bufferSource=k.ctx.createBufferSource(),v._node.bufferSource.buffer=Pe[C._src],v._panner?v._node.bufferSource.connect(v._panner):v._node.bufferSource.connect(v._node),v._node.bufferSource.loop=v._loop,v._loop&&(v._node.bufferSource.loopStart=v._start||0,v._node.bufferSource.loopEnd=v._stop||0),v._node.bufferSource.playbackRate.setValueAtTime(v._rate,k.ctx.currentTime),C},_cleanBuffer:function(v){var C=this,G=k._navigator&&k._navigator.vendor.indexOf("Apple")>=0;if(k._scratchBuffer&&v.bufferSource&&(v.bufferSource.onended=null,v.bufferSource.disconnect(0),G))try{v.bufferSource.buffer=k._scratchBuffer}catch{}return v.bufferSource=null,C},_clearSound:function(v){var C=/MSIE |Trident\//.test(k._navigator&&k._navigator.userAgent);C||(v.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var U=function(v){this._parent=v,this.init()};U.prototype={init:function(){var v=this,C=v._parent;return v._muted=C._muted,v._loop=C._loop,v._volume=C._volume,v._rate=C._rate,v._seek=0,v._paused=!0,v._ended=!0,v._sprite="__default",v._id=++k._counter,C._sounds.push(v),v.create(),v},create:function(){var v=this,C=v._parent,G=k._muted||v._muted||v._parent._muted?0:v._volume;return C._webAudio?(v._node=typeof k.ctx.createGain>"u"?k.ctx.createGainNode():k.ctx.createGain(),v._node.gain.setValueAtTime(G,k.ctx.currentTime),v._node.paused=!0,v._node.connect(k.masterGain)):k.noAudio||(v._node=k._obtainHtml5Audio(),v._errorFn=v._errorListener.bind(v),v._node.addEventListener("error",v._errorFn,!1),v._loadFn=v._loadListener.bind(v),v._node.addEventListener(k._canPlayEvent,v._loadFn,!1),v._endFn=v._endListener.bind(v),v._node.addEventListener("ended",v._endFn,!1),v._node.src=C._src,v._node.preload=C._preload===!0?"auto":C._preload,v._node.volume=G*k.volume(),v._node.load()),v},reset:function(){var v=this,C=v._parent;return v._muted=C._muted,v._loop=C._loop,v._volume=C._volume,v._rate=C._rate,v._seek=0,v._rateSeek=0,v._paused=!0,v._ended=!0,v._sprite="__default",v._id=++k._counter,v},_errorListener:function(){var v=this;v._parent._emit("loaderror",v._id,v._node.error?v._node.error.code:0),v._node.removeEventListener("error",v._errorFn,!1)},_loadListener:function(){var v=this,C=v._parent;C._duration=Math.ceil(v._node.duration*10)/10,Object.keys(C._sprite).length===0&&(C._sprite={__default:[0,C._duration*1e3]}),C._state!=="loaded"&&(C._state="loaded",C._emit("load"),C._loadQueue()),v._node.removeEventListener(k._canPlayEvent,v._loadFn,!1)},_endListener:function(){var v=this,C=v._parent;C._duration===1/0&&(C._duration=Math.ceil(v._node.duration*10)/10,C._sprite.__default[1]===1/0&&(C._sprite.__default[1]=C._duration*1e3),C._ended(v)),v._node.removeEventListener("ended",v._endFn,!1)}};var Pe={},Ie=function(v){var C=v._src;if(Pe[C]){v._duration=Pe[C].duration,it(v);return}if(/^data:[^;]+;base64,/.test(C)){for(var G=atob(C.split(",")[1]),ae=new Uint8Array(G.length),je=0;je<G.length;++je)ae[je]=G.charCodeAt(je);Xe(ae.buffer,v)}else{var Ve=new XMLHttpRequest;Ve.open(v._xhr.method,C,!0),Ve.withCredentials=v._xhr.withCredentials,Ve.responseType="arraybuffer",v._xhr.headers&&Object.keys(v._xhr.headers).forEach(function(K){Ve.setRequestHeader(K,v._xhr.headers[K])}),Ve.onload=function(){var K=(Ve.status+"")[0];if(K!=="0"&&K!=="2"&&K!=="3"){v._emit("loaderror",null,"Failed loading audio file with status: "+Ve.status+".");return}Xe(Ve.response,v)},Ve.onerror=function(){v._webAudio&&(v._html5=!0,v._webAudio=!1,v._sounds=[],delete Pe[C],v.load())},jt(Ve)}},jt=function(v){try{v.send()}catch{v.onerror()}},Xe=function(v,C){var G=function(){C._emit("loaderror",null,"Decoding audio data failed.")},ae=function(je){je&&C._sounds.length>0?(Pe[C._src]=je,it(C,je)):G()};typeof Promise<"u"&&k.ctx.decodeAudioData.length===1?k.ctx.decodeAudioData(v).then(ae).catch(G):k.ctx.decodeAudioData(v,ae,G)},it=function(v,C){C&&!v._duration&&(v._duration=C.duration),Object.keys(v._sprite).length===0&&(v._sprite={__default:[0,v._duration*1e3]}),v._state!=="loaded"&&(v._state="loaded",v._emit("load"),v._loadQueue())},ln=function(){if(k.usingWebAudio){try{typeof AudioContext<"u"?k.ctx=new AudioContext:typeof webkitAudioContext<"u"?k.ctx=new webkitAudioContext:k.usingWebAudio=!1}catch{k.usingWebAudio=!1}k.ctx||(k.usingWebAudio=!1);var v=/iP(hone|od|ad)/.test(k._navigator&&k._navigator.platform),C=k._navigator&&k._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),G=C?parseInt(C[1],10):null;if(v&&G&&G<9){var ae=/safari/.test(k._navigator&&k._navigator.userAgent.toLowerCase());k._navigator&&!ae&&(k.usingWebAudio=!1)}k.usingWebAudio&&(k.masterGain=typeof k.ctx.createGain>"u"?k.ctx.createGainNode():k.ctx.createGain(),k.masterGain.gain.setValueAtTime(k._muted?0:k._volume,k.ctx.currentTime),k.masterGain.connect(k.ctx.destination)),k._setup()}};W.Howler=k,W.Howl=ve,typeof Kn<"u"?(Kn.HowlerGlobal=z,Kn.Howler=k,Kn.Howl=ve,Kn.Sound=U):typeof window<"u"&&(window.HowlerGlobal=z,window.Howler=k,window.Howl=ve,window.Sound=U)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(k){var ve=this;if(!ve.ctx||!ve.ctx.listener)return ve;for(var U=ve._howls.length-1;U>=0;U--)ve._howls[U].stereo(k);return ve},HowlerGlobal.prototype.pos=function(k,ve,U){var Pe=this;if(!Pe.ctx||!Pe.ctx.listener)return Pe;if(ve=typeof ve!="number"?Pe._pos[1]:ve,U=typeof U!="number"?Pe._pos[2]:U,typeof k=="number")Pe._pos=[k,ve,U],typeof Pe.ctx.listener.positionX<"u"?(Pe.ctx.listener.positionX.setTargetAtTime(Pe._pos[0],Howler.ctx.currentTime,.1),Pe.ctx.listener.positionY.setTargetAtTime(Pe._pos[1],Howler.ctx.currentTime,.1),Pe.ctx.listener.positionZ.setTargetAtTime(Pe._pos[2],Howler.ctx.currentTime,.1)):Pe.ctx.listener.setPosition(Pe._pos[0],Pe._pos[1],Pe._pos[2]);else return Pe._pos;return Pe},HowlerGlobal.prototype.orientation=function(k,ve,U,Pe,Ie,jt){var Xe=this;if(!Xe.ctx||!Xe.ctx.listener)return Xe;var it=Xe._orientation;if(ve=typeof ve!="number"?it[1]:ve,U=typeof U!="number"?it[2]:U,Pe=typeof Pe!="number"?it[3]:Pe,Ie=typeof Ie!="number"?it[4]:Ie,jt=typeof jt!="number"?it[5]:jt,typeof k=="number")Xe._orientation=[k,ve,U,Pe,Ie,jt],typeof Xe.ctx.listener.forwardX<"u"?(Xe.ctx.listener.forwardX.setTargetAtTime(k,Howler.ctx.currentTime,.1),Xe.ctx.listener.forwardY.setTargetAtTime(ve,Howler.ctx.currentTime,.1),Xe.ctx.listener.forwardZ.setTargetAtTime(U,Howler.ctx.currentTime,.1),Xe.ctx.listener.upX.setTargetAtTime(Pe,Howler.ctx.currentTime,.1),Xe.ctx.listener.upY.setTargetAtTime(Ie,Howler.ctx.currentTime,.1),Xe.ctx.listener.upZ.setTargetAtTime(jt,Howler.ctx.currentTime,.1)):Xe.ctx.listener.setOrientation(k,ve,U,Pe,Ie,jt);else return it;return Xe},Howl.prototype.init=function(k){return function(ve){var U=this;return U._orientation=ve.orientation||[1,0,0],U._stereo=ve.stereo||null,U._pos=ve.pos||null,U._pannerAttr={coneInnerAngle:typeof ve.coneInnerAngle<"u"?ve.coneInnerAngle:360,coneOuterAngle:typeof ve.coneOuterAngle<"u"?ve.coneOuterAngle:360,coneOuterGain:typeof ve.coneOuterGain<"u"?ve.coneOuterGain:0,distanceModel:typeof ve.distanceModel<"u"?ve.distanceModel:"inverse",maxDistance:typeof ve.maxDistance<"u"?ve.maxDistance:1e4,panningModel:typeof ve.panningModel<"u"?ve.panningModel:"HRTF",refDistance:typeof ve.refDistance<"u"?ve.refDistance:1,rolloffFactor:typeof ve.rolloffFactor<"u"?ve.rolloffFactor:1},U._onstereo=ve.onstereo?[{fn:ve.onstereo}]:[],U._onpos=ve.onpos?[{fn:ve.onpos}]:[],U._onorientation=ve.onorientation?[{fn:ve.onorientation}]:[],k.call(this,ve)}}(Howl.prototype.init),Howl.prototype.stereo=function(k,ve){var U=this;if(!U._webAudio)return U;if(U._state!=="loaded")return U._queue.push({event:"stereo",action:function(){U.stereo(k,ve)}}),U;var Pe=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof ve>"u")if(typeof k=="number")U._stereo=k,U._pos=[k,0,0];else return U._stereo;for(var Ie=U._getSoundIds(ve),jt=0;jt<Ie.length;jt++){var Xe=U._soundById(Ie[jt]);if(Xe)if(typeof k=="number")Xe._stereo=k,Xe._pos=[k,0,0],Xe._node&&(Xe._pannerAttr.panningModel="equalpower",(!Xe._panner||!Xe._panner.pan)&&z(Xe,Pe),Pe==="spatial"?typeof Xe._panner.positionX<"u"?(Xe._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),Xe._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),Xe._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):Xe._panner.setPosition(k,0,0):Xe._panner.pan.setValueAtTime(k,Howler.ctx.currentTime)),U._emit("stereo",Xe._id);else return Xe._stereo}return U},Howl.prototype.pos=function(k,ve,U,Pe){var Ie=this;if(!Ie._webAudio)return Ie;if(Ie._state!=="loaded")return Ie._queue.push({event:"pos",action:function(){Ie.pos(k,ve,U,Pe)}}),Ie;if(ve=typeof ve!="number"?0:ve,U=typeof U!="number"?-.5:U,typeof Pe>"u")if(typeof k=="number")Ie._pos=[k,ve,U];else return Ie._pos;for(var jt=Ie._getSoundIds(Pe),Xe=0;Xe<jt.length;Xe++){var it=Ie._soundById(jt[Xe]);if(it)if(typeof k=="number")it._pos=[k,ve,U],it._node&&((!it._panner||it._panner.pan)&&z(it,"spatial"),typeof it._panner.positionX<"u"?(it._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),it._panner.positionY.setValueAtTime(ve,Howler.ctx.currentTime),it._panner.positionZ.setValueAtTime(U,Howler.ctx.currentTime)):it._panner.setPosition(k,ve,U)),Ie._emit("pos",it._id);else return it._pos}return Ie},Howl.prototype.orientation=function(k,ve,U,Pe){var Ie=this;if(!Ie._webAudio)return Ie;if(Ie._state!=="loaded")return Ie._queue.push({event:"orientation",action:function(){Ie.orientation(k,ve,U,Pe)}}),Ie;if(ve=typeof ve!="number"?Ie._orientation[1]:ve,U=typeof U!="number"?Ie._orientation[2]:U,typeof Pe>"u")if(typeof k=="number")Ie._orientation=[k,ve,U];else return Ie._orientation;for(var jt=Ie._getSoundIds(Pe),Xe=0;Xe<jt.length;Xe++){var it=Ie._soundById(jt[Xe]);if(it)if(typeof k=="number")it._orientation=[k,ve,U],it._node&&(it._panner||(it._pos||(it._pos=Ie._pos||[0,0,-.5]),z(it,"spatial")),typeof it._panner.orientationX<"u"?(it._panner.orientationX.setValueAtTime(k,Howler.ctx.currentTime),it._panner.orientationY.setValueAtTime(ve,Howler.ctx.currentTime),it._panner.orientationZ.setValueAtTime(U,Howler.ctx.currentTime)):it._panner.setOrientation(k,ve,U)),Ie._emit("orientation",it._id);else return it._orientation}return Ie},Howl.prototype.pannerAttr=function(){var k=this,ve=arguments,U,Pe,Ie;if(!k._webAudio)return k;if(ve.length===0)return k._pannerAttr;if(ve.length===1)if(typeof ve[0]=="object")U=ve[0],typeof Pe>"u"&&(U.pannerAttr||(U.pannerAttr={coneInnerAngle:U.coneInnerAngle,coneOuterAngle:U.coneOuterAngle,coneOuterGain:U.coneOuterGain,distanceModel:U.distanceModel,maxDistance:U.maxDistance,refDistance:U.refDistance,rolloffFactor:U.rolloffFactor,panningModel:U.panningModel}),k._pannerAttr={coneInnerAngle:typeof U.pannerAttr.coneInnerAngle<"u"?U.pannerAttr.coneInnerAngle:k._coneInnerAngle,coneOuterAngle:typeof U.pannerAttr.coneOuterAngle<"u"?U.pannerAttr.coneOuterAngle:k._coneOuterAngle,coneOuterGain:typeof U.pannerAttr.coneOuterGain<"u"?U.pannerAttr.coneOuterGain:k._coneOuterGain,distanceModel:typeof U.pannerAttr.distanceModel<"u"?U.pannerAttr.distanceModel:k._distanceModel,maxDistance:typeof U.pannerAttr.maxDistance<"u"?U.pannerAttr.maxDistance:k._maxDistance,refDistance:typeof U.pannerAttr.refDistance<"u"?U.pannerAttr.refDistance:k._refDistance,rolloffFactor:typeof U.pannerAttr.rolloffFactor<"u"?U.pannerAttr.rolloffFactor:k._rolloffFactor,panningModel:typeof U.pannerAttr.panningModel<"u"?U.pannerAttr.panningModel:k._panningModel});else return Ie=k._soundById(parseInt(ve[0],10)),Ie?Ie._pannerAttr:k._pannerAttr;else ve.length===2&&(U=ve[0],Pe=parseInt(ve[1],10));for(var jt=k._getSoundIds(Pe),Xe=0;Xe<jt.length;Xe++)if(Ie=k._soundById(jt[Xe]),Ie){var it=Ie._pannerAttr;it={coneInnerAngle:typeof U.coneInnerAngle<"u"?U.coneInnerAngle:it.coneInnerAngle,coneOuterAngle:typeof U.coneOuterAngle<"u"?U.coneOuterAngle:it.coneOuterAngle,coneOuterGain:typeof U.coneOuterGain<"u"?U.coneOuterGain:it.coneOuterGain,distanceModel:typeof U.distanceModel<"u"?U.distanceModel:it.distanceModel,maxDistance:typeof U.maxDistance<"u"?U.maxDistance:it.maxDistance,refDistance:typeof U.refDistance<"u"?U.refDistance:it.refDistance,rolloffFactor:typeof U.rolloffFactor<"u"?U.rolloffFactor:it.rolloffFactor,panningModel:typeof U.panningModel<"u"?U.panningModel:it.panningModel};var ln=Ie._panner;ln?(ln.coneInnerAngle=it.coneInnerAngle,ln.coneOuterAngle=it.coneOuterAngle,ln.coneOuterGain=it.coneOuterGain,ln.distanceModel=it.distanceModel,ln.maxDistance=it.maxDistance,ln.refDistance=it.refDistance,ln.rolloffFactor=it.rolloffFactor,ln.panningModel=it.panningModel):(Ie._pos||(Ie._pos=k._pos||[0,0,-.5]),z(Ie,"spatial"))}return k},Sound.prototype.init=function(k){return function(){var ve=this,U=ve._parent;ve._orientation=U._orientation,ve._stereo=U._stereo,ve._pos=U._pos,ve._pannerAttr=U._pannerAttr,k.call(this),ve._stereo?U.stereo(ve._stereo):ve._pos&&U.pos(ve._pos[0],ve._pos[1],ve._pos[2],ve._id)}}(Sound.prototype.init),Sound.prototype.reset=function(k){return function(){var ve=this,U=ve._parent;return ve._orientation=U._orientation,ve._stereo=U._stereo,ve._pos=U._pos,ve._pannerAttr=U._pannerAttr,ve._stereo?U.stereo(ve._stereo):ve._pos?U.pos(ve._pos[0],ve._pos[1],ve._pos[2],ve._id):ve._panner&&(ve._panner.disconnect(0),ve._panner=void 0,U._refreshBuffer(ve)),k.call(this)}}(Sound.prototype.reset);var z=function(k,ve){ve=ve||"spatial",ve==="spatial"?(k._panner=Howler.ctx.createPanner(),k._panner.coneInnerAngle=k._pannerAttr.coneInnerAngle,k._panner.coneOuterAngle=k._pannerAttr.coneOuterAngle,k._panner.coneOuterGain=k._pannerAttr.coneOuterGain,k._panner.distanceModel=k._pannerAttr.distanceModel,k._panner.maxDistance=k._pannerAttr.maxDistance,k._panner.refDistance=k._pannerAttr.refDistance,k._panner.rolloffFactor=k._pannerAttr.rolloffFactor,k._panner.panningModel=k._pannerAttr.panningModel,typeof k._panner.positionX<"u"?(k._panner.positionX.setValueAtTime(k._pos[0],Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(k._pos[1],Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(k._pos[2],Howler.ctx.currentTime)):k._panner.setPosition(k._pos[0],k._pos[1],k._pos[2]),typeof k._panner.orientationX<"u"?(k._panner.orientationX.setValueAtTime(k._orientation[0],Howler.ctx.currentTime),k._panner.orientationY.setValueAtTime(k._orientation[1],Howler.ctx.currentTime),k._panner.orientationZ.setValueAtTime(k._orientation[2],Howler.ctx.currentTime)):k._panner.setOrientation(k._orientation[0],k._orientation[1],k._orientation[2])):(k._panner=Howler.ctx.createStereoPanner(),k._panner.pan.setValueAtTime(k._stereo,Howler.ctx.currentTime)),k._panner.connect(k._node),k._paused||k._parent.pause(k._id,!0).play(k._id,!0)}})()});class er{constructor(W,z=!1){this.howler=null,this.useAudioElement=!1,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?this.assets=W.filter(ve=>ve.endsWith("mp3")).concat(W.filter(ve=>!ve.endsWith("mp3"))):this.assets=W,this.useAudioElement=z}load(){this.unload(),this.howler||(this.howler=new bt.Howl({html5:this.useAudioElement,src:this.assets,onloaderror:()=>{console.warn("Howler: sounds failed to load, falling back to html5 audio"),this.howler=new bt.Howl({html5:!0,src:this.assets,onloaderror:()=>{console.error("Howler: html5 audio fallback failed to load")}})}}))}unload(){var W;(W=this.howler)===null||W===void 0||W.unload()}play(){var W;this.howler||this.load(),(W=this.howler)===null||W===void 0||W.play(),window.Cypress&&(window.Cypress.howlerHistory||(window.Cypress.howlerHistory=[]),window.Cypress.howlerHistory.push({time:Date.now(),src:this.assets.slice(0)}))}}var dr;(function($){$.Suspended="web-ui-sound-suspended",$.Enabled="web-ui-sound-enabled"})(dr||(dr={}));const Jr=3;let Qe=0,pn=!1;function dt($){De(dr.Enabled,$)}function We(){xt()&&yr(()=>{window.postMessage({key:dr.Enabled},window.location.origin),Be(We)})}function ot($,W=!1){const z=new er($,W);return xt()?(Ce(We),dt(()=>z.load())):z.load(),z}function xe($){xt()?!pn&&Qe>Jr?(Qe=0,pn=!0,window.postMessage({key:dr.Suspended},window.location.origin)):pn||(Qe++,We(),dt(()=>$.play())):$.play()}class gn{constructor(W="keyval-store",z="keyval"){this.storeName=z,this._dbp=new Promise((k,ve)=>{const U=indexedDB.open(W,1);U.onerror=()=>ve(U.error),U.onsuccess=()=>k(U.result),U.onupgradeneeded=()=>{U.result.createObjectStore(z)}})}_withIDBStore(W,z){return this._dbp.then(k=>new Promise((ve,U)=>{const Pe=k.transaction(this.storeName,W);Pe.oncomplete=()=>ve(),Pe.onabort=Pe.onerror=()=>U(Pe.error),z(Pe.objectStore(this.storeName))}))}}let Jt;function jn(){return Jt||(Jt=new gn),Jt}function nr($,W=jn()){let z;return W._withIDBStore("readonly",k=>{z=k.get($)}).then(()=>z.result)}function Tr($,W,z=jn()){return z._withIDBStore("readwrite",k=>{k.put(W,$)})}function mn(){}function Pn($){return $()}function Pt(){return Object.create(null)}function ft($){$.forEach(Pn)}function Dt($){return typeof $=="function"}function Dn($,W){return $!=$?W==W:$!==W||$&&typeof $=="object"||typeof $=="function"}function Bn($){return Object.keys($).length===0}function ie($,...W){if($==null)return mn;const z=$.subscribe(...W);return z.unsubscribe?()=>z.unsubscribe():z}function E($,W,z){$.$$.on_destroy.push(ie(W,z))}function Y($){return $??""}function R($,W){$.appendChild(W)}function de($,W,z){$.insertBefore(W,z||null)}function Ae($){$.parentNode.removeChild($)}function me($,W){for(let z=0;z<$.length;z+=1)$[z]&&$[z].d(W)}function on($){return document.createElement($)}function L($){return document.createTextNode($)}function pe(){return L(" ")}function ye(){return L("")}function ke($,W,z,k){return $.addEventListener(W,z,k),()=>$.removeEventListener(W,z,k)}function Q($,W,z){z==null?$.removeAttribute(W):$.getAttribute(W)!==z&&$.setAttribute(W,z)}function Ke($){return Array.from($.childNodes)}function yt($,W){W=""+W,$.wholeText!==W&&($.data=W)}function In($,W,z){$.classList[z?"add":"remove"](W)}function Tn($,W,z=!1){const k=document.createEvent("CustomEvent");return k.initCustomEvent($,z,!1,W),k}class Fr{constructor(){this.e=this.n=null}c(W){this.h(W)}m(W,z,k=null){this.e||(this.e=on(z.nodeName),this.t=z,this.c(W)),this.i(k)}h(W){this.e.innerHTML=W,this.n=Array.from(this.e.childNodes)}i(W){for(let z=0;z<this.n.length;z+=1)de(this.t,this.n[z],W)}p(W){this.d(),this.h(W),this.i(this.a)}d(){this.n.forEach(Ae)}}let vt;function _i($){vt=$}function _r(){if(!vt)throw new Error("Function called outside component initialization");return vt}function Ei($){_r().$$.on_mount.push($)}function Jo($){_r().$$.on_destroy.push($)}function Ur(){const $=_r();return(W,z)=>{const k=$.$$.callbacks[W];if(k){const ve=Tn(W,z);k.slice().forEach(U=>{U.call($,ve)})}}}const Gt=[],Ut=[],Dr=[],rr=[],wi=Promise.resolve();let pr=!1;function Vr(){pr||(pr=!0,wi.then(Bo))}function Mo($){Dr.push($)}let go=!1;const ga=new Set;function Bo(){if(!go){go=!0;do{for(let $=0;$<Gt.length;$+=1){const W=Gt[$];_i(W),ea(W.$$)}for(_i(null),Gt.length=0;Ut.length;)Ut.pop()();for(let $=0;$<Dr.length;$+=1){const W=Dr[$];ga.has(W)||(ga.add(W),W())}Dr.length=0}while(Gt.length);for(;rr.length;)rr.pop()();pr=!1,go=!1,ga.clear()}}function ea($){if($.fragment!==null){$.update(),ft($.before_update);const W=$.dirty;$.dirty=[-1],$.fragment&&$.fragment.p($.ctx,W),$.after_update.forEach(Mo)}}const Fo=new Set;let _o;function ta(){_o={r:0,c:[],p:_o}}function vs(){_o.r||ft(_o.c),_o=_o.p}function xo($,W){$&&$.i&&(Fo.delete($),$.i(W))}function Va($,W,z,k){if($&&$.o){if(Fo.has($))return;Fo.add($),_o.c.push(()=>{Fo.delete($),k&&(z&&$.d(1),k())}),$.o(W)}}function za($){$&&$.c()}function Uo($,W,z,k){const{fragment:ve,on_mount:U,on_destroy:Pe,after_update:Ie}=$.$$;ve&&ve.m(W,z),k||Mo(()=>{const jt=U.map(Pn).filter(Dt);Pe?Pe.push(...jt):ft(jt),$.$$.on_mount=[]}),Ie.forEach(Mo)}function Ho($,W){const z=$.$$;z.fragment!==null&&(ft(z.on_destroy),z.fragment&&z.fragment.d(W),z.on_destroy=z.fragment=null,z.ctx=[])}function Pi($,W){$.$$.dirty[0]===-1&&(Gt.push($),Vr(),$.$$.dirty.fill(0)),$.$$.dirty[W/31|0]|=1<<W%31}function Kt($,W,z,k,ve,U,Pe,Ie=[-1]){const jt=vt;_i($);const Xe=$.$$={fragment:null,ctx:null,props:U,update:mn,not_equal:ve,bound:Pt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(jt?jt.$$.context:W.context||[]),callbacks:Pt(),dirty:Ie,skip_bound:!1,root:W.target||jt.$$.root};Pe&&Pe(Xe.root);let it=!1;if(Xe.ctx=z?z($,W.props||{},(ln,v,...C)=>{const G=C.length?C[0]:v;return Xe.ctx&&ve(Xe.ctx[ln],Xe.ctx[ln]=G)&&(!Xe.skip_bound&&Xe.bound[ln]&&Xe.bound[ln](G),it&&Pi($,ln)),v}):[],Xe.update(),it=!0,ft(Xe.before_update),Xe.fragment=k?k(Xe.ctx):!1,W.target){if(W.hydrate){const ln=Ke(W.target);Xe.fragment&&Xe.fragment.l(ln),ln.forEach(Ae)}else Xe.fragment&&Xe.fragment.c();W.intro&&xo($.$$.fragment),Uo($,W.target,W.anchor,W.customElement),Bo()}_i(jt)}class Mn{$destroy(){Ho(this,1),this.$destroy=mn}$on(W,z){const k=this.$$.callbacks[W]||(this.$$.callbacks[W]=[]);return k.push(z),()=>{const ve=k.indexOf(z);ve!==-1&&k.splice(ve,1)}}$set(W){this.$$set&&!Bn(W)&&(this.$$.skip_bound=!0,this.$$set(W),this.$$.skip_bound=!1)}}function at($){return Object.keys($).reduce((W,z)=>Object.assign(Object.assign({},W),{[$[z]]:z}),{})}function _e($,W){return W.reduce((z,k)=>(Object.prototype.hasOwnProperty.call($,k)&&(z[k]=$[k]),z),{})}const At=[];function Yt($,W=mn){let z;const k=new Set;function ve(Ie){if(Dn($,Ie)&&($=Ie,z)){const jt=!At.length;for(const Xe of k)Xe[1](),At.push(Xe,$);if(jt){for(let Xe=0;Xe<At.length;Xe+=2)At[Xe][0](At[Xe+1]);At.length=0}}}function U(Ie){ve(Ie($))}function Pe(Ie,jt=mn){const Xe=[Ie,jt];return k.add(Xe),k.size===1&&(z=W(ve)||mn),Ie($),()=>{k.delete(Xe),k.size===0&&(z(),z=null)}}return{set:ve,update:U,subscribe:Pe}}var $t;(function($){(function(W){W.Hidden="hidden",W.Invisible="invisible"})($.Classes||($.Classes={}))})($t||($t={}));function kt($,W="."){return`${W}${$}`}var Tt;(function($){(function(W){W[W.Backspace=8]="Backspace",W[W.Delete=46]="Delete",W[W.DownArrow=40]="DownArrow",W[W.Enter=13]="Enter",W[W.Escape=27]="Escape",W[W.LeftArrow=37]="LeftArrow",W[W.RightArrow=39]="RightArrow",W[W.Spacebar=32]="Spacebar",W[W.Stop=137]="Stop",W[W.Tab=9]="Tab",W[W.UpArrow=38]="UpArrow"})($.KeyCodes||($.KeyCodes={}))})(Tt||(Tt={}));function fn($){return`${$[0].toUpperCase()}${$.slice(1)}`}},3527:function(lt,nn,Fe){var w=Fe(34155);/*!
 * Chess.com (c) 2020 | all rights reserved
 *//*!
 * A distant fork of chess.js - BSD (c) 2014, Jeff Hlywa (jhlywa@gmail.com)
 */var ne=function(){"use strict";var q=function(){var Le=[[2637767806,863464769],[720845184,95069639],[1155203408,610415943],[2618685246,1655139042],[1971536997,1218186377],[848342074,540017087],[263957791,1627660921],[3896152207,4076560586],[226391645,1484086288],[436746274,3467632685],[2516964848,3797861296],[3491888988,3510251221],[1086189917,1248276018],[18044180,1876255637],[1572111136,1190386149],[597658413,2146900428],[97624494,2243205793],[1738507407,1854916977],[1950989311,2149575947],[2098318769,3283594736],[2194108574,2015279052],[4079062812,2500884588],[856979699,2941369318],[1270058469,3877737539],[2858720366,3170717948],[2378012835,1387254795],[2278688587,2178388503],[435406673,3555273441],[3031118064,1655806655],[2063925420,1107589828],[3376753832,436852829],[615148625,1302492416],[1285502018,1963045959],[346460119,1016137793],[2803604355,1176288659],[55085973,2968618255],[1669016372,4287873088],[164740250,1037634196],[896886403,883023163],[1935551383,2764331555],[410153072,4055711755],[533441746,1505690343],[3541084098,3466290517],[3214426080,4267541060],[2675233103,1951705124],[1374411850,3115986997],[1552073989,3684348154],[4244110986,875606593],[844343081,3115990494],[2356462440,135999605],[3116133511,377238503],[2129956651,2197966368],[299173332,3276914047],[1701379241,745972291],[1306570996,254977976],[2530644806,214138461],[1122123979,1667800879],[1831591130,3801192033],[1116211970,920967505],[1594837592,2551651254],[972591349,2046373768],[2479207924,1935030411],[1675376029,2367888248],[3960916618,3935874422],[1398143232,3265801671],[133930885,1520005442],[1351827834,2829577566],[2076951437,2723839804],[435980918,2364847828],[1668970368,3738157273],[2185864314,3993911799],[2041407829,31969768],[346864372,2004703094],[4047877822,3437142421],[3669961416,538399484],[616810829,4190688246],[3144558884,4030272234],[216165387,2513010905],[2761740594,3216997572],[3919406634,4096014649],[669429112,2434161727],[2234904640,3111407601],[1421079802,1598085235],[1924213810,310373675],[4002762044,2067865415],[2592451728,2586110625],[1890340057,4031717877],[4189625662,2577429954],[2276713138,3049850801],[2741429688,3310307512],[2924122950,3426712818],[421576781,1193704381],[2277442246,3030264553],[153237420,595540057],[4278711886,4176286928],[2380848297,4030514510],[2618700582,1303682185],[3018992701,185284845],[957243316,1291916363],[1543415220,1898408169],[504378001,531073412],[2591337657,1692896435],[1333852064,903543556],[1661259930,188168388],[561112646,2197961224],[1536910315,2632972300],[1349168372,2307429186],[411152329,2745631190],[1694697476,1081411140],[3755185459,2631660711],[4019355068,4027326706],[2066937809,3761668332],[3120395808,3878773315],[94890149,2109283191],[3045629038,358812277],[1249184265,3465901047],[3477490924,2308583306],[4114113436,3875911716],[1014604031,1434513279],[3991324799,2222416029],[2040431088,1539915569],[2253613964,4081224332],[2547464012,1611168627],[2722521980,4281500978],[71289574,213969824],[2450408597,903689630],[1894451515,364024012],[1939968537,374938813],[1447259295,3785468557],[4021046128,1664847745],[3139524504,3562928047],[1173487682,4065269608],[2467266804,3907744866],[4284945151,3486998177],[2925674454,1953016432],[3710671816,1271453948],[2129465869,1422863833],[587093076,18243356],[3373793513,2411305257],[2156648078,1791034213],[3737413652,1534461430],[468575139,2935304962],[1129551363,3603256834],[2861996892,1763494778],[2826449619,2465197654],[1704209531,1014895022],[3738359347,3402630390],[569410928,4095796581],[3021312909,2108247612],[2444777957,2664129360],[282063667,3773661258],[682545472,3188439005],[3318488457,1917822038],[1447622272,4045023041],[757420137,4038580915],[2613420942,4146703316],[4012836163,150381244],[2938127093,3428591704],[1208226490,3086335530],[2935205706,1446903363],[430957978,3830532479],[1381578755,3757172800],[4109399782,1596778224],[288855589,1954372339],[3169178148,2256716053],[2644780093,3895892303],[107966643,1071681559],[1304747544,2607225372],[1359190711,1898207171],[3229237120,3273634996],[3027167685,3863637628],[3011615298,2883984519],[564135827,978463264],[770797430,362326607],[1983662611,1907583229],[4153656423,48268960],[3609759233,720080177],[3727911466,1270989899],[200708787,2366086947],[744508026,393422515],[1213261630,65757284],[3485747185,3845951003],[2958861301,1680248217],[2598470344,3163845864],[2767997908,4233451722],[3881113485,1492930166],[1773764017,2764062206],[4189435844,2898689174],[4234838742,1267095035],[2624081078,3302114327],[2395569449,390426320],[1728307101,690284926],[3309827454,1118258254],[2028172868,3888829086],[4271523049,909051386],[146617804,942892565],[2467685867,974297806],[2483428231,503635829],[3743260573,2018222096],[1002067894,2289153437],[3535252974,3738302271],[4154611160,1002664952],[3623154244,2349656961],[3646679180,3524329383],[862933752,4282853607],[2806008282,3272780913],[2734037942,3828874677],[1328176304,2137666995],[2278785213,2780788825],[381286368,1816476193],[2074232908,2316293454],[4087773386,3651330956],[967884669,3728964514],[4239349185,3213509668],[419231360,1463788948],[1275421624,2672384707],[1088456595,436245261],[2365565249,783696577],[1758083333,845223583],[2048846183,3530914274],[2635948261,124738415],[940630937,3069598626],[839474029,1253439921],[902477345,165479306],[2836079689,2681188273],[2007115168,2093139645],[1363041891,1282466609],[1130479818,1063857938],[3644959908,1260430427],[1385135238,46497915],[1386975934,3110156681],[2635987502,4233461619],[1915744629,4117939016],[487743653,285736599],[2049219159,3960249250],[69242857,3908563670],[1511066720,1488527520],[215590039,1703564952],[1459430344,4184955468],[676103291,2642967214],[83799035,3182827979],[1949179493,476101251],[2593534694,1493478716],[2283504289,995211746],[1349412676,3449243940],[2954378677,1878813305],[249149717,3329151870],[1578231917,1483986052],[4135085182,890874990],[461755528,3505523909],[3669622373,634949665],[219487622,2914465301],[2825233742,3703631897],[2479105382,2935590907],[2582097898,3187672881],[1221328648,1843341402],[2140891889,3958868911],[1482849818,345750049],[751922730,3178831411],[3546542069,4036458902],[216179596,877293293],[444615341,3117393729],[2424254530,494454238],[1344234989,3003337991],[929188581,2760877801],[2507911009,1879899982],[980166547,1311840394],[3566535507,1790747461],[143525013,2311336672],[4181962471,4273938872],[1815842366,862009811],[911175674,1179575598],[3591335374,3694215714],[1452686093,3393294272],[385158879,2447709103],[4011414929,1264623507],[1448477120,911094312],[3971299641,2289992053],[3133647265,2234591563],[3007628400,964409938],[1708345684,3673411261],[3031964479,2843021794],[3022128657,2480338599],[118850112,473449293],[2048127371,3202109429],[3158349745,382018770],[1505327237,3807570472],[2568424029,3272693060],[1866609495,3888556537],[844703982,1852802964],[3504617058,682636099],[1448882679,3733580327],[821387540,2215744532],[3631471417,311618895],[2077838877,2383929020],[3352949096,1688694420],[2491080787,3998672444],[3368630402,4182204255],[983299419,2837414346],[3651215291,1033373924],[265429091,3988955082],[3019003608,2896212153],[2955948456,3025235588],[903690197,2266253487],[3925215275,89402958],[3959093811,3609545561],[2455088053,223552128],[3115011301,2133669107],[1765081558,673805649],[3324795129,2111392191],[3443871631,432345706],[3152559950,3425427147],[3699649406,672784944],[3129545774,7668664],[2747044893,173040075],[3925243406,852328481],[164095314,3161868591],[2234471571,1302682825],[2164784335,105893718],[159995093,536831360],[599199451,425051327],[3274759746,1680930461],[1192619331,3903085578],[2832721114,3078660237],[91404660,4030521531],[3044880024,1578375623],[3906596030,754177855],[803516785,1894094672],[288455592,2030430096],[2143232492,2317305324],[388352703,3406060288],[2521731420,3588403719],[1043041227,4028028525],[3195290851,2468913324],[4166724431,3168683191],[1228226538,968516529],[500177583,3444787306],[533367442,4252082053],[4236023256,657816314],[413575568,3367198397],[3435884549,3334062733],[1004255532,1135705894],[2859513268,4170618274],[3914086821,1251487871],[3080761716,3489067886],[3571165255,699353261],[773372954,3648014952],[769693293,2939128604],[3116440923,507748478],[1687629160,3739431776],[2489486648,3502376324],[3686847158,2878383449],[3530767427,902211375],[2121652637,2493976397],[1827477891,930064171],[2549918411,4029725732],[2071415163,844118802],[2236083679,3088894868],[2040110303,4144562891],[3489536313,1133419300],[2190878435,2301466071],[2465915458,2448602097],[1675766804,2073834499],[3329799896,1613253148],[1483966600,1348836071],[159505618,2527621997],[2674227354,1695130688],[2683539437,1927873839],[3833196123,2570082188],[3891433165,759819981],[1455453349,2179602430],[1430583255,1957776111],[2067726741,4235143439],[303380021,2998980439],[2136024795,3126725799],[2054591852,1051702291],[1029141665,489794361],[2317027384,569642164],[2068461795,624418658],[2499875684,1830645251],[1302894490,4319401],[1002663431,2406815191],[1560941298,2060652753],[2141002286,515773223],[3661248027,475092913],[3705503008,2419919909],[914567990,3496539911],[3462935583,2039034761],[2878378006,2379243316],[1133857586,1390159333],[3023618742,2140726761],[282908558,944874642],[3686955701,1148723903],[2604456805,4163675010],[3061545110,377179268],[3218002352,76459088],[2836503392,916455101],[536836808,151306053],[2886925079,404221671],[2936593041,2011015485],[453815187,1852163908],[3042568989,82176306],[3279635891,4174836410],[3282689058,2360003049],[4088968807,1516570623],[2680453086,1322680794],[1731693966,3438253771],[1842894553,1294307894],[2736377365,2964642609],[121205621,521330014],[2324595870,3005710757],[3784465521,676493813],[1958759409,2030833406],[1306150933,1016370058],[2636541290,482366508],[1950415745,1695073534],[322077955,3746046623],[3602873262,3829181504],[1211684447,1861645455],[504701736,4080111082],[2407799203,1223857855],[1925743434,1498920209],[3617596327,845198428],[2498480299,3484773806],[2680229135,2560201696],[3731399221,1536412390],[2756509305,2924710846],[2635957500,3459716133],[1372762539,769635894],[802677945,3878474636],[1707760534,3075809808],[3714687192,2872792173],[1615679922,1606381794],[1940556374,1337437342],[445390489,731124040],[2864974375,64601760],[1984806574,2141516710],[513390958,1890172555],[744398315,1475299139],[982749166,852662657],[652663695,4260736510],[1184061125,82616221],[3363191899,147951756],[1064069880,1507328085],[2138882964,547595589],[2616926846,3186935246],[2298715513,3606862940],[2414381911,811477686],[2694745228,900437726],[4202576185,2201114451],[3602305260,3323446937],[3756663274,2658490339],[3061587876,2171079416],[3390977925,2850497765],[486312941,224925241],[3515712841,3510684394],[1322319486,2647200565],[3839619171,1148450258],[392296762,1154854654],[1401523788,957405781],[1934485528,527352730],[645968162,3131215255],[696971825,3361451947],[2038689491,1946699733],[1723966113,2785859721],[2652365974,1118037185],[3988018407,3134982149],[1354171594,3053634345],[1287854075,2631782435],[1723106141,2662328866],[563845090,1878819261],[639520332,171129501],[534957223,1696062352],[3612364282,2283204027],[3109494688,1304463816],[500957989,630925278],[3477030536,2149497258],[4109750364,281719363],[951472732,564407054],[922095147,2767874048],[3946156928,829677774],[2622281253,2086286851],[2936811901,850242186],[630086272,3340782667],[2340986210,1296336989],[4107355543,3865114709],[3560210278,3968418243],[3868847493,2967450637],[611513888,2083325060],[3265390517,3025776309],[2874106961,3424470508],[1668707698,2923258228],[2778598353,24320552],[292356118,3415510793],[754567370,86994591],[185141877,1621715171],[2884558258,3722473457],[1492107531,111281805],[3336927864,4225337056],[782994598,1021838039],[346133860,18281270],[2080909533,1649329040],[3612065399,3859901127],[2151962287,284556115],[3957975594,3745718727],[52533817,3998775856],[1232633839,397383972],[2716413964,3629253960],[1531307298,3836851439],[3030137657,2500401718],[3561556693,653345841],[313061910,2945718466],[2065276,3342140708],[410498334,1470588117],[2726640512,4051654894],[2570984935,758567696],[3008987264,3462702678],[623860175,228525243],[3527183895,1829844480],[467272850,3890501742],[568376656,650516927],[990477018,4035508558],[2366955227,817792110],[4183621538,989198068],[946958343,1639184195],[3395758993,3924097558],[1690887473,3220519765],[605184237,1255270525],[275515833,1926424610],[2142902612,283494960],[2021972412,1823828440],[105373677,3448326697],[1666662384,1042433908],[1338566998,261206307],[498685668,1344755577],[3101233780,3119109371],[2733370951,3808165089],[3656512268,3449289481],[4025308119,1607880299],[778896067,1612183167],[2846510368,3674754715],[3058428120,2991822529],[1892379383,3268787440],[2565895844,4154602030],[3213117192,98999135],[2495816991,116985075],[1040203361,1785041385],[3106252493,69316595],[1639829808,2087117568],[3213709576,3799911752],[604681594,2340981536],[4236730699,2938666503],[4009938384,1878897714],[2701667332,1725918218],[2182473079,1258184],[3550198211,2760750799],[657991062,875584532],[1640976276,3380476221],[460041378,2924352091],[1972323596,2287414795],[2510248061,1350206297],[2959337826,3762681165],[1625877874,3235902929],[2070189957,1429368735],[4245163299,1839731898],[2358312347,138364248],[275739390,2179122576],[2037777210,972544338],[2766930226,1984733259],[1933485829,4209310327],[3034118011,3286589799],[2653025529,62078937],[2641780289,2679545709],[3540781195,2787026415],[1569993599,3215949659],[441337890,3947723353],[1878946792,459505587],[3724105660,920173002],[1691411102,3934795955],[148741087,3647709027],[142506469,2776440083],[3811107376,3823285243],[472209891,252266174],[1913386482,1867329194],[2960608550,482740699],[1145005292,1513558421],[1091751784,1687823886],[3625186042,3086337482],[1712140887,940065262],[1504455800,1945702563],[3896940088,2003245591],[2478191531,4197739e3],[3233871270,250924495],[3404865229,1131917964],[1462204167,429621621],[1349259705,3641608989],[3627860584,2048468319],[1244251718,1513180369],[3979211282,371413143],[3043187861,4285699810],[581894202,3060983825],[1390895705,1811317301],[2599134010,3337406128],[2488233440,2436161462],[1816641224,2208816697],[1792034756,815866116],[2779893723,2695577703],[2084952115,2951772258],[1351806869,169269771],[2469979804,86740603],[1163545420,4264616949],[1795352113,2511146232],[1796715044,3134635815],[3521170642,1538900329],[3725363621,1455009392],[1342594643,1512127734],[2618386938,662157428],[2028859350,2494504685],[1841905045,648351336],[4002935891,4033319405],[850071259,1768358867],[979915719,3876018087],[830889197,1629549437],[1744763229,2455795856],[522919199,368499868],[3063822504,2522639205],[2861636095,407686388],[4097602344,1945259027],[4215946617,1251639506],[894485042,534122652],[924809191,1807237502],[1811585710,1589663609],[3439653887,1722232],[3810997538,105152714],[2677100683,4291805514],[77233985,102407776],[4239834691,2851274395],[148802076,2006440603],[2409138150,126301601],[3048474397,3217504870],[588133437,4221603123],[1139638106,263087485],[982032635,3165674595],[562514827,1294842959],[467575086,905357513],[1405117894,3370530088],[3813285157,242912619],[3601878331,1985076606],[1586505598,2092146221],[738488098,103663229],[2970334297,321718822],[1068097019,1742926233],[235518094,420804527],[283685722,4092504887],[2666392744,3799169331],[3569817788,1256762975],[2169728352,292617248],[2444571896,2239859206],[3967907832,1066404216],[420376911,2913277294],[3046293305,2956347747],[2311278792,2477686209],[2885955184,4172514290],[3030078181,2275536480],[4212469731,4280736393],[1046900335,1773022229],[995380926,1414273529],[3892683234,2429494358],[615726237,2127712535],[3880203074,2071130305],[176180504,3070850165],[1474506861,2283723599],[1256707747,1857412043],[764236850,359687368],[3521530334,511649419],[2318567964,3992868140],[128167623,2518992858],[2220129756,1042300052],[2567608573,1349636707],[441446694,384760969],[4143447316,829506048],[817912603,2738025500],[2368091832,357934982],[1187643061,1561463042],[3438021235,3030161697],[1318922279,895468690],[434876457,1130220303],[1180291767,1132759596],[2520707785,1798553137],[1962430872,2958700157],[1510954061,3534879512],[57831539,3269538993],[3354831405,3852135009],[891783098,2698494511],[2555636406,996018997],[2881342935,3982231648],[3473267445,2894952368],[1238029452,3958679326],[2051805420,559465638],[3655936674,1186951582],[330209165,167662935],[1929681327,2450868735],[1313566811,2458925988],[4283920930,3243182650],[1438004300,4185567150],[3093439067,89876832],[3401620219,3721579956],[3673745794,2682874719],[3053321309,825410712],[822915968,3681514755],[3900685126,561657358],[553823814,1857753416],[4166295066,983949325],[128359165,3426887194],[3300989119,3884968622],[4193552686,3647722552],[452189154,1569670618],[4122259632,3537825460],[2519387887,2821594244],[74333898,2940550377],[4032631446,2173999692],[2521268686,1934310532],[2620314688,2177785789],[1378755571,2455646622],[394133753,4231198609],[734399075,2800989170],[573292462,1634883078],[1214417373,3426576256],[2110224475,2399009920],[2331215665,3224086912],[531326186,698539511],[3839443603,583861850],[2644531398,2017784332],[616620850,3070237104],[590349237,2798642861],[3582377217,3317831670],[1582708616,1596570667],[2126148205,2358511947],[173450736,3219362418],[3616831144,1323437318],[2655785577,3131359031],[401600069,2967397952],[496349349,4244179910],[2479612086,2579650653],[1710903074,2049666425],[3589924952,690291925],[3266682943,1900485231],[1496318498,3025542656],[3459221058,3389461212],[2091479615,3140389256],[663040899,1207089672],[3323704225,1105530508],[353318429,2879253542],[2674540957,941987316],[1688550857,620657353],[338551967,4286217277],[204689992,2239736295],[178008789,3940832005],[3871613304,3300636974],[1911672356,2429684487],[4055679954,1974461722],[3878217928,1009991796],[2533095482,310920740],[2174833823,3596041637],[1604814460,2939543881],[1452830254,4092397851],[2441027029,4169690209],[3524103304,3372213855]],Me=[[836181454,1689436944],[2776523577,3710710688],[4049974663,3750330768],[519497435,2979405513]],ge=[[1892447193,197291556],[3793382197,3742120663],[3838936,2994760034],[479846099,1018728609],[3476112862,182272649],[3504620154,1427438450],[2009473484,2679350403],[1738755500,1129731339]],Ce=[4174784170,2938602761],Be={p:0,P:1,n:2,N:3,b:4,B:5,r:6,R:7,q:8,Q:9,k:10,K:11},De=[];De[5]=1,De[6]=0,De[9]=3,De[10]=2,De[17]=5,De[18]=4,De[33]=7,De[34]=6,De[65]=9,De[66]=8,De[129]=11,De[130]=10;var M=[2,5,10,20,40,80,160,64],Je="nbrq",zt=["","0000000","000000","00000","0000","000","00","0",""],cn=16;function xt(Qe){var pn=Qe.toString(16);return zt[pn.length]+pn}function yr(Qe){return xt(Qe[0])+xt(Qe[1])}function Kn(Qe){return[parseInt(Qe.substr(0,8),16),parseInt(Qe.substr(8),16)]}function ht(Qe,pn){var dt,We,ot=Qe.split(" "),xe=ot[0].split("/"),gn,Jt,jn,nr,Tr,mn,Pn,Pt,ft=ot[1]==="w",Dt=0,Dn,Bn,ie=Number(ft),E=ie?3:4;for(gn=7;gn>=0;gn-=1)for(Jt=0,jn=xe[gn],Tr=jn.length,nr=0;nr<Tr;nr+=1)mn=jn[nr],Dn=Be[mn],Dn>=0&&(Pn=Le[64*Dn+8*(7-gn)+Jt],dt=(dt^Pn[0])>>>0,We=(We^Pn[1])>>>0,Dn===ie&&gn===E&&(Dt|=1<<Jt)),Jt+=Number(mn)||1;return ot[2]!=="-"&&(Pt=ot[2],Pt.indexOf("K")>-1&&(Pn=Me[0],dt=(dt^Pn[0])>>>0,We=(We^Pn[1])>>>0),Pt.indexOf("Q")>-1&&(Pn=Me[2],dt=(dt^Pn[0])>>>0,We=(We^Pn[1])>>>0),Pt.indexOf("k")>-1&&(Pn=Me[1],dt=(dt^Pn[0])>>>0,We=(We^Pn[1])>>>0),Pt.indexOf("q")>-1&&(Pn=Me[3],dt=(dt^Pn[0])>>>0,We=(We^Pn[1])>>>0)),ot[3]&&ot[3]!=="-"&&(Bn=ot[3].charCodeAt(0)-97,M[Bn]&Dt&&(Pn=ge[Bn],dt=(dt^Pn[0])>>>0,We=(We^Pn[1])>>>0)),ft&&(dt=(dt^Ce[0])>>>0,We=(We^Ce[1])>>>0),pn&&pn==="hex"?yr([dt,We]):[dt,We]}function bt(Qe,pn){var dt=new XMLHttpRequest,We=Qe.toLowerCase().indexOf(".json")>-1;function ot(){var xe;if(dt.status>=200&&dt.status<300||dt.status===304||dt.status===0||dt.status===1223)if(We)try{pn(null,JSON.parse(dt.response))}catch(gn){pn(gn)}else xe=new DataView(dt.response),pn(null,xe);else pn(new Error("Error code: "+dt.status))}dt.open("GET",Qe,!0),We||(dt.responseType="arraybuffer"),dt.onload=ot,dt.onerror=ot,dt.send()}function er(Qe){var pn,dt={},We,ot,xe;function gn(Pt,ft){var Dt=We.getUint16(Pt+8),Dn=We.getUint16(Pt+10),Bn,ie,E,Y,R,de;return ie=Dt>>9&7,E=Dt>>6&7,Y=Dt>>3&7,R=Dt&7,de=Dt>>12&7,E===4&&ft&&ie===Y&&ft!=="-"&&(R===7&&(ie===0&&ft.indexOf("K")>-1||ie===7&&ft.indexOf("k")>-1)?R-=1:R===0&&(ie===0&&ft.indexOf("Q")>-1||ie===7&&ft.indexOf("q")>-1)&&(R+=2)),Bn=String.fromCharCode(E+97)+(ie+1)+String.fromCharCode(R+97)+(Y+1),de&&(Bn+=Je[de-1]),{move:Bn,weight:Dn}}function Jt(Pt){Pt.sort(function(Dt,Dn){return Dn.weight-Dt.weight})}function jn(Pt){return typeof Pt=="string"&&(Pt={fen:Pt}),pn(Pt)}function nr(Pt){var ft,Dt,Dn,Bn,ie,E=0;if(Pt=Pt||{},ft=Pt.moves||jn(Pt),Jt(ft),Dn=ft.length,Dn){if(!Pt.type||Dn===1||Pt.type==="best")return ft[0].move;if(Pt.type==="random"){for(Bn=Math.floor(Math.random()*ft.sum)+1,ie=0;ie<Dn-1&&(E+=ft[ie].weight,!(Bn<=E));ie+=1);return ft[ie].move}else return Pt.type==="randomDisregardWeight"?ft[Math.floor(Math.random()*Dn)].move:Pt.type==="worst"?ft[Dn-1].move:(Dt=parseInt(Pt.type)||1,Dt<0&&(Dt=Dn+Dt+1),Dt<1?Dt=1:Dt>Dn&&(Dt=Dn),ft[Dt-1].move)}}function Tr(Pt){var ft=We.length||We.byteLength||0,Dt=Pt.offset||0,Dn,Bn=Pt.fen,ie=Pt.chess960,E=Pt.checkAll,Y,R=[],de=0,Ae,me,on;for(Pt.hash?(Dn=Pt.hash,typeof Dn=="string"&&(Dn=Kn(Dn))):Dn=ht(Bn),!ie&&Bn&&(on=Bn.split(" ")[2]),Dt=0;Dt<ft;Dt+=cn)if(We.getUint32(Dt)===Dn[0]&&We.getUint32(Dt+4)===Dn[1])Ae=gn(Dt,on),R[R.length]=Ae,de+=Ae.weight,Y=!0;else if(Y&&!E)break;if(R.sum=de,Pt.relative)for(me=R.length-1;me>=0;me-=1)R[me].relative=Math.round(R[me].weight/de*1e4);return R}function mn(Pt){var ft=[],Dt,Dn=Pt.b.length;for(Dt=0;Dt<Dn;++Dt)ft.push({move:Pt.b[Dt],weight:Pt.w[Dt]});return ft}function Pn(Pt){var ft,Dt,Dn=0,Bn,ie,E,Y=Pt.fen,R;if(dt.useFen)Bn=Y.replace(/ \d+ \d+$/,""),ft=ot[Bn],ft||(ie=Bn.replace(/[a-h][1-8]$/,"-"),ie!==Bn&&(ft=ot[ie]));else if(Pt.hash||(Pt.hash=ht(Y,"hex")),ft=ot[Pt.hash],ft){if(ft[0]&&ft[0].n&&(ft=ft[0]),ft.n&&!ft.b)return[];if(ft.b)ft=mn(ft);else if(!Pt.chess960&&Y)for(R=Y.split(" ")[2],Dt=ft.length-1;Dt>=0;Dt-=1)E=ft[Dt].move.match(/e([18])([ah])\1/),E&&(E[2]==="h"&&(E[1]==="1"&&R.indexOf("K")>-1||E[1]==="8"&&R.indexOf("k")>-1)?ft[Dt]={move:"e"+E[1]+"g"+E[1],weight:ft[Dt].weight}:E[2]==="a"&&(E[1]==="1"&&R.indexOf("Q")>-1||E[1]==="8"&&R.indexOf("q")>-1)&&(ft[Dt]={move:"e"+E[1]+"c"+E[1],weight:ft[Dt].weight}))}if(ft)for(Dt=ft.length-1;Dt>=0;Dt-=1)Dn+=Number(ft[Dt].weight);else ft=[];return ft.sum=Dn,ft}if(dt={query:jn,pick:nr},Qe.getUint32)pn=Tr,We=Qe,dt.buffer=We;else{pn=Pn,ot=Qe,dt.json=ot;for(xe in ot){dt.useFen=xe.indexOf(" ")>-1;break}}return dt}function dr(Qe,pn){function dt(We,ot){var xe;if(ot&&(xe=er(ot)),pn)return pn(We,xe);if(We)throw We;return xe}bt(Qe,dt)}var Jr=function(){var Qe={};return function(dt,We){if(Qe[dt]){Qe[dt].book?setTimeout(function(){We(null,Qe[dt].book)},0):Qe[dt].cbs.push(We);return}Qe[dt]={cbs:[We]},dr(dt,function(xe,gn){var Jt=Qe[dt].cbs;xe?delete Qe[dt]:(Qe[dt].book=gn,Qe[dt].cbs=void 0),Jt.forEach(function(jn){setTimeout(function(){jn(xe,gn)},0)})})}}();return{hash:ht,loadBook:Jr,to64BitHex:yr,zobristPiece:Le,zobristCastle:Me,zobristEnPassant:ge,zobristTurn:Ce,zobristPieceValue:Be,zobristPieceValueNumbers:De}}();/*!
 * Chess.com (c) 2020
 *
 * A distant fork of chess.js - BSD (c) 2014, Jeff Hlywa (jhlywa@gmail.com)
 */var te=function(){var Me={Chess:0,Chess960:1,Crazyhouse:2,"3-check":3,"King of the Hill":4,Bughouse:5,chess960:1,fischerandom:1,fischerrandom:1,fischer:1,chess9lx:1,960:1,crazyhouse:2,"three-check":3,threecheck:3,"3check":3,kingofthehill:4,koth:4,bughouse:5},ge=["Chess","Chess960","Crazyhouse","3-check","King of the Hill","Bughouse"],Ce={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Be,De,M,Je,zt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],cn=0,xt=0,yr=0,Kn=-1,ht=1,bt=2,er=4,dr=8,Jr=16,Qe=32,pn=64,dt=128,We=3,ot=252,xe=255,gn=256,Jt=512,jn=112,nr=1,Tr=2,mn=4,Pn=3,Pt=7,ft=14,Dt=21,Dn=127,Bn="pnbrqkPNBRQK",ie="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",E=[];E[5]=[-16,-17,-15],E[6]=[16,17,15],E[8]=[-18,-33,-31,-14,18,33,31,14],E[16]=[-17,-15,17,15],E[32]=[-16,1,16,-1],E[64]=[-17,-16,-15,1,17,16,15,-1],E[128]=[-17,-16,-15,1,17,16,15,-1];var Y={P:5,p:6,N:9,n:10,B:17,b:18,R:33,r:34,Q:65,q:66,K:129,k:130},R={P:4,p:4,N:8,n:8,B:16,b:16,R:32,r:32,Q:64,q:64,K:128,k:128},de={5:"P",6:"p",9:"N",10:"n",17:"B",18:"b",33:"R",34:"r",65:"Q",66:"q",129:"K",130:"k"},Ae={9:"N",10:"N",17:"B",18:"B",33:"R",34:"R",65:"Q",66:"Q",129:"K",130:"K"},me=[80,0,0,0,0,0,0,96,0,0,0,0,0,0,80,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,96,96,96,96,96,96,224,0,224,96,96,96,96,96,96,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,80,0,0,0,0,0,0,96,0,0,0,0,0,0,80],on=[336,80,80,0,0,0,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,360,508,252,0,252,508,360,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,0,0,0,80,80,336],L=[336,80,80,0,0,0,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,360,508,252,0,252,508,488,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,96,0,0,80,80,336],pe=[336,80,80,0,0,96,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,488,508,252,0,252,508,360,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,0,0,0,80,80,336],ye=[336,80,80,0,0,96,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,488,508,252,0,252,508,488,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,96,0,0,80,80,336],ke=[336,80,80,112,112,112,96,352,96,96,112,112,112,80,336,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,352,352,480,480,488,508,252,0,252,508,488,480,480,480,352,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,336,80,80,112,112,112,96,352,96,96,112,112,112,80,336],Q=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,33,16,31,15,0,0,0,0,0,0,0,0,0,0,0,18,17,16,15,14,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,-14,-15,-16,-17,-18,0,0,0,0,0,0,0,0,0,0,0,-15,-31,-16,-33,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],Ke=[0,5,8,11,14],yt=[31,7,7,7,63],In={P:0,p:0,N:5,n:5,B:8,b:8,R:11,r:11,Q:14,q:14},Tn=[er,dr,Jr,Qe,pn],Fr=["","N","B","R","Q"],vt={CAPTURE:1,BIG_PAWN:2,EP_CAPTURE:4,ANY_CAPTURE:5,PROMOTION:8,KSIDE_CASTLE:16,QSIDE_CASTLE:32,KQSIDE_CASTLE:48,DROP:64,DROP_OR_PROMOTE:72},_i=[0,6,1],_r={K:119,Q:112,k:7,q:0,A:112,B:113,C:114,D:115,E:116,F:117,G:118,H:119,a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},Ei=["Event","Site","Date","Round","White","Black","Result"],Jo=["Event","Site","Date","Round","White","Black","Result","Variant","SetUp","FEN","WhiteA","WhiteB","BlackA","BlackB"];function Ur(Kt){return Kt>>4}function Gt(Kt){return Kt&7}function Ut(Kt){return String.fromCharCode(Gt(Kt)+97)+(8-Ur(Kt))}function Dr(Kt){return 3-Kt}function rr(Kt,Mn){Kt[0]=(Kt[0]^Mn[0])>>>0,Kt[1]=(Kt[1]^Mn[1])>>>0}function wi(Kt,Mn,at){return Mn<1?Kt:(Mn=typeof Mn=="number"?Mn:80,Kt.replace(new RegExp("(.{1,"+Mn+`})(?: |$|\r?
)`,"g"),"$1"+at).slice(0,-at.length))}function pr(Kt){var Mn,at;return Kt=Kt.trim(),at=Kt.split(" "),Mn=[""," w - - 0 1"," - - 0 1"," - 0 1"," 0 1"," 1"][at.length],Mn&&Kt?Kt+=Mn:at[5]==="0"&&(at[5]=1,Kt=at.join(" ")),Kt}function Vr(Kt){var Mn=Math.floor(Kt%36e3/600),at=Math.floor(Kt%36e3%600)/10;return Math.floor(Kt/36e3)+":"+(Mn<10?"0":"")+Mn+":"+(at<10?"0":"")+at}function Mo(Kt){var Mn=Kt.split(":");return(Mn[0]*3600+Mn[1]*60+Mn[2]*1)*10}function go(){q.zobristCheck=[[441249556,340005552],[1040760204,311043682],[1621584863,1749286446],[1006868636,1625552915],[1953853171,24921145],[161251506,1935545265]]}function ga(Kt,Mn){var at=Kt.length,_e,At=0,Yt=0,$t=Mn&&(Mn===Me.Crazyhouse||Mn===Me.Bughouse),kt;for(_e=0;_e<at;++_e)if(kt=Kt[_e],+kt!=+kt)if(kt==="/"){if(Yt!==8&&(Kt=Kt.substr(0,_e)+(8-Yt)+Kt.substr(_e),++_e,++at),Yt=0,++At>7){if(!$t&&_e<at-1||!/^[pnbrq]{0,63}$/i.test(Kt.substr(_e+1)))return!1;break}}else if(Y[kt]){if(++Yt>8)return!1}else if(kt==="~")(!$t||!_e||!/[nbrq]/i.test(Kt[_e-1]))&&(Kt=Kt.substr(0,_e)+Kt.substr(_e+1),--_e,--at);else return!1;else Yt+=kt*1,Yt>8&&(Kt=Kt.substr(0,_e)+(kt-(Yt-8))+Kt.substr(_e+1),Yt=8);return Kt}function Bo(Kt,Mn){var at,_e,At,Yt=/^(?:[A-H]{1,2}[a-h]{0,2}|[A-H]{0,2}[a-h]{1,2}|KQ?k?q?|Qk?q?|kq?|q|-)$/,$t=Me[Mn]||Mn*1||Me[String(Mn).replace(/\s/g,"").toLowerCase()],kt=$t===Me.Crazyhouse||$t===Me.Bughouse,Tt,fn,$,W=0,z=0,k,ve=!0,U="",Pe={0:0,7:0},Ie={0:0,7:0},jt={0:"k",7:"K"},Xe={0:"r",7:"R"},it,ln,v=$t===Me.Chess960,C,G,ae,je,Ve,K,Et,Gn,ur,Pr,Hn;if(!Kt)return 1;if($t===Me.Bughouse&&(fn=Kt.split(" | "),fn.length===2))return $=Bo(fn[0],Mn),$===0&&($=Bo(fn[1],Mn)),$;if(fn=Kt.split(/\s+/),$t===Me["3-check"]&&fn.length===7&&(Tt=fn.pop(),!/^\+[0-3]\+[0-3]$/.test(Tt)||Tt==="+3+3"))return 14;if(fn.length!==6)return 1;if(/\D|.{7,}|^0|^$/.test(fn[5]))return 2;if(/\D|.{7,}|^0.|^$/.test(fn[4]))return 3;if(!/^(?:-|[abcdefgh][36])$/.test(fn[3]))return 4;if(C=fn[2],v){if(!Yt.test(C))return 12}else if(!/^(?:KQ?k?q?|Qk?q?|kq?|q|-)$/.test(C)){if(typeof Mn<"u"||!Yt.test(C))return 5;v=!0}if(fn[1]!=="w"&&fn[1]!=="b")return 6;if(kt&&(fn[0]=fn[0].replace(/~(?=.*\/)/g,"")),_e=fn[0].split("/"),kt&&_e.length===9&&(Tt=_e.pop(),!/^[pnbrq]{0,63}$/i.test(Tt)))return 13;if(_e.length!==8)return 7;if(fn[3][1]==="3"&&fn[1]==="w"||fn[3][1]==="6"&&fn[1]==="b")return 11;for(fn[3]!=="-"&&(z=fn[3][1]==="3"?4:3,k=z===4?5:2,W=fn[3].charCodeAt(0)-97,ve=!1,U=z===4?"P":"p"),at=0;at<_e.length;++at){for(ur=0,Pr=!1,Hn=0;Hn<_e[at].length;Hn++)if(At=_e[at][Hn],+At==+At){if(Pr)return 8;ur+=At*1,Pr=!0}else{if(Bn.indexOf(At)===-1)return 9;if(!ve&&z===at&&W===ur&&U===At&&(ve=!0),k===at&&W===ur)return 11;at%7===0&&(At===jt[at]?Ie[at]=1<<ur:At===Xe[at]&&(Pe[at]|=1<<ur)),++ur,Pr=!1}if(ur!==8)return 10}if(!ve)return 11;if(C!=="-"){if(v){for(ae={0:0,1:0,2:252,4:248,8:240,16:224,32:192,64:128,128:0},G={0:0,1:0,2:1,4:3,8:7,16:15,32:31,64:63,128:0},Gn={0:[0,0],7:[0,0]},at=C.length-1;at>=0;--at)if(K=C.charCodeAt(at),Et&&Et>K&&Et-K<8||(K===75?(Ve=7,je=Pe[Ve]&ae[Ie[Ve]]):K===81?(Ve=7,je=Pe[Ve]&G[Ie[Ve]]):K===107?(Ve=0,je=Pe[Ve]&ae[Ie[Ve]]):K===113?(Ve=0,je=Pe[Ve]&G[Ie[Ve]]):(Ve=K>=97?0:7,je=1<<K-(Ve?65:97),Et=K),!je||je&je-1)||Ie[Ve]<2||Ie[Ve]>64||(je&Pe[Ve])!==je||++Gn[Ve][(Ie[Ve]<je)*1]>1)return 15}else if(it=(C.indexOf("K")>-1?128:0)|(C.indexOf("Q")>-1?1:0),it&&(Ie[7]!==16||(it&Pe[7])!==it)||(ln=(C.indexOf("k")>-1?128:0)|(C.indexOf("q")>-1?1:0),ln&&(Ie[0]!==16||(ln&Pe[0])!==ln)))return 15}return 0}function ea(Kt,Mn){var at="",_e=0,At,Yt,$t=Mn?6:0;if(Kt)for(;_e<5;){for(At=Kt>>Ke[_e]&yt[_e],Yt=0;Yt<At;++Yt)at+=Bn[_e+$t];++_e}return at}function Fo(Kt,Mn){Mn[ht]&&rr(Kt,q.zobristCheck[Mn[ht]-1]),Mn[bt]&&rr(Kt,q.zobristCheck[Mn[bt]+2])}function _o(Kt,Mn){var at,_e,At,Yt,$t=0,kt,Tt,fn;for(at=1;at<3;++at){if(_e=Mn[at],_e)for(At=0;At<5;){for(kt=$t+At*63,Yt=_e>>Ke[At]&yt[At],Tt=0;Tt<Yt;++Tt)fn=q.zobristPiece[kt++],rr(Kt,[fn[0]*31>>>0,fn[1]*17>>>0]);++At}$t=315}}function ta(Kt,Mn,at,_e){(Kt[at+1]===_e||Kt[at-1]===_e)&&rr(Mn,q.zobristEnPassant[Gt(at)])}function vs(Kt,Mn){var at=[],_e,At;for(_e=0;_e<120;++_e)if(_e&136&&(_e+=8),At=Kt[_e],At&&(At&Mn)===Mn){at.push(_e);continue}return at}function xo(Kt,Mn,at,_e){var At;(De===0||Kt[at+8]&Tr)&&(Ur(at)%7===0?(At=_e|vt.PROMOTION|Mn<<Pt|at<<ft,zt[xt++]=At|4<<Dt,zt[xt++]=At|3<<Dt,zt[xt++]=At|2<<Dt,zt[xt++]=At|1<<Dt):zt[xt++]=_e|Mn<<Pt|at<<ft)}function Va(Kt){switch(Kt){case 67:case 68:case 51:case 52:return!0}return!1}function za(Kt,Mn,at,_e){var At=Mn+(at-Mn%8),Yt=at>Mn%8?1:-1,$t,kt,Tt;for(Tt=Mn+Yt;Tt!==At;Tt+=Yt)if(Kt[Tt])return!1;if(_e===ht?$t=Yt===1?118:114:$t=Yt===1?6:2,kt=$t-Yt,Kt[$t+8]||Kt[$t]&&$t!==Mn&&$t!==At||Kt[kt]&&kt!==Mn&&kt!==At)return!1;if($t!==Mn){for(Yt=$t>Mn?1:-1,Tt=Mn+Yt;Tt!==$t;Tt+=Yt)if(Tt!==At&&Kt[Tt]||Kt[Tt+8])return!1}return!0}var Uo=function(){function Kt(_e,At,Yt,$t,kt,Tt,fn){var $=[],W="",z=!0,k,ve,U,Pe,Ie,jt,Xe=At[Yt],it=Xe.length,ln,v,C="";if(Xe.commands)for(Pe in Xe.commands)(!Tt||Tt.indexOf(Pe)>-1)&&(C+="[%"+Pe+" "+Xe.commands[Pe]+"]");for(Xe.initComment&&!fn&&(C=(C+" "+Xe.initComment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),C&&$.push("{"+C+"}"),ve=0;ve<it;++ve){if(k=Xe[ve],jt=k.color===ht,W="",C="",$t!==Me.Bughouse?(z&&!jt?W=_e+"...":jt&&(W=_e+"."),kt&&(jt||z)&&(W+=" ")):($.bughouseOrder||($.bughouseOrder=[]),$.bughouseOrder.push(k.bughouseOrder),ve||($.blackCountOffset=Xe[0].color===bt?1:0)),W+=k.san,k.annotation&&(W+=k.annotation),k.additionalAnnotation&&(W+=" "+k.additionalAnnotation.join(" ")),z=!1,typeof k.time<"u"&&!k.commands&&(k.commands={clk:Vr(k.time)}),k.commands)for(Pe in k.commands)(!Tt||Tt.indexOf(Pe)>-1)&&(C+="[%"+Pe+" "+k.commands[Pe]+"]");if(k.comment&&!fn&&(C=(C+" "+k.comment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),C&&(W+=" {"+C+"}",z=!0),$.push(W),k.lines)for(ln=k.lines.length,U=0;U<ln;++U)v=k.lines[U],At[v].length&&(Ie=Kt(_e,At,v,$t,kt,Tt,fn),Ie[0]="("+Ie[0],Ie[Ie.length-1]+=")",$=$.concat(Ie),z=!0);jt||_e++}return $}function Mn(_e,At,Yt){var $t=At,kt=_e.siblingGame.pgn(),Tt=0,fn=0,$=[];for(At.bughouseOrder=At.bughouseOrder||[],kt.bughouseOrder=kt.bughouseOrder||[];At.bughouseOrder.length||kt.bughouseOrder.length;)!At.bughouseOrder.length||kt.bughouseOrder.length&&At.bughouseOrder[0]>kt.bughouseOrder[0]?(kt.bughouseOrder.shift(),$.push("B")):(At.bughouseOrder.shift(),$.push("A"));return At=[],$.forEach(function(W){var z,k,ve="",U;W==="A"?(z=$t,++Tt,k=Tt,U=_e.startingMoveNumber()):(z=kt,++fn,k=fn,U=_e.siblingGame.startingMoveNumber()),ve=String(Math.floor((k+1)/2)+U-1),(z.blackCountOffset+k)%2?ve+=W:ve+=W.toLowerCase(),ve+="."+(Yt?" ":"")+z.shift(),At.push(ve)}),At}function at(_e,At){return"["+_e+' "'+String(At).replace(/(\"|\\)/g,"\\$1")+'"]'}return function(At,Yt,$t,kt,Tt,fn){var $=typeof At.newline=="string"?At.newline:`
`,W=typeof At.spaceAfterPeriods>"u"?!0:At.spaceAfterPeriods,z="",k,ve;z+=at("Event",Yt.Event)+$,z+=at("Site",Yt.Site)+$,z+=at("Date",Yt.Date)+$,z+=at("Round",Yt.Round)+$,Tt===Me.Bughouse?(z+=at("WhiteA",Yt.WhiteA||"?")+$,z+=at("BlackA",Yt.BlackA||"?")+$,z+=at("WhiteB",Yt.WhiteB||"?")+$,z+=at("BlackB",Yt.BlackB||"?")+$):(z+=at("White",Yt.White)+$,z+=at("Black",Yt.Black)+$),z+=at("Result",Yt.Result)+$,Tt&&(z+=at("Variant",Yt.Variant)+$),Yt.FEN&&Yt.FEN!==ie&&(z+=at("SetUp","1")+$,z+=at("FEN",Yt.FEN)+$);for(k in Yt)Jo.indexOf(k)===-1&&(z+=at(k,Yt[k])+$);if(z+=$,ve=Kt(kt,$t,0,Tt,W,At.hideCommands?[]:At.restrictCommands,At.hideComments),Tt===Me.Bughouse){if(fn.isDependent)return ve;ve=Mn(fn,ve,W)}return ve.push(Yt.Result),z+wi(ve.join(" "),At.maxWidth,$)}}(),Ho=function(){var Kt="!?\u203C\u2047\u2049\u2048\u25A1\u2207\u0394\u221E\u2A72\u2A71\xB1\u2213\u2A00\u27F3\u2192\u2191\u21C6\u2206\u2313\u21D4\u21D7\u27EB\u27EA\u2715\u22A5\u2295\u25CB\u21C4\u21BB\u2299\u2612~",Mn=/\[%(\S+)\s([^\]]+)\]/,at=/^(?:[+=~\/\-\u2212]+|T?N|RR|D)$/;function _e(Yt){for(var $t,kt=Yt.commands||{};$t=Mn.exec(Yt.value);)Yt.value=Yt.value.replace($t[0],"").trim(),kt[$t[1]]=$t[2],Yt.commands=kt}function At(Yt,$t,kt,Tt){for(var fn;++$t<kt;)if((fn=Yt[$t].trim())&&fn[0]!=="%")return fn[0]==="["&&(!Tt||/^\[\S+\s+".*"\]$/.test(fn))}return function($t,kt){var Tt,fn,$,W,z="tags",k,ve,U,Pe=[],Ie={type:z,value:""},jt=0,Xe=[],it=!0;kt=kt||{},Tt=$t.split(/\r?\n/),W=Tt.length;e:for(fn=0;fn<W;++fn)if($=Tt[fn].trim(),$[0]!=="%")if(!$)Pe.length&&(z==="tags"?(z="san",it=!1):z!=="tagValueStart"&&At(Tt,fn,W,jt||z==="comment")&&(z==="comment"&&Pe.push(Ie),Pe[Pe.length-1].type!=="tagValue"&&(Xe.push(Pe),Pe=[]),z="tags",it=!0,jt=0));else{if($=" "+$+" ",ve=$.length,k=0,it)for(;k<ve;++k)if(U=$[k],z==="tags"){if(U==="[")z="tagName",Ie={type:z,value:""};else if(U.trim()){z="san",Ie={type:z,value:""},it=!1;break}}else if(z==="tagName")Ie.value&&U.trim()===""?(Pe.push(Ie),z="tagValueStart"):U!==" "&&(Ie.value+=U);else if(z==="tagValueStart"){if(U==='"'||U==="\u201C")z="tagValue",Ie={type:z,value:""};else if(U.trim()){Pe.push({type:"tagValue",value:$.slice(k,-1).match(/(.*?)"?\]?$/)[1]}),z="tags",Ie={type:z,value:""};continue e}}else if(z==="tagValue")if(U==='"'||U==="\u201D")if(Pe.push(Ie),$[k+1]==="]")z="tags",Ie={type:z,value:""},++k;else if($.slice(-2,-1)==="]"){Ie.value+=$.substr(k).match(/(.*?)"?\s*\] $/)[1],z="tags",Ie={type:z,value:""};continue e}else z="tagEnd";else U==="\\"&&k+2<ve&&(++k,U=$[k]),k>0&&(Ie.value+=U);else{if(U!=="]"){if(!U.trim())continue;--k}z="tags",Ie={type:z,value:""}}for(;k<ve;++k)if(U=$[k],z==="san"){if(Kt.indexOf(U)>-1)U==="!"||U==="?"||Kt.indexOf(U)<6&&(U=["!!","??","!?","?!"][Kt.indexOf(U)-2])?(Ie.value&&Pe.push(Ie),Ie={type:"a",value:U},($[k+1]==="!"||$[k+1]==="?")&&(Ie.value+=$[++k]),Pe.push(Ie),Ie={type:"san",value:""}):(U==="\u221E"&&Ie.value==="=/"?(Ie.type="aa",Ie.value+=U):(Ie.value&&(at.test(Ie.value)&&(Ie.value!=="--"||kt.rejectNullMoves)&&(Ie.type="aa"),Pe.push(Ie)),Ie={type:"aa",value:U},U==="\u2191"&&$[k+1]==="\u2191"&&(Ie.value="\u21BB",++k)),Pe.push(Ie),Ie={type:"san",value:""});else if(U===" "||U==="	"||U==="\r"||U==="{"||U==="("||U===")"){if(Ie.value){if(Ie.value[0]==="$")Ie.type="nag";else if(Ie.value==="*"||Ie.value==="1-0"||Ie.value==="0-1"||Ie.value==="1/2-1/2"||Ie.value==="\xBD-\xBD")if(jt||k+1<ve)Ie.type=Ie.value==="*"?"cont":"comment";else{if(Ie.type="result",Ie.value==="\xBD-\xBD"&&(Ie.value="1/2-1/2"),Pe.push(Ie),Xe.push(Pe),fn+1===W||fn+2===W&&!Tt[fn+1])return Xe;z="tags",it=!0,Ie={type:z,value:""},Pe=[];break}at.test(Ie.value)&&(Ie.value!=="--"||kt.rejectNullMoves)&&(Ie.type="aa"),Pe.push(Ie),Ie={type:z,value:""}}if(U===" "||U==="	"||U==="\r")z="san";else if(U==="{")z="comment",Pe.length&&Pe[Pe.length-1].type==="comment"&&(Ie=Pe.pop(),Ie.value+=" ");else if(U==="(")z="san",Pe.push({type:"variationStart",value:++jt});else{if(jt<1){if(!kt.commentErrors)return!1}else Pe.push({type:"variationEnd",value:jt--});z="san"}Ie.type=z}else if(U!=="."&&(Ie.value||+U!=+U||$[k+1]==="-"||$[k+1]==="/"))Ie.value+=U;else if(+U==+U)switch(Ie.number||(Ie.number=""),Ie.number+=U,$[k+1]){case"A":case"a":case"B":case"b":Ie.number+=$[++k],Pe.push({type:"number",value:Ie.number}),delete Ie.number}}else k===0&&(Ie.value=Ie.value.trim()),U!=="}"?(U==="\\"&&k+2<ve&&(U=$[++k]),Ie.value+=U):(Ie.value=Ie.value.trim(),Ie.value.indexOf("[")>-1&&_e(Ie),Pe.push(Ie),z="san",Ie={type:z,value:""})}return Ie.value&&Pe.push(Ie),(Pe.length||!Xe.length)&&Xe.push(Pe),Xe}}();function Pi(Kt,Mn){var at,_e,At=0,Yt=!0,$t=[],kt=ht,Tt=[],fn=Kn,$=0,W=1,z=1,k=[],ve=[k],U=0;k.id=U;var Pe={},Ie=[],jt=!1,Xe=!1,it=b,ln=function(y,T){var x="",H,O,X,Z,_t,nt;return y&vt.KQSIDE_CASTLE?y&vt.KSIDE_CASTLE?x="O-O":x="O-O-O":y&vt.DROP?(X=y>>ft&Dn,H=y>>Dt,H&&(x+=Fr[H]),x+="@"+Ut(X)):(X=y>>ft&Dn,O=y>>Pt&Dn,Z=_e[O],Z&er?(y&vt.ANY_CAPTURE&&(x+=String.fromCharCode(Gt(O)+97)+"x"),x+=Ut(X),y&vt.PROMOTION&&(H=y>>Dt,x+="="+Fr[H])):(x+=Ae[Z&xe],yr>1&&(x+=Te(Z,O,X)),y&vt.ANY_CAPTURE&&(x+="x"),x+=Ut(X))),T||(y&vt.KQSIDE_CASTLE?(O=y>>Pt&Dn,X=y>>ft&Dn):y&vt.DROP_OR_PROMOTE&&(Z=Tn[H]+kt),Nn(Z,O,X,y)&&(it(y,O,X,H),_t=cn,cn=xt,nt=yr,At&&yn()||ar()===cn?x+="#":x+="+",xt=cn,cn=_t,yr=nt,fe(k.pop()))),x};function v(){var y=kt===ht?[4174784170,2938602761]:[0,0],T,x,H;for(H=0;H<120;++H)H&136&&(H+=8),T=_e[H],T&&rr(y,q.zobristPiece[64*q.zobristPieceValueNumbers[T&xe]+8*(7-Ur(H))+Gt(H)]);if(Xe)for(x=1;x<3;++x)Tt[x]&&(Tt[x]&Tt[x]-1?(rr(y,q.zobristCastle[x-1]),rr(y,q.zobristCastle[x+1])):Tt[x]>1<<Gt($t[x])?rr(y,q.zobristCastle[x-1]):rr(y,q.zobristCastle[x+1]));else{for(x=1;x<3;++x)Tt[x]&&(Tt[x]&vt.KSIDE_CASTLE&&rr(y,q.zobristCastle[x-1]),Tt[x]&vt.QSIDE_CASTLE&&rr(y,q.zobristCastle[x+1]));jt?_o(y,at._hand):At===Me["3-check"]&&Fo(y,Ie)}return fn!==Kn&&ta(_e,y,fn+(kt===ht?16:-16),er|kt),y}function C(){var y;return k.length?y=k[k.length-1].hash:(k.hash||(k.hash=v()),y=k.hash),[y[0],y[1]]}function G(y){function T(H){return/#/.test(H)&&en()&&(H=H.replace("#","+")),H}function x(H,O){var X=y(H,O);return X&&(typeof X=="string"?X=T(X):(X.san=T(X.san),k[k.length-1].san=X.san)),X}return x._isBughouseified=!0,x._orig=y,x}function ae(y,T){var x=At;y?At=Me[y]||y*1||Me[String(y).replace(/\s/g,"").toLowerCase()]||Me.Chess:At=0,x!==At&&(At===Me.Bughouse?(jt=!0,at.isDependent||(at.siblingGame=Pi(),at.siblingGame.hashing(Yt),at.siblingGame.isDependent=!0,at.siblingGame.siblingGame=at,at.siblingGame.header({Variant:"Bughouse"})),go(),it=oe,ln=G(ln),at.move=G(at.move)):(delete at.siblingGame,jt=At===Me.Crazyhouse,Xe=At===Me.Chess960,At?(go(),it=oe):it=b,ln._isBughouseified&&(ln=ln._orig,at.move=at.move._orig)),T||Vt(Pr()))}function je(y,T){for(var x=y>7?ht:bt,H,O;!(y&136);){if(H=_e[y],H&x){if(H&Qe){if(O)return;O=y%8+(x===ht?65:97)}else if(H&dt)return O}y+=T}}function Ve(y,T,x){_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],kt=ht,$t[ht]=Kn,$t[bt]=Kn,Tt[ht]=0,Tt[bt]=0,at._hand[ht]=0,at._hand[bt]=0,Ie[ht]=0,Ie[bt]=0,fn=Kn,$=0,W=1,T||(k=[],ve=[k],U=0,k.id=U,Pe={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},y?Hn(["Variant",y]):ae(!1,x),x||Vt(Pr()))}function K(){Ve(0,!1,!0),k.hash=[1178310168,378666140],_e=[34,10,18,66,130,18,10,34,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,33,9,17,65,129,17,9,33,0,0,0,0,0,0,0,0],z=1,$t[ht]=116,$t[bt]=4,Tt[ht]=48,Tt[bt]=48}function Et(y,T,x,H){var O=0,X,Z,_t,nt,Ue,j,qe,Qt,Fn,Vn,Un,an;if(H?(X=y.split(" "),an=X[3],Un=X[2]):(X=y.trim().split(/\s+/),an=X[3]||"-",Un=X[2]||"-"),typeof T>"u"?(Un.charCodeAt(0)&31)<9&&ae(Me.Chess960,!0):ae(T,!0),Z=X[0],!H&&!(Z=ga(Z,At)))return!1;if(nt=Z.length,Ve(ge[At],x,!0),jt){if(At===Me.Bughouse&&!at.isDependent&&(j=y.split(" | "),!at.siblingGame.load(j.length===1?y:j[1],T,x,H)))return K(),!1;for(Ue=0;Ue<nt;++Ue)if(qe=Z[Ue],+qe!=+qe)if(qe==="/")if(O>111){for(++Ue;Ue<nt;++Ue)qe=Z[Ue],at._hand[qe<"a"?ht:bt]+=1<<In[qe]>>>0;break}else O+=8;else _e[O]=Y[qe],Z[Ue+1]==="~"&&(++Ue,_e[O]|=Jt),_e[O]&dt&&($t[_e[O]&We]=O),++O;else O+=qe*1}else for(Ue=0;Ue<nt;++Ue)qe=Z[Ue],+qe!=+qe?qe==="/"?O+=8:(_e[O]=Y[qe],_e[O]&dt&&($t[_e[O]&We]=O),++O):O+=qe*1;if(kt=X[1]==="b"?bt:ht,Un!=="-")if(Xe){for(Fn={1:[0,0],2:[0,0]},Ue=Un.length-1;Ue>=0;--Ue)_t=Un.charCodeAt(Ue),_t===75?_t=je(119,-1):_t===81?_t=je(112,1):_t===107?_t=je(7,-1):_t===113&&(_t=je(0,1)),Qt=_t<97?ht:bt,Vn=_r[String.fromCharCode(_t)],(H||_e[Vn]===(Qe|Qt))&&(_t>=97?$t[Qt]>=1&&$t[Qt]<=6&&(Tt[Qt]|=1<<Vn):$t[Qt]>=113&&$t[Qt]<=118&&(Tt[Qt]|=1<<Vn-112),++Fn[Qt][($t[Qt]<Vn)*1]);(Fn[ht][0]>1||Fn[ht][1]>1)&&(Tt[ht]=0),(Fn[bt][0]>1||Fn[bt][1]>1)&&(Tt[bt]=0)}else{if(!H)for(Ue=Un.length-1;Ue>=0;--Ue)Qt=Un.charCodeAt(Ue)<97?ht:bt,(_e[_r[Un[Ue]]]!==(Qe|Qt)||$t[Qt]!==(Qt===ht?116:4))&&(Un=Un.substr(0,Ue)+Un.substr(Ue+1));for(Ue=Un.length-1;Ue>=0;--Ue)switch(Un[Ue]){case"K":Tt[ht]|=vt.KSIDE_CASTLE;break;case"Q":Tt[ht]|=vt.QSIDE_CASTLE;break;case"k":Tt[bt]|=vt.KSIDE_CASTLE;break;case"q":Tt[bt]|=vt.QSIDE_CASTLE;break}}return!H&&(an.length!==2||kt===ht&&an[1]!=="6"||kt===bt&&an[1]!=="3"||_e[an.charCodeAt(0)-97+(8-(an[1]==="3"?4:5))*16]!==(er|Dr(kt))||_e[Ce[an]])&&(an="-"),fn=an==="-"?Kn:Ce[an],$=X[4]*1||0,W=X[5]*1||1,At===Me["3-check"]&&(X[6]&&X[6]!=="+3+3"&&(j=X[6].match(/^\+([0-3])\+([0-3])$/)),j=j||[0,0,0],Ie[ht]=j[1]*1,Ie[bt]=j[2]*1),x||(z=W,Vt(Pr())),!0}function Gn(){var y=0,T="",x,H="",O;for(x=0;x<120;++x)x&136&&(y&&(T+=y),T+="/",y=0,x+=8),O=_e[x],O?(y&&(T+=y,y=0),T+=de[O&xe]):++y;return y&&(T+=y),Tt[ht]&vt.KSIDE_CASTLE&&(H+="K"),Tt[ht]&vt.QSIDE_CASTLE&&(H+="Q"),Tt[bt]&vt.KSIDE_CASTLE&&(H+="k"),Tt[bt]&vt.QSIDE_CASTLE&&(H+="q"),T+=" "+(kt===ht?"w":"b")+" "+(H||"-")+" "+(fn===Kn?"-":Ut(fn))+" "+$+" "+W,T}function ur(){var y=0,T="",x,H,O="",X;for(x=0;x<120;++x)x&136&&(y&&(T+=y),T+="/",y=0,x+=8),X=_e[x],X?(y&&(T+=y,y=0),T+=de[X&xe],jt&&X&Jt&&(T+="~")):++y;if(y&&(T+=y),jt&&(T+="/"+ea(at._hand[ht],!0)+ea(at._hand[bt])),Xe){for(H=Tt[bt],x=0;H;)H&1&&(O=String.fromCharCode(x+97)+O),H>>=1,++x;for(H=Tt[ht],x=0;H;)H&1&&(O=String.fromCharCode(x+65)+O),H>>=1,++x}else Tt[ht]&vt.KSIDE_CASTLE&&(O+="K"),Tt[ht]&vt.QSIDE_CASTLE&&(O+="Q"),Tt[bt]&vt.KSIDE_CASTLE&&(O+="k"),Tt[bt]&vt.QSIDE_CASTLE&&(O+="q");return T+=" "+(kt===ht?"w":"b")+" "+(O||"-")+" "+(fn===Kn?"-":Ut(fn))+" "+$+" "+W,At===Me["3-check"]?T+=" +"+Ie[ht]+"+"+Ie[bt]:At===Me.Bughouse&&!at.isDependent&&(T+=" | "+at.siblingGame.fen()),T}function Pr(){return At?ur():Gn()}function Hn(y){var T,x,H;for(T=0;T<y.length;T+=2)x=y[T],H=y[T+1],x&&(x==="Variant"&&(ae(H),At?H=ge[At]:H=void 0),x==="Result"&&H!=="*"&&H!=="1-0"&&H!=="0-1"&&H!=="1/2-1/2"&&(H="*"),H!==void 0?Pe[x]=String(H):Ei.indexOf(x)>-1?x==="Date"?Pe[x]="????.??.??":Pe[x]="?":delete Pe[x]);return Pe}function Vt(y){k.length>0||U||(y!==ie?(Pe.SetUp="1",Pe.FEN=y,k.hash=null):(delete Pe.SetUp,delete Pe.FEN,k.hash=[1178310168,378666140]))}function et(y){var T=_e[Ce[y]];return T?{type:de[T&ot|bt],color:T&We,promoted:(T&Jt)!==0}:null}function Re(y,T){return Xe&&Tt[y]?ke:Tt[y]&vt.KSIDE_CASTLE&&!_e[T+1]&&!_e[T+2]?Tt[y]&vt.QSIDE_CASTLE&&!_e[T-1]&&!_e[T-2]&&!_e[T-3]?(Je=vt.KQSIDE_CASTLE,ye):(Je=vt.KSIDE_CASTLE,L):Tt[y]&vt.QSIDE_CASTLE&&!_e[T-1]&&!_e[T-2]&&!_e[T-3]?(Je=vt.QSIDE_CASTLE,pe):on}function Xt(y,T){var x,H,O,X=kt,Z,_t,nt,Ue,j,qe,Qt,Fn,Vn,Un,an=_e;if(Be=[],De=0,M=0,Je=0,an[8]=an[9]=an[10]=an[11]=an[12]=an[13]=an[14]=an[15]=an[24]=an[25]=an[26]=an[27]=an[28]=an[29]=an[30]=an[31]=an[40]=an[41]=an[42]=an[43]=an[44]=an[45]=an[46]=an[47]=an[56]=an[57]=an[58]=an[59]=an[60]=an[61]=an[62]=an[63]=an[72]=an[73]=an[74]=an[75]=an[76]=an[77]=an[78]=an[79]=an[88]=an[89]=an[90]=an[91]=an[92]=an[93]=an[94]=an[95]=an[104]=an[105]=an[106]=an[107]=an[108]=an[109]=an[110]=an[111]=an[120]=an[121]=an[122]=an[123]=an[124]=an[125]=an[126]=an[127]=0,T===Kn){Be=vs(_e,X|y);return}for(Vn=Re(X,T),x=0;x<120;++x)if(x&136&&(x+=8),Z=_e[x],!!Z){if(Z&X){(!y||(Z|0)&y)&&Be.push(x);continue}if(Un=Vn[x-T+119],!!(Un&Z))if(Z&er)for(qe=E[Z],H=1;H<3;++H)Ue=x+qe[H],!(Ue&136)&&(an[Ue+8]|=nr,Ue===T&&(++De,an[x+8]|=Tr));else{qe=E[Z&ot],j=qe.length,Fn=Z&jn;e:for(H=0;H<j;++H)if(Qt=qe[H],Ue=x,!(T>Ue&&Qt<0&&T-Ue>16||T<Ue&&Qt>0&&Ue-T>16))for(;!((Ue+=Qt)&136);){if(an[Ue+8]|=nr,_t=_e[Ue],_t){if(_t&X){if(Ue===T){for(O=Ue-Qt;O!==x;O-=Qt)an[O+8]|=Tr;an[x+8]|=Tr,++De,Fn&&(Ue+=Qt,Ue&136||(an[Ue+8]|=nr))}else if(Fn&&Un&gn){for(nt=Ue;(nt+=Qt)!==T;)if(nt&136||_e[nt])continue e;an[Ue+8]|=mn+(Math.abs(Qt)<<Pn),++M}}break}if(!Fn)break}}}De>1&&(Be=[T])}function un(y,T){var x,H,O=T+16*(kt===ht?1:-1),X;return De===1&&!(_e[T+8]&Tr)&&!(_e[O+8]&Tr)?!1:(x=_e[y],_e[T]=x,_e[y]=0,H=_e[O],_e[O]=0,X=vr(),_e[y]=x,_e[T]=0,_e[O]=H,!X)}function cr(y){var T,x,H;if(Xe){if(Tt[y])for(T=$t[y],x=T%8,H=0;H<8;++H)Tt[y]&1<<H&&za(_e,T,H,y)&&(zt[xt++]=(H>x?vt.KSIDE_CASTLE:vt.QSIDE_CASTLE)+(T<<Pt)+(T+(H-x)<<ft),++H)}else Je&vt.KSIDE_CASTLE&&(T=$t[y],x=T+2,_e[T+9]===0&&_e[T+10]===0&&(zt[xt++]=vt.KSIDE_CASTLE+(T<<Pt)+(x<<ft))),Je&vt.QSIDE_CASTLE&&(T=$t[y],x=T-2,_e[T+7]===0&&_e[T+6]===0&&(zt[xt++]=vt.QSIDE_CASTLE+(T<<Pt)+(x<<ft)))}function or(y,T,x){var H,O,X,Z,_t;if(!y){for(T&&(T>>=26),Z=0;Z<5;++Z)if((!T||(T|0)===1<<Z)&&at._hand[x]&yt[Z]<<Ke[Z]){for(Z===0?(H=16,O=103,X=vt.DROP):(H=0,O=119,X=vt.DROP|Z<<Dt),_t=H;_t<=O;++_t)_t&136&&(_t+=8),_e[_t]||(De===0||De===1&&_e[_t+8]&Tr)&&(zt[xt++]=X|_t<<ft);if(T)return}}}function ar(y,T){var x,H,O,X=kt,Z=Dr(X),_t,nt,Ue,j,qe,Qt=$t[X],Fn,Vn;for(Xt(y,Qt),yr=Be.length,xt=cn,Fn=0;Fn<yr;++Fn)if(x=Be[Fn],_t=_e[x],!(De&&M&&_e[x+8]&mn))if(_t&er)for(Ue=E[_t],(M===0||!(_e[x+8]&mn)||_e[x+8]>>Pn===16)&&(nt=x+Ue[0],_e[nt]===0&&(xo(_e,x,nt,0),_i[X]===Ur(x)&&(nt+=Ue[0],_e[nt]||xo(_e,x,nt,vt.BIG_PAWN)))),H=1;H<3;++H)j=Ue[H],nt=x+j,!(nt&136||M&&_e[x+8]&mn&&_e[x+8]>>Pn!==Math.abs(j))&&(_e[nt]&Z?xo(_e,x,nt,vt.CAPTURE):nt===fn&&un(x,nt)&&(zt[xt++]=vt.EP_CAPTURE|x<<Pt|nt<<ft));else{if(M&&_e[x+8]&mn){if(_t&dr)continue;if(me[x-$t[X]+119]&_t)j=_e[x+8]>>Pn,Ue=[j,-j];else continue}else Ue=E[_t&ot];if(Vn=x<<Pt,x===Qt){for(H=0;H<8;++H)j=Ue[H],nt=x+j,nt&136||(_e[nt]?_e[nt]&Z&&(_e[nt+8]&nr||(zt[xt++]=vt.CAPTURE|Vn|nt<<ft)):_e[nt+8]&nr||(zt[xt++]=Vn|nt<<ft));De===0&&cr(X)}else for(O=Ue.length,qe=_t&jn,H=0;H<O;++H)for(j=Ue[H],nt=x;nt+=j,!(nt&136);){if(_e[nt]){_e[nt]&Z&&(De===0||_e[nt+8]&Tr)&&(zt[xt++]=vt.CAPTURE|Vn|nt<<ft);break}else(De===0||_e[nt+8]&Tr)&&(zt[xt++]=Vn|nt<<ft);if(!qe)break}}return At&&(jt?or(T,y,X):!Xe&&yn()&&(xt=cn)),xt}function Nn(y,T,x,H){var O,X,Z,_t,nt,Ue,j,qe,Qt;if(At===Me["King of the Hill"]&&y&dt&&Va(x))return!0;if(H&vt.KQSIDE_CASTLE&&(kt===ht?x=H&vt.KSIDE_CASTLE?117:115:x=H&vt.KSIDE_CASTLE?5:3,y=Qe,Qt=!0),O=$t[Dr(kt)],O===Kn)return!1;if(!(y&dt)&&(X=me[x-O+119],X&y))for(_t=Q[x-O+119],Ue=y&jn,nt=x+_t;!(nt&136);){if(nt===O){if(y&er){if((y&We)===ht?O-x<0:O-x>0)return!0;break}return!0}if(nt!==T&&_e[nt]||!Ue)break;nt+=_t}if(!Qt){if(Z=me[T-O+119],Z&jn&&(_t=Q[T-O+119],_t!==Q[x-O+119]))for(nt=O-_t;!(nt&136);){if(nt!==T&&(j=_e[nt],j)){if(j&kt&&Z&j&&j&jn)return!0;break}nt-=_t}if(H&vt.EP_CAPTURE&&(qe=x+16*(kt===ht?1:-1),Z=me[qe-O+119],Z&jn))for(_t=Q[qe-O+119],nt=O-_t;!(nt&136);){if(nt!==T&&nt!==qe){if(nt===x)break;if(j=_e[nt],j){if(j&kt&&Z&j&&j&jn)return!0;break}}nt-=_t}}return!1}function Er(y,T){var x,H,O,X=E[dr],Z,_t=dr|y;for(x=0;x<8;++x)if(O=T+X[x],!(O&136)&&(H=_e[O],(H&_t)===_t))return!0;for(X=E[dt],x=0;x<8;++x)for(Z=X[x],O=T+Z;!(O&136);){if(H=_e[O],H){if(H&y&&me[T-O+119]&H)if(H&er){if(y===ht?T-O<0:T-O>0)return!0}else return!0;break}O+=Z}return!1}function Mr(y){return $t[y]!==Kn&&Er(Dr(y),$t[y])}function vr(){return Mr(kt)}function en(){var y,T,x,H=1<<Ke[4];return at._hand[kt]+=H,y=cn,cn=xt,T=yr,x=ar()!==cn,xt=cn,cn=y,yr=T,at._hand[kt]-=H,x}function qt(){return vr()&&(zt[0]=0)===ar()&&!zt[0]&&(At!==Me.Bughouse||!en())}function Rn(){var y=!vr()&&(zt[0]=0)===ar()&&!zt[0];return y&&At===Me.Bughouse&&!at.isDependent&&(y=at.siblingGame.inStalemate()),y&&$t[kt]!==Kn}function $e(y){var T,x,H=100,O=0,X=0,Z=0;for(x=0;x<120;++x)if(x&136&&(x+=8),T=_e[x],T){if(y&&!(T&y))continue;if(H&T)return!1;if(T&dr){if(X||O++)return!1}else if(T&Jr&&(O||(++X,(Ur(x)+x)%2&&++Z,Z&&X!==Z)))return!1}return $t[ht]!==Kn&&$t[bt]!==Kn}function It(){if($<8)return!1;for(var y=C(),T=!1,x,H=$,O=!1,X=k,Z=X.length-1;;){if(Z-=2,Z<0){if(X.id){Z=X.atMoveNode+Z+2,X=ve[X.parentId];continue}if(Z===-2)return!1;x=X.hash,O=!0}else x=X[Z].hash,X[Z].halfMoves>H||H<2?O=!0:H=X[Z].halfMoves;if(x[0]===y[0]&&x[1]===y[1]){if(T)return!0;T=!0}if(O)return!1}}function Ht(y){var T=y.move,x,H,O,X,Z,_t,nt,Ue,j,qe;if(At===Me.Crazyhouse||T&vt.DROP?(H=at._hand,_t=y.hash,qe=y.color):(H=at.siblingGame._hand,y.handSibling=!0,Yt&&(nt=at.siblingGame._history(),nt.length?_t=nt[nt.length-1].hash:(nt.hash||(nt.hash=at.siblingGame._hashPosition()),_t=nt.hash)),qe=Dr(y.color)),y.captured){switch(y.captured&Jt?O=er:O=y.captured&ot,O&ot){case er:Ue=0;break;case dr:Ue=1;break;case Jr:Ue=2;break;case Qe:Ue=3;break;default:Ue=4}x=1<<Ke[Ue],Yt&&(Z=H[qe]>>Ke[Ue]&yt[Ue],j=q.zobristPiece[Z+63*Ue+(qe===ht?0:315)])}else X=T>>Dt,x=-1<<Ke[X],Yt&&(Z=H[qe]>>Ke[X]&yt[X],j=q.zobristPiece[Z-1+63*X+(qe===ht?0:315)]);H[qe]+=x,y.handChange=x,Yt&&rr(_t,[j[0]*31>>>0,j[1]*17>>>0])}function b(y,T,x,H){var O=kt,X=Dr(O),Z,_t,nt,Ue,j={move:y,epSquare:fn,halfMoves:$,castlingW:Tt[ht],castlingB:Tt[bt],color:O},qe,Qt,Fn=O===ht,Vn,Un;Yt&&(Ue=C(),j.hash=Ue,rr(Ue,q.zobristTurn),fn!==Kn&&ta(_e,Ue,fn+(Fn?16:-16),er|O)),y&vt.KQSIDE_CASTLE?Vn=dt:jt&&y&vt.DROP?(_e[x]=Tn[H]|O,Yt&&rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[_e[x]]+8*(7-Ur(x))+Gt(x)]),Ht(j),Vn=0):(Vn=_e[T],Un=_e[x],Un&&(j.captured=Un,Yt&&rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[_e[x]&xe]+8*(7-Ur(x))+Gt(x)]),Un&Qe&&Tt[X]&&(Xe?Ur(x)===(Fn?0:7)&&(nt=1<<Gt(x),Tt[X]&nt&&(Tt[X]^=nt,Yt&&(nt>1<<Gt($t[O])?rr(Ue,q.zobristCastle[X-1]):rr(Ue,q.zobristCastle[X+1])))):x===(Fn?7:119)?Tt[X]&vt.KSIDE_CASTLE&&(Tt[X]^=vt.KSIDE_CASTLE,Yt&&rr(Ue,q.zobristCastle[X-1])):x===(Fn?0:112)&&Tt[X]&vt.QSIDE_CASTLE&&(Tt[X]^=vt.QSIDE_CASTLE,Yt&&rr(Ue,q.zobristCastle[X+1])))),y&vt.PROMOTION?_e[x]=Tn[H]|O|Jt:_e[x]=_e[T],_e[T]=0,Yt&&(rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[Vn&xe]+8*(7-Ur(T))+Gt(T)]),rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[_e[x]&xe]+8*(7-Ur(x))+Gt(x)]))),y&vt.EP_CAPTURE?(Fn?(Qt=x+16,qe=6):(Qt=x-16,qe=8),j.captured=er|X,_e[Qt]=0,Yt&&rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[er|X]+8*(qe-Ur(x))+Gt(x)])):Vn&dt?(Xe?(y&vt.KQSIDE_CASTLE&&(_e[x]=0,_e[T]=0,y&vt.KSIDE_CASTLE?Fn?(Z=118,_t=117):(Z=6,_t=5):Fn?(Z=114,_t=115):(Z=2,_t=3),_e[Z]=O|dt,_e[_t]=O|Qe,Yt&&(rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[dt|O]+8*(7-Ur(T))+Gt(T)]),rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[Qe|O]+8*(7-Ur(x))+Gt(x)]),rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[dt|O]+8*(7-Ur(Z))+Gt(Z)]),rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[Qe|O]+8*(7-Ur(_t))+Gt(_t)]))),Yt&&(Tt[O]&Tt[O]-1?(rr(Ue,q.zobristCastle[O-1]),rr(Ue,q.zobristCastle[O+1])):Tt[O]>1<<Gt($t[O])?rr(Ue,q.zobristCastle[O-1]):rr(Ue,q.zobristCastle[O+1])),$t[O]=Z||x):(y&vt.KQSIDE_CASTLE&&(_e[x]=_e[T],_e[T]=0,y&vt.KSIDE_CASTLE?(Z=x-1,_t=x+1):(Z=x+1,_t=x-2),_e[Z]=_e[_t],_e[_t]=0,Yt&&(rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[dt|O]+8*(7-Ur(T))+Gt(T)]),rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[Qe|O]+8*(7-Ur(_t))+Gt(_t)]),rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[dt|O]+8*(7-Ur(x))+Gt(x)]),rr(Ue,q.zobristPiece[64*q.zobristPieceValueNumbers[Qe|O]+8*(7-Ur(Z))+Gt(Z)]))),Yt&&(Tt[O]&vt.KSIDE_CASTLE&&rr(Ue,q.zobristCastle[O-1]),Tt[O]&vt.QSIDE_CASTLE&&rr(Ue,q.zobristCastle[O+1])),$t[O]=x),Tt[O]=0):Vn&Qe&&Tt[O]&&(Xe?Ur(T)===(Fn?7:0)&&(nt=1<<Gt(T),Tt[O]&nt&&(Tt[O]^=nt,Yt&&(nt>1<<Gt($t[O])?rr(Ue,q.zobristCastle[O-1]):rr(Ue,q.zobristCastle[O+1])))):T===(Fn?119:7)?Tt[O]&vt.KSIDE_CASTLE&&(Tt[O]^=vt.KSIDE_CASTLE,Yt&&rr(Ue,q.zobristCastle[O-1])):T===(Fn?112:0)&&Tt[O]&vt.QSIDE_CASTLE&&(Tt[O]^=vt.QSIDE_CASTLE,Yt&&rr(Ue,q.zobristCastle[O+1]))),y&vt.BIG_PAWN?(Fn?fn=x+16:fn=x-16,Yt&&ta(_e,Ue,x,er|X)):fn=Kn,Vn&er||y&vt.ANY_CAPTURE?$=0:$++,kt=X,k.push(j)}function se(){var y={color:kt,san:"--",epSquare:fn},T={color:kt,san:"--"},x;return Yt&&(x=C(),y.hash=x,rr(x,q.zobristTurn),fn!==Kn&&ta(_e,x,fn+(kt===ht?16:-16),er|kt)),fn=Kn,$++,kt=Dr(kt),kt===ht&&++W,k.push(y),T}function oe(y,T,x,H){var O,X=kt;b(y,T,x,H),O=k[k.length-1],jt?($=O.halfMoves+1,O.captured&&Ht(O),At===Me.Bughouse&&(O.bughouseOrder=at.moveCount()-1+at.siblingGame.moveCount())):At===Me["3-check"]&&Mr(kt)&&(O.checked=!0,Yt&&Ie[X]&&rr(O.hash,q.zobristCheck[Ie[X]+(X===ht?-1:2)]),++Ie[X],Yt&&rr(O.hash,q.zobristCheck[Ie[X]+(X===ht?-1:2)]))}function fe(y){var T,x,H=kt,O=Dr(H),X=y.move,Z=X>>ft&Dn,_t=X>>Pt&Dn;if(kt=O,Tt[bt]=y.castlingB,Tt[ht]=y.castlingW,fn=y.epSquare,$=y.halfMoves,At){if(Xe&&X&vt.KQSIDE_CASTLE){X&vt.KSIDE_CASTLE?O===ht?(x=118,T=117):(x=6,T=5):O===ht?(x=114,T=115):(x=2,T=3),_e[x]=0,_e[T]=0,_e[_t]=O|dt,_e[Z]=O|Qe,$t[O]=_t;return}if(y.handChange&&(At===Me.Crazyhouse||!y.handSibling?at._hand[O]-=y.handChange:at.siblingGame._hand[Dr(O)]-=y.handChange),X&vt.DROP){_e[Z]=0;return}y.checked&&--Ie[O]}X&vt.PROMOTION?(_e[_t]=er|O,X&vt.CAPTURE?_e[Z]=y.captured:_e[Z]=0):(_e[_t]=_e[Z],X&vt.KQSIDE_CASTLE?(_e[Z]=0,X&vt.KSIDE_CASTLE?(T=Z+1,x=Z-1):(T=Z-2,x=Z+1),_e[T]=O|Qe,_e[x]=0,$t[O]=_t):(Z===$t[O]&&($t[O]=_t),X&vt.CAPTURE?_e[Z]=y.captured:(_e[Z]=0,X&vt.EP_CAPTURE&&(_e[Z-(O===ht?-16:16)]=er|H))))}function Te(y,T,x){var H,O,X,Z,_t,nt,Ue,j;if(xt<2)return"";for(y=y&ot,j=0;j<xt;++j)if(H=zt[j],Ue=H>>ft,x===Ue&&(Z=H>>Pt&Dn,Z!==T&&(O=_e[Z],O&y))){if(X=!0,Ur(T)===Ur(Z)){if(_t)return Ut(T);nt=!0}if(Gt(T)===Gt(Z)){if(nt)return Ut(T);_t=!0}}return X?_t?String(8-Ur(T)):String.fromCharCode(Gt(T)+97):""}function Ne(y,T,x){var H,O,X=y>>ft&Dn,Z={color:kt,to:Ut(X),flags:y&Dn};return!jt||!(y&vt.DROP)?(H=y>>Pt&Dn,Z.from=Ut(H),Z.piece=_e[H],y&vt.PROMOTION&&(O=y>>Dt,Z.promotion=Tn[O]+kt),y&vt.CAPTURE?Z.captured=_e[X]:y&vt.EP_CAPTURE&&(Z.captured=er|Dr(kt))):(O=y>>Dt,Z.drop=O,Z.piece=Tn[O]+kt),T?Z.san=T:Z.san=ln(y,x),Z}function yn(){if(At===Me["3-check"])return Ie[Dr(kt)]===3;if(At===Me["King of the Hill"])return Va($t[Dr(kt)])}function F(){if(At===Me.Bughouse)return at.siblingGame.inCheckmate()}function he(){if(At===Me.Bughouse)return at.siblingGame.in50MoveRule()||at.siblingGame.inThreefoldRepetition()}function we(){var y=[],T=Pr(),x=k.length-1,H=k[x];return H?(y.parentId=U,y.id=ve.length,k.curFen=T,H.lines||(H.lines=[]),H.lines.push(y.id),H.move?fe(H):(fn=H.epSquare,--$,kt=Dr(kt)),kt===bt&&--W,y.atMoveNode=x,x?y.hash=k[x-1].hash:y.hash=k.hash,U=y.id,ve.push(y),k=y,!0):!1}function Oe(y){var T=Pr();k.curFen=T,k=ve[y],U=y,Et(k.curFen,At,!0,!0)}return at={WHITE:ht,BLACK:bt,PAWN:er,KNIGHT:dr,BISHOP:Jr,ROOK:Qe,QUEEN:pn,KING:dt,FLAGS:vt,load:Et,reset:K,moves:function(y){var T=[],x,H=ln,O,X;for(y&&(y.verbose&&(H=Ne),y.type&&(O=y.type|y.type<<24),X=y.noDrop),ar(O,X),x=0;x<xt;++x)T.push(H(zt[x]));return T},inCheck:vr,inCheckmate:qt,inStalemate:Rn,isBughouseWin:F,in50MoveRule:function(){return $>=100},inDraw:function(){return $>=100||Rn()||$e()||It()||!!he()},insufficientMaterial:$e,inThreefoldRepetition:It,isVariantWin:yn,gameOver:function(){return at.inDraw()||qt()||!!yn()||!!F()},isPositionValid:function(y){var T,x,H=0,O;if(y=y||{},y.pawns!==!1)for(T=0;T<=119;){if(O=_e[T],O&er)return!1;++T===8&&(T=112)}if(y.kings!==!1){for(T=0;T<=119;++T)if(T&136&&(T+=8),O=_e[T],O&dt){if(++H>2||x&&x&O)return!1;x=O&We}if(H!==2)return!1}return!(y.check!==!1&&!(y.kings===!1&&$t[Dr(kt)]===Kn)&&Mr(Dr(kt)))},validateFen:Bo,fen:Pr,pgn:function(y){return y=y||{},!y.useResultHeader&&!U&&(yn()||qt()?Pe.Result=kt===bt?"1-0":"0-1":at.inStalemate()?Pe.Result="1/2-1/2":F()&&(Pe.Result=at.siblingGame.turn()===ht?"1-0":"0-1")),Uo(y,Pe,ve,z,At,at)},loadPgn:function(y,T,x){var H,O,X,Z,_t={},nt,Ue,j=0,qe;if(typeof T!="number"&&(x=x||T,T=0),x=x||{},typeof y=="string"&&(x.singleGame&&(y=y.replace(/(?:\r?\n\s*){2,}/g,`
`)),y=at.tokenizePgn(y,x)),T<0&&(T=y.length+T),Z=y[T],!Z)return!1;for(K(),O=Z.length,H=0;H<O&&(X=Z[H],X.type==="tagName");++H){if(!Z[H+1]||Z[H+1].type!=="tagValue")return!1;++H,X.value==="FEN"?qe=pr(Z[H].value):_t[X.value]=Z[H].value}if(x.variant&&(_t.Variant=x.variant),_t.Variant&&!qe&&(qe=ie),qe||_t.SetUp==="1"){if(_t.SetUp==="0")_t.FEN=qe;else if(!qe||!Et(qe,_t.Variant))return!1}for(at.header(_t),nt=at,Ue=nt._history();H<O;++H)if(X=Z[H],X.type==="san"&&j===0){if(!nt.move(X.value)&&(X.value!=="Z0"&&X.value!=="<>"||x.rejectNullMoves||!nt.move("--")))if(x.commentErrors)Ue.length?Ue[Ue.length-1].comment=((Ue[Ue.length-1].comment||"")+" "+X.value).trim():Ue.initComment=((Ue.initComment||"")+" "+X.value).trim();else if(x.skipBadLines&&(U!==0||k.length&&x.allowBadMainLine))j=1;else return K(),!1}else if(X.type==="result"&&Pe.Result==="*")Hn(["Result",X.value]);else if(X.type==="a"&&j===0&&Ue[Ue.length-1])Ue[Ue.length-1].annotation=X.value;else if((X.type==="nag"||X.type==="aa")&&j===0&&Ue[Ue.length-1])Ue[Ue.length-1].additionalAnnotation||(Ue[Ue.length-1].additionalAnnotation=[]),Ue[Ue.length-1].additionalAnnotation.indexOf(X.value)===-1&&Ue[Ue.length-1].additionalAnnotation.push(X.value);else if(X.type==="comment"&&j===0)Ue.length?(X.value&&(Ue[Ue.length-1].comment=X.value),X.commands&&(Ue[Ue.length-1].commands=X.commands,X.commands.clk&&(Ue[Ue.length-1].time=Mo(X.commands.clk)))):(Ue.initComment=String(X.value),X.commands&&(Ue.commands=X.commands));else if(X.type==="variationStart"){if(j>0)++j;else if(!we())return K(),!1;Ue=nt._history()}else if(X.type==="variationEnd")j>0&&--j,j===0&&(Oe(Ue.parentId),Ue=nt._history());else if(X.type==="number"){if(/b/i.test(X.value.slice(-1))?nt=at.siblingGame:nt=at,!nt)return!1;Ue=nt._history()}else X.type==="cont"&&U&&!Ue.length&&nt.move(nt._lines()[Ue.parentId][Ue.atMoveNode].san);return!0},header:function(y){return Array.isArray(y)?Hn(y):(typeof y=="object"&&Object.keys(y).forEach(function(T){Hn([T,y[T]])}),Pe)},turn:function(y){return(y===ht||y===bt)&&(kt=y),kt},move:function y(T){var x,H,O,X,Z,_t,nt,Ue,j,qe,Qt,Fn,Vn;if(typeof T=="string"){switch(X=T.length-1,T[X]){case"+":case"#":T=T.substr(0,X)}for(Bn.indexOf(T[0])>6?j=R[T[0]]:T[0]==="O"?j=dt:j=er,jt&&(T.indexOf("@")===-1?qe=!0:(qe=!1,j<<=24)),ar(j,qe),X=0;X<xt;++X)if(_t=ln(zt[X],!0),T===_t){H=zt[X];break}if(H)nt=H>>Pt&Dn,Ue=H>>ft&Dn,O=H>>Dt;else{if(T==="--")return se();if(T=at.fixMove(T))try{return y(T)}catch{}return null}}else{if(T.drop){switch(T.drop){case"p":O=0;break;case"n":O=1;break;case"b":O=2;break;case"r":O=3;break;case"q":O=4;break;default:return null}j=1<<26+O}else{if(T.promotion)switch(T.promotion){case"q":O=4;break;case"n":O=1;break;case"r":O=3;break;case"b":O=2;break;default:return null}nt=Ce[T.from],qe=!0,j=_e[nt]&ot}for(Ue=Ce[T.to],x=((O?O<<Dt:0)|Ue<<ft)>>Pt|nt,ar(j,qe),X=0;X<xt;++X)if(zt[X]>>Pt===x){H=zt[X];break}if(!H)return(T=at.fixMove(T))?y(T):null}return H&vt.DROP_OR_PROMOTE?Vn=Tn[O]+kt:Vn=_e[nt],Z=Ne(H,_t,!0),Qt=Nn(Vn,nt,Ue,H),it(H,nt,Ue,O),Qt&&(At&&yn()||ar()===0?Z.san+="#":Z.san+="+"),Fn=k[k.length-1],Fn.san=Z.san,Z.piece&Jt&&(Fn.promoted=!0),kt===ht&&++W,Z},undo:function(y){var T=k.pop();return T?(kt===ht&&--W,T.move?(fe(T),y?!0:Ne(T.move,T.san)):(fn=T.epSquare,--$,kt=Dr(kt),y?!0:{san:"--",color:T.color})):null},clear:function(y){Ve(y)},put:function(y,T,x){var H=Ce[T],O=!1,X,Z=_e[H],_t=Z&We,nt=y.color;if(isNaN(H)||!y.type||!nt||Bn.indexOf(y.type)===-1)return!1;if(_e[H]=R[y.type]|nt|(y.promoted?Jt:0),_e[H]&dt&&($t[nt]=H),Z&&_e[$t[_t]]&&_e[$t[_t]]!==(dt|_t)){for(X=0;X<120;++X)X&136&&(X+=8),_e[X]===(dt|_t)&&($t[_t]=X,O=!0);O||($t[_t]=Kn)}return x||Et(Pr(),At,!1,!1),!0},get:et,remove:function(y,T){var x=_e[Ce[y]],H=et(y),O=x&We,X;if(_e[Ce[y]]=0,x&dt){for($t[O]=Kn,Tt[O]=0,X=0;X<120;++X)if(X&136&&(X+=8),_e[X]===(dt|O)){$t[x.color]=X;break}}return T||Et(Pr(),At,!0,!1),H},history:function(y,T){for(var x=[],H,O=k,X=O.length;;){if(--X===-1)if(O.id&&!T){X=O.atMoveNode,O=ve[O.parentId];continue}else break;y?(H=Ne(O[X].move,O[X].san),H.color=O[X].color,!X&&O.initComment&&(H.firstComment=O.initComment),O[X].comment!==void 0&&(H.comment=O[X].comment),O[X].time!==void 0&&(H.time=O[X].time),O[X].annotation!==void 0&&(H.annotation=O[X].annotation),O[X].additionalAnnotation!==void 0&&(H.additionalAnnotation=O[X].additionalAnnotation),O[X].commands!==void 0&&(H.commands=O[X].commands),O[X].captured!==void 0&&(H.captured=O[X].captured),O[X].promoted!==void 0&&(H.promoted=O[X].promoted),O[X].lines!==void 0&&(H.lines=O[X].lines),O[X].bughouseOrder!==void 0&&(H.bughouseOrder=O[X].bughouseOrder),Bn.indexOf(O[X].san[0])>6?H.piece=R[O[X].san[0]]:O[X].san[0]==="O"?H.piece=dt:H.piece=er,H.piece|=H.color,x.unshift(H)):x.unshift(O[X].san)}return x},hashes:function(){for(var y=[],T=k,x=T.length;;){if(--x===-1)if(T.id){x=T.atMoveNode,T=ve[T.parentId];continue}else{T.hash||C(),y.unshift(T.hash);break}y.unshift(T[x].hash)}return y},moveCount:function(){return k.length},startingMoveNumber:function(){return z},completeFen:pr,createVariation:we,selectLine:Oe,hash:function(){var y=C();return At===Me.Bughouse&&!at.isDependent?[y,at.siblingGame.hash()]:y},hashing:function(y){Yt=y,At===Me.Bughouse&&!at.isDependent&&at.siblingGame.hashing(Yt)},hand:function(){if(jt)return ea(at._hand[ht],!0)+ea(at._hand[bt])},checks:function(){if(At===Me["3-check"])return[Ie[ht],Ie[bt]]},threats:function(){var y=kt,T=Dr(y),x=[],H=[],O=[],X=[],Z=[],_t=fn,nt,Ue,j,qe,Qt,Fn,Vn;if(Xt(0,$t[y]),De||M)for(nt=0;nt<120;++nt)nt&136&&(nt+=8),_e[nt+8]&Tr&&_e[nt]?O.push(Ut(nt)):_e[nt+8]&mn&&x.push(Ut(nt));for(kt=T,fn=Kn,ar(),nt=xt;nt--;){if(Ue=zt[nt],Qt=Ue>>ft&Dn,Fn=Ue>>Pt&Dn,Ue&vt.DROP_OR_PROMOTE){if(Vn=Ue>>Dt,qe=Tn[Vn]|T,Ue&vt.PROMOTION&&Vn%3!==1)continue}else qe=_e[Fn],Vn=0;if(Nn(qe,Fn,Qt,Ue)&&(it(Ue,Fn,Qt,Vn),cn=nt,(At&&yn()||ar()===nt)&&H.push((Ue&vt.DROP?de[qe].toLowerCase()+"@":Ut(Fn))+Ut(Qt)),fe(k.pop()),Ue&vt.CAPTURE)){for(j=0,nt=xt;nt>cn;)if((zt[--nt]>>ft&Dn)===Qt){j=1,nt=cn;break}if(!j){X.push(Ut(Fn)+Ut(Qt));continue}}Ue&vt.CAPTURE&&Vn!==1&&(j=_e[Qt]&124)&&(Er(y,Qt)?(qe=_e[Fn]&ot,j>qe&&j-qe!==8&&Z.push(Ut(Fn)+Ut(Qt))):X.push(Ut(Fn)+Ut(Qt)))}return cn=0,kt=y,fn=_t,{pins:x,checkers:O,mates:H,undefended:X,underdefended:Z}},tokenizePgn:Ho,fixMove:function(y){var T,x,H;if(typeof y=="string"){if(/0|[?!+#]$|[18][QNRB]$|^P/i.test(y))return y.replace(/[?!+#]+$/,"").replace(/0/g,"O").replace(/([18])([QNRB])$/i,"$1=$2").replace(/^P+/i,"");if(x=y.indexOf("=")>0?-4:-2,T=Ce[y.substr(x,2)],typeof T=="number"){if(_e[T]&Dr(kt)||/^[a-h]x?[a-h][36]$/.test(y)){if(y.indexOf("x")===-1)return y.slice(0,x)+"x"+y.substr(x)}else if(y.indexOf("x")>-1)return y.replace(/x/g,"");if(H=y.match(/^([KQNRB]?)([a-h][1-8]?|[1-8])x?([a-h][1-8])=?(.?)$/)){if(_e[Ce[H[2]]])return{from:H[2],to:H[3],promotion:H[4].toLowerCase()};if(/^\d$/.test(H[2])){for(y=0,ar(R[H[1]],!0),x=0;x<xt;++x)if(zt[x]>>ft===T&&Ur(zt[x]>>Pt&Dn)===8-H[2]){if(y)return;y=zt[x]}if(y)return ln(y,!0)}return H[1]+H[3]+H[4]}}}else if(_e[Ce[y.from]]===(dt|kt)&&y.to&&y.from[1]===y.to[1]){if(y.from<y.to)return"O-O";if(y.from>y.to)return"O-O-O"}},_hand:[],_history:function(y){return y&&(k=y,U=k.id),k},_lines:function(){return ve},_hashPosition:v,_board:function(){return _e}},Kt&&Et(Kt,Mn)||K(),at}return Pi.variants=ge,Pi}(),He=function(Le){var Me="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",ge=["bench","d","eval","flip","isready","ponderhit","stop","uci","ucinewgame"],Ce=[{cmd:"position",args:["fen","startpos","moves","continuation"]},{cmd:"go",args:["binc","btime","confidence","depth","infinite","mate","mindepth","mintime","maxdepth","maxtime","movestogo","movetime","ponder","searchmoves","shallow","winc","wtime"]}],Be=["moves","searchmoves"],De=["ponder","infinite","startpos"],M={depth:1,seldepth:1,time:1,nodes:1,multipv:1,cp:1,mate:1,currmovenumber:1,hashfull:1,nps:1,tbhits:1,sbhits:1,cpuload:1,bmc:1,score:2,lowerbound:2,upperbound:2,bestmove:3,ponder:3,baseTurn:3,bestmoveSan:3,ponderSan:3,pv:4,pvSan:4,string:4,refutation:4,currline:4},Je=/(?:Total|Final) Evaluation[\s\S]+\n$/i;function zt(We,ot){var xe,gn={},Jt=ot.args||[],jn="",nr=ot.onSignal,Tr=ot.onError;function mn(Pn){Le.log&&console.log("echo: ",Pn.toString()),jn+=Pn.toString(),jn.slice(-1)===`
`&&gn.onmessage(jn.slice(0,-1)+(jn=""))}return We.slice(-3).toLowerCase()===".js"&&(Jt=Jt.concat(We),We=w.execPath,w.version.substr(1,2)>11&&(Jt.unshift("--experimental-wasm-bulk-memory"),Jt.unshift("--experimental-wasm-threads"))),xe=spawn(We,Jt,{stdio:"pipe"}),xe.stdout.on("data",mn),xe.stderr.on("data",mn),Tr&&(xe.on("error",Tr),xe.stdin.on("error",Tr),xe.on("close",function(Pt){Pt&&Tr(new Error("Engine errored with code "+Pt))})),nr&&xe.on("close",function(Pt,ft){nr(ft)}),gn.postMessage=function(Pn){Le.log&&console.log("postMessage: "+Pn),xe.stdin.write(Pn+`
`)},gn.terminate=function(){xe.stdin.end(),xe.kill(),xe=null},gn}function cn(We){var ot=[],xe=[],gn={},Jt={isFakeWorker:!0},jn,nr=We.replace(/^[^#]*#/,"");function Tr(Pt,ft){var Dt=document.createElement("script");Dt.setAttribute("src",Pt),Dt.onload=function(){Dt.remove(),ft(Dt._exports)},Dt.onerror=function(Bn){jn=!0,Dt.remove(),gn.onerror(Bn)},document.head.appendChild(Dt)}function mn(Pt){setTimeout(Pt,1)}function Pn(Pt,ft){var Dt;jn||(Pt.onmessage?(Dt=ft.concat(),ft.length=0,Dt.forEach(function(Dn){try{Pt.onmessage({data:Dn})}catch(Bn){console.error(Bn)}})):setTimeout(Pn,5,Pt,ft))}return Tr(We,function(Pt){var ft=We.replace(/[?#].*/,""),Dt=ft.replace(/\/[^\/]+$/,"/"),Dn={locateFile:function(Bn){return Bn.indexOf(".wasm")>-1&&nr?nr:Bn.indexOf(".worker.js")>-1?ft+"#"+nr+",worker":Dt+Bn}};Pt(Dn).then(function(Bn){Pt=null;function ie(){Bn=null,jn=!0}window.addEventListener("beforeunload",ie,{once:!0}),Jt.onmessage=function(Y){var R=Y.data;Bn.onCustomMessage(R),R==="quit"&&(Bn=null,jn=!0,window.removeEventListener("beforeunload",ie))},Bn.addMessageListener(Jt.postMessage)}).catch(function(Bn){Pt=null,jn=!0,gn.onerror(Bn)})}),gn.postMessage=function(Pt){ot.push(Pt),mn(function(){Pn(Jt,ot)})},Jt.postMessage=function(Pt){xe.push(Pt),mn(function(){Pn(gn,xe)})},gn.terminate=function(){},gn}function xt(We,ot,xe){var gn=ot.useFakeWorker&&ot.useFakeWorker[We.replace(/[?#].*$/,"")],Jt=gn?cn(We):new Worker(We),jn={terminate:Tr,postMessage:nr};function nr(Pn){Jt.postMessage(Pn)}function Tr(){Jt.terminate()}function mn(Pn){var Pt=Pn.concat();Pn.length=0,Pt.forEach(function(ft){ft.cmd?ft.cmd.substr(0,2)!=="go"&&xe.send(ft.cmd,ft.cb,ft.stream):(clearTimeout(ft.timer),xe.getBestMove(ft.args,ft.cb,ft.stream))})}return Jt.onmessage=function(Pn){typeof Pn.data=="string"&&jn.onmessage(Pn.data)},Jt.onerror=function(Pn){if(xe.fallbackPath&&xe.fallbackPath!==We){try{Pn.preventDefault()}catch{}try{Jt.terminate()}catch{}return Jt=xt(xe.fallbackPath,ot,xe),Jt.onmessage=function(Pt){jn.onmessage(Pt)},mn(xe._activeCommands()),mn(xe._bestMoveQueue()),!1}if(ot.onError)return ot.onError(Pn)},jn}function yr(We,ot){ot.fallbackPath=We.pathToNonWasmEngine,ot.path=We.enginePath||We.pathToEngineWorker,ot.wasmPath=We.pathToWasmEngine,We.engines&&(We.engines.multiThreaded&&Le.supportsMultithreading()?!We.engines.multiThreadedNoSIMD||Le.supportsSIMD()?(ot.path=We.engines.multiThreaded.loader,ot.wasmPath=We.engines.multiThreaded.engine):(ot.path=We.engines.multiThreadedNoSIMD.loader,ot.wasmPath=We.engines.multiThreadedNoSIMD.engine):We.engines.singleThreaded&&(ot.path=We.engines.singleThreaded.loader,ot.wasmPath=We.engines.singleThreaded.engine),ot.fallbackPath=We.engines.asm||ot.fallbackPath)}function Kn(We,ot){var xe;return yr(We,ot),xe=ot.path,(ot.fallbackPath&&typeof WebAssembly>"u"||!xe)&&(xe=ot.fallbackPath),ot.wasmPath&&(xe+="#"+ot.wasmPath),xt(xe||"stockfish.js",We,ot)}function ht(We){for(var ot=We.split(" "),xe=ot.length,gn=ot[0]==="info"?1:0,Jt={mtype:ot[0]},jn,nr;gn<xe;++gn)if(nr=ot[gn],nr)if(jn=M[nr],jn===1){for(;!ot[++gn]&&gn<xe;);Jt[nr]=Number(ot[gn])}else if(jn===2)Jt[nr]=!0;else if(jn===3){for(;!ot[++gn]&&gn<xe;);Jt[nr]=ot[gn]}else for(Jt[nr]=[],++gn;gn<xe;++gn)if(!M[ot[gn]])ot[gn]&&Jt[nr].push(ot[gn]);else{--gn;break}return(Jt.bestmove==="(none)"||Jt.bestmove==="0000")&&(Jt.bestmove=void 0,Jt.bestmoveSan=void 0),(Jt.ponder==="(none)"||Jt.ponder==="0000")&&(Jt.ponder=void 0,Jt.ponderSan=void 0),Jt}function bt(We){var ot=We.indexOf(" ");return ot===-1?We:We.substr(0,ot)}function er(We){return(We+"").replace(/^([^/]+)((?:\/[^/]+){7})\/([qrbnp]*)/i,"$1$2[$3]").replace(/( \d+ \d+) \+([0-3])\+([0-3])/,function(ot,xe,gn,Jt){return" "+(3-gn)+"+"+(3-Jt)+xe})}function dr(We){return(We+"").replace(/\[([qrbnp]*)\]/i,"/$1").replace(/([0-3])\+([0-3]) (\d+ \d+)/,function(ot,xe,gn,Jt){return Jt+" +"+(3-xe)+"+"+(3-gn)})}function Jr(We,ot){var xe,gn=bt(We),Jt,jn,nr;for(gn==="uciok"||gn==="option"?xe="uci":gn==="readyok"||gn==="ready"?xe="isready":gn==="json"||We.indexOf("info string CEEError")>=0?xe="fetch":gn==="bestmove"||gn==="info"?xe="go":xe="other",nr=ot.length,jn=0;jn<nr;jn+=1)if(Jt=bt(ot[jn].cmd),Jt===xe||xe==="other"&&(Jt==="d"||Jt==="eval"))return jn;return 0}function Qe(We){var ot=We.match(/id name ((\S+) ([\d.a-z]+).*)/i);if(ot)return{all:ot[1].trim(),short:ot[2],version:ot[3],full:ot[2]+" "+ot[3],wasm:/ wasm/i.test(We),multithreaded:/ multithreaded/i.test(We)}}function pn(We,ot){var xe={},gn,Jt=[],jn,nr=[],Tr,mn=null;function Pn(ie){var E,Y=0,R,de,Ae;if(ie.indexOf(`
`)>-1){for(de=ie.split(`
`),Ae=0;Ae<de.length;Ae+=1)Pn(de[Ae]);return}if(Le.log&&console.log("debug (onmessage): "+ie),xe.stream&&xe.stream(ie),!Jt.length||ie.indexOf("No such option")===0||ie.indexOf("Stockfish")===0||ie.indexOf("Komodo")===0||ie.indexOf("Explanation Engine")===0||ie.indexOf("info string variant")===0){if(We.ceeMode&&ie.indexOf("Explanation Engine")===0){var me=ie.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)\s*\(C\)/);me?mn={date:me[1],increment:me[2]}:(me=ie.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)\.([0-9]+)/),mn={major:parseInt(me[1]),minor:parseInt(me[2]),patch:parseInt(me[3])})}return}if(Y=Jr(ie,Jt),R=Jt[Y],R.stream&&!R.discard&&R.stream(ie),typeof R.message>"u"?R.message="":R.message!==""&&(R.message+=`
`),R.message+=ie,ie.indexOf("uciok")===0)xe.name=Qe(R.message),E=!0;else if(ie.indexOf("ready")===0)E=!0;else if((ie.indexOf("bestmove")===0||bt(ie)==="bestmove")&&R.cmd!=="bench")E=!0,R.message=ie;else if(R.cmd==="d")(ie.indexOf("Legal uci moves")===0||ie.indexOf("Key is")===0)&&(R.done=!0,E=!0);else if(R.cmd.indexOf("fetch")===0)try{var on=R.message.split(`
`).filter(function(L){return L.startsWith("json")}).join(`
`);on&&(R.message=JSON.parse(on.replace(/^json /mg,"").replace(/\n/g,"")),E=!0)}catch{}else R.cmd==="eval"?Je.test(R.message)&&(E=!0):(ie.indexOf("pawn key")===0||ie.indexOf("Nodes/second")===0||ie.indexOf("Unknown command")===0)&&(E=!0);E&&(Jt.splice(Y,1),R.cb&&!R.discard?R.cb(R.message):R.ondiscard&&R.ondiscard())}function Pt(ie){return ie!=="ucinewgame"&&ie!=="flip"&&ie!=="stop"&&ie!=="ponderhit"&&ie.indexOf("position")!==0&&ie.indexOf("setoption")!==0&&ie.indexOf("variation")!==0&&ie.indexOf("threat-variation")!==0&&ie.indexOf("push")!==0&&ie.indexOf("pop")!==0&&ie.indexOf("serve")!==0&&ie.indexOf("speech")!==0}xe.send=function(ie,E,Y){var R;ie=String(ie).trim(),Pt(ie)?Jt[Jt.length]={cmd:ie,cb:E,stream:Y}:R=!0,gn&&(Le.log&&console.log("stdin: "+ie),gn.postMessage(ie),R&&E&&setTimeout(E,0))},xe._activeCommands=function(){return Jt},xe._bestMoveQueue=function(){return nr},xe.quit=function(){if(gn&&gn.terminate){try{xe.send("quit")}catch{}gn.terminate(),gn=null,xe.ready=void 0}clearTimeout(jn)},ge.forEach(function(E){xe[E]=function(R,de){xe.send(E,R,de)}}),Ce.forEach(function(E){xe[E.cmd]=function(R,de,Ae){var me=[E.cmd];Tr&&R.fen&&(R.fen=er(R.fen)),E.args.forEach(function(L){if(R[L]||R[L]===0){if(Be.indexOf(L)>-1){if(!R[L]||!R[L].length)return;Array.isArray(R[L])&&(R[L]=R[L].join(" "))}me.push(L),De.indexOf(L)===-1&&me.push(R[L])}}),xe.send(me.join(" "),de,Ae)}}),xe.setoption=function(ie,E){xe.send("setoption name "+ie+" value "+E)},xe.setVariant=function(ie){var E;ie!==Tr&&(E=String(ie).toLowerCase().replace(/ |-/g,""),!ie||E==="chess"?(E=void 0,xe.setoption("UCI_Variant","chess"),xe.setoption("UCI_Chess960","false")):E==="chess960"?(xe.setoption("UCI_Variant","chess"),xe.setoption("UCI_Chess960","true")):(E==="threecheck"&&(E="3check"),xe.setoption("UCI_Variant",E),xe.setoption("UCI_Chess960","false")),Tr=E)},xe.loadBook=function(ie,E){xe.pathToBook=ie,q.loadBook(ie,function(R,de){xe.book=de,xe.bookLoaded=!0,R&&(console.error("Error loading opening book."),console.error(R),xe.pathToBook=null,xe.bookLoaded=!1),E()})},xe.getBookMove=function(ie){var E=Le.createGame(ie),Y=xe.book.pick({fen:E.fen(),type:typeof ie.bookPick<"u"?ie.bookPick:"random",chess960:E.header().Variant==="Chess960"}),R=Y&&E.move(Y);if(R)return{moveSan:R.san,moveLan:Y,move:{from:R.from,to:R.to,promotion:R.promotion||null},baseTurn:E.turn()===1?"b":"w",pv:[{moveSan:R.san,moveLan:Y}],depth:null,score:null,mateIn:null,isBookMove:!0}};function ft(){var ie=1,E=[],Y=[],R,de,Ae=null,me=nr[0].args,on=nr[0].cb,L=nr[0].stream,pe,ye=1,ke,Q=[],Ke=14,yt=pn._previousCP;nr[0].started=!0,pn._previousCP=null;function In(Gt){var Ut=[],Dr=Y[Gt]||Ei(E[Gt]);return E[Gt].forEach(function(wi,pr){Ut.push({moveSan:Dr[pr],moveLan:wi})}),Ut}function Tn(Gt,Ut,Dr,rr){var wi;for(wi=E.length-1;wi>=0;wi-=1)if(E[wi][0]===Gt)return In(wi);return Dr?[{moveSan:Ut,moveLan:Gt},{moveSan:rr,moveLan:Dr}]:Ut?[{moveSan:Ut,moveLan:Gt}]:[]}function Fr(Gt){var Ut=.03*Math.pow(32,Gt.depth/Ke);Gt.cp=yt+(Gt.cp-yt)*Ut}function vt(Gt){Gt.mate===0?(Gt.mateIn=0,Gt.cp=-31800*ye):(Gt.mateIn=Number(Gt.mate*ye)||null,typeof Gt.mateIn=="number"&&!isNaN(Gt.mateIn)&&typeof Gt.cp!="number"?Gt.cp=31800*ye*(Gt.mate/Math.abs(Gt.mate)):(Gt.cp*=ye,Math.abs(Gt.cp)===9&&(Gt.cp=0),me.normalize&&Gt.depth<=Ke&&typeof yt=="number"&&Gt.multipv===1&&Fr(Gt))),Gt.score=Gt.cp/100}function _i(Gt){var Ut=ht(Gt);if(_r(Ut),ie>Ke&&R<5e3&&R>-5e3&&(pn._previousCP=R),Ut.pv=Tn(Ut.moveLan,Ut.moveSan),Ut.pv.length===1&&Ut.ponder&&(Ut.pv=Tn(Ut.moveLan,Ut.moveSan,Ut.ponder,Ut.ponderSan)),Q.length>1)Q.splice(Q.indexOf(Ut.moveLan),1),me.searchmoves=Q,me.getNextBest=0,Dt(me,function(){on(Ut)},function(rr){L&&(rr.multipv=2,L(rr))});else if(on)try{on(Ut)}catch(Dr){console.error(Dr)}nr.shift(),clearTimeout(jn),nr.length>0&&ft()}function _r(Gt){var Ut;Gt.baseTurn=pe,Gt.cp=R,Gt.score=R/100,Gt.mate=de,Gt.mateIn=Ae,Gt.depth=ie,Gt.moveLan=Gt.bestmove,Gt.moveLan&&(Gt.move=Le.uciToObj(Gt.moveLan)[0],Ut=ke.move(Gt.move),Ut&&(Gt.moveSan=Gt.bestmoveSan=Ut.san,Gt.ponder&&(Ut=ke.move(Le.uciToObj(Gt.ponder)[0]),Ut&&(Gt.ponderSan=Ut.san,ke.undo(!0))),ke.undo(!0)))}function Ei(Gt){var Ut,Dr=Gt.length,rr=[],wi;for(Ut=0;Ut<Dr&&(wi=ke.move(Le.uciToObj(Gt[Ut])[0]),!!wi);++Ut)rr.push(wi.san);for(;Ut>0;--Ut)ke.undo(!0);return rr}function Jo(Gt){var Ut=ht(Gt);Ut.score&&(Ut.baseTurn=pe,vt(Ut),!Ut.multipv&&Ut.depth&&(Ut.multipv=1),(Ut.multipv===1||Ut.depth===0)&&(R=Ut.cp,de=Ut.mate,Ae=Ut.mateIn)),Ut.pv&&L&&(Ut.pvSan=Ei(Ut.pv)),Ut.pv&&!(Ut.lowerbound||Ut.upperbound)&&(E.push(Ut.pv),L&&Y.push(Ut.pvSan)),Ut.depth>ie?ie=Ut.depth:Ut.mtype==="bestmove"&&_r(Ut),L&&!(Ut.mateIn===0&&Ut.pv)&&L(Ut),Ur()}function Ur(){me.timeout&&(clearTimeout(jn),nr[0].timer=jn=setTimeout(function(){xe.stop(),on&&(on(),on=void 0)},me.timeout))}me.difficulty>=0&&me.difficulty<20?(xe.setoption("Skill Level",me.difficulty),me.maximumError>=0&&me.maximumError<=4999&&xe.setoption("Skill Level Maximum Error",me.maximumError),me.errorProbability>=1&&me.errorProbability<=128&&xe.setoption("Skill Level Probability",me.errorProbability)):xe.setoption("Skill Level",20),me.contempt!==void 0?xe.setoption("Contempt",me.contempt):xe.setoption("Contempt","0"),me.multiPv>1?xe.setoption("MultiPV",me.multiPv):xe.setoption("MultiPV",1),!me.movetime&&(!me.wtime||!me.btime)&&!me.depth&&(me.btime=me.btime||72e3,me.wtime=me.wtime||72e3),(me.startpos||!me.fen)&&!me.moves&&!me.variant?(pe="w",ke=Le.createGame({disableHashing:!0})):(ke=Le.createGame({fen:me.fen?dr(me.fen):Me,moves:me.moves,variant:me.variant,disableHashing:!0}),ke.turn()===ke.WHITE?pe="w":(pe="b",ye=-1)),xe.setVariant(me.variant),xe.position(me),xe.go(me,_i,Jo),me.getNextBest&&on&&ke.moves({verbose:!0}).forEach(function(Ut){Ut=Le.normalizeMoveObj(Ut),Q.push(Ut.from+Ut.to+(Ut.promotion||""))}),Ur()}function Dt(ie,E,Y){nr.push({args:ie,cb:E,stream:Y}),nr.length===1&&ft()}xe.getBestMove=function(ie,E,Y){var R;if(ie=ie||{},ie.fen=ie.fen||ie.baseFen,ie.is960&&(ie.variant="Chess960"),xe.bookLoaded&&ie.useBook&&(R=xe.getBookMove(ie),R))return setTimeout(function(){R.mtype="bestmove",E(R)},0);Dt(ie,E,Y)},xe.stopAll=function(ie){var E,Y=Jt.length,R=0;function de(){R-=1,R===0&&ie()}for(nr=[],E=0;E<Y;E+=1)Le.log&&console.log("debug (stop_moves): "+E,bt(Jt[E].cmd)),bt(Jt[E].cmd)==="go"&&!Jt[E].discard&&(xe.stop(),Jt[E].discard=!0,ie&&(R+=1,Jt[E].ondiscard=de));ie&&!R&&xe.isready(ie)},xe.restartEngine=function(ie){return xe.stopAll(),xe.quit(),Jt=[],nr=[],xe.bookLoaded&&!We.book&&(We=JSON.parse(JSON.stringify(We)),We.book=xe.book),pn(We,ie)},xe.stopFast=function(ie,E){var Y,R=xe,de;if(xe._isStopping)return xe._stopQueue.push(ie);de=function(Ae){xe._stopQueue.forEach(function(me){me(Ae)}),xe._stopQueue=null,xe._isStopping=!1},xe._isStopping=!0,xe._stopQueue=[ie],xe.stopAll(function(){clearTimeout(Y),de(xe)}),Y=setTimeout(function(){R.restartEngine(de)},Math.max(+E||5e3,50))};function Dn(){xe.uci(function(){We.settings&&Object.keys(We.settings).forEach(function(Y){xe.setoption(Y,We.settings[Y])}),xe.ready=!0,Bn()})}function Bn(){xe.ready&&(xe.bookLoaded||!xe.pathToBook)&&ot&&ot(xe)}return typeof Worker>"u"?!1:(We.ceeMode&&(dt(xe,We),xe.ceeVersion=function(){return JSON.parse(JSON.stringify(mn))}),gn=Kn(We,xe),gn.onmessage=Pn,We.book&&(xe.book=We.book,xe.bookLoaded=!0,xe.pathToBook=We.pathToBook),xe.getFenFromMoves=Le.getFenFromMoves,xe.getLegalMoves=Le.getLegalMoves,xe.getPositionInfo=Le.getPositionInfo,xe.isFenValid=Le.isFenValid,xe.ready=!1,Dn(),!xe.book&&We.pathToBook&&xe.loadBook(We.pathToBook,Bn),xe)}function dt(We,ot){var xe=1e3,gn=0,Jt,jn;function nr(mn){function Pn(Pt){var ft=Pn.callbacks;Pn.callbacks={},Pn.original&&Pn.original(Pt);for(var Dt in ft)ft[Dt](Pt)}return Pn.callbacks={},Pn.original=mn,Pn}ot.onError=Jt=nr(ot.onError),ot.onSignal=jn=nr(ot.onSignal);function Tr(mn,Pn,Pt,ft){var Dt,Dn=Date.now(),Bn=!1,ie=++gn;function E(){clearTimeout(Dt),delete Jt.callbacks[ie],delete jn.callbacks[ie],Bn=!0}function Y(Ae){Bn||(E(),ft({data:Ae,action:Pn,uci:mn},mn))}function R(Ae){Y({msg:"CEE process crashed unexpectedly",code:Le.ERROR_CODES.CRASH,exitCode:Ae,err:new Error("CEE process exited with "+Ae)})}Jt.callbacks[ie]=R,jn.callbacks[ie]=R,Dt=setTimeout(function(){Y({msg:"CEE timed out",code:Le.ERROR_CODES.TIMEOUT,timeout:xe,duration:Date.now()-Dn,err:new Error("CEE timed out")})},xe);for(var de=0;de<mn.length;++de)We.send(mn[de]);We.send("fetch "+Pn,function(me){Bn||(E(),Pt(me,mn))},function(me){me.indexOf("info string CEEError")>=0?Y({msg:"CEE crashed with error code",code:Le.ERROR_CODES.ERROR,log:me.match(/info string CEEError\s*(.*)/)[1],err:new Error(me.match(/info string CEEError\s*(.*)/)[1])}):We.ceeDebug&&me.indexOf("not recognized")>=0&&Y({msg:"CEE received unknown UCI option (engine.ceeDebug mode on)",option:me,code:Le.ERROR_CODES.NONFATAL_ERROR,err:new Error(me)})})}We.fetch=function(mn,Pn,Pt){var ft,Dt;mn=mn||[],ft=mn.action||"analysis",Array.isArray(mn)?Dt=mn:(Dt=mn.uciCommands?mn.uciCommands.map(function(Dn){return Dn}):[],mn.startFen&&(mn.options=mn.options||{},typeof mn.options.ScoreWhiteToMove>"u"&&(mn.options.ScoreWhiteToMove=!0),typeof mn.options.SerializeLikeCEAC>"u"&&(mn.options.SerializeLikeCEAC=!0),Le.CEE_LIB.addOptions(Dt,mn.options),Le.CEE_LIB.addVariant(Dt,mn.variant),Le.CEE_LIB.addPosition(Dt,mn.startFen)),Le.CEE_LIB.addVariations(Dt,mn.evals&&mn.evals[0]),Le.CEE_LIB.addVariations(Dt,mn.threats&&mn.threats[0],"threat-variation"),(mn.moves||[]).forEach(function(Dn,Bn){var ie=Bn+1;Le.CEE_LIB.addPush(Dt,Dn),Le.CEE_LIB.addVariations(Dt,mn.evals&&mn.evals[ie]),Le.CEE_LIB.addVariations(Dt,mn.threats&&mn.threats[ie],"threat-variation")})),Tr(Dt,ft,Pn,Pt)},We.fetch.setTimeout=function(mn){xe=mn},Le.ERROR_CODES={TIMEOUT:1,CRASH:2,ERROR:3,NONFATAL_ERROR:4}}return pn},Ge=function(){var Le=te(),Me,ge="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Ce=252,Be=255,De={4:"p",5:"P",6:"p",8:"n",9:"N",10:"n",16:"b",17:"B",18:"b",32:"r",33:"R",34:"r",64:"q",65:"Q",66:"q",128:"k",129:"K",130:"k"},M="pnbrq",Je=512,zt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?{~}(^)[_]@#$,./&-*++=",cn="qnrbkp";function xt(E){var Y,R=E.length,de=[],Ae,me,on;for(Y=0;Y<R;Y+=2)on={},Ae=zt.indexOf(E[Y]),me=zt.indexOf(E[Y+1]),me>63&&(on.promotion=cn[Math.floor((me-64)/3)],me=Ae+(Ae<16?-8:8)+(me-1)%3-1),Ae>75?on.drop=cn[Ae-79]:on.from=zt[Ae%8]+(Math.floor(Ae/8)+1),on.to=zt[me%8]+(Math.floor(me/8)+1),de.push(on);return de}function yr(E){var Y,R,de="",Ae,me;for(Array.isArray(E)||(E=[E]),R=E.length,Y=0;Y<R;Y+=1)E[Y].drop?Ae=79+cn.indexOf(E[Y].drop):Ae=zt.indexOf(E[Y].from[0])+(E[Y].from[1]-1)*8,me=zt.indexOf(E[Y].to[0])+(E[Y].to[1]-1)*8,E[Y].promotion&&(me=cn.indexOf(E[Y].promotion)*3+64+(me<Ae?9+me-Ae:me-Ae-7)),de+=zt[Ae]+zt[me];return de}function Kn(E){var Y=E.split(" "),R,de=Y.length,Ae=[],me;if(E)for(R=0;R<de;++R)me=Y[R],me.length===4?me[1]==="@"?Ae.push({drop:me[0].toLowerCase(),to:me.substr(2,2)}):Ae.push({from:me.substr(0,2),to:me.substr(2,2)}):Ae.push({from:me.substr(0,2),to:me.substr(2,2),promotion:me[4]});return Ae}function ht(E,Y){return E.san===Y.san||E.to===Y.to&&(E.from===Y.from||!E.from&&!Y.from)&&(E.promotion===Y.promotion||!E.promotion&&!Y.promotion)&&(E.drop===Y.drop||!E.drop&&!Y.drop)}function bt(E,Y,R){var de=[],Ae,me,on,L,pe,ye,ke,Q,Ke,yt,In=1,Tn=8,Fr=1,vt=8,_i={verbose:!0};for(yt=E.turn(),Ke=3-yt,L=te("/",Y),L.turn(Ke),R&&(In=Tn=+R[1],Fr=vt=R.charCodeAt(0)-96),Ae=In;Ae<=Tn;++Ae)for(me=Fr;me<=vt;++me)pe=String.fromCharCode(me+96)+Ae,on=E.get(pe),on&&on.color===Ke&&(L.put(on,pe,!0),on.type==="p"?(ye=String.fromCharCode(me-1+96)+(Ae+(Ke===1?1:-1)),ke=String.fromCharCode(me+1+96)+(Ae+(Ke===1?1:-1)),L.put({type:"n",color:yt},ye,!0),L.put({type:"n",color:yt},ke,!0)):on.type==="k"&&(Q=E.fen().split(" ")[2],Q!=="-"&&L.load(L.fen().replace(/^(\S+\s\S\s)(\S+)/,"$1"+Q),Y,!0,!0)),de=de.concat(L.moves(_i)),L.remove(pe,!0),on.type==="p"&&(L.remove(ye,!0),L.remove(ke,!0)));return Y&&E.hand()&&(L._hand[Ke]=18721,de=de.concat(L.moves({verbose:!0}).filter(function(_r){return!R||_r.to===R}))),de.forEach(function(_r){jn(_r)}),de}function er(E,Y){var R=E.header().Variant,de=bt(E,R,Y.from),Ae,me,on,L,pe,ye=3-E.turn();for(Ae=de.length-1;Ae>=0;--Ae)if(me=de[Ae],ht(me,Y)){on=!0;break}if(on)return me.drop?E.put({type:me.drop,color:ye},me.to):(L=E.remove(me.from,!0),me.flags===Le.FLAGS.KSIDE_CASTLE?(pe=E.remove(R==="Chess960"?me.to:"h"+me.from[1],!0),E.put(L,"g"+me.from[1],!0),E.put(pe,"f"+me.from[1])):me.flags===Le.FLAGS.QSIDE_CASTLE?(pe=E.remove(R==="Chess960"?me.to:"a"+me.from[1],!0),E.put(L,"c"+me.from[1],!0),E.put(pe,"d"+me.from[1])):(me.promotion&&(L.type=me.promotion,L.promoted=!0),pe=E.get(me.to),E.put(L,me.to,L.type!=="k"&&L.type!=="r"&&(!pe||pe.color!==ye||pe.type!=="r")))),me;if(Y.from&&(E.turn(ye),Y=E.fixMove(Y),E.turn(3-ye),Y))return er(E,{san:Y,from:Y.from})}function dr(E,Y){var R=Y?{}:[],de=E._board(),Ae,me,on;if(Y)for(Ae=112;Ae>=0;++Ae)Ae&136&&(Ae-=24),(me=de[Ae])&&(on=zt[Ae&7]+(8-(Ae>>4)),R[on]={type:De[me&Ce],color:me&3,promoted:(me&Je)!==0,square:on});else for(Ae=112;Ae>=0;++Ae)Ae&136&&(Ae-=24),(me=de[Ae])&&R.push({type:De[me&Ce],color:me&3,promoted:(me&Je)!==0,rank:8-(Ae>>4),file:(Ae&7)+1});return R}function Jr(E,Y){var R=Math.min(Math.max(.20773843*Math.atan(2.49085889*E/100-2.47841945*Y/100)+.02262979*E/100-.02256839*Y/100+.52239679,0),1),de=Math.min(Math.max(-.20720905*Math.atan(2.49626837*E/100-2.48220286*Y/100)+-.02352551*E/100+.02172627*Y/100+.49443923,0),1),Ae=Math.min(Math.max(Math.exp(.037043456*E/100+.178106427*Y/100+-8.069742932)+.004823544*Math.exp(-1.364136591*Math.pow(E/100-Y/100,2))+-.001625539,0),1),me=R+de+Ae;return{w:R/me,b:de/me,d:Ae/me}}function Qe(E,Y){var R,de,Ae,me;if(E=E||{},E.disableHashing=!0,R=xe(E),!R)return null;if(Y){if(Ae=R.move(Y),!Ae)return null;R.extended||jn(Ae)}return me=R.fen(),!E.skipValidation&&!R.isPositionValid(E)?null:(de=me.split(" "),{fen:me,pieces:dr(R),sideToMove:R.turn(),castling:de[2],epSquare:de[3]==="-"?null:de[3],halfMoves:+de[4],moveNumber:+de[5],move:Ae,hand:R.hand(),checks:R.checks()})}function pn(E){var Y=xe(E),R,de,Ae,me,on,L,pe=[""],ye=[],ke,Q,Ke;if(!Y)return!1;for(Q=Y.header(),Ke=Q.Variant||"",L=Y.hashes(),R=typeof Y.origHistory=="function"?Y.origHistory(!0):Y.history(!0),on=L.length,de=[L[0][0],L[0][1]],ye.push(q.to64BitHex(de)+Ke),L[0]=q.to64BitHex(L[0]),Ae=1;Ae<on;++Ae)de[0]=(de[0]^L[Ae][0]*(Ae+58465))>>>0,de[1]=(de[1]^L[Ae][1]*(Ae+984))>>>0,L[Ae]=q.to64BitHex(L[Ae]),ye.push(q.to64BitHex(de)+Ke),me=Ae-1,jn(R[me]),ke=(R[me].from?R[me].from:R[me].drop.toUpperCase()+"@")+R[me].to+(R[me].promotion||""),me&&(ke=pe[me]+" "+ke),pe.push(ke);return{startingFen:Q.FEN||ge,hashes:L,fingerprints:ye,moves:pe,variant:Q.Variant}}function dt(E,Y,R,de){var Ae,me,on,L,pe,ye,ke,Q,Ke,yt,In;for(R=R||{},typeof Y=="string"&&(Y=Y.trim().split(" ")),on=Y.length,Ae=0;Ae<on;Ae+=1){if(Y[Ae].board==="b"||Y[Ae].board==="B"?pe=E.siblingGame:pe=E,typeof Y[Ae].moveLan=="string"?ye=Kn(Y[Ae].moveLan)[0]:typeof Y[Ae]=="string"?ye=Kn(Y[Ae])[0]:Y[Ae].san?ye=Y[Ae].san:ye=Y[Ae],!pe.move(ye))if(R.autoPromote){if(R.autoPromote===!0?ye.promotion="q":ye.promotion=R.autoPromote,!pe.move(ye)){if(R.skipBadLines)break;return!1}}else{if(R.skipBadLines)break;return!1}if(ke=pe._history(),Q=ke[ke.length-1],de&&(Ke=parseInt(de[Ae],10)),(typeof Ke!="number"||isNaN(Ke))&&(Ke=parseInt(Y[Ae].time,10)),typeof Ke=="number"&&!isNaN(Ke)&&(Q.time=Ke,Ke=void 0),Y[Ae].firstComment&&(ke.initComment=Y[Ae].firstComment),Y[Ae].comment&&(Q.comment=Y[Ae].comment),Y[Ae].annotation&&(Q.annotation=Y[Ae].annotation),Y[Ae].additionalAnnotation&&(Q.additionalAnnotation=Y[Ae].additionalAnnotation),Y[Ae].commands&&(Q.commands=Y[Ae].commands),Y[Ae].lines)for(L=Y[Ae].lines.length,me=0;me<L;++me){if(yt=E._history().id,E.createVariation(),In=dt(E,Y[Ae].lines[me],R),!In&&!R.skipBadLines)return!1;E.selectLine(yt)}}return!0}function We(E,Y,R){var de=[xt(Y[0]),xt(Y[1])],Ae=[0,0],me=[0,0],on=de[0].length+de[1].length,L=Math.max(R[0][0]|0,R[0][1]|0,R[1][0]|0,R[1][1]|0),pe,ye=[0,0],ke=[0,0],Q,Ke;for(L+=600-L%600,pe=[[L,L],[L,L]];on--;){if(ke[0]=ye[0]+pe[0][me[0]]-R[0][Ae[0]]||0,ke[1]=ye[1]+pe[1][me[1]]-R[1][Ae[1]]||0,Q=ke[0]<=ke[1]?0:1,de[Q][Ae[Q]]||(Q^=1),Ke=Q?E.siblingGame:E,(!Ke.move(de[Q][Ae[Q]])||on&&Ke.inCheckmate()&&Ke.undo(!0))&&(Q^=1,Ke=Q?E.siblingGame:E,!Ke.move(de[Q][Ae[Q]])))return!1;Ke._history()[Ae[Q]].time=R[Q][Ae[Q]],pe[Q][me[Q]]=R[Q][Ae[Q]],ye[Q]=ke[Q],me[Q]^=1,++Ae[Q]}return!0}function ot(E){var Y,R=-1,de=0,Ae;function me(L,pe,ye){for(var ke=L[pe],Q;typeof(Q=ke.parentId)=="number";){if(Q===ye)return ke.atMoveNode;ke=L[Q]}return!1}function on(L,pe){var ye={moveTime:L.moveTime,firstComment:L.firstComment,comment:L.comment,annotation:L.annotation,additionalAnnotation:L.additionalAnnotation,commands:L.commands};Object.keys(ye).forEach(function(ke){L[ke]=pe[ke],pe[ke]=ye[ke]})}E.extended||(E.extended=!0,Y={header:E.header,load:E.load,loadPgn:E.loadPgn,createVariation:E.createVariation,undo:E.undo,pgn:E.pgn},E._move=E.move,E.undo=function(){return E.siblingGame?E.deleteBughouseMove(E.curBughouseMove()):E.deletePosition(R,de)},E.getMove=function(L){return L&&(typeof L=="string"||L.to&&(L.from||L.drop))&&E._move(L)&&jn(Y.undo())||null},E.premove=function(){var L,pe=[];return{queue:pe,move:function(ye){var ke;return L=L||te(E.fen(),E.header().Variant),ke=er(L,ye),!ke||de||R!==E._history().length-1?(pe.length||(L=void 0),null):(pe.push(ke),ke)},consume:function(){var ye=pe.shift(),ke,Q,Ke;if(ye){if(ke=E.move(ye),ke){if(L=void 0,Q=pe.length,Q)for(L=te(E.fen(),E.header().Variant),Ke=0;Ke<Q;++Ke)er(L,pe[Ke]);return ke}E.premove.cancel()}},moves:function(ye){return!de&&R===E._history().length-1&&bt(L||E,E.header().Variant,ye)},getPieces:function(ye){return dr(L||E,ye)},fen:function(){return(L||E).fen()},cancel:function(){pe.length=0,L=void 0}}}(),E.getPieces=function(L){return dr(E,L)},E.material=function(){var L=E.getPieces(),pe={imbalance:0,white:{p:8,n:2,b:2,r:2,q:1,count:0},black:{p:8,n:2,b:2,r:2,q:1,count:0}},ye,ke={p:1,n:3,b:3,r:5,q:9,k:0},Q,Ke;for(ye=L.length-1;ye>=0;--ye)L[ye].color===1?(Q=pe.white,Ke=pe.black):(Q=pe.black,Ke=pe.white),Ke[L[ye].type]&&--Ke[L[ye].type],Q.count+=ke[L[ye].type];return pe.imbalance=pe.white.count-pe.black.count,pe},E.origHistory=E.history,E.history=function(L,pe){var ye=[],ke,Q=E._history(),Ke=Q.length,yt=E._lines(),In,Tn;for(typeof L=="boolean"&&(L={verbose:L}),L=L||{},pe&&(L.noParentLines=pe),L.toCurrent&&(Ke=E.ids().move+1);;){if(--Ke===-1)if(Q.id&&!L.noParentLines){Ke=Q.atMoveNode,Q=yt[Q.parentId];continue}else break;if(L.verbose){ke={};for(In in Q[Ke])if(Q[Ke][In]&&typeof Q[Ke][In]=="object"){ke[In]=Q[Ke][In].constructor===Array?[]:{};for(Tn in Q[Ke][In])ke[In][Tn]=Q[Ke][In][Tn]}else ke[In]=Q[Ke][In];ye.unshift(ke)}else ye.unshift(Q[Ke].san)}return ye},E._getPos=function(L,pe){var ye,ke,Q;return typeof L!="number"&&(L=R),typeof pe!="number"&&(pe=de),ke=E._lines(),ye=ke[pe],L>=0?ye[L]:ye.id?ye.atMoveNode?ke[ye.parentId][ye.atMoveNode-1]:E._getPos(ye.atMoveNode-1,ye.parentId):(Q={fen:Y.header().FEN||ge,hash:ye.hash,initial:!0,ids:{move:-1,line:0}},E.siblingGame&&(Q.bughouseOrder=-1),Q)},E.move=function(L,pe){var ye,ke=E._history(),Q,Ke,yt;if(L&&(typeof L=="string"||L.to&&(L.from||L.drop))){if(de===ke.id&&R<ke.length-1||pe){if(E.moveForward(pe,L))return!0;R<ke.length-1&&(E.selectPosition(R+1),E.createVariation(),ke=E._history())}E.siblingGame&&(Ke=E.isDependent?E.siblingGame.fen():E.fen()),ye=E._move(L),ye&&(jn(ye),de=ke.id,R=ke.length-1,Q=ke[R],yt=E._getPos(R-1),E.siblingGame?(Q.fen=E.isDependent?E.siblingGame.fen():E.fen(),Q.beforeFen=Ke,Q.siblingIds=E.siblingGame.ids()):(Q.fen=E.fen(),Q.beforeFen=yt.fen),yt.initial?(Q.moveNumber=0,Q.previous=null):(Q.moveNumber=yt.moveNumber+1,Q.previous=yt.ids),de&&R===0&&E._lines()[ke.parentId][ke.atMoveNode].move===Q.move&&(Q.isContinuation=!0),Q.flags=ye.flags,Q.to=ye.to,Q.from=ye.from,Q.drop=ye.drop,Q.capturedStr=ye.captured,Q.promotion=ye.promotion,Q.piece=ye.piece,ye.promoted&&(Q.promoted=!0),ye.capturedPromotedPawn&&(Q.capturedPromotedPawn=!0),Q.ids={move:R,line:de})}return ye},E.moveDetails=function(L){return L=L||E._history()[R],L&&(L.lines=L.lines||null,L.flags===Le.FLAGS.KSIDE_CASTLE?(L.rookFrom=E.header().Variant==="Chess960"?L.to:"h"+L.to[1],L.rookTo="f"+L.to[1],L.kingTo="g"+L.to[1]):L.flags===Le.FLAGS.QSIDE_CASTLE?(L.rookFrom=E.header().Variant==="Chess960"?L.to:"a"+L.to[1],L.rookTo="d"+L.to[1],L.kingTo="c"+L.to[1]):L.flags===Le.FLAGS.EP_CAPTURE&&(L.epCapture=L.to[0]+L.from[1])),L},E.header=E.headers=function(L){var pe=Y.header(L);return E.siblingGame&&ot(E.siblingGame),pe},E.load=function(L,pe,ye,ke){var Q=Y.load(L,pe,ye,ke);return E.siblingGame&&ot(E.siblingGame),Q&&!ye&&(R=-1,de=0),Q},E.removeEmptyLines=function(){var L=E._lines(),pe,ye;for(pe=L.length-1;pe>0;--pe)L[pe].length||(L[pe]=void 0,ye=!0);ye&&E.reorderLines()},E.loadPgn=function(L,pe,ye){var ke=Y.loadPgn(L,pe,ye),Q=E._history();return E.removeEmptyLines(),R=Q.length-1,de=Q.id,de&&E.selectLine(0),ke},E.ids=function(){return{move:R,line:de}},E.selectLine=function(L){E.selectPosition(null,L)},E.curBughouseMove=function(){return Math.max(E._getPos().bughouseOrder,E.siblingGame._getPos().bughouseOrder)},E.deleteBughouseMove=function(L){var pe=E.curBughouseMove(),ye=!1,ke=E,Q,Ke,yt;if(L>=0)for(pe>=L&&E.selectBughouseMove(L-1);;){for(Q=ke._history(),Ke=Q.length,yt=0;yt<Ke;++yt)if(Q[yt].bughouseOrder>=L){Q.length=yt,ye=!0;break}if(ke===E.siblingGame)break;ke=E.siblingGame}return ye},E.selectBughouseMove=function(L){var pe=E.isDependent?E.siblingGame:E,ye=pe,ke,Q;if(L===-1)return ye.selectPosition(-1,0,!0),ye.siblingGame.selectPosition(-1,0,!0),pe.load(pe.header().FEN,"Bughouse",!0,!0);for(;;){for(ke=ye._history(),Q=ke.length-1;Q>=0;--Q)if(ke[Q].bughouseOrder===L)return ye.selectPosition(ke[Q].ids.move,0,!0),ye.siblingGame.selectPosition(ke[Q].siblingIds.move,0,!0),pe.load(ke[Q].fen,"Bughouse",!0,!0);if(ye===pe.siblingGame)return!1;ye=pe.siblingGame}},E.moveBackward=function(L){var pe;if(E.siblingGame)return E.selectBughouseMove(E.curBughouseMove()-1);if(R<=1)if(de===0){if(R===-1)return!1;E.selectPosition(R-1)}else pe=E._getPos(R-1,de),pe.isContinuation&&!L&&(pe=E._getPos(pe.ids.move-1,pe.ids.line),pe=E._getPos(pe.ids.move+1,pe.ids.line)),E.selectPosition(pe.ids.move,pe.ids.line);else E.selectPosition(R-1);return!0},E.moveForward=function(L,pe){var ye=E._lines(),ke,Q,Ke,yt,In,Tn;if(E.siblingGame)return E.selectBughouseMove(E.curBughouseMove()+1);if(ke=ye[de][R+1],typeof pe=="string"&&(pe={san:pe}),!ke||pe&&!ht(pe,ke)){if(pe&&ke&&ke.lines){for(In=ke.lines.length,yt=0;yt<In;++yt)if(Ke=ye[ke.lines[yt]][0],Ke&&ht(pe,Ke)){ke=Ke,Tn=!0;break}}if(!Tn&&L&&(Q=ye[de][R],Q&&Q.lines)){for(In=Q.lines.length,yt=0;yt<In;++yt)if(Ke=ye[Q.lines[yt]][0],Ke&&Ke.isContinuation&&(Ke=ye[Q.lines[yt]][1],Ke&&(!pe||ht(pe,Ke)))){ke=Ke,Tn=!0;break}}if(!Tn){try{if(pe&&pe.san&&(pe=E.fixMove(pe.san))||pe&&pe.to&&pe.from&&Math.abs(pe.to.charCodeAt(0)-pe.from.charCodeAt(0))>1&&(pe=E.fixMove(pe)))return E.moveForward(L,pe)}catch{}return!1}}return E.selectPosition(ke.ids.move,ke.ids.line)},E.moveVariation=function(L,pe){var ye=E._lines(),ke=ye[L],Q,Ke,yt;if(ke&&ke.id){for(Q=ye[ke.parentId][ke.atMoveNode].lines,Ke=Q.length-1;Ke>=0;--Ke)if(Q[Ke]===L&&(yt=Ke-(pe?1:-1),Q[yt]))return Q[Ke]=Q[yt],Q[yt]=L,E.reorderLines(),!0}return!1},E.promoteVariation=function(L,pe){for(var ye=E._lines(),ke=ye[L],Q,Ke,yt,In,Tn,Fr;ke&&ke[0]&&ke.id&&(pe!==-1||ke.parentId);){for(yt=ke.parentId,Q=ye[yt],In=ke.atMoveNode,ke[0].lines=Q[In].lines.concat(ke[0].lines||[]),Q[In].lines=void 0,Fr=Q.length-In,Ke=Q.splice(In,Fr),Tn=0;Tn<Fr;++Tn)Ke[Tn].ids.line=L,Ke[Tn].ids.move=Tn;for(Ke.id=L,Ke.parentId=yt,Ke.atMoveNode=In,Ke.hash=ke.hash,In===0?(Ke.initComment=Q.initComment,Q.initComment=ke.initComment):ke.initComment&&(Q[In-1].comment=((Q[In-1].comment||"")+" "+ke.initComment).trim()),ye[L]=Ke,Fr=ke.length,Tn=0;Tn<Fr;++Tn)ke[Tn].ids.line=yt,ke[Tn].ids.move=Tn+In,Q.push(ke[Tn]);for(Ke[0].isContinuation=!!ke[0].isContinuation,Q[In].isContinuation=!In&&typeof Q.parentId=="number"&&ye[Q.parentId][Q.atMoveNode].move===Q[0].move,Fr=Q[In].lines.length,Tn=0;Tn<Fr;++Tn)ye[Q[In].lines[Tn]].atMoveNode=In,ye[Q[In].lines[Tn]][0]&&(ye[Q[In].lines[Tn]][0].isContinuation=ye[Q[In].lines[Tn]][0].move===Q[In].move);if(de===L?(de=yt,R+=In):de===yt&&R>=In&&(de=L,R-=In),pe===1)break;L=yt,ke=ye[L]}return Q!==void 0?(E._history(ye[de]),E.reorderLines(),!R&&ye[de][0].isContinuation&&E.selectPosition(ye[de].atMoveNode,ye[de].parentId),!0):!1},E.reorderLines=function(L,pe){var ye=E._lines(),ke,Q,Ke,yt,In,Tn,Fr,vt,_i,_r,Ei=!1;for(L?_i=pe.length-1:(L=0,pe=[ye[0]],_i=0,Ae=!1),ke=ye[L],Ke=ke.length,Q=0;Q<Ke;++Q)if(yt=ke[Q],yt.ids.line!==_i&&(Ei=!0,yt.ids.line=_i),yt.lines)for(In=yt.lines.length,Tn=0;Tn<In;++Tn)Fr=yt.lines[Tn],vt=ye[Fr],vt?(vt.atMoveNode=Q,_r=pe.length,yt.lines[Tn]=_r,vt.parentId=_i,!Ae&&Fr===de&&(Ae=!0,de=_r),pe.push(vt),Ei=E.reorderLines(Fr,pe)||Ei):(yt.lines.length===1?delete yt.lines:yt.lines.splice(Tn,1),--Tn,--In);return L||E.saveLines(pe,!0),Ei},E.createVariation=function(){var L=E._history(),pe=E._lines(),ye,ke,Q;return R===L.length-1?(ye=Y.createVariation(),L=E._history(),R=L.length-1,de=L.id,ye):R===-1?!1:(ke=[],Q=L[R],ke.parentId=L.id,ke.id=pe.length,Q.lines||(Q.lines=[]),Q.lines.push(ke.id),ke.hash=E._getPos(R-1).hash,ke.atMoveNode=R,pe.push(ke),E.selectPosition(-1,ke.id))},E.selectLineEnd=function(L){return E.siblingGame?E.selectBughouseMove(E._history().length+E.siblingGame._history().length-1):(typeof L!="number"&&(L=de),L!==de||R<E._history().length-1?E.selectPosition(null,L,!0):!1)},E.selectLineStart=function(){var L,pe;return E.siblingGame?E.selectBughouseMove(-1):de?(R>1||R===1&&!E._getPos(0).isContinuation?L=E._history():(pe=E._getPos(-1),L=E._lines()[pe.ids.line]),E.selectPosition(L.id?L[1]&&L[0].isContinuation?1:0:-1,L.id)):R===-1?!1:E.selectPosition(-1,0)},E.selectPosition=function(L,pe,ye){var ke=E._lines(),Q=E._history();if(typeof pe=="number"&&(pe!==de||ye)){if(pe<0||pe>=ke.length)return!1;if(Q=ke[pe],typeof L!="number")L=Q.length-1;else if(L<-1||L>=Q.length)return!1;de=pe,E._history(Q),ye=!0}if(typeof L=="number"&&(L!==R||ye)){if(L<-1||L>=Q.length)return!1;Y.load(E._getPos(L).fen,Y.header().Variant,!0,!0),R=L}return!0},E.resetToMainLine=function(){var L=E._lines();E.selectLineEnd(0),L.length>1&&(L.length=1,E.reorderLines())},E.updateNode=function(L,pe,ye){var ke=E._lines(),Q,Ke;ye=typeof ye=="number"?ye:de,pe=typeof pe=="number"?pe:R,Q=ke[ye][pe]||ke[ye];for(Ke in L)Q[Ke]=L[Ke]},E.updateLineComment=function(L,pe){E.updateNode({initComment:L},-1,pe)},E.saveLines=function(L,pe){var ye=E._lines(),ke,Q=L.length,Ke,yt;for(L!==ye&&(ye.length=0),Ke=0;Ke<Q;++Ke){if(ke=L[Ke],Ke&&typeof ke.parentId!="number")return!1;L!==ye&&ye.push(ke),ke.id=Ke}return E._history(E._history()),pe||(yt=E.ids(),E.selectPosition(-1,0,!0),E.selectPosition(yt.move,yt.line)),!0},E.deletePosition=function(L,pe){var ye=E._lines(),ke,Q;return!ye[pe]||!ye[pe][L]&&(L!==-1||pe===0)?!1:(pe&&(L===0||L===1&&ye[pe][0].isContinuation)&&(L=-1),de>0&&pe!==de?(ke=me(ye,de,pe),Q=ke!==!1&&ke>=L):Q=pe===de&&L<=R,Q&&(L>1?E.selectPosition(L-1,pe):(E.selectPosition((ye[pe][0].isContinuation||L===1)&&ye[pe][1]?1:0,pe),E.moveBackward())),L>0?ye[pe].length=L:pe?ye[pe]=null:ye[0].length=0,E.reorderLines(),E.ids())},E.mark=function(L,pe){var ye=R<0?E._lines()[de]:E._lines()[de][R],ke=L.type,Q=1;L.color&&(ke==="arrow"?E.mark({key:L.color+L.key,type:"cal"},pe):ke==="square"&&E.mark({key:L.color+L.key,type:"csl"},pe)),ke!=="cal"&&ke!=="csl"&&(ke="c_"+ke,Q=0),ye.commands&&ye.commands[ke]&&(ye.commands[ke]=ye.commands[ke].split(",").filter(function(yt){return yt.slice(Q).split(";")[0]!==L.key.slice(Q)}).join(","),ye.commands[ke]||delete ye.commands[ke]),pe||(ye.commands||(ye.commands={}),ye.commands[ke]=(ye.commands[ke]?ye.commands[ke]+",":"")+L.key+(L.data?";"+L.data.join(";"):""))},E.markings=function(){var L={},pe=R<0?E._lines()[de]:E._lines()[de][R],ye,ke,Q,Ke={cal:"arrow",csl:"square"},yt,In,Tn,Fr,vt;for(ke in pe.commands){if(Q=pe.commands[ke],Ke[ke])ke=Ke[ke],yt=0;else if(ke.substr(0,2)==="c_")ke=ke.slice(2),yt=1;else continue;for(L[ke]=L[ke]||{},In=Q.split(","),Tn=In.length,ye=0;ye<Tn;++ye)yt?(Fr=In[ye].split(";"),vt=Fr.shift(),L[ke][vt]=L[ke][vt]||{type:ke,key:vt},L[ke][vt].data=Fr):(vt=In[ye].slice(1),L[ke][vt]=L[ke][vt]||{type:ke,key:vt},L[ke][vt].color=In[ye][0])}return L},E.clearMarkings=function(){var L=R<0?E._lines()[de]:E._lines()[de][R],pe;for(pe in L.commands)/^c[sa]l$|^c_/.test(pe)&&delete L.commands[pe]},E.pgn=function(L){var pe=E.ids(),ye;return E.selectLineEnd(0),ye=Y.pgn(L),E.selectPosition(pe.move,pe.line),ye},E.loadMoves=function(L,pe){var ye,ke,Q,Ke,yt;if(pe=pe||{},typeof L=="string"&&(L=xt(L)),L){for(pe.atCurrent||E.selectPosition(-1,0),Q=de,ke=L.length,ye=0;ye<ke;++ye){if(Ke=E.move(L[ye],!0),!Ke&&(L[ye].promotion=pe.autoPromote===!0?"q":pe.autoPromote,Ke=E.move(L[ye],!0),!Ke))return!1;de!==Q&&pe.method!=="merge"&&(E.promoteVariation(de,1),pe.method!=="promote"&&(E._history()[R].lines=void 0,E.reorderLines()),Q=de)}if(pe.method==="promote"){if(ke){for(E._history()[R+1]&&(Ke=E._history()[R],E.createVariation(),E.move(Ke),on(E._history()[0],Ke),E.promoteVariation(de,1)),yt=E._lines(),ye=yt.length-1;ye>=0;--ye)yt[ye].length===1&&yt[ye][0].isContinuation&&(on(yt[ye][0],yt[yt[ye].parentId][yt[ye].atMoveNode]),yt[ye].length=0);E.removeEmptyLines()}}else pe.method!=="merge"&&E.deletePosition(R+1,de)}return!0})}function xe(E){var Y,R;if(E=E||{},E.game)return E.game;if(Y=te(),E.analysis&&ot(Y),E.disableHashing&&Y.hashing(!1),E.pgn){if(!Y.loadPgn(E.pgn,E.index,E.options)&&(E.variant!=="detect"||!te.variants.some(function(de){return E.options=E.options||{},E.options.variant=de,Y.loadPgn(E.pgn,E.index,E.options)})))return!1}else{if(E.headers&&(E.variant=E.headers.Variant||E.variant,E.fen||(E.fen=E.headers.FEN)),E.variant==="detect"&&E.fen&&(E.fen.indexOf("|")>-1?E.variant="Bughouse":E.fen.split("/").length===9?E.variant="Crazyhouse":E.fen.indexOf("+")>-1?E.variant="3-check":E.variant=void 0),(E.fen||E.variant)&&!Y.load(E.fen||ge,E.variant))return!1;E.headers&&typeof E.headers=="object"&&!Array.isArray(E.headers)&&Y.header(E.headers)}if(E.tcn)if(typeof E.tcn=="object"){if(!We(Y,E.tcn,E.timestamps||[[],[]]))return!1}else R=xt(E.tcn);else R=E.moves;return R&&!dt(Y,R,E,E.timestamps)?!1:Y}function gn(E){var Y;return E=E||{},E.disableHashing=!0,Y=xe(E),Y?Y.pgn(E):!1}function Jt(E,Y){var R,de=[],Ae;if(Le.reset(),!Le.loadPgn(E))return!1;if(R=Le.moveCount(),typeof Y=="number"){for(Y<0&&(Y=R+Y+1),Ae=R-1;Ae>=Y&&Ae>=0;Ae-=1)Le.undo();return Le.fen()}for(Ae=0;Ae<=R;Ae+=1)de.unshift(Le.fen()),Le.undo();return de}function jn(E){return E&&(E.piece&Je&&(E.promoted=!0),E.piece=De[E.piece&Ce],E.captured&&(E.captured&Je&&(E.capturedPromotedPawn=!0),E.captured=De[E.captured&Be]),E.promotion&&(E.promotion=De[E.promotion&Ce]),E.drop!==void 0&&(E.drop=M[E.drop])),E}function nr(E){var Y=E.history(!0,!0),R,de,Ae,me,on,L,pe;if(E.siblingGame){for(R=E.siblingGame.history(!0,!0),Ae=Y.length+R.length,de=[],me=0;me<Ae;++me)!Y.length||R.length&&R[0].bughouseOrder<Y[0].bughouseOrder?(on=R.shift(),on.board="b"):(on=Y.shift(),on.board="a"),de.push(on);Y=de}for(Ae=Y.length,me=0;me<Ae;++me)if(L=Y[me],L.fen||jn(L),L.lines)for(pe=L.lines.length-1;pe>=0;--pe)E.selectLine(L.lines[pe]),L.lines[pe]=nr(E).moves;return{moves:Y}}function Tr(E,Y,R){var de=[],Ae,me=Le;return typeof Y!="number"&&(R=Y,Y=void 0),Ae=me.tokenizePgn(E,R),Y<0&&(Y=Ae.length+Y),Ae?(R&&R.includeFen&&(me=xe({analysis:!0})),Ae.forEach(function(on,L){var pe,ye;L===Y||Y===void 0?me.loadPgn([on],0,R)?(ye=nr(me),pe=me.header(),de.push({headers:pe,moves:ye.moves})):de.push(!1):de.push(void 0)}),typeof Y=="number"?de[Y]:de):!1}function mn(E,Y,R){return Le.reset(),Le.load(Y,R)?jn(Le.move(E)):!1}function Pn(E,Y){return Le.completeFen(E).split(" ").slice(0,Y||4).join(" ")}function Pt(E,Y,R){return Le.reset(),Le.load(E,R),Y&&!dt(Le,Y)?!1:Le.fen()}function ft(E,Y){var R,de,Ae,me;if(typeof E=="string"){if(de=Le,de.reset(),!de.load(E,Y))return null}else de=xe(E);for(R=de.moves({verbose:!0}),me=R.length,Ae=0;Ae<me;++Ae)jn(R[Ae]);return R}function Dt(E,Y,R){var de,Ae={gameOver:!1,check:!1,checkmate:!1,draw:!1,stalemate:!1,threefold:!1,insufficient:!1},me;if(Array.isArray(Y)||(R=Y,Y=null),typeof R=="boolean"?(de=R,R={}):(R=R||{},de=R.variant),typeof E=="string"){if(me=Le,me.reset(),me.validateFen(E,de)!==0||!me.load(E,de))return!1}else me=xe(E);return Y&&!dt(me,Y)?!1:(R.getLegalMoves&&(Ae.legalMoves=ft({game:me})),me.inCheck()?(Ae.check=!0,Ae.checkmate=me.inCheckmate()):Ae.stalemate=me.inStalemate(),Ae.threefold=me.inThreefoldRepetition(),Ae.insufficient=me.insufficientMaterial(R.color),Ae.fiftyMoveRule=me.in50MoveRule(),Ae.draw=Ae.stalemate||Ae.threefold||Ae.insufficient||Ae.fiftyMoveRule||me.inDraw(),R.skipValidation||(Ae.isValid=me.isPositionValid(R)),de&&(Ae.variantWin=me.isVariantWin(),Ae.variantWin===void 0&&(Ae.variantWin=me.isBughouseWin())),Ae.gameOver=Ae.checkmate||Ae.draw||!!Ae.variantWin,Ae)}function Dn(E,Y){return Le.validateFen(E,Y)===0}function Bn(E,Y){q.loadBook(E,function(de,Ae){if(!Ae||!Ae.json)return Y(de||new Error("Invalid book"));Y(de,function(on){var L,pe,ye,ke,Q,Ke,yt,In,Tn;if(on.hash)typeof on.hash=="string"?pe=[q.hex64ToDec(on.hash)]:pe=[on.hash],ke=1;else{if(L=xe(on),!L)return!1;pe=L.hashes(),ke=pe.length}for(ye=0;ye<ke;++ye)if(Q=Ae.json[q.to64BitHex(pe[ye])],Q){if(Q.constructor===Array)if(Ke&&Q[0].m.indexOf(Ke.m)===-1){for(In=Q.length-1;In>=0;--In)if(!In||Q[In].m.indexOf(Ke.m)!==-1){Tn=Q[In],Tn.e=Q[0].e,Tn.s=Q[0].s,Tn.mate=Q[0].mate,Tn.v=Q[0].v,Tn.h=Q[0].h,Tn.n=Tn.n||Q[0].n,Tn.u=Tn.u||Q[0].u,Tn.c=Tn.c||Q[0].c;break}}else Tn=Q[0];else Tn=Q;(Tn.n||on.allowNameless)&&(Ke=Tn)}else on.mustEndInBook&&(Ke=void 0);if(Ke)return yt={name:Ke.n},Ke.m&&(yt.moves=Ke.m),Ke.d!==void 0&&(yt.sdiff=Ke.d/100),Ke.c&&(yt.code=Ke.c,yt.url=Ke.u||Ke.n.replace(/[\u00e1-\u00e5]/g,"a").replace(/[\u0107\u010d]/g,"c").replace(/[\u00e9\u00e8\u0117\u0113]/g,"e").replace(/[\u00f3\u00f6\u00f8]/g,"o").replace(/[\u016f\u00fc]/g,"u").replace(/['+,]/g,"").replace(/[^a-z0-9.]+/ig,"-").replace(/(with-\d|St)\.+-?/,"$1-")),Ke.e?(yt.eval=Ke.e,yt.depth=Ke.h,yt.score=Ke.e[0].cp/100,Ke.e[0].mate!==void 0&&(yt.mate=Ke.e[0].mate)):(yt.score=Ke.s/100,Ke.mate!==void 0&&(yt.mate=Ke.mate)),Ke.v&&(yt.bad=!0),yt},Ae.json)})}function ie(E,Y){return Me=Me||He(ie),Me(E,Y)}return ie.supportsMultithreading=function(){var E,Y=!!ie._hasThreads;if(typeof ie._hasThreads!="boolean"){try{E=new Worker("data:application/javascript,"),E.postMessage(new SharedArrayBuffer(1)),Y=!0}catch{}try{E.terminate()}catch{}ie._hasThreads=Y}return Y},ie.supportsSIMD=function(){return typeof ie._hasSIMD=="boolean"?ie._hasSIMD:ie._hasSIMD=WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))},ie.gameFingerprints=pn,ie.getFenFromMoves=Pt,ie.getLegalMoves=ft,ie.getPositionInfo=Dt,ie.isFenValid=Dn,ie.encodeTCN=yr,ie.decodeTCN=xt,ie.uciToObj=Kn,ie.generatePgn=gn,ie.pgnToFen=Jt,ie.pgnToJson=Tr,ie.sanToObj=mn,ie.completeFen=Le.completeFen,ie.shortenFen=Pn,ie.createGame=xe,ie.getPositionDetails=Qe,ie.predict=Jr,ie.normalizeMoveObj=jn,ie.FLAGS=Le.FLAGS,ie.loadECO=Bn,ie.CEE_LIB=function(){var E={};return E.addOptions=function(Y,R){for(var de in R)R[de]!==void 0&&Y.push("setoption name "+de+" value "+R[de]);return Y},E.addVariations=function(Y,R,de){var Ae,me;R=R||[],de=de||"variation";for(var on=0;on<R.length;++on)Ae=R[on],Ae.pv=Array.isArray(Ae.pv)&&Ae.pv.join(" ")||Ae.pv||"",me=de+" "+Ae.pv,typeof Ae.mateIn=="number"?me+=" mate "+Ae.mateIn:typeof Ae.mate=="number"?me+=" mate "+Ae.mate:me+=" cp "+Math.round(Ae.cp),typeof Ae.depth=="number"&&(me+=" depth "+Ae.depth),Y.push(me);return Y},E.addPush=function(Y,R){var de;return typeof R=="string"&&(R={moveLan:R}),de="push "+R.moveLan,R.isBook&&(de+=" isBook"),R.isRetry&&(de+=" isRetry"),Y.push(de),Y},E.addPosition=function(Y,R){return Y.push("position fen "+R),Y},E.addVariant=function(Y,R){return String(R).toLowerCase().replace(/ |-/g,"")==="chess960"?(Y.push("setoption name UCI_Variant value chess"),Y.push("setoption name UCI_Chess960 value "+!0)):(Y.push("setoption name UCI_Variant value chess"),Y.push("setoption name UCI_Chess960 value "+!1)),Y},E}(),ie}();return lt.exports=Ge,Ge}()},9669:function(lt,nn,Fe){lt.exports=Fe(51609)},55448:function(lt,nn,Fe){"use strict";var w=Fe(64867),ne=Fe(36026),q=Fe(4372),te=Fe(15327),He=Fe(94097),Ge=Fe(84109),Le=Fe(67985),Me=Fe(85061),ge=Fe(45655),Ce=Fe(65263);lt.exports=function(De){return new Promise(function(Je,zt){var cn=De.data,xt=De.headers,yr=De.responseType,Kn;function ht(){De.cancelToken&&De.cancelToken.unsubscribe(Kn),De.signal&&De.signal.removeEventListener("abort",Kn)}w.isFormData(cn)&&delete xt["Content-Type"];var bt=new XMLHttpRequest;if(De.auth){var er=De.auth.username||"",dr=De.auth.password?unescape(encodeURIComponent(De.auth.password)):"";xt.Authorization="Basic "+btoa(er+":"+dr)}var Jr=He(De.baseURL,De.url);bt.open(De.method.toUpperCase(),te(Jr,De.params,De.paramsSerializer),!0),bt.timeout=De.timeout;function Qe(){if(bt){var dt="getAllResponseHeaders"in bt?Ge(bt.getAllResponseHeaders()):null,We=!yr||yr==="text"||yr==="json"?bt.responseText:bt.response,ot={data:We,status:bt.status,statusText:bt.statusText,headers:dt,config:De,request:bt};ne(function(gn){Je(gn),ht()},function(gn){zt(gn),ht()},ot),bt=null}}if("onloadend"in bt?bt.onloadend=Qe:bt.onreadystatechange=function(){!bt||bt.readyState!==4||bt.status===0&&!(bt.responseURL&&bt.responseURL.indexOf("file:")===0)||setTimeout(Qe)},bt.onabort=function(){bt&&(zt(Me("Request aborted",De,"ECONNABORTED",bt)),bt=null)},bt.onerror=function(){zt(Me("Network Error",De,null,bt)),bt=null},bt.ontimeout=function(){var We=De.timeout?"timeout of "+De.timeout+"ms exceeded":"timeout exceeded",ot=De.transitional||ge.transitional;De.timeoutErrorMessage&&(We=De.timeoutErrorMessage),zt(Me(We,De,ot.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",bt)),bt=null},w.isStandardBrowserEnv()){var pn=(De.withCredentials||Le(Jr))&&De.xsrfCookieName?q.read(De.xsrfCookieName):void 0;pn&&(xt[De.xsrfHeaderName]=pn)}"setRequestHeader"in bt&&w.forEach(xt,function(We,ot){typeof cn>"u"&&ot.toLowerCase()==="content-type"?delete xt[ot]:bt.setRequestHeader(ot,We)}),w.isUndefined(De.withCredentials)||(bt.withCredentials=!!De.withCredentials),yr&&yr!=="json"&&(bt.responseType=De.responseType),typeof De.onDownloadProgress=="function"&&bt.addEventListener("progress",De.onDownloadProgress),typeof De.onUploadProgress=="function"&&bt.upload&&bt.upload.addEventListener("progress",De.onUploadProgress),(De.cancelToken||De.signal)&&(Kn=function(dt){bt&&(zt(!dt||dt&&dt.type?new Ce("canceled"):dt),bt.abort(),bt=null)},De.cancelToken&&De.cancelToken.subscribe(Kn),De.signal&&(De.signal.aborted?Kn():De.signal.addEventListener("abort",Kn))),cn||(cn=null),bt.send(cn)})}},51609:function(lt,nn,Fe){"use strict";var w=Fe(64867),ne=Fe(91849),q=Fe(30321),te=Fe(47185),He=Fe(45655);function Ge(Me){var ge=new q(Me),Ce=ne(q.prototype.request,ge);return w.extend(Ce,q.prototype,ge),w.extend(Ce,ge),Ce.create=function(De){return Ge(te(Me,De))},Ce}var Le=Ge(He);Le.Axios=q,Le.Cancel=Fe(65263),Le.CancelToken=Fe(14972),Le.isCancel=Fe(26502),Le.VERSION=Fe(97288).version,Le.all=function(ge){return Promise.all(ge)},Le.spread=Fe(8713),Le.isAxiosError=Fe(16268),lt.exports=Le,lt.exports.default=Le},65263:function(lt){"use strict";function nn(Fe){this.message=Fe}nn.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},nn.prototype.__CANCEL__=!0,lt.exports=nn},14972:function(lt,nn,Fe){"use strict";var w=Fe(65263);function ne(q){if(typeof q!="function")throw new TypeError("executor must be a function.");var te;this.promise=new Promise(function(Le){te=Le});var He=this;this.promise.then(function(Ge){if(He._listeners){var Le,Me=He._listeners.length;for(Le=0;Le<Me;Le++)He._listeners[Le](Ge);He._listeners=null}}),this.promise.then=function(Ge){var Le,Me=new Promise(function(ge){He.subscribe(ge),Le=ge}).then(Ge);return Me.cancel=function(){He.unsubscribe(Le)},Me},q(function(Le){He.reason||(He.reason=new w(Le),te(He.reason))})}ne.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},ne.prototype.subscribe=function(te){if(this.reason){te(this.reason);return}this._listeners?this._listeners.push(te):this._listeners=[te]},ne.prototype.unsubscribe=function(te){if(this._listeners){var He=this._listeners.indexOf(te);He!==-1&&this._listeners.splice(He,1)}},ne.source=function(){var te,He=new ne(function(Le){te=Le});return{token:He,cancel:te}},lt.exports=ne},26502:function(lt){"use strict";lt.exports=function(Fe){return!!(Fe&&Fe.__CANCEL__)}},30321:function(lt,nn,Fe){"use strict";var w=Fe(64867),ne=Fe(15327),q=Fe(80782),te=Fe(13572),He=Fe(47185),Ge=Fe(54875),Le=Ge.validators;function Me(ge){this.defaults=ge,this.interceptors={request:new q,response:new q}}Me.prototype.request=function(Ce,Be){if(typeof Ce=="string"?(Be=Be||{},Be.url=Ce):Be=Ce||{},!Be.url)throw new Error("Provided config url is not valid");Be=He(this.defaults,Be),Be.method?Be.method=Be.method.toLowerCase():this.defaults.method?Be.method=this.defaults.method.toLowerCase():Be.method="get";var De=Be.transitional;De!==void 0&&Ge.assertOptions(De,{silentJSONParsing:Le.transitional(Le.boolean),forcedJSONParsing:Le.transitional(Le.boolean),clarifyTimeoutError:Le.transitional(Le.boolean)},!1);var M=[],Je=!0;this.interceptors.request.forEach(function(er){typeof er.runWhen=="function"&&er.runWhen(Be)===!1||(Je=Je&&er.synchronous,M.unshift(er.fulfilled,er.rejected))});var zt=[];this.interceptors.response.forEach(function(er){zt.push(er.fulfilled,er.rejected)});var cn;if(!Je){var xt=[te,void 0];for(Array.prototype.unshift.apply(xt,M),xt=xt.concat(zt),cn=Promise.resolve(Be);xt.length;)cn=cn.then(xt.shift(),xt.shift());return cn}for(var yr=Be;M.length;){var Kn=M.shift(),ht=M.shift();try{yr=Kn(yr)}catch(bt){ht(bt);break}}try{cn=te(yr)}catch(bt){return Promise.reject(bt)}for(;zt.length;)cn=cn.then(zt.shift(),zt.shift());return cn},Me.prototype.getUri=function(Ce){if(!Ce.url)throw new Error("Provided config url is not valid");return Ce=He(this.defaults,Ce),ne(Ce.url,Ce.params,Ce.paramsSerializer).replace(/^\?/,"")},w.forEach(["delete","get","head","options"],function(Ce){Me.prototype[Ce]=function(Be,De){return this.request(He(De||{},{method:Ce,url:Be,data:(De||{}).data}))}}),w.forEach(["post","put","patch"],function(Ce){Me.prototype[Ce]=function(Be,De,M){return this.request(He(M||{},{method:Ce,url:Be,data:De}))}}),lt.exports=Me},80782:function(lt,nn,Fe){"use strict";var w=Fe(64867);function ne(){this.handlers=[]}ne.prototype.use=function(te,He,Ge){return this.handlers.push({fulfilled:te,rejected:He,synchronous:Ge?Ge.synchronous:!1,runWhen:Ge?Ge.runWhen:null}),this.handlers.length-1},ne.prototype.eject=function(te){this.handlers[te]&&(this.handlers[te]=null)},ne.prototype.forEach=function(te){w.forEach(this.handlers,function(Ge){Ge!==null&&te(Ge)})},lt.exports=ne},94097:function(lt,nn,Fe){"use strict";var w=Fe(91793),ne=Fe(7303);lt.exports=function(te,He){return te&&!w(He)?ne(te,He):He}},85061:function(lt,nn,Fe){"use strict";var w=Fe(80481);lt.exports=function(q,te,He,Ge,Le){var Me=new Error(q);return w(Me,te,He,Ge,Le)}},13572:function(lt,nn,Fe){"use strict";var w=Fe(64867),ne=Fe(18527),q=Fe(26502),te=Fe(45655),He=Fe(65263);function Ge(Le){if(Le.cancelToken&&Le.cancelToken.throwIfRequested(),Le.signal&&Le.signal.aborted)throw new He("canceled")}lt.exports=function(Me){Ge(Me),Me.headers=Me.headers||{},Me.data=ne.call(Me,Me.data,Me.headers,Me.transformRequest),Me.headers=w.merge(Me.headers.common||{},Me.headers[Me.method]||{},Me.headers),w.forEach(["delete","get","head","post","put","patch","common"],function(Be){delete Me.headers[Be]});var ge=Me.adapter||te.adapter;return ge(Me).then(function(Be){return Ge(Me),Be.data=ne.call(Me,Be.data,Be.headers,Me.transformResponse),Be},function(Be){return q(Be)||(Ge(Me),Be&&Be.response&&(Be.response.data=ne.call(Me,Be.response.data,Be.response.headers,Me.transformResponse))),Promise.reject(Be)})}},80481:function(lt){"use strict";lt.exports=function(Fe,w,ne,q,te){return Fe.config=w,ne&&(Fe.code=ne),Fe.request=q,Fe.response=te,Fe.isAxiosError=!0,Fe.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},Fe}},47185:function(lt,nn,Fe){"use strict";var w=Fe(64867);lt.exports=function(q,te){te=te||{};var He={};function Ge(De,M){return w.isPlainObject(De)&&w.isPlainObject(M)?w.merge(De,M):w.isPlainObject(M)?w.merge({},M):w.isArray(M)?M.slice():M}function Le(De){if(w.isUndefined(te[De])){if(!w.isUndefined(q[De]))return Ge(void 0,q[De])}else return Ge(q[De],te[De])}function Me(De){if(!w.isUndefined(te[De]))return Ge(void 0,te[De])}function ge(De){if(w.isUndefined(te[De])){if(!w.isUndefined(q[De]))return Ge(void 0,q[De])}else return Ge(void 0,te[De])}function Ce(De){if(De in te)return Ge(q[De],te[De]);if(De in q)return Ge(void 0,q[De])}var Be={url:Me,method:Me,data:Me,baseURL:ge,transformRequest:ge,transformResponse:ge,paramsSerializer:ge,timeout:ge,timeoutMessage:ge,withCredentials:ge,adapter:ge,responseType:ge,xsrfCookieName:ge,xsrfHeaderName:ge,onUploadProgress:ge,onDownloadProgress:ge,decompress:ge,maxContentLength:ge,maxBodyLength:ge,transport:ge,httpAgent:ge,httpsAgent:ge,cancelToken:ge,socketPath:ge,responseEncoding:ge,validateStatus:Ce};return w.forEach(Object.keys(q).concat(Object.keys(te)),function(M){var Je=Be[M]||Le,zt=Je(M);w.isUndefined(zt)&&Je!==Ce||(He[M]=zt)}),He}},36026:function(lt,nn,Fe){"use strict";var w=Fe(85061);lt.exports=function(q,te,He){var Ge=He.config.validateStatus;!He.status||!Ge||Ge(He.status)?q(He):te(w("Request failed with status code "+He.status,He.config,null,He.request,He))}},18527:function(lt,nn,Fe){"use strict";var w=Fe(64867),ne=Fe(45655);lt.exports=function(te,He,Ge){var Le=this||ne;return w.forEach(Ge,function(ge){te=ge.call(Le,te,He)}),te}},45655:function(lt,nn,Fe){"use strict";var w=Fe(34155),ne=Fe(64867),q=Fe(16016),te=Fe(80481),He={"Content-Type":"application/x-www-form-urlencoded"};function Ge(Ce,Be){!ne.isUndefined(Ce)&&ne.isUndefined(Ce["Content-Type"])&&(Ce["Content-Type"]=Be)}function Le(){var Ce;return(typeof XMLHttpRequest<"u"||typeof w<"u"&&Object.prototype.toString.call(w)==="[object process]")&&(Ce=Fe(55448)),Ce}function Me(Ce,Be,De){if(ne.isString(Ce))try{return(Be||JSON.parse)(Ce),ne.trim(Ce)}catch(M){if(M.name!=="SyntaxError")throw M}return(De||JSON.stringify)(Ce)}var ge={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:Le(),transformRequest:[function(Be,De){return q(De,"Accept"),q(De,"Content-Type"),ne.isFormData(Be)||ne.isArrayBuffer(Be)||ne.isBuffer(Be)||ne.isStream(Be)||ne.isFile(Be)||ne.isBlob(Be)?Be:ne.isArrayBufferView(Be)?Be.buffer:ne.isURLSearchParams(Be)?(Ge(De,"application/x-www-form-urlencoded;charset=utf-8"),Be.toString()):ne.isObject(Be)||De&&De["Content-Type"]==="application/json"?(Ge(De,"application/json"),Me(Be)):Be}],transformResponse:[function(Be){var De=this.transitional||ge.transitional,M=De&&De.silentJSONParsing,Je=De&&De.forcedJSONParsing,zt=!M&&this.responseType==="json";if(zt||Je&&ne.isString(Be)&&Be.length)try{return JSON.parse(Be)}catch(cn){if(zt)throw cn.name==="SyntaxError"?te(cn,this,"E_JSON_PARSE"):cn}return Be}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(Be){return Be>=200&&Be<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ne.forEach(["delete","get","head"],function(Be){ge.headers[Be]={}}),ne.forEach(["post","put","patch"],function(Be){ge.headers[Be]=ne.merge(He)}),lt.exports=ge},97288:function(lt){lt.exports={version:"0.25.0"}},91849:function(lt){"use strict";lt.exports=function(Fe,w){return function(){for(var q=new Array(arguments.length),te=0;te<q.length;te++)q[te]=arguments[te];return Fe.apply(w,q)}}},15327:function(lt,nn,Fe){"use strict";var w=Fe(64867);function ne(q){return encodeURIComponent(q).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}lt.exports=function(te,He,Ge){if(!He)return te;var Le;if(Ge)Le=Ge(He);else if(w.isURLSearchParams(He))Le=He.toString();else{var Me=[];w.forEach(He,function(Be,De){Be===null||typeof Be>"u"||(w.isArray(Be)?De=De+"[]":Be=[Be],w.forEach(Be,function(Je){w.isDate(Je)?Je=Je.toISOString():w.isObject(Je)&&(Je=JSON.stringify(Je)),Me.push(ne(De)+"="+ne(Je))}))}),Le=Me.join("&")}if(Le){var ge=te.indexOf("#");ge!==-1&&(te=te.slice(0,ge)),te+=(te.indexOf("?")===-1?"?":"&")+Le}return te}},7303:function(lt){"use strict";lt.exports=function(Fe,w){return w?Fe.replace(/\/+$/,"")+"/"+w.replace(/^\/+/,""):Fe}},4372:function(lt,nn,Fe){"use strict";var w=Fe(64867);lt.exports=w.isStandardBrowserEnv()?function(){return{write:function(te,He,Ge,Le,Me,ge){var Ce=[];Ce.push(te+"="+encodeURIComponent(He)),w.isNumber(Ge)&&Ce.push("expires="+new Date(Ge).toGMTString()),w.isString(Le)&&Ce.push("path="+Le),w.isString(Me)&&Ce.push("domain="+Me),ge===!0&&Ce.push("secure"),document.cookie=Ce.join("; ")},read:function(te){var He=document.cookie.match(new RegExp("(^|;\\s*)("+te+")=([^;]*)"));return He?decodeURIComponent(He[3]):null},remove:function(te){this.write(te,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},91793:function(lt){"use strict";lt.exports=function(Fe){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(Fe)}},16268:function(lt,nn,Fe){"use strict";var w=Fe(64867);lt.exports=function(q){return w.isObject(q)&&q.isAxiosError===!0}},67985:function(lt,nn,Fe){"use strict";var w=Fe(64867);lt.exports=w.isStandardBrowserEnv()?function(){var q=/(msie|trident)/i.test(navigator.userAgent),te=document.createElement("a"),He;function Ge(Le){var Me=Le;return q&&(te.setAttribute("href",Me),Me=te.href),te.setAttribute("href",Me),{href:te.href,protocol:te.protocol?te.protocol.replace(/:$/,""):"",host:te.host,search:te.search?te.search.replace(/^\?/,""):"",hash:te.hash?te.hash.replace(/^#/,""):"",hostname:te.hostname,port:te.port,pathname:te.pathname.charAt(0)==="/"?te.pathname:"/"+te.pathname}}return He=Ge(window.location.href),function(Me){var ge=w.isString(Me)?Ge(Me):Me;return ge.protocol===He.protocol&&ge.host===He.host}}():function(){return function(){return!0}}()},16016:function(lt,nn,Fe){"use strict";var w=Fe(64867);lt.exports=function(q,te){w.forEach(q,function(Ge,Le){Le!==te&&Le.toUpperCase()===te.toUpperCase()&&(q[te]=Ge,delete q[Le])})}},84109:function(lt,nn,Fe){"use strict";var w=Fe(64867),ne=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];lt.exports=function(te){var He={},Ge,Le,Me;return te&&w.forEach(te.split(`
`),function(Ce){if(Me=Ce.indexOf(":"),Ge=w.trim(Ce.substr(0,Me)).toLowerCase(),Le=w.trim(Ce.substr(Me+1)),Ge){if(He[Ge]&&ne.indexOf(Ge)>=0)return;Ge==="set-cookie"?He[Ge]=(He[Ge]?He[Ge]:[]).concat([Le]):He[Ge]=He[Ge]?He[Ge]+", "+Le:Le}}),He}},8713:function(lt){"use strict";lt.exports=function(Fe){return function(ne){return Fe.apply(null,ne)}}},54875:function(lt,nn,Fe){"use strict";var w=Fe(97288).version,ne={};["object","boolean","number","function","string","symbol"].forEach(function(He,Ge){ne[He]=function(Me){return typeof Me===He||"a"+(Ge<1?"n ":" ")+He}});var q={};ne.transitional=function(Ge,Le,Me){function ge(Ce,Be){return"[Axios v"+w+"] Transitional option '"+Ce+"'"+Be+(Me?". "+Me:"")}return function(Ce,Be,De){if(Ge===!1)throw new Error(ge(Be," has been removed"+(Le?" in "+Le:"")));return Le&&!q[Be]&&(q[Be]=!0,console.warn(ge(Be," has been deprecated since v"+Le+" and will be removed in the near future"))),Ge?Ge(Ce,Be,De):!0}};function te(He,Ge,Le){if(typeof He!="object")throw new TypeError("options must be an object");for(var Me=Object.keys(He),ge=Me.length;ge-- >0;){var Ce=Me[ge],Be=Ge[Ce];if(Be){var De=He[Ce],M=De===void 0||Be(De,Ce,He);if(M!==!0)throw new TypeError("option "+Ce+" must be "+M);continue}if(Le!==!0)throw Error("Unknown option "+Ce)}}lt.exports={assertOptions:te,validators:ne}},64867:function(lt,nn,Fe){"use strict";var w=Fe(91849),ne=Object.prototype.toString;function q(Qe){return Array.isArray(Qe)}function te(Qe){return typeof Qe>"u"}function He(Qe){return Qe!==null&&!te(Qe)&&Qe.constructor!==null&&!te(Qe.constructor)&&typeof Qe.constructor.isBuffer=="function"&&Qe.constructor.isBuffer(Qe)}function Ge(Qe){return ne.call(Qe)==="[object ArrayBuffer]"}function Le(Qe){return ne.call(Qe)==="[object FormData]"}function Me(Qe){var pn;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?pn=ArrayBuffer.isView(Qe):pn=Qe&&Qe.buffer&&Ge(Qe.buffer),pn}function ge(Qe){return typeof Qe=="string"}function Ce(Qe){return typeof Qe=="number"}function Be(Qe){return Qe!==null&&typeof Qe=="object"}function De(Qe){if(ne.call(Qe)!=="[object Object]")return!1;var pn=Object.getPrototypeOf(Qe);return pn===null||pn===Object.prototype}function M(Qe){return ne.call(Qe)==="[object Date]"}function Je(Qe){return ne.call(Qe)==="[object File]"}function zt(Qe){return ne.call(Qe)==="[object Blob]"}function cn(Qe){return ne.call(Qe)==="[object Function]"}function xt(Qe){return Be(Qe)&&cn(Qe.pipe)}function yr(Qe){return ne.call(Qe)==="[object URLSearchParams]"}function Kn(Qe){return Qe.trim?Qe.trim():Qe.replace(/^\s+|\s+$/g,"")}function ht(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function bt(Qe,pn){if(!(Qe===null||typeof Qe>"u"))if(typeof Qe!="object"&&(Qe=[Qe]),q(Qe))for(var dt=0,We=Qe.length;dt<We;dt++)pn.call(null,Qe[dt],dt,Qe);else for(var ot in Qe)Object.prototype.hasOwnProperty.call(Qe,ot)&&pn.call(null,Qe[ot],ot,Qe)}function er(){var Qe={};function pn(ot,xe){De(Qe[xe])&&De(ot)?Qe[xe]=er(Qe[xe],ot):De(ot)?Qe[xe]=er({},ot):q(ot)?Qe[xe]=ot.slice():Qe[xe]=ot}for(var dt=0,We=arguments.length;dt<We;dt++)bt(arguments[dt],pn);return Qe}function dr(Qe,pn,dt){return bt(pn,function(ot,xe){dt&&typeof ot=="function"?Qe[xe]=w(ot,dt):Qe[xe]=ot}),Qe}function Jr(Qe){return Qe.charCodeAt(0)===65279&&(Qe=Qe.slice(1)),Qe}lt.exports={isArray:q,isArrayBuffer:Ge,isBuffer:He,isFormData:Le,isArrayBufferView:Me,isString:ge,isNumber:Ce,isObject:Be,isPlainObject:De,isUndefined:te,isDate:M,isFile:Je,isBlob:zt,isFunction:cn,isStream:xt,isURLSearchParams:yr,isStandardBrowserEnv:ht,forEach:bt,merge:er,extend:dr,trim:Kn,stripBOM:Jr}},36905:function(lt,nn){var Fe,w,ne;(function(q,te){var He=te();w=[],Fe=He.Routing,ne=typeof Fe=="function"?Fe.apply(nn,w):Fe,ne!==void 0&&(lt.exports=ne)})(this,function(){"use strict";var q=Object.assign||function(ge){for(var Ce=1;Ce<arguments.length;Ce++){var Be=arguments[Ce];for(var De in Be)Object.prototype.hasOwnProperty.call(Be,De)&&(ge[De]=Be[De])}return ge},te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ge){return typeof ge}:function(ge){return ge&&typeof Symbol=="function"&&ge.constructor===Symbol&&ge!==Symbol.prototype?"symbol":typeof ge},He=function(){function ge(Ce,Be){for(var De=0;De<Be.length;De++){var M=Be[De];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(Ce,M.key,M)}}return function(Ce,Be,De){return Be&&ge(Ce.prototype,Be),De&&ge(Ce,De),Ce}}();function Ge(ge,Ce){if(!(ge instanceof Ce))throw new TypeError("Cannot call a class as a function")}var Le=function(){function ge(Ce,Be){Ge(this,ge),this.context_=Ce||{base_url:"",prefix:"",host:"",port:"",scheme:"",locale:""},this.setRoutes(Be||{})}return He(ge,[{key:"setRoutingData",value:function(Be){this.setBaseUrl(Be.base_url),this.setRoutes(Be.routes),"prefix"in Be&&this.setPrefix(Be.prefix),"port"in Be&&this.setPort(Be.port),"locale"in Be&&this.setLocale(Be.locale),this.setHost(Be.host),this.setScheme(Be.scheme)}},{key:"setRoutes",value:function(Be){this.routes_=Object.freeze(Be)}},{key:"getRoutes",value:function(){return this.routes_}},{key:"setBaseUrl",value:function(Be){this.context_.base_url=Be}},{key:"getBaseUrl",value:function(){return this.context_.base_url}},{key:"setPrefix",value:function(Be){this.context_.prefix=Be}},{key:"setScheme",value:function(Be){this.context_.scheme=Be}},{key:"getScheme",value:function(){return this.context_.scheme}},{key:"setHost",value:function(Be){this.context_.host=Be}},{key:"getHost",value:function(){return this.context_.host}},{key:"setPort",value:function(Be){this.context_.port=Be}},{key:"getPort",value:function(){return this.context_.port}},{key:"setLocale",value:function(Be){this.context_.locale=Be}},{key:"getLocale",value:function(){return this.context_.locale}},{key:"buildQueryParams",value:function(Be,De,M){var Je=this,zt=void 0,cn=new RegExp(/\[\]$/);if(De instanceof Array)De.forEach(function(xt,yr){cn.test(Be)?M(Be,xt):Je.buildQueryParams(Be+"["+((typeof xt>"u"?"undefined":te(xt))==="object"?yr:"")+"]",xt,M)});else if((typeof De>"u"?"undefined":te(De))==="object")for(zt in De)this.buildQueryParams(Be+"["+zt+"]",De[zt],M);else M(Be,De)}},{key:"getRoute",value:function(Be){var De=this.context_.prefix+Be,M=Be+"."+this.context_.locale,Je=this.context_.prefix+Be+"."+this.context_.locale,zt=[De,M,Je,Be];for(var cn in zt)if(zt[cn]in this.routes_)return this.routes_[zt[cn]];throw new Error('The route "'+Be+'" does not exist.')}},{key:"generate",value:function(Be,De){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Je=this.getRoute(Be),zt=De||{},cn=q({},zt),xt="",yr=!0,Kn="",ht=typeof this.getPort()>"u"||this.getPort()===null?"":this.getPort();if(Je.tokens.forEach(function(pn){if(pn[0]==="text"){xt=ge.encodePathComponent(pn[1])+xt,yr=!1;return}if(pn[0]==="variable"){var dt=Je.defaults&&pn[3]in Je.defaults;if(yr===!1||!dt||pn[3]in zt&&zt[pn[3]]!=Je.defaults[pn[3]]){var We=void 0;if(pn[3]in zt)We=zt[pn[3]],delete cn[pn[3]];else if(dt)We=Je.defaults[pn[3]];else{if(yr)return;throw new Error('The route "'+Be+'" requires the parameter "'+pn[3]+'".')}var ot=We===!0||We===!1||We==="";if(!ot||!yr){var xe=ge.encodePathComponent(We);xe==="null"&&We===null&&(xe=""),xt=pn[1]+xe+xt}yr=!1}else dt&&pn[3]in cn&&delete cn[pn[3]];return}throw new Error('The token type "'+pn[0]+'" is not supported.')}),xt===""&&(xt="/"),Je.hosttokens.forEach(function(pn){var dt=void 0;if(pn[0]==="text"){Kn=pn[1]+Kn;return}pn[0]==="variable"&&(pn[3]in zt?(dt=zt[pn[3]],delete cn[pn[3]]):Je.defaults&&pn[3]in Je.defaults&&(dt=Je.defaults[pn[3]]),Kn=pn[1]+dt+Kn)}),xt=this.context_.base_url+xt,Je.requirements&&"_scheme"in Je.requirements&&this.getScheme()!=Je.requirements._scheme){var bt=Kn||this.getHost();xt=Je.requirements._scheme+"://"+bt+(bt.indexOf(":"+ht)>-1||ht===""?"":":"+ht)+xt}else if(typeof Je.schemes<"u"&&typeof Je.schemes[0]<"u"&&this.getScheme()!==Je.schemes[0]){var er=Kn||this.getHost();xt=Je.schemes[0]+"://"+er+(er.indexOf(":"+ht)>-1||ht===""?"":":"+ht)+xt}else Kn&&this.getHost()!==Kn+(Kn.indexOf(":"+ht)>-1||ht===""?"":":"+ht)?xt=this.getScheme()+"://"+Kn+(Kn.indexOf(":"+ht)>-1||ht===""?"":":"+ht)+xt:M===!0&&(xt=this.getScheme()+"://"+this.getHost()+(this.getHost().indexOf(":"+ht)>-1||ht===""?"":":"+ht)+xt);if(Object.keys(cn).length>0){var dr=void 0,Jr=[],Qe=function(dt,We){We=typeof We=="function"?We():We,We=We===null?"":We,Jr.push(ge.encodeQueryComponent(dt)+"="+ge.encodeQueryComponent(We))};for(dr in cn)this.buildQueryParams(dr,cn[dr],Qe);xt=xt+"?"+Jr.join("&")}return xt}}],[{key:"getInstance",value:function(){return Me}},{key:"setData",value:function(Be){var De=ge.getInstance();De.setRoutingData(Be)}},{key:"customEncodeURIComponent",value:function(Be){return encodeURIComponent(Be).replace(/%2F/g,"/").replace(/%40/g,"@").replace(/%3A/g,":").replace(/%21/g,"!").replace(/%3B/g,";").replace(/%2C/g,",").replace(/%2A/g,"*").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/'/g,"%27")}},{key:"encodePathComponent",value:function(Be){return ge.customEncodeURIComponent(Be).replace(/%3D/g,"=").replace(/%2B/g,"+").replace(/%21/g,"!").replace(/%7C/g,"|")}},{key:"encodeQueryComponent",value:function(Be){return ge.customEncodeURIComponent(Be).replace(/%3F/g,"?")}}]),ge}();Le.Route,Le.Context;var Me=new Le;return{Router:Le,Routing:Me}})},25494:function(lt,nn,Fe){"use strict";var w=Fe(26734);const ne=["additionalAnnotation","annotation","arrows","color","comment","commentBefore","fen","flags","from","ids","lines","moveNumber","piece","previous","promotion","san","time","to"],q=()=>{let te;const He={lines:[]};return{state:He,updateLines:Le=>{He.lines=[...Le],(Le||[]).forEach((Me,ge)=>{te=w.x.isContinuation(Le,Me.id),He.lines[ge]=Me.map(Ce=>{const Be={};return ne.forEach(De=>{typeof Ce[De]<"u"&&(Be[De]=Ce[De])}),te&&Ce.ids.move===0&&(Be.commentBefore=Me.initComment),Be}),He.lines[ge].atMoveNode=Me.atMoveNode,He.lines[ge].id=Me.id,He.lines[ge].parentId=Me.parentId})}}};nn.Z=q()},26734:function(lt,nn,Fe){"use strict";Fe.d(nn,{x:function(){return w}});const w={getLine:(ne,q)=>ne[q]||null,getNode:(ne,q,te)=>{if(typeof q=="number"){if(typeof te<"u"){const Ge=w.getLine(ne,Math.max(0,q));return Ge?Ge[te]:null}return null}else if(!q)return null;const He=w.getLine(ne,Math.max(0,q.line));return He?He[q.move]:null},getSelectedLine:ne=>w.getLine(ne.jce._lines(),ne.tree.selected.line),getSelectedNode:ne=>w.getNode(ne.jce._lines(),ne.tree.selected),nodeIsSelected:(ne,q)=>!q&&!q.line&&!q.move?!1:ne.selected.line===q.line&&ne.selected.move===q.move,getLinesFromJce:ne=>w.formatLinesFromJce(ne.jce._lines()),getJceSelectedLine:ne=>ne._lines()[ne._history().id],formatLinesFromJce:ne=>w.consolidateComments(ne),consolidateComments:ne=>ne.map(q=>{const te=w.isContinuation(ne,q.id)?w.getNode(ne,q.id,1):w.getNode(ne,q.id,0);return te&&q.initComment&&(te.commentBefore=q.initComment),q}),isContinuation:(ne,q)=>{const te=w.getLine(ne,q);if(!te)return!1;if(typeof te.parentId<"u"&&typeof te[0]<"u"){const He=w.getNode(ne,te.parentId,te.atMoveNode);return!He||!He.move?!1:He.move===te[0].move}return!1},isMainLine:ne=>ne===0,getNextNodeIds:(ne,q)=>!ne||ne.move+q<0?null:{line:ne.line,move:ne.move+q},getNextContinuationLineId:(ne,q)=>{const te=w.getNode(ne,q);if(!te||!te.lines)return null;const He=te.lines.find(Ge=>w.isContinuation(ne,Ge));return He!==-1?He:null},getParentNode:(ne,q)=>{const te={line:ne[q.line].parentId,move:ne[q.line].atMoveNode};return w.findNode(ne,te)},getParentNodeIds:(ne,q)=>{const te=w.getLine(ne,q.line);return!te||typeof te.parentId>"u"?null:{line:te.parentId,move:te.atMoveNode}},deleteRemainingNodes:(ne,q)=>ne?(ne.length=q+1,ne):null,deleteNode:(ne,q)=>w.prune(ne,{line:q.line,move:q.move-1}),deleteLine:(ne,q)=>{const te=w.getLine(ne,q);if(typeof te.parentId<"u"){const Ge=w.getNode(ne,{line:te.parentId,move:te.atMoveNode});Ge.lines=Ge.lines.filter(Le=>Le!==q),Ge.lines.length===0&&delete Ge.lines}const He=ne.filter(Ge=>w.isMainLine(Ge.id)||Ge.id!==q);return w.rebuildIds(He)},rebuildIds:ne=>{const q=[];return ne.forEach((te,He)=>{te.id!==He&&(q[te.id]=He)}),ne.map(te=>(te.id=typeof q[te.id]<"u"?q[te.id]:te.id,typeof q[te.parentId]<"u"&&(te.parentId=q[te.parentId]),te.forEach(He=>{He.ids.line=typeof q[He.ids.line]<"u"?q[He.ids.line]:He.ids.line,He.lines&&He.lines.length>0&&(He.lines=He.lines.map(Ge=>typeof q[Ge]<"u"?q[Ge]:Ge).filter(Ge=>typeof ne[Ge]<"u"),He.lines.length===0&&delete He.lines)}),te))},prune:(ne,q)=>w.getNode(ne,{line:q.line,move:q.move+1})?(ne[q.line]=w.deleteRemainingNodes(ne[q.line],q.move),!w.isMainLine(q.line)&&w.isFirstVisibleNode(ne,q)&&ne.splice(ne.findIndex(te=>te.id===q.line),1),ne.sort((te,He)=>te.id-He.id).reduce((te,He)=>{const Ge=w.getNode(te,{line:He.parentId,move:He.atMoveNode});return(w.isMainLine(He.id)||Ge)&&te.push(He),te},[])):ne,isFirstNodeInTree:ne=>ne.line===0&&ne.move===-1,isFirstVisibleNode:(ne,q)=>w.isContinuation(ne,q.line)?q.move===1:q.move===0,isFirstNodeInLine:(ne,q)=>q&&ne&&ne[q.line]&&ne[q.line][0]&&ne[q.line][0].ids&&ne[q.line][0].ids.line===q.line&&ne[q.line][0].ids.move===q.move,isHead:(ne,q)=>q&&ne[q.line].length-1===q.move||!1,getHeadIds:(ne,q)=>({line:q,move:ne[q].length-1}),nodeMatchesMove:(ne,q,te)=>{const He=w.getNode(ne,q);return He?He.from===te.from&&He.to===te.to&&(He.promotion||null)===(te.promotion||null):!1},shouldMatchMove:(ne,q,te)=>ne&&q===1&&te===0,getNextMatchingNode:(ne,q={},te)=>{const He=w.getNode(ne,q),Ge=w.getNode(ne,q.line,q.move+1);return ne.reduce((Me,ge)=>Me.concat(ge),[]).filter(Me=>He&&Me.moveNumber===He.moveNumber+1||Ge&&Me.moveNumber===Ge.moveNumber).filter(Me=>!!(He&&Me.ids.line===He.ids.line||Ge&&Me.ids.line===Ge.ids.line||He&&He.lines&&He.lines.indexOf(Me.ids.line)!==-1&&w.isContinuation(ne,Me.ids.line)||Ge&&Ge.lines&&Ge.lines.indexOf(Me.ids.line)!==-1&&!w.isContinuation(ne,Me.ids.line))).filter(Me=>w.nodeMatchesMove(ne,Me.ids,te)).sort((Me,ge)=>Me.ids.line-ge.ids.line)[0]||null},clearNode:(ne,q)=>{const te=w.getNode(ne,q);return te?(delete te.comment,delete te.annotation,te):null},findNode:(ne,q={},te=void 0,He=!0)=>{if(!ne||typeof q.line>"u")return null;if(typeof te=="string")switch(q.move){case"begin":q.move=0;break;case"end":q.move=ne[0].length-1;break;default:break}else if(typeof q.move>"u")return ne[q.line];let Ge;return te&&Math.abs(te)!==0&&(q=new Array(Math.abs(te)).fill(te/Math.abs(te)).reduce((Le,Me)=>{if(Le===null)return null;const ge=w.isContinuation(ne,Le.line);let Ce=w.getNextNodeIds(Le,Me);if(w.getNode(ne,Ce)&&!(Me===-1&&ge&&Ce.move===0))return Ce;switch(Me){case 1:return He?Le:(Ge=w.getNextContinuationLineId(ne,Le),Ge!==null?{line:Ge,move:1}:null);case-1:return Ce=ge?w.getParentNodeIds(ne,Le):w.getNextNodeIds(w.getParentNodeIds(ne,Le),-1),w.getNode(ne,Ce)?Ce:Le;default:return null}},q)),w.getNode(ne,q)||null},clearNodeMarkings:(ne,q)=>{const te=w.getNode(ne,q);return te?(delete te.squares,delete te.arrows,delete te.effects,te):null},clearNodeAnalysis:(ne,q)=>{const te=w.getNode(ne,q);return te?(delete te.comment,delete te.annotation,delete te.additionalAnnotation,te):null},clearAllMarkings:ne=>ne?(ne.forEach(q=>{q.length>0&&q.forEach(te=>w.clearNodeMarkings(ne,{line:te.ids.line,move:te.ids.move}))}),ne):null,clearAnalysis:ne=>ne?(ne.forEach(q=>{q.length>0&&q.forEach(te=>w.clearNodeAnalysis(ne,{line:te.ids.line,move:te.ids.move}))}),ne):null}},34155:function(lt){var nn=lt.exports={},Fe,w;function ne(){throw new Error("setTimeout has not been defined")}function q(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Fe=setTimeout:Fe=ne}catch{Fe=ne}try{typeof clearTimeout=="function"?w=clearTimeout:w=q}catch{w=q}})();function te(Je){if(Fe===setTimeout)return setTimeout(Je,0);if((Fe===ne||!Fe)&&setTimeout)return Fe=setTimeout,setTimeout(Je,0);try{return Fe(Je,0)}catch{try{return Fe.call(null,Je,0)}catch{return Fe.call(this,Je,0)}}}function He(Je){if(w===clearTimeout)return clearTimeout(Je);if((w===q||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(Je);try{return w(Je)}catch{try{return w.call(null,Je)}catch{return w.call(this,Je)}}}var Ge=[],Le=!1,Me,ge=-1;function Ce(){!Le||!Me||(Le=!1,Me.length?Ge=Me.concat(Ge):ge=-1,Ge.length&&Be())}function Be(){if(!Le){var Je=te(Ce);Le=!0;for(var zt=Ge.length;zt;){for(Me=Ge,Ge=[];++ge<zt;)Me&&Me[ge].run();ge=-1,zt=Ge.length}Me=null,Le=!1,He(Je)}}nn.nextTick=function(Je){var zt=new Array(arguments.length-1);if(arguments.length>1)for(var cn=1;cn<arguments.length;cn++)zt[cn-1]=arguments[cn];Ge.push(new De(Je,zt)),Ge.length===1&&!Le&&te(Be)};function De(Je,zt){this.fun=Je,this.array=zt}De.prototype.run=function(){this.fun.apply(null,this.array)},nn.title="browser",nn.browser=!0,nn.env={},nn.argv=[],nn.version="",nn.versions={};function M(){}nn.on=M,nn.addListener=M,nn.once=M,nn.off=M,nn.removeListener=M,nn.removeAllListeners=M,nn.emit=M,nn.prependListener=M,nn.prependOnceListener=M,nn.listeners=function(Je){return[]},nn.binding=function(Je){throw new Error("process.binding is not supported")},nn.cwd=function(){return"/"},nn.chdir=function(Je){throw new Error("process.chdir is not supported")},nn.umask=function(){return 0}},89402:function(lt,nn,Fe){lt.exports=Fe(84474)(475)},84474:function(lt){"use strict";lt.exports=vueDLL}},Mh={};function sr(lt){var nn=Mh[lt];if(nn!==void 0)return nn.exports;var Fe=Mh[lt]={id:lt,loaded:!1,exports:{}};return Th[lt].call(Fe.exports,Fe,Fe.exports,sr),Fe.loaded=!0,Fe.exports}sr.m=Th,function(){sr.n=function(lt){var nn=lt&&lt.__esModule?function(){return lt.default}:function(){return lt};return sr.d(nn,{a:nn}),nn}}(),function(){sr.d=function(lt,nn){for(var Fe in nn)sr.o(nn,Fe)&&!sr.o(lt,Fe)&&Object.defineProperty(lt,Fe,{enumerable:!0,get:nn[Fe]})}}(),function(){sr.f={},sr.e=function(lt){return Promise.all(Object.keys(sr.f).reduce(function(nn,Fe){return sr.f[Fe](lt,nn),nn},[]))}}(),function(){sr.u=function(lt){if(lt===6048)return"web.chunk.client.fa4df721.js";if(lt===525)return"web.chunk.client.fc9590a1.js";if(lt===2804)return"web.chunk.client.48e23656.js";if(lt===2155)return"web.chunk.client.677f4abb.js";if(lt===8442)return"web.chunk.client.bd519834.js"}}(),function(){sr.miniCssF=function(lt){if(lt===7538)return"board-default.client.4cbbe818.css"}}(),function(){sr.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){sr.hmd=function(lt){return lt=Object.create(lt),lt.children||(lt.children=[]),Object.defineProperty(lt,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+lt.id)}}),lt}}(),function(){sr.o=function(lt,nn){return Object.prototype.hasOwnProperty.call(lt,nn)}}(),function(){var lt={},nn="client:";sr.l=function(Fe,w,ne,q){if(lt[Fe]){lt[Fe].push(w);return}var te,He;if(ne!==void 0)for(var Ge=document.getElementsByTagName("script"),Le=0;Le<Ge.length;Le++){var Me=Ge[Le];if(Me.getAttribute("src")==Fe||Me.getAttribute("data-webpack")==nn+ne){te=Me;break}}te||(He=!0,te=document.createElement("script"),te.charset="utf-8",te.timeout=120,sr.nc&&te.setAttribute("nonce",sr.nc),te.setAttribute("data-webpack",nn+ne),te.src=Fe),lt[Fe]=[w];var ge=function(Be,De){te.onerror=te.onload=null,clearTimeout(Ce);var M=lt[Fe];if(delete lt[Fe],te.parentNode&&te.parentNode.removeChild(te),M&&M.forEach(function(Je){return Je(De)}),Be)return Be(De)},Ce=setTimeout(ge.bind(null,void 0,{type:"timeout",target:te}),12e4);te.onerror=ge.bind(null,te.onerror),te.onload=ge.bind(null,te.onload),He&&document.head.appendChild(te)}}(),function(){sr.r=function(lt){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(lt,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(lt,"__esModule",{value:!0})}}(),function(){sr.p="/bundles/app/js/"}(),function(){if(typeof sr<"u"){var lt=sr.u,nn=sr.e,Fe=new Map,w=new Map;sr.u=function(ne){var q=lt(ne);return q+(Fe.has(ne)?"?"+Fe.get(ne):"")},sr.e=function(ne){var q=nn(ne);return q.catch(function(te){var He=w.has(ne)?w.get(ne):2;if(He<1){var Ge=lt(ne);throw te.message="Loading chunk "+ne+` failed after 2 retries.
(`+Ge+")",te.request=Ge,te}return new Promise(function(Le){setTimeout(function(){var Me=2-He+1,ge="&retry-attempt="+Me,Ce="cache-bust=true"+ge;Fe.set(ne,Ce),w.set(ne,He-1),Le(sr.e(ne))},0)})})}}}(),function(){var lt={7538:0};sr.f.j=function(w,ne){var q=sr.o(lt,w)?lt[w]:void 0;if(q!==0)if(q)ne.push(q[2]);else{var te=new Promise(function(Me,ge){q=lt[w]=[Me,ge]});ne.push(q[2]=te);var He=sr.p+sr.u(w),Ge=new Error,Le=function(Me){if(sr.o(lt,w)&&(q=lt[w],q!==0&&(lt[w]=void 0),q)){var ge=Me&&(Me.type==="load"?"missing":Me.type),Ce=Me&&Me.target&&Me.target.src;Ge.message="Loading chunk "+w+` failed.
(`+ge+": "+Ce+")",Ge.name="ChunkLoadError",Ge.type=ge,Ge.request=Ce,q[1](Ge)}};sr.l(He,Le,"chunk-"+w,w)}};var nn=function(w,ne){var q=ne[0],te=ne[1],He=ne[2],Ge,Le,Me=0;if(q.some(function(Ce){return lt[Ce]!==0})){for(Ge in te)sr.o(te,Ge)&&(sr.m[Ge]=te[Ge]);if(He)var ge=He(sr)}for(w&&w(ne);Me<q.length;Me++)Le=q[Me],sr.o(lt,Le)&&lt[Le]&&lt[Le][0](),lt[Le]=0},Fe=(typeof self<"u"?self:this).wpChessCom_1oIq=(typeof self<"u"?self:this).wpChessCom_1oIq||[];Fe.forEach(nn.bind(null,0)),Fe.push=nn.bind(null,Fe.push.bind(Fe))}();var o5={};(function(){"use strict";var lt=function(){var u=this,c=u._self._c;return c("div",{staticClass:"board v-board",attrs:{tabindex:"-1",id:u.boardId}},[u.initialized&&u.options.coordinates?c("coordinates",{attrs:{colors:u.coordColors,position:u.options.coordinates,"board-style":u.options.boardStyle,flipped:u.options.flipBoard,size:u.squareSize}}):u._e(),u._v(" "),c("div",{staticClass:"arrows-container"},u._l(u.arrows,function(p){return c("marked-arrow",{key:`${p.fromFileRank.file}${p.fromFileRank.rank}${p.toFileRank.file}${p.toFileRank.rank}`,attrs:{"additional-styles":p.additionalStyles,"square-size":u.squareSize,files:u.game.setup.files,ranks:u.game.setup.ranks,flipped:u.options.flipBoard,"from-file-rank":p.fromFileRank,"to-file-rank":p.toFileRank,color:p.color,opacity:p.opacity}})}),1),u._v(" "),u._l(u.effects,function(p){return c("marked-effect",{key:`${p.square.file}${p.square.rank}`,attrs:{"additional-styles":p.additionalStyles,files:u.game.setup.files,flipped:u.options.flipBoard,position:p.position,ranks:u.game.setup.ranks,square:p.square,"square-size":u.squareSize,template:p.template}})}),u._v(" "),u._l(u.customItems,function(p){return c("custom-item",{key:`${p.fileRank.file}${p.fileRank.rank}`,attrs:{"square-size":u.squareSize,files:u.game.setup.files,ranks:u.game.setup.ranks,flipped:u.options.flipBoard,"file-rank":p.fileRank}})})],2)},nn=[];const Fe={default:["#B58863","#F0D9B5",null,".png","#ffff33"],"8_bit":["#6a9b41","#f3f3f4","8_bit",".png","#ffff33"],bases:["#c26b38","#efcca1","bases",".jpg","#f5cc2a"],blue:["#4D6D92","#ECECD7","blue",".png","#00a5ff"],brown:["#B58863","#F0D9B5","brown",".png","#ffff33"],bubblegum:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],burled_wood:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],checkers:["#e3a6a9","#999999","checkers",".png","#fae18a"],dark_wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],dash:["#6b3a27","#bd9257","dash",".jpg","#eca722"],glass:["#282f3f","#667188","glass",".png","#5b91b3"],graffiti:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],green:["#779952","#edeed1","green",".png","#ffff33"],icy_sea:["#7a9db2","#c5d5dc","icy_sea",".jpg","#5ed7f1"],light:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],lolz:["#909898","#e0e9e9","lolz",".jpg","#a3becd"],marble:["#706b66","#c7bdaa","marble",".jpg","#f0db86"],metal:["#6e6e6e","#c9c9c9","metal",".jpg","#a3becd"],nature:["#8c976e","#c3d1a4","translucent",".png","#eef396"],neon:["#636363","#b9b9b9","neon",".png","#6d90a6"],newspaper:["#5a5956","#5a5956","newspaper",".jpg","#99976e"],orange:["#D08B18","#FCE4B2","orange",".png","#ffff33"],overlay:["#789ebd","#4878a0","overlay",".png","#0d9acf"],parchment:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],purple:["#8877B7","#EFEFEF","purple",".png","#7dacc9"],red:["#BA5546","#F0D8BF","red",".png","#f8f893"],sand:["#b8a590","#e5d3c4","sand",".jpg","#e2bc87"],sky:["#c2d7e2","#efefef","sky",".png","#65daf7"],stone:["#666463","#c8c3bd","stone",".jpg","#36525f"],tan:["#D08B18","#FCE4B2","tan",".png","#f7d84a"],tournament:["#316549","#ebece8","tournament",".jpg","#a4c25b"],translucent:["#667188","#282f3f","translucent",".png","#5b91b3"],walnut:["#835f42","#c0a684","walnut",".jpg","#d1a52d"],wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],grey:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],pink:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],natural:["#D08B18","#FCE4B2","tan",".png","#f0e464"],winboard:["#316549","#ebece8","tournament",".jpg","#a4c25b"],blackwhite:["#667188","#282f3f","translucent",".png","#5b91b3"],marbleblue:["#c2d7e2","#efefef","marbleblue",".jpg","#65daf7"],marblebrown:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],marblegreen:["#706b66","#c7bdaa","marblegreen",".jpg","#f0db86"],wooddark:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],woodlight:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],woodmid:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],woodolive:["#6e6e6e","#c9c9c9","woodolive",".jpg","#a3becd"]},w={modern2:{imgPath:"modern",imgFormat:".png"},lines:{imgPath:"alpha",imgFormat:".png"},luca:{imgPath:"luca",imgFormat:".png"},"3dwood":{imgPath:"3d_wood",imgFormat:".png"},"3dplastic":{imgPath:"3d_plastic",imgFormat:".png"},"3dchesskid":{imgPath:"3d_chesskid",imgFormat:".png"}};var ne=function(){var u=this,c=u._self._c;return u.position?c("div",{staticClass:"coordinates",class:[u.position,u.className]},[u._l(u.numbers,function(p,_){return c("div",{staticClass:"number",class:[_%2===0?"coords-light":"coords-dark"],style:{color:u.colorForNumber(_),fontSize:u.fontSize,transform:u.position==="inside"?`translate(0, ${_*100}%)`:`translate(-145%, ${_*100}%)`,width:u.position==="inside"?"":u.outsideNumbersFontWidth}},[u._v(u._s(p))])}),u._v(" "),u._l(u.letters,function(p,_){return c("div",{staticClass:"letter",class:[_%2===0?"coords-dark":"coords-light"],style:{color:u.colorForLetter(_),fontSize:u.fontSize,transform:u.position==="inside"?`translate(${_*100}%, 0)`:`translate(${_*100}%, 110%)`}},[u._v(`
    `+u._s(p)+`
  `)])})],2):u._e()},q=[];const te="//images.chesscomfiles.com",He="/bundles/web/images/webgl_data",Ge={paths:{boards:`${te}/chess-themes/boards`,pieces:`${te}/chess-themes/pieces`,sounds:`${te}/chess-themes/sounds`,variants:"//www.chess.com/bundles/web/images/variants",webglData:He},defaultBoardOptions:{boardStyle:"green",pieceStyle:"neo",highlightColor:"#FFFF33",highlightOpacity:.5,arrowColor:"rgb(255, 168, 0)",flipped:!1,files:8,ranks:8}};var Le={props:{boardStyle:{type:String,default:Ge.defaultBoardOptions.boardStyle},colors:{type:Object,required:!0},flipped:{type:Boolean,default:!1},position:{type:String,default:null},size:{type:Number,required:!0}},methods:{colorForLetter(a){return a%2===0?this.colors.white:this.colors.black},colorForNumber(a){return a%2===0?this.colors.black:this.colors.white}},computed:{className(){return this.position==="inside"?`inside-coords chess-color-scheme-${this.boardStyle}`:""},fontSize(){return this.position==="outside"?`${Math.min(this.size/4.1,20)}px`:`${this.size/4.5}px`},letters(){const a=["a","b","c","d","e","f","g","h"];return this.flipped?a.reverse():a},numbers(){const a=["1","2","3","4","5","6","7","8"];return this.flipped?a:a.reverse()},outsideNumbersFontWidth(){return`${Math.min(this.size/6.15,20)}px`}}},Me=Le,ge={};function Ce(a,u,c,p,_,A,V,ue){var re=typeof a=="function"?a.options:a;u&&(re.render=u,re.staticRenderFns=c,re._compiled=!0),p&&(re.functional=!0),A&&(re._scopeId="data-v-"+A);var wt;if(V?(wt=function(qn){qn=qn||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!qn&&typeof __VUE_SSR_CONTEXT__<"u"&&(qn=__VUE_SSR_CONTEXT__),_&&_.call(this,qn),qn&&qn._registeredComponents&&qn._registeredComponents.add(V)},re._ssrRegister=wt):_&&(wt=ue?function(){_.call(this,(re.functional?this.parent:this).$root.$options.shadowRoot)}:_),wt)if(re.functional){re._injectStyles=wt;var On=re.render;re.render=function(wn,Bt){return wt.call(Bt),On(wn,Bt)}}else{var vn=re.beforeCreate;re.beforeCreate=vn?[].concat(vn,wt):[wt]}return{exports:a,options:re}}var Be=Ce(Me,ne,q,!1,null,null,null),De=Be.exports,M=function(){var u=this,c=u._self._c;return c("svg",{staticClass:"arrow-container",style:u.arrowStyles,attrs:{version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",width:`${u.transform.width}px`,height:`${u.transform.height}px`,viewBox:`0 0 ${u.transform.viewBox.width} ${u.transform.viewBox.height}`}},[c("polygon",{staticClass:"arrow",style:{fill:u.color},attrs:{points:u.arrowPoints,transform:`translate(0, ${u.transform.baseOffset})`}})])},Je=[];const cn=22/2,yr=52/2,Kn=37,ht=13,bt=13;var er={props:{additionalStyles:{type:Object,default:()=>({})},color:{type:String,default:Ge.defaultBoardOptions.arrowColor},files:{type:Number,default:Ge.defaultBoardOptions.files},flipped:{type:Boolean,default:!1},fromFileRank:{type:Object,required:!0},ranks:{type:Number,default:Ge.defaultBoardOptions.ranks},squareSize:{type:Number,required:!0},toFileRank:{type:Object,required:!0}},computed:{arrowStyles(){const{origin:a,position:u,rotation:c,scale:p}=this.transform;return{...{transform:`translate(${u.x}px, ${u.y}px)
                    rotate(${c}deg)
                    scale(${p.x}, ${p.y})`,transformOrigin:`${a.x}% ${a.y}%`},...this.additionalStyles}},isStraight(){const a=this.fromFileRank,u=this.toFileRank;return!(a.file!==u.file&&a.rank!==u.rank&&Math.abs(a.file-u.file)!==Math.abs(a.rank-u.rank))},arrowPoints(){return this.isStraight?`
            ${50-cn} ${100-bt},
            ${50+cn} ${100-bt},
            ${50+cn} ${100+ht+this.transform.length},
            ${50+yr} ${100+ht+this.transform.length},
            50 ${100+ht+Kn+this.transform.length},
            ${50-yr} ${100+ht+this.transform.length},
            ${50-cn} ${100+ht+this.transform.length}
          `:`
          ${100-bt} ${50-cn},
          ${250+cn} ${50-cn},
          ${250+cn} ${100+ht},
          ${250+yr} ${100+ht},
          250 ${100+ht+Kn},
          ${250-yr} ${100+ht},
          ${250-cn} ${100+ht},
          ${250-cn} ${50+cn},
          ${100-bt} ${50+cn}
        `},transform(){const a=this.files,u=this.ranks,c=this.squareSize;let p=this.fromFileRank,_=this.toFileRank;this.flipped&&(p={file:a+1-p.file,rank:u+1-p.rank},_={file:a+1-_.file,rank:u+1-_.rank});const A={length:0,baseOffset:0,width:this.isStraight?c:c*3,height:c*2,viewBox:{width:this.isStraight?100:300,height:200},origin:{x:0,y:0},position:{x:0,y:0},rotation:0,scale:{x:1,y:1}};if(this.isStraight){const V=Math.abs(p.file-_.file),ue=Math.abs(p.rank-_.rank);if(p.file===_.file){const re=ue+1;A.length=100*(ue-1),A.height=c*re,A.viewBox.height=100*re,A.origin.x=50,A.position.x=(p.file-1)*c,p.rank<_.rank?(A.rotation=180,A.position.y=(u+1-p.rank)*c):A.position.y=(u-p.rank)*c}if(p.rank===_.rank){const re=V+1;A.length=100*(V-1),A.height=c*re,A.viewBox.height=100*re,A.position.x=(p.file-1)*c,A.position.y=(u+1-p.rank)*c,p.file<_.file?A.rotation=-90:(A.rotation=90,A.origin.x=100)}if(Math.abs(p.file-_.file)===Math.abs(p.rank-_.rank)){const re=ue+1,wt=Math.sqrt(2*c**2),On=141.42;A.length=On*ue-100,A.baseOffset=20.71,A.height=wt*re,A.viewBox.height=On*re,A.origin={x:50,y:50},p.file<_.file?(A.position.x=(p.file-1+ue/2)*c,p.rank<_.rank?(A.rotation=-135,A.position.y=(u-_.rank+re/2)*c-A.height/2):(A.rotation=-45,A.position.y=(u-p.rank+re/2)*c-A.height/2)):(A.position.x=(_.file-1+ue/2)*c,p.rank<_.rank?(A.rotation=135,A.position.y=(u-_.rank+re/2)*c-A.height/2):(A.rotation=45,A.position.y=(u-p.rank+re/2)*c-A.height/2))}}else A.origin.y=50,Math.abs(p.rank-_.rank)===2?(p.rank<_.rank?(A.rotation=-90,A.position.y=(u-p.rank)*c):(A.rotation=90,A.position.y=(u-1-p.rank)*c),p.file<_.file?(A.position.x=p.file*c,p.rank>_.rank&&(A.scale.y=-1)):(A.position.x=(p.file-1)*c,p.rank<_.rank&&(A.scale.y=-1))):p.file<_.file?(A.position.x=(p.file-1)*c,p.rank<_.rank?(A.position.y=(u-_.rank)*c,A.scale.y=-1):A.position.y=(u-p.rank)*c):(A.position.x=p.file*c,A.scale.x=-1,p.rank<_.rank?(A.position.y=(u-1-p.rank)*c,A.scale.y=-1):A.position.y=(u-p.rank)*c);return A}}},dr=er,Jr={},Qe=Ce(dr,M,Je,!1,null,null,null),pn=Qe.exports,dt=function(){var u=this,c=u._self._c;return c("div",{class:u.$style.effect,style:u.effectStyles,domProps:{innerHTML:u._s(u.template)}})},We=[];const ot={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};var xe={props:{additionalStyles:{type:Object,default:()=>({})},files:{type:Number,default:Ge.defaultBoardOptions.files},flipped:{type:Boolean,default:!1},square:{type:Object,required:!0},ranks:{type:Number,default:Ge.defaultBoardOptions.ranks},position:{type:Object,default:()=>({y:ot.TOP,x:ot.LEFT})},squareSize:{type:Number,required:!0},template:{type:String,required:!0}},computed:{effectStyles(){return{...{transform:`translate3d(${this.transform.x}px, ${this.transform.y}px, 0)`,width:`${this.size}px`,height:`${this.size}px`},...this.additionalStyles}},size(){return this.squareSize*.4},shift(){const{x:a,y:u}=this.position;return{x:a===ot.LEFT?-(this.size/2.5):this.squareSize-this.size/1.5,y:u===ot.TOP?-(this.size/2.5):this.squareSize-this.size/1.5}},transform(){const{files:a,ranks:u,squareSize:c}=this;let p=this.square;return this.flipped&&(p={file:a+1-p.file,rank:u+1-p.rank}),{x:(p.file-1)*c+this.shift.x,y:(u-p.rank)*c+this.shift.y}}}},gn=xe,Jt={effect:"marked-effect-effect"};function jn(a){this.$style=Jt.locals||Jt}var nr=Ce(gn,dt,We,!1,jn,null,null),Tr=nr.exports,mn=function(){var u=this,c=u._self._c;return c("transition",{attrs:{name:"transition"}},[c("svg",{staticClass:"item-container",style:{left:`${u.transform.position.x}px`,top:`${u.transform.position.y}px`},attrs:{version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",width:`${u.transform.width}px`,height:`${u.transform.height}px`,viewBox:"0 0 40 40"}},[c("path",{style:{fill:u.color},attrs:{d:"M23.12,17.84H16.4a1.11,1.11,0,0,1-1.06-1.43L18.7,5.21a1.11,1.11,0,0,1,2.13,0l3.36,11.2A1.11,1.11,0,0,1,23.12,17.84Z"}}),u._v(" "),c("path",{style:{fill:u.color},attrs:{d:"M27.21,34.11,4.35,16.88a1.11,1.11,0,0,1,.67-2l17.89,0a1.11,1.11,0,0,1,1.06.8l5,17.19A1.11,1.11,0,0,1,27.21,34.11Z"}}),u._v(" "),c("path",{style:{fill:u.color},attrs:{d:"M35.17,16.88,12.31,34.11a1.11,1.11,0,0,1-1.74-1.2l5-17.19a1.11,1.11,0,0,1,1.06-.8l17.89,0A1.11,1.11,0,0,1,35.17,16.88Z"}})])])},Pn=[],Pt={props:{color:{type:String,default:"#ffa704"},files:{type:Number,default:Ge.defaultBoardOptions.files},flipped:{type:Boolean,default:!1},fileRank:{type:Object,required:!0},ranks:{type:Number,default:Ge.defaultBoardOptions.ranks},squareSize:{type:Number,required:!0}},computed:{transform(){let a=this.fileRank;return this.flipped&&(a={file:this.files+1-this.fileRank.file,rank:this.ranks+1-this.fileRank.rank}),{width:this.squareSize,height:this.squareSize,position:{x:(a.file-1)*this.squareSize,y:(this.ranks-a.rank)*this.squareSize}}}}},ft=Pt,Dt={},Dn=Ce(ft,mn,Pn,!1,null,null,null),Bn=Dn.exports;const ie=(a,...u)=>JSON.parse(a,...u),E=(a,...u)=>JSON.stringify(a,...u),Y={getId:a=>{const u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return Array(a||20).fill(void 0).reduce(c=>c+u.charAt(Math.floor(Math.random()*u.length)),"")},getInitialFen:()=>"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",formatJSTimestampForPgn:a=>{const u=new Date(a),c=`0${u.getUTCDate()}`.slice(-2),p=`0${u.getUTCMonth()+1}`.slice(-2);return`${u.getFullYear()}-${p}-${c}`},getSanFromFileRank:a=>!a||!a.file||!a.rank?null:String.fromCharCode(96+a.file)+a.rank.toString(),getFileRankFromSan:a=>a?{file:a.toLowerCase().charCodeAt(0)-96,rank:Number(a.charAt(1))}:null,getPieceAt:(a,u)=>a.setup.pieces.find(c=>c.file===u.file&&c.rank===u.rank),cloneGame:a=>({id:a.id,variant:a.variant,jce:a.jce,tree:Y.cloneTree(a.tree),setup:ie(E(a.setup)),markings:{...a.markings},settings:{...a.settings},history:[...a.history],premoves:a.premoves.map(u=>ie(E(u)))}),cloneTree:a=>({...a,initialMarkings:JSON.parse(JSON.stringify(a.initialMarkings)),selected:{...a.selected},selectedNode:a.selectedNode?{...a.selectedNode,ids:{...a.selectedNode.ids},hash:[...a.selectedNode.hash],lines:a.selectedNode.lines&&[...a.selectedNode.lines],arrows:a.selectedNode.arrows&&[...a.selectedNode.arrows]}:null}),getFirstFen:a=>a.tree.lines[0].length?a.tree.lines[0][0].beforeFen:a.setup.fen},R={ADD_BLINKING_SQUARE:"ADD_BLINKING_SQUARE",CLEAR_ARROW:"CLEAR_ARROW",CLEAR_BLINKING_SQUARE:"CLEAR_BLINKING_SQUARE",CLEAR_EFFECT:"CLEAR_EFFECT",CLEAR_MARKED_SQUARE:"CLEAR_MARKED_SQUARE",INIT:"INIT",LOAD:"LOAD",MAKE_MOVE:"MAKE_MOVE",ILLEGAL_MOVE:"ILLEGAL_MOVE",JUMP_TO_POSITION:"JUMP_TO_POSITION",TREE_CHANGE:"TREE_CHANGE",TREE_AMENDED:"TREE_AMENDED",SETTINGS_CHANGE:"SETTINGS_CHANGE",PGN_HEADERS_UPDATED:"PGN_HEADERS_UPDATED",CANCEL_PREMOVES:"CANCEL_PREMOVES",PREMOVE:"PREMOVE",GUESS_THE_MOVE:"GUESS_THE_MOVE",CANCEL_GUESS_THE_MOVE:"CANCEL_GUESS_THE_MOVE",UPDATE_NODE:"UPDATE_NODE"},de={MAX_HISTORY_LIMIT:200,getInitialHistory(){return[]},add(a,u,c={}){if(a.length>de.MAX_HISTORY_LIMIT-1){const p=a.findIndex(_=>_!==null);a[p]=null}a.push({type:u,payload:c})},getLastItem(a){return a[a.length-1]}},Ae="ontouchstart"in window||window.navigator.maxTouchPoints>0||/firefox/i.test(window.navigator.userAgent)&&"TouchEvent"in window,me=window.navigator.pointerEnabled||window.navigator.msPointerEnabled,on=document.documentElement,L="mouseup",pe="mousedown",ye="mousemove",ke="dragstart",Q="contextmenu",Ke="touchend",yt="touchstart",In="touchmove",Tn="touchcancel",Fr=1,vt=1,_i=3,_r=2,Ei=1;class Jo{constructor(u){this.chessboard=u}setFixed(u){this.inFixedElement=!!u}destroy(){this.destroyTouch&&(this.destroyTouch(),delete this.destroyTouch),this.destroyMouse&&(this.destroyMouse(),delete this.destroyMouse)}observe(u){this.destroy(),Ae&&this.observeTouch(u),this.observeMouse(u)}observeTouch(u){const c=this.chessboard;let p,_,A,V,ue,re=!1;const wt=wn=>{if(u.keepDefault||(wn.returnValue=!1,typeof wn.preventDefault=="function"&&wn.preventDefault()),wn.cancelBubble=!0,typeof wn.stopPropagation=="function"&&wn.stopPropagation(),wn.touches&&wn.touches[0]?(V=wn.touches[0].pageX,ue=wn.touches[0].pageY):wn.changedTouches&&wn.changedTouches[0]&&(V=wn.changedTouches[0].pageX,ue=wn.changedTouches[0].pageY),re)typeof u.dragmove=="function"&&(wn.pointer={x:V,y:ue,type:"touch",target:A},u.dragmove.call(c,wn));else{const Bt=Math.abs(V-p)>Ei,Rr=Math.abs(ue-_)>Ei;re=Bt||Rr,re&&typeof u.dragstart=="function"&&(wn.pointer={x:p,y:_,type:"touch",target:A},u.dragstart.call(c,wn))}},On=wn=>{u.keepDefault||(wn.returnValue=!1,typeof wn.preventDefault=="function"&&wn.preventDefault()),re?typeof u.dragstop=="function"&&(wn.pointer={x:V,y:ue,type:"touch",target:A},u.dragstop.call(c,wn)):typeof u.click=="function"&&(wn.pointer={x:V,y:ue,type:"touch",target:A},u.click.call(c,wn)),p=void 0,_=void 0,A=void 0,V=void 0,ue=void 0,re=!1,on.removeEventListener(In,wt),on.removeEventListener(Ke,On)},vn=wn=>{u.keepDefault||(wn.returnValue=!1,typeof wn.preventDefault=="function"&&wn.preventDefault()),A=wn.target,wn.touches&&wn.touches[0]?(V=wn.touches[0].pageX,p=wn.touches[0].pageX,ue=wn.touches[0].pageY,_=wn.touches[0].pageY):wn.changedTouches&&wn.changedTouches[0]&&(V=wn.changedTouches[0].pageX,p=wn.changedTouches[0].pageX,ue=wn.changedTouches[0].pageY,_=wn.changedTouches[0].pageY),typeof u.pointerdown=="function"&&(wn.pointer={x:p,y:_,type:"touch",target:A},u.pointerdown.call(c,wn)),on.addEventListener(In,wt,!1),on.addEventListener(Ke,On,!1)},qn=()=>{p=void 0,_=void 0,A=void 0,V=void 0,ue=void 0,re=!1,on.removeEventListener(In,wt),on.removeEventListener(Ke,On)};c.addEventListener(yt,vn,!1),c.addEventListener(Tn,qn,!1),this.destroyTouch=()=>{c.removeEventListener(yt,vn),c.removeEventListener(yt,qn)}}observeMouse(u){const c=this.chessboard;me&&(c.style.touchAction="none",c.style.msTouchAction="none");let p,_,A,V=!1,ue=!1,re=!1,wt=!1;const On=this.inFixedElement,vn=gt=>{if(gt.buttons){if(re&&gt.buttons===vt||ue&&gt.buttons===_r)return!0}else if(gt.button){if(re&&gt.button===vt||ue&&gt.button===_r)return!0}else if(gt.which&&(re&&gt.which===Fr||ue&&gt.which===_i))return!0;return!1},qn=gt=>{u.keepDefault||(gt.returnValue=!1,typeof gt.preventDefault=="function"&&gt.preventDefault()),gt.cancelBubble=!0,typeof gt.stopPropagation=="function"&&gt.stopPropagation()},wn=gt=>{u.keepDefault||(gt.returnValue=!1,typeof gt.preventDefault=="function"&&gt.preventDefault()),gt.cancelBubble=!0,typeof gt.stopPropagation=="function"&&gt.stopPropagation(),typeof u.contextmenu=="function"&&u.contextmenu.call(c,gt)},Bt=gt=>{if(u.keepDefault||(gt.returnValue=!1,typeof gt.preventDefault=="function"&&gt.preventDefault()),wt)return;let Or,Xr;if(On?(Or=gt.clientX,Xr=gt.clientY):(Or=gt.pageX,Xr=gt.pageY),A.parentNode||(A=gt.target||gt.srcElement),vn(gt))V&&(typeof u.dragcancel=="function"&&(gt.pointer={x:Or,y:Xr,type:"mouse",target:A},gt.isRightClick=re,u.dragcancel.call(c,gt)),V=!1);else if(V)typeof u.dragmove=="function"&&(gt.pointer={x:Or,y:Xr,type:"mouse",target:A},gt.isRightClick=re,u.dragmove.call(c,gt));else if(ue||re){const ca=Math.abs(Or-p)>Ei,as=Math.abs(Xr-_)>Ei;V=ca||as,V&&typeof u.dragstart=="function"&&(gt.pointer={x:p,y:_,type:"mouse",target:A},gt.isRightClick=re,u.dragstart.call(c,gt)===!1&&(wt=!0))}},Rr=gt=>{u.keepDefault||(gt.returnValue=!1,typeof gt.preventDefault=="function"&&gt.preventDefault());let Or,Xr;On?(Or=gt.clientX,Xr=gt.clientY):(Or=gt.pageX,Xr=gt.pageY),A.parentNode||(A=gt.target||gt.srcElement),vn(gt)?V&&(typeof u.dragcancel=="function"&&(gt.pointer={x:Or,y:Xr,type:"mouse",target:A},gt.isRightClick=re,u.dragcancel.call(c,gt)),V=!1):V?wt||typeof u.dragstop=="function"&&(gt.pointer={x:Or,y:Xr,type:"mouse",target:A},gt.isRightClick=re,u.dragstop.call(c,gt)):ue?typeof u.click=="function"&&(gt.pointer={x:Or,y:Xr,type:"mouse",target:A},gt.isRightClick=re,u.click.call(c,gt)):re&&typeof u.rightclick=="function"&&(gt.pointer={x:Or,y:Xr,type:"mouse",target:A},gt.isRightClick=re,u.rightclick.call(c,gt)),typeof u.pointerup=="function"&&(gt.pointer={x:p,y:_,type:"mouse",target:A},gt.isRightClick=re,u.pointerup.call(c,gt)),p=void 0,_=void 0,A=void 0,V=!1,ue=!1,re=!1,wt=!1,on.removeEventListener(ye,Bt),on.removeEventListener(L,Rr)},Vi=gt=>{u.keepDefault||(gt.returnValue=!1,typeof gt.preventDefault=="function"&&gt.preventDefault()),gt.which?(ue=gt.which===Fr,re=gt.which===_i):gt.button?(ue=gt.button===vt,re=gt.button===_r):gt.buttons&&(ue=gt.buttons===vt,re=gt.buttons===_r),(ue||re)&&(V&&(typeof u.dragcancel=="function"&&(gt.pointer={x:p,y:_,type:"mouse",target:A},gt.isRightClick=re,u.dragcancel.call(c,gt)),V=!1),A=gt.target||gt.srcElement,On?(p=gt.clientX,_=gt.clientY):(p=gt.pageX,_=gt.pageY),typeof u.pointerdown=="function"&&(gt.pointer={x:p,y:_,type:"mouse",target:A},gt.isRightClick=re,u.pointerdown.call(c,gt)),on.addEventListener(ye,Bt,!1),on.addEventListener(L,Rr,!1))};c.addEventListener(pe,Vi,!1),c.addEventListener(ke,qn,!1),c.addEventListener(Q,wn,!1),this.destroyMouse=()=>{c.removeEventListener(pe,Vi),c.removeEventListener(ke,qn),c.removeEventListener(Q,wn)}}}function Ur(a,u,c,p){const _=`$unbind${a}`;u[_]&&u[_](),Object.keys(c).forEach(A=>{u.addEventListener(A,c[A],p)}),u[_]=()=>{Object.keys(c).forEach(A=>{u.removeEventListener(A,c[A]),delete c[A]}),delete u[_]}}const Gt=window.AudioContext||window.webkitAudioContext;let Ut=!!Gt;function Dr(){try{return new Gt}catch{return null}}function rr(){return Ut}function wi(a){if(Gt){if(window.chessComAudioContext||(window.chessComAudioContext=Dr()),!window.chessComAudioContext||!window.chessComAudioContext.resume){Ut=!1,a();return}window.chessComAudioContext.resume().then(()=>{Ut=!1,a()})}}const pr=3,Vr={SOUND_SUSPENDED:"sound-suspended",SOUND_ENABLED:"sound-enabled"},Mo=["webm","ogg","mp3","wav"],go="default",ga="//images.chesscomfiles.com/chess-themes/sounds",Bo=["move-check","premove","capture","castle","game-end","game-start","promote","move-opponent","move-self"],ea=Bo.concat(["click","correct","drawoffer","illegal","incorrect","notify","tenseconds"]);function Fo(a,u,c=go){return`${ga}/_${u.toUpperCase()}_/${c}/${a}.${u}`}function _o(a,u){return Bo.includes(a)?Mo.map(c=>Fo(a,c,u)):ea.includes(a)?Mo.map(c=>Fo(a,c)):[`/bundles/web/sounds/${a}.mp3`]}var ta=Object.defineProperty,vs=(a,u,c)=>u in a?ta(a,u,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[u]=c,xo=(a,u,c)=>(vs(a,typeof u!="symbol"?u+"":u,c),c);class Va{constructor(u,c){xo(this,"code"),xo(this,"theme"),xo(this,"tags"),this.code=u,this.theme=c,this.tags=[]}load(){this.unload(),this.addTag()}addTag(){const u=document.createElement("audio");u.setAttribute("preload","auto"),_o(this.code,this.theme).forEach(c=>{const p=c.split(".").pop(),_=p==="mp3"?"audio/mpeg":`audio/${p}`,A=document.createElement("source");A.setAttribute("src",c),A.setAttribute("type",_),u.appendChild(A)}),document.body.appendChild(u),u.pause&&u.pause(),this.tags.push(u)}unload(){for(;this.tags.length;){const u=this.tags.shift();u?.parentNode&&u.parentNode.removeChild(u)}}play(){const u=this.tags.find(p=>p.paused||p.ended);if(!u){if(this.tags.length>=5)return;this.addTag(),this.play();return}const c=u.play();c&&c.catch(()=>{})}}function za(a){window.postMessage(a,window.location.origin)}let Uo=0,Ho=!1;function Pi(){rr()&&wi(()=>{Uo=0,Ho=!1,za({key:Vr.SOUND_ENABLED}),window.$unbindSound&&window.$unbindSound()})}function Kt(a){const u=c=>{c&&c.data&&c.data.key===Vr.SOUND_ENABLED&&(a(),window.removeEventListener("message",u))};window.addEventListener("message",u)}function Mn(){window.$unbindSound||Ur("Sound",window,{mousedown:Pi,keydown:Pi,touchstart:Pi,touchend:Pi})}function at(a,u){const c=new Va(a,u);return rr()?(Mn(),Kt(()=>c.load())):c.load(),c}function _e(a){a.unload()}function At(a){rr()?!Ho&&Uo>pr?(Uo=0,Ho=!0,za({key:Vr.SOUND_SUSPENDED})):Ho||(Uo++,Pi(),Kt(()=>a.play())):a.play()}var Yt=Object.defineProperty,$t=(a,u,c)=>u in a?Yt(a,u,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[u]=c,kt=(a,u,c)=>($t(a,typeof u!="symbol"?u+"":u,c),c);const Tt=["game-start","game-end","capture","castle","premove","move-self","move-check","move-opponent","promote","notify","tenseconds","illegal"];class fn{constructor(u,c){kt(this,"sounds"),this.sounds={},this.load(u,c)}load(u,c){let p=c;c||(p=Tt),p.forEach(_=>{this.sounds[_]=at(_,u)})}play(u){At(this.sounds[u])}removeAll(){Object.values(this.sounds).forEach(_e),this.sounds={}}}var $=sr(25494);const W={HISTORY_CHANGE:"HISTORY_CHANGE"},z={ADD_LEGAL_MOVES:"ADD_LEGAL_MOVES",ADD_PIECES:"ADD_PIECES",ADD_SQUARES:"ADD_SQUARES",BLINK_SQUARE:"BLINK_SQUARE",CLOSE_PROMOTION_MENU:"CLOSE_PROMOTION_MENU",DRAG_PIECE:"DRAG_PIECE",DROP_PIECE:"DROP_PIECE",DISABLE_FAKE_CURSOR:"DISABLE_FAKE_CURSOR",ENABLE_FAKE_CURSOR:"ENABLE_FAKE_CURSOR",FADE_PIECES:"FADE_PIECES",FLIP_BOARD:"FLIP_BOARD",HIDE_HOVER_SQUARE:"HIDE_HOVER_SQUARE",MOVE_PIECES:"MOVE_PIECES",OPEN_PROMOTION_MENU:"OPEN_PROMOTION_MENU",PICK_UP_PIECE:"PICK_UP_PIECE",PLAY_SOUND:"PLAY_SOUND",REMOVE_LEGAL_MOVES:"REMOVE_LEGAL_MOVES",REMOVE_PIECES:"REMOVE_PIECES",REMOVE_SQUARES:"REMOVE_SQUARES",SET_ARROWS:"SET_ARROWS",SET_CUSTOM_ITEMS:"SET_CUSTOM_ITEMS",SET_EFFECTS:"SET_EFFECTS",SET_SQUARES:"SET_SQUARES",SET_PIECE:"SET_PIECE",SET_PIECES:"SET_PIECES",SHOW_HOVER_SQUARE:"SHOW_HOVER_SQUARE",UPDATE_BOARD_CLASSES:"UPDATE_BOARD_CLASSES",UPDATE_BOARD_IMAGE:"UPDATE_BOARD_IMAGE",UPDATE_BOARD_SIZE:"UPDATE_BOARD_SIZE",UPDATE_PIECE_IMAGES:"UPDATE_PIECE_IMAGES",UPDATE_PIECE_SIZES:"UPDATE_PIECE_SIZES",UPDATE_PROMOTION_MENU_SIZE:"UPDATE_PROMOTION_MENU_SIZE"},k={ANOTHER_CHESSBOARD_ONBLUR:"DIAGRAM_VIEWER_BLUR",ANOTHER_CHESSBOARD_ONFOCUS:"DIAGRAM_VIEWER_FOCUS",ARROW_CLEARED:"ARROW_CLEARED",ARROW_MARKED:"ARROW_MARKED",BUSY_FLAG:"BUSY_FLAG",BOARD_DIMENSIONS_SET:"BOARD_DIMENSIONS_SET",CANCEL_GTM:"CANCEL_GTM",CANCEL_PREMOVES:"CANCEL_PREMOVES",CHANGED_POSITION:"CHANGED_POSITION",CLICKED:"CLICKED",EFFECT_MARKED:"EFFECT_MARKED",EFFECT_CLEARED:"EFFECT_CLEARED",KEY_PRESS:"KEY_PRESS",LEGAL_MOVES_UPDATED:"LEGAL_MOVES_UPDATED",LOADED:"LOADED",MARKINGS_CLEARED:"MARKINGS_CLEARED",MOVE_BACKWARD:"MOVE_BACKWARD",MOVE_FORWARD:"MOVE_FORWARD",MOVE_MADE:"MOVE_MADE",MOVE_SQUARES_SET:"MOVE_SQUARES_SET",MOVE_TO_END:"MOVE_TO_END",MOVE_TO_START:"MOVE_TO_START",OPTIONS_CHANGED:"OPTIONS_CHANGED",PIECE_DROPPED:"PIECE_DROPPED",PIECE_PICKED_UP:"PIECE_PICKED_UP",PIECE_SELECTED:"PIECE_SELECTED",PIECE_UNSELECTED:"PIECE_UNSELECTED",POSITION_CHANGED:"POSITION_CHANGED",PROMOTION_ATTEMPTED:"PROMOTION_ATTEMPTED",PROMOTION_PIECE_SET:"PROMOTION_PIECE_SET",PROMOTION_PIECE_UNSET:"PROMOTION_PIECE_UNSET",SOUND_THEME_UPDATED:"SOUND_THEME_UPDATED",SQUARE_CLEARED:"SQUARE_CLEARED",SQUARE_MARKED:"SQUARE_MARKED",SQUARE_UNSELECTED:"SQUARE_UNSELECTED"},ve={MARKED:"marked",MOVE:"move",SELECTION:"selection"},U={CAPTURE:"capture",CASTLE:"castle",CHECK:"move-check",MOVE_OPPONENT:"move-opponent",MOVE_SELF:"move-self",PREMOVE:"premove",PROMOTION:"promote",ILLEGAL:"illegal"},Pe={CAPTURE:"CAPTURE",CASTLE:"CASTLE",CHECK:"CHECK",CHECKMATE:"CHECKMATE",NORMAL:"NORMAL",PREMOVE:"PREMOVE",PROMOTION:"PROMOTION"},Ie=({emit:a,state:u},c)=>{u.customItems.push(c),a(z.SET_CUSTOM_ITEMS,u.customItems)},jt=a=>a!==null&&typeof a<"u"&&typeof a.file<"u"&&typeof a.rank<"u",Xe=(a,u)=>a.filter(c=>c.file===u.file&&c.rank===u.rank)[0],it=(a,u,c)=>jt(a)?{file:Math.min(Math.max(a.file,1),u),rank:Math.min(Math.max(a.rank,1),c)}:null,ln=a=>!a||!a.file||!a.rank?null:String.fromCharCode(96+a.file)+a.rank.toString(),v=a=>a?{file:a.toLowerCase().charCodeAt(0)-96,rank:Number(a.charAt(1))}:null,C=(a={},u=[],c=[])=>{if(u===null&&(u=[]),c===null&&(c=[]),Object.keys(a).length===0&&u.length===0)return[];const p=u.reduce((_,A)=>(A.from&&_.push(A.from),A.to&&_.push(A.to),_),[]).concat(c.map(_=>ln(_)));return[a.from&&!p.includes(a.from)?v(a.from):null,a.to&&!p.includes(a.to)?v(a.to):null,...u.reduce((_,A)=>(_.push(A.from?{...v(A.from),isPremove:!0}:null),_.push(A.to?{...v(A.to),isPremove:!0}:null),_),[])]};let G=0;const ae=()=>(G+=1,`square-${G}`),je=(a,u)=>a.file===u.file&&a.rank===u.rank,Ve=(a,u)=>je(a,u)?!0:a.file===u.file||a.rank===u.rank||Math.abs(a.file-u.file)===Math.abs(a.rank-u.rank)?!1:!(Math.abs(a.file-u.file)===2&&Math.abs(a.rank-u.rank)===1||Math.abs(a.rank-u.rank)===2&&Math.abs(a.file-u.file)===1),K=(a,u,c)=>{if(!a||!u||!c)return!1;const p=Xe(a,u);if(!p||!p.color||!p.type)return!1;const _=p.color===1?7:2,A=p.color===1?8:1;return u.rank===_&&c.rank===A&&p.type==="p"},Et=a=>"pnbrqkPNBRQK".indexOf(a)!==-1,Gn=({state:a,emit:u})=>{const c=a.selectedPiece;if(u(z.REMOVE_SQUARES,{type:ve.SELECTION}),!!a.options.highlightMoves&&c){let p=!0;if(a.premoves.forEach(_=>{(_.from&&je(_.from,c)||_.to&&je(_.to,c))&&(p=!1)}),a.squares.forEach(_=>{je(_,c)&&(p=!1)}),p){const _={id:ae(),file:c.file,rank:c.rank,color:a.options.highlightColor,opacity:a.options.highlightOpacity};u(z.ADD_SQUARES,{moveSquares:[_],type:ve.SELECTION})}}},ur=({emit:a,state:u})=>{a(z.SET_PIECE,{piece:u.promotion.from,fileRank:u.promotion.from}),u.promotion={from:null,piece:null,to:null},a(z.CLOSE_PROMOTION_MENU),a(z.REMOVE_SQUARES,{type:ve.SELECTION})},Pr=a=>a.map(u=>({...u,id:`${u.color===1?"w":"b"}${u.type}${u.file}${u.rank}`}));let Hn=0;const Vt=()=>(Hn+=1,`piece-${Hn}`),et=()=>{Hn=0},Re=a=>{const u={};return a.forEach(c=>u[c.id]={...c}),u},Xt=a=>Object.keys(a).map(u=>a[u]),un=(a,u)=>{const c=Re(a),p=Re(Pr(u));let _=[];const A=[],V=[];Object.keys(p).forEach(re=>{c[re]&&(_.push({...p[re],key:c[re].key}),delete c[re],delete p[re])});const ue=Xt(c);return _=Xt(p).map(re=>{const wt=ue.findIndex(vn=>vn&&vn.type===re.type&&vn.color===re.color);let On;return wt!==-1?(On=ue[wt].key,A.push({...re,key:On}),ue[wt]=null):(On=Vt(),V.push({...re,key:On})),{...re,key:On||Vt()}}).concat(_),{added:V,final:_,moved:A,previous:a,removed:ue.filter(re=>re!==null)}},cr={type:null,timeout:null};function or(){cr.type=null,cr.timeout=null}function ar(a){clearTimeout(cr.timeout),a(z.PLAY_SOUND,cr.type),or()}function Nn(a,u,c){cr.type=u,cr.timeout=setTimeout(()=>{c(z.PLAY_SOUND,u),or()},a*1e3)}const Er=a=>{switch(a){case"none":return 0;case"slow":return .5;default:return .2}},Mr=a=>{if(!a)return null;let u;const c=a.san.slice(-1);return c==="+"?u=Pe.CHECK:c==="#"?u=Pe.CHECKMATE:a.flags===1||a.flags===4?u=Pe.CAPTURE:a.flags===16||a.flags===32?u=Pe.CASTLE:a.flags===8||a.flags===9?u=Pe.PROMOTION:u=Pe.NORMAL,u},vr=(a,u)=>{let c;switch(a){case Pe.CHECK:case Pe.CHECKMATE:c=U.CHECK;break;case Pe.CAPTURE:c=U.CAPTURE;break;case Pe.CASTLE:c=U.CASTLE;break;case Pe.PREMOVE:c=U.PREMOVE;break;case Pe.PROMOTION:c=U.PROMOTION;break;default:u?c=U.MOVE_OPPONENT:c=U.MOVE_SELF;break}return c},en=({dispatch:a,emit:u,state:c},p)=>{ar(u);let _=!1,A=null,V=c.busy;const ue=p.animate?Er(c.options.animationType):0,re=un(c.pieces,p.pieces),wt=p.sideToMove===p.playingAs,vn=p.premoves.length>c.premoves.length?Pe.PREMOVE:Mr(p.selectedNode),qn={...c.selectedNode};c.isCheck=p.isCheck,c.isCheckmate=p.isCheckmate,c.pieces=[...re.final],c.premoves=[...p.premoves],c.previousPieces=[...re.previous],c.selectedNode={...p.selectedNode},c.sideToMove=p.sideToMove,c.playingAs=p.playingAs,c.promotion.to&&(c.promotion={from:null,piece:null,to:null},u(z.CLOSE_PROMOTION_MENU)),a(Zt.UPDATE_LEGAL_MOVES,p),qn&&(p.selectedNode||(p.selectedNode={moveNumber:-1}),_=Math.abs(qn.moveNumber-p.selectedNode.moveNumber)===1),p.playSound?_&&qn.moveNumber>p.selectedNode.moveNumber?A=vr(Mr(qn),!wt):p.selectedNode&&(A=vr(vn,wt)):A=null;const wn={fadeTime:_?ue:0,pieces:re.added,moveType:vn},Bt={animationSpeed:c.options.fadeSetup>0?0:ue,pieces:re.moved,moveType:vn},Rr={fadeTime:_&&!(c.movedPiece||c.draggingPiece)?ue:0,pieces:re.removed,moveType:vn};a(Zt.SET_BUSY_FLAG,!0);const Vi=c.options.highlightMoves?C(c.selectedNode,p.premoves,p.squares):C({},p.premoves,p.squares);if(a(Zt.SET_MOVE_SQUARES,Vi),c.options.fadeSetup>0&&u(z.FADE_PIECES),p.loaded&&(a(Zt.DESELECT_PIECE),u(k.LOADED)),c.draggingPiece&&Rr.pieces&&Rr.pieces.length>0&&Rr.pieces.findIndex(Xr=>Xr.key===c.draggingPiece.key)>=0&&(a(Zt.DESELECT_PIECE),a(Zt.DRAG_CANCEL)),u(k.POSITION_CHANGED,re),u(z.SET_PIECES,re.previous),u(z.REMOVE_PIECES,Rr),u(z.ADD_PIECES,wn),A&&c.options.playSounds&&(V?u(z.PLAY_SOUND,A):Nn(ue,A,u)),c.selectedPiece&&Bt.pieces&&Bt.pieces.length&&Bt.pieces.findIndex(Or=>Or.key===c.selectedPiece.key)>=0&&a(Zt.DESELECT_PIECE),(c.movedPiece||c.draggingPiece)&&Bt.pieces&&Bt.pieces.length>0){let Or=null,Xr=-1;c.draggingPiece&&(Xr=Bt.pieces.findIndex(ca=>ca.key===c.draggingPiece.key),Xr>=0&&(Or={file:Bt.pieces[Xr].file,rank:Bt.pieces[Xr].rank},Bt.pieces.splice(Xr,1)),Or!==null&&(u(z.DROP_PIECE,{state:c,draggingPiece:c.draggingPiece,fileRank:Or}),c.draggingPiece=null)),c.movedPiece&&(Or=null,Xr=Bt.pieces.findIndex(ca=>ca.key===c.movedPiece.key),Xr>=0&&(Or={file:Bt.pieces[Xr].file,rank:Bt.pieces[Xr].rank},Bt.pieces.splice(Xr,1)),Or!==null&&(u(z.DROP_PIECE,{state:c,draggingPiece:c.movedPiece,fileRank:Or}),c.movedPiece=null))}u(z.MOVE_PIECES,Bt);let gt=100;ue>0&&(Bt.pieces&&Bt.pieces.length||c.options.fadeSetup>0)&&(gt+=ue*1e3),c.busyFlagTimeout!==null&&clearTimeout(c.busyFlagTimeout),c.busyFlagTimeout=setTimeout(()=>{c.busyFlagTimeout=null,a(Zt.SET_BUSY_FLAG,!1)},gt)},qt=({emit:a,state:u},c)=>{u.arrows=u.arrows.filter(p=>!je(p,c)),a(k.ARROW_CLEARED,c)},Rn=({emit:a,state:u})=>{u.squares=[],u.arrows=[],a(k.MARKINGS_CLEARED)},$e=({emit:a,state:u},c)=>{u.squares=u.squares.filter(p=>!je(p,c)),a(k.SQUARE_CLEARED,c)},It=(a,u,c)=>jt(a)?a.file>0&&a.file<u+1&&a.rank>0&&a.rank<c+1:null,Ht=(a,u,c)=>{const p={};return a.file!==void 0?(p.file=Math.max(a.file,1),p.file=Math.min(p.file,u||8),p.rank=Math.max(a.rank,1),p.rank=Math.min(p.rank,c||8)):a.x!==void 0&&(p.x=Math.max(a.x,0),p.x=Math.min(p.x,a.boardRect.width),p.y=Math.max(a.y,0),p.y=Math.min(p.y,a.boardRect.height),p.boardRect=a.boardRect),p},b=(a,u)=>{const c=u.getBoundingClientRect();let p=0,_,A;return a.touches&&a.pointer?(_=a.pointer.x,A=a.pointer.y,p=Number(window.scrollY||0)):a.touches&&a.touches[0]?(_=a.touches[0].clientX,A=a.touches[0].clientY):(_=a.clientX,A=a.clientY),{x:_-c.left,y:A-(c.top+p),boardRect:c}},se=(a,u,c,p,_,A)=>{const V=a.boardRect.width/_,ue=A?(8-u)*V:(u-1)*V,re=A?(c-1)*V:(8-c)*V;return{offsetX:a.x-ue,offsetY:a.y-re}},oe=(a,u,c,p,_)=>{const A=a.boardRect.width/p,V=Math.floor(a.x/A),ue=Math.floor(a.y/A);return{file:_?c-V:V+1,rank:_?ue+1:p-ue}},fe=(a,u,c,p,_)=>oe(b(a,u),u,c,p,_),Te=(a,u,c)=>fe(a,u,c.board.files,c.board.ranks,c.options.flipBoard),Ne=a=>{const u=a.match(/square-(\d+)/);if(!u)return null;const c=u[1].match(/.{1,2}/g).map(p=>parseInt(p,10));return{file:c[0],rank:c[1]}},yn=({dispatch:a,emit:u,state:c},p)=>{if(!c.options.enabled||!It(p,c.board.files,c.board.ranks))return null;(c.squares&&c.squares.length||c.arrows&&c.arrows.length)&&a(Zt.CLEAR_MARKINGS),p.piece=Xe(c.pieces,p),c.options.moveMethod==="drag"&&c.draggingPiece&&je(c.draggingPiece,p)?(a(Zt.DROP_PIECE,c.draggingPiece),c.preselectedPiece&&c.selectedPiece&&c.preselectedPiece.key===c.selectedPiece.key?(a(Zt.DESELECT_PIECE),c.preselectedPiece=null):a(Zt.SELECT_PIECE,p)):c.selectedPiece&&c.options.moveMethod==="drag"?(c.promotion.from!==null&&ur({emit:u,state:c}),a(Zt.MAKE_MOVE,p)):!c.selectedPiece&&p.piece?c.preventNextSelect?c.preventNextSelect=!1:a(Zt.SELECT_PIECE,p):a(Zt.DESELECT_PIECE),c.busyFlagTimeout=setTimeout(()=>{c.busyFlagTimeout=null,a(Zt.SET_BUSY_FLAG,!1)},100),u(k.CLICKED,{state:c,file:p.file,rank:p.rank})},F=({emit:a,dispatch:u,state:c})=>{a(z.REMOVE_LEGAL_MOVES),a(k.PIECE_UNSELECTED,c.selectedPiece),c.selectedPiece=null,u(Zt.UPDATE_SELECTED_PIECE_SQUARE)},he=({emit:a,dispatch:u})=>{u(Zt.SET_BUSY_FLAG,!0),a(z.DISABLE_FAKE_CURSOR)},we=({emit:a,dispatch:u})=>{u(Zt.SET_BUSY_FLAG,!1),a(z.ENABLE_FAKE_CURSOR)},Oe=({emit:a,dispatch:u,state:c})=>{c.busyFlagTimeout!==null&&(clearTimeout(c.busyFlagTimeout),c.busyFlagTimeout=null,u(Zt.SET_BUSY_FLAG,!1)),c.draggingPiece&&(u(Zt.DROP_PIECE,{file:c.draggingPiece.file,rank:c.draggingPiece.rank}),a(k.PIECE_DROPPED,{state:c,draggingPiece:c.draggingPiece})),c.drawingArrow=!1},y=({emit:a,state:u},c)=>{if(!u.draggingPiece)return null;a(z.DRAG_PIECE,{state:u,draggingPiece:u.draggingPiece,coords:c}),a(z.SHOW_HOVER_SQUARE,{state:u,coords:c})},T=({dispatch:a,emit:u,state:c},p)=>{if(!c.options.enabled||!It(p,c.board.files,c.board.ranks)||c.draggingPiece||c.preventNextSelect)return null;if(c.selectedPiece&&c.promotion.from!==null){ur({emit:u,state:c});return}p.piece=Xe(c.pieces,p),p.piece&&!(c.selectedPiece&&c.selectedPiece.color!==p.piece.color)&&(c.selectedPiece=p.piece),c.selectedPiece&&(p.piece={...c.selectedPiece}),!p.isRightClick&&c.selectedPiece?(c.draggingPiece={...c.selectedPiece},a(Zt.SET_BUSY_FLAG,!0),a(Zt.SELECT_PIECE,p),u(z.PICK_UP_PIECE,c.selectedPiece),u(k.PIECE_PICKED_UP,c.selectedPiece)):p.isRightClick&&c.options.allowMarkings&&(c.drawingArrowFrom=p)},x=({emit:a,dispatch:u,state:c},p)=>{if(!c.draggingPiece&&!c.drawingArrowFrom||!p)return null;const{file:_,rank:A,isRightClick:V}=p,ue={file:_,rank:A};if(c.drawingArrowFrom&&V){if(je(c.drawingArrowFrom,ue))return c.drawingArrowFrom=null,null;const re={fromFileRank:c.drawingArrowFrom,toFileRank:it(ue,c.board.files,c.board.ranks)};if(Ve(re.fromFileRank,re.toFileRank))return c.drawingArrowFrom=null,null;c.arrows.find(wt=>je(wt.fromFileRank,re.fromFileRank)&&je(wt.toFileRank,re.toFileRank))?u(Zt.CLEAR_ARROW,re):u(Zt.MARK_ARROW,re),c.drawingArrowFrom=null,c.selectedPiece=null}else It(ue,c.board.files,c.board.ranks)?(c.busyFlagTimeout!==null&&clearTimeout(c.busyFlagTimeout),c.busyFlagTimeout=setTimeout(()=>{c.busyFlagTimeout=null,u(Zt.SET_BUSY_FLAG,!1)},100),V?c.draggingPiece&&(u(Zt.DROP_PIECE,{file:c.draggingPiece.file,rank:c.draggingPiece.rank}),a(k.PIECE_DROPPED,{state:c,draggingPiece:c.draggingPiece})):c.selectedPiece&&!je(c.selectedPiece,ue)?u(Zt.MAKE_MOVE,p):u(Zt.DROP_PIECE,ue)):(c.busyFlagTimeout!==null&&clearTimeout(c.busyFlagTimeout),c.busyFlagTimeout=setTimeout(()=>{c.busyFlagTimeout=null,u(Zt.SET_BUSY_FLAG,!1)},100),u(Zt.MAKE_MOVE,null))},H=({emit:a,state:u},c)=>{u.draggingPiece&&(a(z.DROP_PIECE,{state:u,draggingPiece:u.draggingPiece,fileRank:c}),a(z.HIDE_HOVER_SQUARE,{state:u}),u.draggingPiece=null)};function O(a){var u=typeof a;return a!=null&&(u=="object"||u=="function")}var X=O,Z=typeof global=="object"&&global&&global.Object===Object&&global,_t=Z,nt=typeof self=="object"&&self&&self.Object===Object&&self,Ue=_t||nt||Function("return this")(),j=Ue,qe=function(){return j.Date.now()},Qt=qe,Fn=j.Symbol,Vn=Fn,Un=Object.prototype,an=Un.hasOwnProperty,gs=Un.toString,na=Vn?Vn.toStringTag:void 0;function Qs(a){var u=an.call(a,na),c=a[na];try{a[na]=void 0;var p=!0}catch{}var _=gs.call(a);return p&&(u?a[na]=c:delete a[na]),_}var _s=Qs,Js=Object.prototype,ja=Js.toString;function _a(a){return ja.call(a)}var el=_a,tl="[object Null]",ba="[object Undefined]",bs=Vn?Vn.toStringTag:void 0;function qa(a){return a==null?a===void 0?ba:tl:bs&&bs in Object(a)?_s(a):el(a)}var ys=qa;function nl(a){return a!=null&&typeof a=="object"}var rl=nl,il="[object Symbol]";function Wa(a){return typeof a=="symbol"||rl(a)&&ys(a)==il}var dn=Wa,$n=0/0,st=/^\s+|\s+$/g,Ee=/^[-+]0x[0-9a-f]+$/i,Rt=/^0b[01]+$/i,rn=/^0o[0-7]+$/i,sn=parseInt;function Ot(a){if(typeof a=="number")return a;if(dn(a))return $n;if(X(a)){var u=typeof a.valueOf=="function"?a.valueOf():a;a=X(u)?u+"":u}if(typeof a!="string")return a===0?a:+a;a=a.replace(st,"");var c=Rt.test(a);return c||rn.test(a)?sn(a.slice(2),c?2:8):Ee.test(a)?$n:+a}var Nt=Ot,_n="Expected a function",Cn=Math.max,Nr=Math.min;function En(a,u,c){var p,_,A,V,ue,re,wt=0,On=!1,vn=!1,qn=!0;if(typeof a!="function")throw new TypeError(_n);u=Nt(u)||0,X(c)&&(On=!!c.leading,vn="maxWait"in c,A=vn?Cn(Nt(c.maxWait)||0,u):A,qn="trailing"in c?!!c.trailing:qn);function wn(pi){var da=p,ss=_;return p=_=void 0,wt=pi,V=a.apply(ss,da),V}function Bt(pi){return wt=pi,ue=setTimeout(gt,u),On?wn(pi):V}function Rr(pi){var da=pi-re,ss=pi-wt,pc=u-da;return vn?Nr(pc,A-ss):pc}function Vi(pi){var da=pi-re,ss=pi-wt;return re===void 0||da>=u||da<0||vn&&ss>=A}function gt(){var pi=Qt();if(Vi(pi))return Or(pi);ue=setTimeout(gt,Rr(pi))}function Or(pi){return ue=void 0,qn&&p?wn(pi):(p=_=void 0,V)}function Xr(){ue!==void 0&&clearTimeout(ue),wt=0,p=re=_=ue=void 0}function ca(){return ue===void 0?V:Or(Qt())}function as(){var pi=Qt(),da=Vi(pi);if(p=arguments,_=this,re=pi,da){if(ue===void 0)return Bt(re);if(vn)return clearTimeout(ue),ue=setTimeout(gt,u),wn(re)}return ue===void 0&&(ue=setTimeout(gt,u)),V}return as.cancel=Xr,as.flush=ca,as}var Mt=En,Ar="Expected a function";function kn(a,u,c){var p=!0,_=!0;if(typeof a!="function")throw new TypeError(Ar);return X(c)&&(p="leading"in c?!!c.leading:p,_="trailing"in c?!!c.trailing:_),Mt(a,u,{leading:p,maxWait:u,trailing:_})}var Wn=kn,St=Wn;function qr({emit:a,state:u},c){if(!u.options.captureKeyStrokes)return null;switch(a(k.KEY_PRESS,c),c){case 37:a(k.MOVE_BACKWARD,1);break;case 38:a(k.MOVE_TO_START);break;case 39:a(k.MOVE_FORWARD,1);break;case 40:a(k.MOVE_TO_END);break;default:break}}const Gr=St(qr,120);let ui=0;const di=()=>(ui+=1,`arrow-${ui}`),Ki=({emit:a},u)=>{if(!u||!u.fromFileRank||!u.toFileRank)return null;const c={id:di(),fromFileRank:{...u.fromFileRank},toFileRank:{...u.toFileRank}};return a(k.ARROW_MARKED,c)};let Br=0;const bi=()=>(Br+=1,`effect-${Br}`),oo=({emit:a},u)=>{if(!u||!u.square)return null;const c={id:bi(),...u};return a(k.EFFECT_MARKED,c)},Ai=({dispatch:a,emit:u,state:c},p)=>{if(!c.selectedPiece&&(!c.promotion||!c.promotion.piece||!c.promotion.from))return c.draggingPiece=null,null;let _=c.selectedPiece?{...Xe(c.pieces,c.selectedPiece)}:null;if(!_||!_.file&&!_.rank||_&&c.selectedPiece&&(_.type!==c.selectedPiece.type||_.color!==c.selectedPiece.color)){if(c.draggingPiece=null,a(Zt.DESELECT_PIECE),!c.promotion.from)return null;_=c.promotion.from}u(k.SQUARE_UNSELECTED,{state:c,square:c.selectedPiece});let A,V={file:_.file,rank:_.rank},ue=c.promotion.piece,re=c.promotion.to||p;const wt=c.options.autoPromote&&!(p&&p.altKey),On=K(c.pieces,_,re),vn=c.legalMoves.filter(Bt=>Bt.from===ln(V)&&Bt.to===ln(re)&&Bt.captured!=="k").length===0,qn=On&&!vn&&!c.promotion.piece&&!wt,wn=!vn&&On&&(wt||c.promotion.piece);if(qn)return c.promotion={from:{..._},piece:null,to:p},a(Zt.DROP_PIECE,p),u(z.OPEN_PROMOTION_MENU,{piece:_,toFileRank:p,top:c.options.flipBoard&&_.color===2||!c.options.flipBoard&&_.color===1});if(wn&&(V=c.promotion.from||V,re=c.promotion.to||p,ue=wt?"q":c.promotion.piece,a(Zt.DROP_PIECE,p)),c.movedPiece=c.draggingPiece,p===null&&c.gameSettings.rules&&(A={file:_.file,rank:_.rank}),vn&&(A={file:_.file,rank:_.rank}),A&&a(Zt.DROP_PIECE,A),vn||a(Zt.DROP_PIECE,p),u(k.MOVE_MADE,{from:V,to:re,isIllegal:vn,promotion:ue}),a(Zt.DESELECT_PIECE),c.isCheck&&vn&&_&&_.color===c.sideToMove&&!c.pieces.find(Rr=>Rr&&re&&Rr.file===re.file&&Rr.rank===re.rank&&Rr.color===c.sideToMove)){const Rr=c.pieces.find(Vi=>Vi.type==="k"&&Vi.color===c.sideToMove);u(z.BLINK_SQUARE,{file:Rr.file,rank:Rr.rank,times:3,color:"#ff0000",interval:200}),c.options.playSounds&&u(z.PLAY_SOUND,U.ILLEGAL)}c.promotion={from:null,piece:null,to:null}},Qr=({emit:a,state:u},c)=>{if(!c||!c.file||!c.rank)return null;const p={id:ae(),file:c.file,rank:c.rank,color:c.color||u.options.highlightColor,opacity:c.opacity||u.options.highlightOpacity};return a(k.SQUARE_MARKED,p)},fi=({dispatch:a,emit:u,state:c},p)=>{if(!p)return;const{file:_,rank:A,x:V,y:ue,boardRect:re,isRightClick:wt}=p;if(wt)return a(Zt.DRAG_CANCEL);if(!c.options.enabled||!It({file:_,rank:A},c.board.files,c.board.ranks)||c.selectedPiece&&c.promotion.from!==null)return null;if(c.options.moveMethod==="drag"){if(!c.gameSettings.rules||c.selectedPiece&&c.legalMoves.findIndex(vn=>vn.from===ln(c.selectedPiece)&&vn.to===ln({file:_,rank:A}))>-1||!Xe(c.pieces,{file:_,rank:A}))return;c.selectedPiece=null,a(Zt.DRAG_START,{file:_,rank:A,x:V,y:ue}),u(z.DRAG_PIECE,{state:c,draggingPiece:c.selectedPiece,coords:{x:V,y:ue,boardRect:re}})}else c.selectedPiece&&!je(c.selectedPiece,{file:_,rank:A})?(c.preventNextSelect=!0,a(Zt.MAKE_MOVE,p),c.busyFlagTimeout!==null&&(clearTimeout(c.busyFlagTimeout),c.busyFlagTimeout=null,a(Zt.SET_BUSY_FLAG,!1))):c.preventNextSelect=!1},$i=({dispatch:a,emit:u,state:c},{file:p,rank:_,x:A,y:V,isRightClick:ue})=>{if(c.draggingPiece&&!ue)a(Zt.DROP_PIECE,{file:c.draggingPiece.file,rank:c.draggingPiece.rank}),u(k.PIECE_DROPPED,{state:c,draggingPiece:c.draggingPiece});else if(ue){if(c.gameSettings.premoves&&c.premoves.length)return u(k.CANCEL_PREMOVES),null;if(c.gameSettings.GTM&&c.premoves.length)return u(k.CANCEL_GTM),null}},ya=({emit:a,state:u},c)=>{u.customItems=u.customItems.filter(p=>!je(p.fileRank,c.fileRank)),a(z.SET_CUSTOM_ITEMS,u.customItems)};function Zi(a){return!a||a==="default"?"medium":a}function Si(a){return!a||a==="medium"||a==="battle"?"default":a}function ao(a){switch(a){case"drag_only":return"drag-only";case"click":return"click";case"drag":default:return"drag"}}function Ea(a){switch(a){case"click":return"click";case"drag-only":return"drag_only";case"drag":default:return"drag"}}const Wr=["boardStyle","pieceStyle","soundTheme"],ol=a=>Object.entries(a).reduce((u,[c,p])=>{if(Wr.includes(c))return u;const[_,A]=Ka(c,p);return u[_]=A,u},{}),Ka=(a,u)=>{const c=$a(a);return[c,al(c,u)]},$a=a=>{switch(a){case"animationType":return"board.animation_type";case"coordinates":return"board.coordinates";case"highlightLegalMoves":return"board.show_legal_moves";case"highlightMoves":return"board.highlight_moves";case"isWhiteOnBottom":return"board.white_always_on_bottom";case"moveListDisplayType":return"board.move_list_style";case"moveMethod":return"board.move_method";case"playSounds":return"board.play_sounds";case"showTimestamps":return"gameplay.show_timestamps";default:return a}},al=(a,u)=>{switch(a){case"board.animation_type":return Zi(u);case"board.move_method":return Ea(u);case"board.coordinates":return["off","inside","outside"].includes(u)?u:["off","inside","outside"][u];default:return u}};var Ti=sr(9669),Ri=sr.n(Ti);const Es={CONNECT:"connect",DISCONNECT:"disconnect",FAILURE:"failure",MESSAGE:"message",RECONNECT:"reconnect",SUBSCRIBE:"subscribe",SUBSCRIBE_FAIL:"subscribe_fail",UNSUBSCRIBE:"unsubscribe",ERROR:"error"};var Aa=(a=>(a.Base="base",a.Chat="chat",a.Classroom="classroom",a.Matcher="matcher",a.Play="play",a.Presence="presence",a.Ratings="ratings",a.Insights="insights",a.TopPlayers="topplayers",a.Users="users",a.Invitations="invitations",a.Settings="settings",a.GameList="gamelist",a))(Aa||{}),wa=(a=>(a.Classroom="classroom",a.Game="game",a.Disable="disable",a.Messages="messages",a.Mute="mute",a.Unmute="unmute",a.User="user",a))(wa||{}),ra=(a=>(a.Users="users",a))(ra||{}),As=(a=>(a.Accept="accept",a.Cancel="cancel",a.Challenges="challenges",a.Decline="reject",a.Games="games",a.Seeks="seeks",a))(As||{}),Za=(a=>(a.Actions="actions",a.Games="games",a.Moves="moves",a))(Za||{}),Ya=(a=>(a.Alias="alias",a.Arrows="arrows",a.AudioSettings="audio-settings",a.AutoSave="auto-save",a.Boards="boards",a.ChatSettings="chat-settings",a.Clock="clock",a.CollectionIds="collection-ids",a.Commands="commands",a.Confirmations="confirmations",a.Current="current",a.Enrollment="enrollment",a.EvaluationSettings="evaluation-settings",a.Flipped="flipped",a.GameId="game-id",a.Images="images",a.Invitees="invitees",a.LargeClassroom="large-classroom",a.Moves="moves",a.Notifications="notifications",a.PinnedVideos="pinned-videos",a.Players="players",a.Position="position",a.Publish="publish",a.SelectedCollectionId="selected-collection-id",a.Sequence="sequence",a.Sessions="sessions",a.Squares="squares",a.Stopwatch="stopwatch",a.Timer="timer",a.Title="title",a.Twilio="twilio",a.Users="users",a.Webrtc="webrtc",a))(Ya||{}),ws=(a=>(a.Users="users",a))(ws||{}),Ss=(a=>(a.Users="users",a))(Ss||{});const zr=window.PubSub;async function Xa(a){const{data:u}=await zr.fetch({method:"get",path:"users/me",service:Aa.Settings,params:{include:a.join(",")}});return u}const sl=["off","inside","outside"];function Yi(a){const u=Number.parseInt(a,10);return Number.isInteger(u)?sl[u]:a}const Go={BOARD_POPOVER:"v-board-popover",CONFIRM_POPOVER:"v-confirm-popover",TOOLTIP:"v-tooltip",USER_POPOVER:"v-user-popover"};var ll=sr(36905),ia=sr.n(ll);function bo(){return ia()}function Qa(a){var u,c,p;const _=bo();if(!_.routes_[a]){try{Object.assign(_.context_,{base_url:"",prefix:"",host:"www.chess.com",port:"",scheme:"https",locale:""})}catch{}if(Object.isFrozen(_.routes_)&&(_.routes_=Object.assign({},_.routes_)),(c=(u=window.chesscom)==null?void 0:u.routes)!=null&&c[a]){const A=window.chesscom.routes[a],V=".chess-dev.com",ue=window.location.host.replace(/^[^.]+/,"");ue&&((p=A.hosttokens)==null||p.forEach(re=>{re.forEach((wt,On)=>{wt.includes(V)&&(re[On]=wt.replace(V,ue))})})),_.routes_[a]=A}}}class ul{generate(u,c,p){const _=c||{};typeof _.username=="string"&&(_.username=_.username.toLowerCase()),Qa(u);try{return bo().generate(u,_,p)}catch{const V=new Error(`Couldn't find missing route '${u}'.`);return console.error(V),"/"}}i18nable(u){return`i18n_${u}`in window.chesscom.routes}i18n(u,c,p){var _,A;let V=u;const ue=c||{};if((A=(_=window.context)==null?void 0:_.route)!=null&&A.startsWith("i18n")&&this.i18nable(u)){const wt="_locale";ue[wt]=window.context.locale.slice(0,2),V=`i18n_${u}`}const re=this.generate(V,ue,p);return p?re:re.replace(/^.*\/\/[^/]+/,"")}}var Mi=new ul,Cs=sr(89402),N=sr.n(Cs),J,B;const ce=((B=(J=window.context)==null?void 0:J.i18n)==null?void 0:B.locale)==="fr_FR";N().placeHolderPrefix="",N().placeHolderSuffix="";const ee=a=>a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),le=a=>{const u={};return a!==null&&typeof a<"u"&&Object.keys(a).forEach(c=>{const p=ee(c);p!=null&&p.length>0&&(u[p]=a[c])}),u},rt=(a,u="messages",c)=>{if(window.chesscom_translations&&window.chesscom_translations[u]&&window.chesscom_translations[u][a])return window.chesscom_translations[u][a];if(window.chesscom_live_translations&&window.chesscom_live_translations[u]&&window.chesscom_live_translations[u][a])return window.chesscom_live_translations[u][a];if(u==="live"&&window.i18n_phrases&&window.i18n_phrases[a])return window.i18n_phrases;if(u==="countries"&&window.Country&&window.Country[a])return window.Country;if(!c)return u!=="javascript"?rt(a,"javascript"):a},Lt=(a,u,c)=>N().trans(rt(a,c),le(u),c),ut=(a,u,c,p)=>{if(typeof u>"u")return"";const _=rt(a,p),A=le(c);return ce?ze(_,u,A,p):N().transChoice(_,u,A)};function ze(a,u,c,p){const[_,A,V]=a.split("|").map(ue=>ue.trim());return u===0||u===1?N().trans(_,c,p):u%1e6===0?N().trans(A,c,p):N().trans(V,c,p)}const xn=(a,u)=>!!rt(a,u,!0),Yn=()=>{if(window.chesscom_translations&&window.chesscom_translations.countries)return window.chesscom_translations.countries;if(window.chesscom_live_translations&&window.chesscom_live_translations.countries)return window.chesscom_live_translations.countries;if(window.Country)return window.Country};var pt={trans:Lt,transChoice:ut},Lr,ct;const hn={ARIA_CONTROLS:"aria-controls",ARIA_LABEL:"aria-label",ARIA_SELECTED:"aria-selected",AVATAR:"data-avatar",ALIGN_DROPDOWN:"data-align-dropdown",BORDER_TOP:"data-border-top",BORDER_TOP_WIDE:"data-border-top-wide",BUTTON_TEXT:"data-button-text",CATEGORIES:"data-categories",CONTROL_LABEL_TEXT:"data-control-label-text",CUSTOM_BTN_CLASS:"data-custom-btn-class",CUSTOM_COLLAPSE_CLASS:"data-custom-collapse-class",DARK_MODE:"data-dark-mode",HIDDEN:"hidden",ICON_BUTTON:"data-icon-button",NEXT_LESSON_HINT:"data-next-lesson-hint",OPTIONS:"data-options",SHOW_ICON:"data-show-icon",SELECTED_LANGUAGES:"data-selected-languages",SELECTED_PAGE:"data-selected-page",SELECTED_VALUE:"data-selected-value",SLOTS:"data-stats-slots",SRC:"src",STATS:"data-stats",SURVEY_DATA:"data-survey",SURVEY_VOTED:"data-voted-survey",TAB_URL_PARAM:"data-tab-url-param",TYPE:"data-type",USERNAME:"data-username",USER_LANGUAGE:"data-user-language",VALUE:"data-value",VS_STATS:"data-vs-stats"},cu={getArticleAuthors:"web_article_callback_list_authors",lockUnlockComments:{article:"web_article_callback_lock_coments",blog:"web_blog_callback_lock_coments",news:"web_news_callback_lock_coments",video:"web_video_callback_lock_coments"},setArticleFeature:"web_content_callback_feature_article",setBlogFeature:"web_content_callback_feature_blog",setLessonsFeature:"web_content_callback_feature_lesson_course",setNewsFeature:"web_content_callback_feature_news",setVideoFeature:"web_content_callback_feature_chess_video"},Wc={BLOG:"blog",CSRF_TOKEN:(ct=(Lr=window.context)==null?void 0:Lr.csrf)==null?void 0:ct.token,DARK_MODE:"dark-mode",DEFAULT_LOCALE:"en_US",LESSONS:"lessons",NEWS:"news",VIDEO:"video",GRID_VIEW:"grid",LIST_VIEW:"list",LOCALE:window.context&&window.context.locale||"en_US",LOGGED_IN:window.context&&window.context.user,PUZZLES_COUNT:500,TIME:{hour:36e5},USERNAME:window.context&&window.context.user?window.context.user.username:null,USER_COLOR_SCHEME:"COLOR_SCHEME"},cl={CHESS_960:"chess960"},xh={category:a=>pt.trans(a,{},"dynamic"),commentsSynced:pt.trans("Comment count will be recalculated in few moments"),daysOfWeek:[pt.trans("Sunday"),pt.trans("Monday"),pt.trans("Tuesday"),pt.trans("Wednesday"),pt.trans("Thursday"),pt.trans("Friday"),pt.trans("Saturday")],loading:pt.trans("Loading..."),months:[pt.trans("January"),pt.trans("February"),pt.trans("March"),pt.trans("April"),pt.trans("May"),pt.trans("June"),pt.trans("July"),pt.trans("August"),pt.trans("September"),pt.trans("October"),pt.trans("November"),pt.trans("December")],monthsAbbreviated:[pt.trans("Jan"),pt.trans("Feb"),pt.trans("Mar"),pt.trans("Apr"),pt.trans("May"),pt.trans("Jun"),pt.trans("Jul"),pt.trans("Aug"),pt.trans("Sep"),pt.trans("Oct"),pt.trans("Nov"),pt.trans("Dec")],noResult:pt.trans("No results found."),pleaseEnter:a=>pt.trans("Please enter %number% or more characters",{"%number%":a}),showMore:pt.trans("More"),showLess:pt.trans("Less"),lessonsHintMessage:pt.trans("Let me help you learn everything you need to know with this guide."),nextLessonHintMessage:pt.trans("Your next lesson is ready. Study daily if you really want to improve!"),openingsHintMessage:pt.trans("Let me help you improve your openings!")},Ih={AMPLITUDE_LOGGER:"amplitude-logger",AMPLITUDE_LOG_SELECTION:"[data-log-selection-to-amplitude]",BOARD_POPOVER:Go.BOARD_POPOVER,CAPTCHA:"captcha",COLLAPSE:"v-toggle-collapse",COLLAPSED:"toggle-collapsed",CONTENT_AD:"content-ad",CONTENT_CATEGORY_SELECT:"content-category-select",CONTENT_LANGUAGE_SELECT:"content-language-select",CONFIRM_OPEN:"confirm-open",CONFIRM_POPOVER:"v-confirm-popover",CONFIRM_POPOVER_INLINE:"confirm-popover-inline",DELETE_CONTENT:"post-category-link-delete",DELETE_SPAM_CONTENT:"post-category-link-delete-spam",DONATE_MODAL:"donate-modal",FEATURE_SIDEBAR_LINK:"post-category-link-feature",FILTERS:"page-filters",FOLLOW_UNFOLLOW_AUTHOR:"follow-unfollow-author",FORM_DATEPICKER:"v-datepicker",FORM_DROPDOWN:"form-dropdown",GAME_PREVIEW:"game-preview",GIFT_MEMBERSHIP_BUTTON:"give-gift-membership",GIFT_MEMBERSHIP_MODAL:"gift-membership-modal",HEADLINE_SIDEBAR_LINK:"post-category-link-headline",HIDDEN:"toggle-hidden",HINT_WRAPPER:"hint-wrapper",LANGUAGE_DROPDOWN:"post-view-languages",LOCK_UNLOCK_CONTENT:"lock-unlock-content",MESSAGE_PARENT:"vue-message",NAVIGATION_FOOTER:"navigation-footer",NEW_GAME:"new-game",PAGINATION_BOTTOM:"pagination-bottom",PAGINATION_BUTTON:"ui_pagination-item-component",PAGINATION_TOP:"pagination-top",PAGINATION_SCROLL_TOP:".pagination-scroll-to-top",POST_AUTHOR_FOLLOW:"post-author-follow",POST_CAN_EDIT_URL:"post-can-edit-url",POST_EDIT_URL:"post-edit-url",POST_EDIT_URL_FIELD:"post-edit-url-field",POST_IMAGE_BUTTON:"image-upload-button",POST_IMAGE_THUMBNAIL:"image-upload-thumbnail",PUBLISH_CONTENT:"post-category-link-publish",SCROLL_TOP_ANCHOR:"scroll-top-anchor",SHORT_SIDEBAR_AD_BOTTOM:"short-sidebar-ad-bottom",SHORT_SIDEBAR_AD_TOP:"short-sidebar-ad-top",SIDEBAR_STATS:"sidebar-stats",SIDEBAR_SURVEY:"sidebar-survey",SIDEBAR_TOGGLE_BUTTON_TEXT:"toggle-content-button-text",SIDEBAR_TOGGLE_ICON:"toggle-content-icon",SIDEBAR_USER_ITEMS:"sidebar-users-grid-toggle-item",SIDEBAR_USERS_TOGGLE_BUTTON:"toggle-content-button",STAT_CHART:"stat-chart",TABS_BUTTON:"v5-tabs-button",TABS_PANEL:"v5-tabs-panel",TABS_WRAPPER:"v5-tabs-wrapper",TIMEZONES:"page-timezones",TOOLTIP:Go.TOOLTIP,TOOLTIP_CLASS:"tooltip",TOOLTIP_TOP:"top",UPGRADE_ACCORDION:"upgrade-accordion",USER_LEAGUE:"user-league",USER_TAGLINE:"post-view-meta-user",VERSION_DROPDOWN:"version-dropdown"},Kc={CONFIRM_POPOVER_YES:"confirm-popover-yes",SHOW_MODAL:"show-confirm-popover",VOTE_COUNTED:"vote-counted",VIEW_CHANGE:"view-change",VIEW_GRID:"view-grid",VIEW_LIST:"view-list"},du={changeContentLanguage:()=>Mi.generate("web_user_callback_set_content_language"),enPassant:()=>Mi.generate("web_article_view",{url:"how-to-capture-en-passant"}),inviteLink:(a,u,c)=>Mi.generate(a,{url:u,secret:c}),lockUnlockComments:(a,u)=>Mi.generate(cu.lockUnlockComments[a],{id:u}),loginPage:Mi.generate("web_security_login_and_go"),redirectToLoginPage:a=>Mi.generate("web_security_login_and_go",{redirectUrl:a}),surveyVote:(a,u)=>Mi.generate("web_survey_callback_vote",{id:a,optionId:u}),teamMatch:a=>Mi.generate("web_team_match_view",{match:a}),tournament:a=>Mi.generate("web_tournament_view",{url:a}),userProfile:a=>Mi.generate("web_member_view",{username:a})},Rh={LESSONS_ADMIN_SECTION_STATE:"lessons_admin_section_state",LESSONS_SECTION_STATE:"lessons_section_state"},Oh={OPENINGS_HINT_STATE:"openings_hint_state",LESSONS_HINT_STATE:"lessons_hint_state"},$c=90;function Xi(a,u,c){let p="";if(c){const _=new Date;_.setTime(_.getTime()+Math.min($c,c)*24*60*60*1e3),p=`; expires=${_.toUTCString()}`}document.cookie=`${a}=${u||""}${p}; path=/; samesite=none; secure`}function Zc(a){Xi(a,"",-3650)}function fu(a){const u={};return document.cookie.split("; ").forEach(c=>{const[p,_]=c.split("=");p&&_&&(u[p]=_)}),u[a]||null}var Nh={getCookie:fu,deleteCookie:Zc,setCookie:Xi};const Io="dark-mode",dl=()=>document.body.classList.contains(Io),Yc=dl(),hu=a=>a?document.body.classList.add(Io):document.body.classList.remove(Io),Lh=a=>a?setCookie(constants.USER_COLOR_SCHEME,Io,30):setCookie(constants.USER_COLOR_SCHEME,"",30),Dh=a=>{const c=window.tinymce;c?.editors.forEach(({id:p})=>{a?(c.get(p).settings.body_class=Io,c.get(p).getBody().classList.add(Io)):(c.get(p).settings.body_class="",c.get(p).getBody().classList.remove(Io))})},pu=a=>{const u=document.querySelectorAll("[data-tweet-id]"),c=a?"theme=light":"theme=dark",p=a?"theme=dark":"theme=light";u.forEach(_=>{const A=_.getAttribute(attributes.SRC);_.setAttribute(attributes.SRC,A?A.replace(c,p):"")})};var fl=Ri();function mu(a){return Qi(a)||Xc(a)||Qc(a)}function Qi(a){return a.startsWith("/service/")||a.includes(".com/service/")}function Xc(a){return a.includes("chessbomb.com")}function Qc(a){return/https:\/\/(?!www)([\S]+)chess.com/.test(a)}const vu=["delete","patch","post","put"];function Jc(a){return!a||mu(a.url)||!vu.includes(a.method)||(a.data instanceof FormData||a.data instanceof URLSearchParams?a.data.append("_token",window.context.csrf.token):a.data=Object.assign({_token:window.context.csrf.token},a.data||{})),a}const ed={BADGE_COUNT:"data-badge-count",BADGE_TEXT:"data-badge-text",BADGE_TYPE:"data-badge",SEEK_IS_SEEKER:"data-seek-is-seeker",SHAREABLE_GAME_UUID:"data-seek-short-uuid",SHAREABLE_SHARE_LINK:"data-seek-share-link"},ks={PUZZLE_BATTLE_CHALLENGE_TOASTER:"puzzle-battle-challenge-toaster",PUZZLE_BATTLE_CHALLENGE_USER:"puzzle-battle-challenge-user",HOME_NOTIFICATIONS:"home-sb-notifications",LOGIN_REGISTER_MODAL:"login-register-modal",OFFLINE_CHALLENGE_TOASTER:"offline-challenge-toaster",NAV_ROOT:"sb",SHAREABLE_GAME_URL_MODAL:"shareable-game-url-modal",SHAREABLE_GAME_SHORT_UUID:"shareable-game-short-uuid"},Bh={BADGES:".svelte-badge"},Ci=()=>Math.random().toString(36).substring(2,15),gu=a=>{let u=Ci();for(;u.length<a;)u+=Ci();return u.substring(0,a)},td=()=>{const a=document.getElementById(ks.NAV_ROOT);return a?!!a.dataset.featureClientRequestId:!1};function ni(a){return td()&&(a.headers.common["X-Chesscom-Request-Id"]=gu(32)),a}const Ps=a=>(Object.keys(a).forEach(u=>{const c=a[u];typeof c=="boolean"&&(a[u]=Number(c)),typeof c=="object"&&c!==null&&(a[u]=Ps(c))}),a);function _u(a){return!a||mu(a.url)||typeof a.data=="object"&&(a.data=Ps(a.data)),a}var nd=[Jc,ni,_u];const bu=Ri().create(),oa=[/api\.iterable\.com/];function rd(a){var u;if(oa.some(p=>p.test(a.requestUrl)))return;const c={ip:window.context.ip,error:{message:a.message,method:a.method,requestHost:(u=a.requestHost)!=null?u:window.location.hostname,requestUrl:a.requestUrl,stack:a.stack,status:a.status,type:"HTTP_REQUEST"},user:window.context.user?{countryCode:window.context.user.country.code,id:window.context.user.id,membershipCode:window.context.user.membershipCode,membershipLevel:window.context.user.membershipLevel,timezone:window.context.user.timezone,username:window.context.user.username}:{},userAgent:window.navigator.userAgent};id(c)}function id(a){window.chesscom.features.includes("client_metrics_error_reporting")&&bu.post(`${window.chesscom.clientMetricsDomain}/error-reporting/web`,a)}function yu(a){const u=a.config,c=a.response;if(a.toString()==="Cancel")return Promise.reject(a);try{u.data=JSON.parse(u.data)}catch{return Promise.reject(a)}if(c&&c.status===403&&c.headers["x-chesscom-csrf-token"]&&u&&!u.data.retry){const p=c.headers["x-chesscom-csrf-token"];return u.data._token=p,u.data.retry=!0,window.context.csrf.token=p,fl(u)}if(c?.status>=400)try{rd({message:a.message,method:a.config.method,requestUrl:a.config.url.replace("https://www.chess.com"),stack:a.stack,status:a.response.status})}catch{}return Promise.reject(a)}async function Eu(){return sr.e(6048).then(sr.bind(sr,26048))}async function od(){try{return!!(await Eu()).getCurrentHub().getClient()}catch{return!1}}async function Ts(a){if(!await od())return;(await Eu()).configureScope(c=>{Object.keys(a).forEach(p=>{c.setExtra(p,a[p])})})}const ad=({key:a,value:u})=>{window.chesscom||(window.chesscom={}),window.chesscom[a]||(window.chesscom[a]=u)},Ro=()=>{ad({key:"logData",value:{}})},hl=({key:a,value:u})=>{Ro(),window.chesscom.logData[a]=u,Ts({[a]:u})},sd=({key:a,value:u})=>{Ro();const c=window.chesscom.logData[a]||[];Array.isArray(c)?window.chesscom.logData[a]=[...c,u]:window.chesscom.logData[a]=[c,u]},Fh=()=>{Ro(),window.chesscom.logData={}};function pl(a){return a.headers&&a.headers["x-chesscom-request-id-cdn"]&&(hl({key:"x-chesscom-request-id-cdn",value:a.headers["x-chesscom-request-id-cdn"]}),hl({key:"x-chesscom-request-id-lb",value:a.headers["x-chesscom-request-id-lb"]})),a}function Au(a,u){var c;if(!u.name)throw new Error("interceptor must be a named function");return(c=a.handlers)==null?void 0:c.find(p=>{var _;return((_=p.fulfilled)==null?void 0:_.name)===u.name})}function ld(a){nd.forEach(u=>{Au(a.interceptors.request,u)||a.interceptors.request.use(u)}),Au(a.interceptors.response,pl)||a.interceptors.response.use(pl,yu)}ld(fl);var wu=fl;const Ms={},xs={};async function ud(a){var u;const p=await wu.get(Mi.generate(a));return Ms[a]=p,(u=xs[a])==null||u.forEach(_=>_(Ms[a])),p}function Uh(a,u){xs[a]=xs[a]||[],xs[a].push(u),Ms[a]&&u(Ms[a])}async function cd(){const a=dl();if(window.chesscom.features.includes("settings_service_read")){const Rr=await Xa(["board.animation_type","board.coordinates","board.show_legal_moves","board.highlight_moves","board.white_always_on_bottom","board.move_list_style","board.move_method","board.play_sounds","gameplay.show_timestamps"]);return{animationType:Si(Rr["board.animation_type"]),boardSize:"auto",coordinates:Rr["board.coordinates"],darkMode:a,highlightLegalMoves:Rr["board.show_legal_moves"],highlightMoves:Rr["board.highlight_moves"],isWhiteOnBottom:Rr["board.white_always_on_bottom"],moveListDisplayType:Rr["board.move_list_style"],moveMethod:ao(Rr["board.move_method"]),playSounds:Rr["board.play_sounds"],showTimestamps:Rr["gameplay.show_timestamps"]}}const{data:u}=await ud("web_user_callback_get_board_settings"),{animationType:c,boardCoords:p,boardSize:_,colorScheme:A,highlightLegalMoves:V,highlightMoves:ue,isWhiteOnBottom:re,moveListDisplayType:wt,moveMethod:On,pieceStyle:vn,playSounds:qn,soundTheme:wn,showTimestamps:Bt}=u;return{animationType:Si(c),boardSize:_,boardStyle:A,coordinates:Yi(p),darkMode:a,highlightLegalMoves:V==="1",highlightMoves:ue==="1",isWhiteOnBottom:re,moveListDisplayType:wt,moveMethod:On,pieceStyle:vn,playSounds:qn==="1",soundTheme:wn,showTimestamps:!!Bt}}const ml={animationType:"web_user_game_settings_email_callback_animation_type",boardStyle:"web_user_game_settings_email_callback_board_color",coordinates:"web_user_game_settings_email_callback_coordinates",darkMode:"web_user_game_settings_callback_dark_mode_toggle",highlightLegalMoves:"web_user_game_settings_email_callback_show_legal_moves_toggle",highlightMoves:"web_user_game_settings_email_callback_highlight_last_move_toggle",isWhiteOnBottom:"web_user_game_settings_email_callback_is_white_on_bottom_toggle",moveListDisplayType:"web_user_game_settings_email_callback_move_list_display_type",moveMethod:"web_user_game_settings_email_callback_move_method",pieceStyle:"web_user_game_settings_email_callback_piece",playSounds:"web_user_game_settings_email_callback_sound_toggle",showTimestamps:"web_user_game_settings_email_callback_show_timestamps",soundTheme:"web_user_game_settings_email_callback_sound_theme"},dd=(a,u)=>[a,vl(a,u)],vl=(a,u)=>{switch(a){case"coordinates":return gl(u);default:return u}},gl=a=>["off","inside","outside"].includes(a)?["off","inside","outside"].indexOf(a):a;async function fd(a,u){if(!ml[a])throw new Error(`${a} is not a valid board option`);const[c,p]=dd(a,u);await wu.post(Mi.generate(ml[c]),{action:p})}async function Su(a){window.chesscom.features.includes("settings_service_data_sync")&&Object.keys(a).length>0&&await zr.publish({method:"post",service:Aa.Settings,path:"users/me",data:a})}const hd={getOptions:"web_user_callback_get_board_settings",getStyles:"web_themes_data_callback",updateOption:ml},yo=.3,Hh=525,Gh={pieces:["real3d"],animations:["arcade","natural"]};var Vh=sr(95653),ei=sr(12117),pd=Object.defineProperty,md=Object.defineProperties,vd=Object.getOwnPropertyDescriptors,Cu=Object.getOwnPropertySymbols,Sa=Object.prototype.hasOwnProperty,gd=Object.prototype.propertyIsEnumerable,ku=(a,u,c)=>u in a?pd(a,u,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[u]=c,Ca=(a,u)=>{for(var c in u||(u={}))Sa.call(u,c)&&ku(a,c,u[c]);if(Cu)for(var c of Cu(u))gd.call(u,c)&&ku(a,c,u[c]);return a},ka=(a,u)=>md(a,vd(u));function _d(a){return a===!0||a===!1}function bd(a,u,c){return a.reduce((p,_)=>{const A=u.classList.contains(ei.aX.Pseudo3d),V=(0,ei.aY)(_,A?":after":void 0),ue=(0,ei.aZ)(V,c),{file:re,rank:wt}=(0,ei.a_)(_.dataset.testSquare);return!ue||!re||!wt||(p[8-wt][re-1]=ue),p},[[".",".",".",".",".",".",".","."],[".",".",".",".",".",".",".","."],[".",".",".",".",".",".",".","."],[".",".",".",".",".",".",".","."],[".",".",".",".",".",".",".","."],[".",".",".",".",".",".",".","."],[".",".",".",".",".",".",".","."],[".",".",".",".",".",".",".","."]]).map(p=>p.join("").replace(/(\.+)/g,_=>_.length.toString())).join("/")}function Pu(a,u,c){return new Cypress.Promise(p=>{const _=u.getBoundingClientRect();let A,V;const ue=(_.right-_.left)/8,re=(0,ei.a_)(a);c&&(re.file=9-re.file,re.rank=9-re.rank),re!==null?(A=(re.file-1)*ue+ue/2,V=(9-re.rank)*ue-ue/2):(A=-1,V=-1),p({x:A,y:V})})}function yd({color:a,opacity:u,options:c}){return a==="#ffff00"&&u===c.highlightOpacity?"default":a===c.premoveHighlightColor&&u===c.premoveHighlightOpacity?"premove":a===c.analysisHighlightColors.alt&&u===c.analysisHighlightOpacity?"altAnalysis":a===c.analysisHighlightColors.default&&u===c.analysisHighlightOpacity?"defaultAnalysis":a===c.analysisHighlightColors.shift&&u===c.analysisHighlightOpacity?"shiftAnalysis":a===c.analysisHighlightColors.ctrl&&u===c.analysisHighlightOpacity?"ctrlAnalysis":a&&u?{color:a,opacity:u}:null}function Ed(a){return a.substring(1)}function Ad({boardRect:a,elRect:u,flipped:c=!1}){const p=a.width/8,_=(u.left-a.left)/p+1,A=(u.top-a.top)/p+1;return c?(0,ei.a$)({file:9-_,rank:A}):(0,ei.a$)({file:_,rank:9-A})}function Ja(a,u){cy.get(u).should(c=>{a?expect(c[0]).to.exist:expect(c[0]).to.not.exist})}function es({event:a,options:u={},data:c={},pointerCoordsFn:p}){const{eventName:_,which:A}=Vo(a);if(A&&Object.assign(u,{which:A}),c.keyPressed&&Object.assign(u,{[`${c.keyPressed}Key`]:!0}),c.deltaY&&Object.assign(u,{deltaY:c.deltaY}),c.el){const V=c.position||"center";c.withText?cy.get(c.el).contains(c.withText).first().trigger(_,V,u):cy.get(c.el).first().trigger(_,V,u)}else if(typeof c.square<"u"&&c.square===null)cy.wait(0),cy.document().trigger(_,1,1,u);else{const{board:V,flipped:ue}=u;cy.getBoard(V).then(re=>{c.coords?cy.getBoard(V).trigger(_,c.coords.x,c.coords.y,u):typeof c.square<"u"?p(c.square,re[0],ue).then(wt=>{cy.getBoard(V).trigger(_,wt.x,wt.y,u)}):c.deltaY&&c.forced?cy.getBoard(V).trigger(_,ka(Ca({},u),{force:!0})):cy.getBoard(V).trigger(_,u)})}}function Vo(a){return a==="Pointermove"?{eventName:"pointermove"}:a==="PointerdownLeft"?{eventName:"pointerdown",which:0}:a==="PointerdownMiddle"?{eventName:"pointerdown",which:2}:a==="PointerdownRight"?{eventName:"pointerdown",which:3}:a==="MousedownLeft"?{eventName:"mousedown",which:0}:a==="MousedownRight"?{eventName:"mousedown",which:3}:a==="Pointerup"?{eventName:"pointerup"}:a==="DoubleClick"?{eventName:"dblclick"}:a==="Wheel"?{eventName:"wheel"}:{eventName:a}}function Tu(a){switch(a){case"true":return!0;case"false":return!1;default:return a}}const wd={bp:"p",bb:"b",bn:"n",br:"r",bq:"q",bk:"k",wp:"P",wb:"B",wn:"N",wr:"R",wq:"Q",wk:"K"},Sd={p:"bp",b:"bb",n:"bn",r:"br",q:"bq",k:"bk",P:"wp",B:"wb",N:"wn",R:"wr",Q:"wq",K:"wk"},Cd={"8_bit":"#ffff00",bases:"#f5cc2a",blackwhite:"#5b91b3",blue:"#00a5ff",brown:"#ffff00",bubblegum:"#de5d6f",burled_wood:"#ee9016",dark_wood:"#cc9122",dash:"#eca722",default:"#ffff00",glass:"#5b91b3",graffiti:"#f39011",green:"#ffff00",grey:"#a4b8c4",icy_sea:"#5ed7f1",light:"#a4b8c4",lolz:"#a3becd",marble:"#f0db86",marbleblue:"#65daf7",marblebrown:"#f39011",marblegreen:"#f0db86",metal:"#a3becd",natural:"#f0e464",nature:"#eef396",neon:"#6d90a6",newspaper:"#99976e",orange:"#ffff00",overlay:"#0d9acf",parchment:"#d8cc66",pink:"#de5d6f",purple:"#7dacc9",red:"#f8f893",sand:"#e2bc87",sky:"#65daf7",stone:"#36525f",tan:"#f7d84a",tournament:"#a4c25b",translucent:"#5b91b3",walnut:"#d1a52d",winboard:"#a4c25b",wood:"#cc9122",wooddark:"#ee9016",woodlight:"#d8cc66",woodmid:"#cc9122",woodolive:"#a3becd"};var kd=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",highlights:Cd}),zh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",booleanArgumentPassed:_d,config:kd,getBoardPosition:bd,getCoordsFromSquare:Pu,getElementBackgroundImage:ei.aY,getFileRankFromSan:ei.a_,getHighlightType:yd,getPieceShortStringFromUrl:ei.aZ,getSanFromFileRank:ei.a$,getSelectorName:Ed,getSquareFromRects:Ad,pieceNameToTestShortString:wd,rgbToHex:ei.r,shouldExist:Ja,testShortStringToPieceName:Sd,triggerEvent:es,trueFalseToBoolean:Tu});function Pd(a){return a.api.extendAPI("siblingGame",{siblingGame:function(c){return createAPI({game:c.game.siblingGame,options:{}})}})}function jh(){let a;return{create:u,destroy:A,match:[{condition:isOneOf([Core.APIEvents.CreateGame,Core.APIEvents.Load]),handler:c}],apiOverrides:{isAtEndOfLine:V=>{const ue=V.api.isAtEndOfLine;return()=>V.api.siblingGame?ue()&&V.api.siblingGame.isAtEndOfLine():ue()},selectNode:{handler:V=>function(re){const{game:wt,api:On}=V;return On.siblingGame&&(wt.selectBughouseMove(wt.moveDetails().bughouseOrder),On.siblingGame.reload()),re},run:"after"}},name:BughouseAPI.Plugin.Name};function u(V){V.api.getVariant()===Game.Variants.Bughouse&&p(V)}function c(V,ue){a?.(),ue.api.getVariant()===Game.Variants.Bughouse&&p(ue)}function p(V){a=Pd(V),_(V);const{siblingGame:ue,getContext:re}=V.api,{respond:wt}=re();ue.onMany(positionChangeEvents,()=>wt(HandPieces.Events.SetHand))}function _(V){V.api.siblingGame.overrideAPI(BughouseAPI.Plugin.Name,{move:ue=>{const{move:re,getContext:wt}=ue.api,On=re,vn=handleMoveOnPreviousNodeFactory(wt());return qn=>(vn(),On(qn))}})}function A(){a?.()}}var qh=`.sibling-board {
  background-size: 100%;
  display: block;
  height: 0;
  padding-bottom: 100%;
  position: relative;
  width: 100%;
}

.sibling-board.board {
  height: auto;
  margin-left: 10%;
  padding-bottom: 90%;
  width: 90%;
}
.sibling-board.board.board-webgl-3d {
  margin-left: 7.5%;
  padding-bottom: 69.369%;
  width: 92.5%;
}
.sibling-board.board.board-webgl-3d canvas, .sibling-board.board.board-webgl-2d canvas {
  position: absolute;
}`;function Td(a){return[...createStandardPlugins().filter(c=>!a.includes(c.name)),createHandPiecesPlugin({replaceContainer:!1})]}const Md=[ei.b8.Plugin.Name,ei.b9.Plugin.Name];function xd({context:a,el:u,mainBoardRenderer:c}){const p=a.api.getOptions(),_=ka(Ca({},p),{flipped:!p.flipped,id:`${p.id}-sibling`});u.classList.add("board");const A=c.createRenderer(ka(Ca({},c.getRendererOptions()),{containerEl:u,el:u,options:_,testElement:TestElements.SiblingBoard}));return createGame({api:a.api.siblingGame,el:u,mode:create(),options:_,plugins:Td(Md),renderer:A})}function Wh(a){let u,c;return{create:p,destroy:V,match:[{condition:isOneOf([Core.APIEvents.Load,Core.APIEvents.CreateGame,Core.InstanceEvents.RendererSet]),handler:_},{condition:isOneOf(positionChangeEvents),handler:re},{condition:is(Core.OptionsEvents.Update),handler:wt},{condition:is(Core.UIEvents.Resize),handler:A}],name:BughouseSiblingBoard.Plugin.Name};function p(vn){vn.api.siblingGame&&(ue(vn),re())}function _(vn,qn){p(qn)}function A(){clearTimeout(c),c=setTimeout(()=>{var vn;(vn=u?.resize)==null||vn.call(u)},10)}function V(){On()}function ue(vn){const{renderer:qn}=vn;qn&&(On(),u=xd({context:vn,el:a,mainBoardRenderer:qn}),u.resize())}function re(){if(!u)return;const{respond:vn}=u.getContext();vn(Core.APIEvents.SetBoardPosition,{pieces:u.getPieces()}),vn(HandPieces.Events.SetHand)}function wt({data:vn}){vn.flipped!==void 0&&u?.setOptions({flipped:!vn.flipped})}function On(){var vn;(vn=u?.destroy)==null||vn.call(u)}}function Id({timers:a}){let u=!0;return Ca({activate:c,deactivate:p,isActive:_,resetClocks:A,stopClocks:V},a);function c(){u=!0}function p(){u=!1}function _(){return u}function A(ue){const{baseTime:re}=ue;a[Game.ColorsAsNumbers.Black].reset(re),a[Game.ColorsAsNumbers.White].reset(re)}function V(){a[Game.ColorsAsNumbers.Black].stop(),a[Game.ColorsAsNumbers.White].stop()}}function Rd(a,u){const c=[Game.ColorsAsNumbers.Black,Game.ColorsAsNumbers.White].reduce((_,A)=>{return a[A].on(Timer.Events.End,p),_.push(V),_;function V(){a[A].off({handler:p,type:Timer.Events.End})}},[]);return function(){c.forEach(A=>A())};function p(_){_.color&&u.outOfTime(_.color)}}function Mu(a){return createStateMachine({initialState:Timer.States.Initial,states:{[Timer.States.Ended]:{[Timer.Actions.Reset]:u},[Timer.States.Going]:{[Timer.Actions.Reset]:u,[Timer.Actions.Stop]:()=>(a.timeSpent=Date.now()-a.startTimestamp,Timer.States.Stopped),[Timer.Actions.Tick]:()=>(a.timeSpent=Date.now()-a.startTimestamp,a.currentTime=a.resetTime-a.timeSpent,a.currentTime<=0?Timer.States.Ended:Timer.States.Going)},[Timer.States.Initial]:{[Timer.Actions.Reset]:u,[Timer.Actions.Start]:()=>(a.startTimestamp=Date.now(),Timer.States.Going)},[Timer.States.Stopped]:{[Timer.Actions.Reset]:u,[Timer.Actions.Start]:()=>(a.startTimestamp=Date.now()-a.timeSpent,Timer.States.Going)}}});function u(c){return Object.assign(a,{currentTime:c,resetTime:c,timeSpent:0}),Timer.States.Initial}}const _l=1e3,Od=100;function xu({color:a,decisecondThreshold:u=_l*20,emitter:c=createEventEmitter(),initialTime:p,interval:_=_l}={}){const A={color:a,currentTime:p||0,lastTickTimestamp:0,resetTime:p||0,startTimestamp:0,state:Timer.States.Initial,timeSpent:0},V=Mu(A);return V.on(StateMachine.Event.Types.OnEnter,vn),V.on(StateMachine.Event.Types.OnReEnter,qn),ka(Ca({},c),{add:ue,destroy:wt,get:On,reset:wn,start:Rr,stop:Vi});function ue(gt){A.startTimestamp-=gt,A.timeSpent-=gt,A.currentTime+=gt,re(Timer.Events.TimeAdded)}function re(gt){c.emit(gt,ka(Ca({},On()),{type:gt}))}function wt(){V.off({handler:vn,type:StateMachine.Event.Types.OnEnter}),V.off({handler:qn,type:StateMachine.Event.Types.OnReEnter})}function On(){return V.getCurrentState()===Timer.States.Going&&(A.timeSpent=A.startTimestamp?Date.now()-A.startTimestamp:0),A.currentTime=A.resetTime-A.timeSpent,A}function vn(gt){let Or;switch(gt.nextState){case Timer.States.Ended:Or=Timer.Events.End;break;case Timer.States.Going:Bt(),Or=Timer.Events.Start;break;case Timer.States.Initial:Or=Timer.Events.Reset;break;case Timer.States.Stopped:Or=Timer.Events.Stop;break}A.state=gt.nextState,Or&&re(Or)}function qn(gt){let Or;switch(gt.nextState){case Timer.States.Going:Bt(),Or=Timer.Events.Tick;break;case Timer.States.Initial:Or=Timer.Events.Reset;break;case Timer.States.Stopped:break}Or&&re(Or)}function wn(gt){V.transition(Timer.Actions.Stop),V.transition(Timer.Actions.Reset,gt||A.resetTime)}function Bt(){const gt=Math.round(A.currentTime/_)*_;u&&gt<=u?setTimeout(()=>{V.transition(Timer.Actions.Tick)},Od):setTimeout(()=>{V.transition(Timer.Actions.Tick)},_)}function Rr(){V.transition(Timer.Actions.Start)}function Vi(){V.transition(Timer.Actions.Stop)}}function Nd(a){return{[Game.ColorsAsNumbers.White]:xu({color:Game.ColorsAsNumbers.White,initialTime:a.baseTime}),[Game.ColorsAsNumbers.Black]:xu({color:Game.ColorsAsNumbers.Black,initialTime:a.baseTime})}}function tt(a){const u=a.api.load;return function(p){const{api:_}=a,A=_.getHeaders().TimeControl,V=u(p);return _.setGameDetails({TimeControl:A}),V}}function Pa(){return function(u){const c=u.api.move;return function(_){const{api:A}=u,V=A.timeControl.get();if(!A.clocks.isActive()||!V)return c(_);const{clock:ue,moveTime:re,increment:wt}=getClockTime(A);_.time=re;const On=c(_);return wt&&On?.type===Core.APIEvents.Move&&ue.add(wt),On}}}function ts(){const a=Nd(DEFAULT_TIME_CONTROL);let u;return{api:()=>Id({timers:a}),apiOverrides:{load:tt,move:Pa()},create:p,destroy:_,match:[{condition:is(Core.APIEvents.Move),handler:c},{condition:V,handler:A}],name:Clocks.Plugin.Name};function c(ue,re){const{api:wt,queue:On}=re,vn=ue.data.move,{color:qn}=vn;if(!wt.timeControl.get()||!wt.clocks.isActive())return;const{clock:Bt,increment:Rr}=getClockTime(wt,qn);ue.data.consumedPremove&&Rr&&On.add(Bt.add,Rr),wt.clocks[qn].stop(),wt.clocks[getOppositeColor(qn)].start()}function p(ue){const{api:re}=ue;u=Rd(a,re)}function _(){u()}function A(ue,re){const{api:wt}=re,On=wt.timeControl.get();On?wt.clocks.resetClocks(On):wt.clocks.stopClocks()}function V(ue){return is(Core.APIEvents.UpdatePGNHeaders)(ue)&&ue.data.TimeControl}}function Eo(a){let u=StateMachine$1.States.Idle,c,p={droppedFramesByState:{all:0},totalFramesByState:{all:0},totalTimeByState:{all:0}};return{startRecording:_,stopRecording:A,getMetrics:V,clearMetrics:ue,setBoardState:re};function _(wt=100){let On=performance.now(),vn=wt;c=requestAnimationFrame(qn);function qn(wn){const Bt=wn-On;if(On=wn,Bt>1e3){c=requestAnimationFrame(qn);return}if(p.totalFramesByState[u]||(p.totalFramesByState[u]=0,p.totalTimeByState[u]=0,p.droppedFramesByState[u]=0),p.totalFramesByState.all+=1,p.totalFramesByState[u]+=1,p.totalTimeByState.all+=Bt,p.totalTimeByState[u]+=Bt,vn>=1){vn--,c=requestAnimationFrame(qn);return}Bt>p.totalTimeByState.all/p.totalFramesByState.all+1&&(p.droppedFramesByState.all+=1,p.droppedFramesByState[u]+=1),c=requestAnimationFrame(qn)}}function A(){return cancelAnimationFrame(c),p}function V(){return p}function ue(){p={droppedFramesByState:{all:0},totalFramesByState:{all:0},totalTimeByState:{all:0}}}function re(wt){u=wt}}function Ld(){return{name:PerformanceMetrics.Plugin.Name,api:Eo,match:[{condition:isOneOf([Core.UserEvents.MousedownLeft,Core.UserEvents.MousedownRight,Core.UserEvents.PointerdownRight,Core.UserEvents.PointerdownLeft,Core.UserEvents.Pointerup]),handler:a}]};function a(u,c){c.api[PerformanceMetrics.Plugin.Name].setBoardState(c.state.get().machineState)}}function Dd(){let a,u;return{create:c,match:[{condition:is(Core.InstanceEvents.RendererSet),handler:V},{condition:is(Core.OptionsEvents.Update),handler:ue}],destroy:_,name:ScrollThroughMoves.Plugin.Name};function c(re){const{api:wt,el:On}=re;u=On,p(!1),a||(a=A(wt)),p(re.options.enabled)}function p(re){re?u.addEventListener("wheel",a):u.removeEventListener("wheel",a)}function _(){p(!1)}function A(re){return function(On){On.preventDefault(),On.deltaY<0?re.moveBackward():re.moveForward()}}function V(re,wt){c(wt)}function ue(re){"enabled"in re.data&&p(re.data.enabled)}}function zo(a){return Object.keys(a).filter(u=>["pins","undefended","underdefended"].includes(u)).reduce((u,c)=>(u.push(...a[c]||[]),u),[]).map(u=>u.slice(-2))}function Iu(a){const u=a.game.threats;let c=!0,p=null;return{enable:On(_),getAsArray:A,getAsObject:V,isEnabled:ue,isShowingThreatsCreatedByColor:wt,onlyShowThreatsCreatedByColor:On(re)};function _(vn=!0){c=vn}function A(){return zo(u())}function V(){return u()}function ue(){return c}function re(vn){p=vn}function wt(vn){return p===vn||p===null}function On(vn){return function(...wn){vn(...wn),a.respond(Threats.Events.Updated)}}}function Ru(a,u){const{api:c,options:p}=u;return!c.threats||!c.threats.isEnabled()||!c.threats.isShowingThreatsCreatedByColor(getOppositeColor(c.getTurn()))?[]:c.threats.getAsArray().map(_=>{if(_)return createKeyedHighlight({color:p.threatSquareColor,opacity:p.threatSquareOpacity,square:_,type:"threat"})})}function Kh(){return{api:Iu,create:u,destroy:c,match:[{condition:is(Core.InstanceEvents.ModeChanged),handler:p}],name:Threats.Plugin.Name};function a(_){var A;(A=_.highlights)==null||A.addModule(Ru)}function u(_){a(_.api)}function c(_){var A;const{api:V}=_;(A=V.highlights)==null||A.removeModule(Ru)}function p(_,A){a(A.api)}}function Bd(a,u){return Object.entries(a).every(([p,_])=>{const A=u[p];return _.type===A.type&&_.color===A.color})&&Object.keys(a).length===Object.keys(u).length}function $h(){return{afterRender:!0,match:[{condition:a,handler:u}],name:Validate.Plugin.Name};function a(c){return isOneOf([...Object.values(Core.APIEvents),...Object.values(Core.InstanceEvents),...Object.values(Core.OptionsEvents)])(c)}function u(c,p){const{api:_,renderer:A}=p;if(!A)return;const V=A.getPieces(),ue=_.getPieces().getCollection();Bd(V,ue)||_.logger.log({code:Validate.ErrorCodes.InvalidPosition,data:{APIPieces:ue,boardPieces:V},level:Logger.Levels.Error,message:Validate.ErrorMessages.InvalidPosition})}}const Zh={config:{perspective:ei.a0.Perspective.TOP_DOWN},board:{assets:{background:"https://www.chess.com/boards/green/150.png"},config:{highlightSquareHex:"#ffff00",darkSquareCoordinateHex:"#edeed1",lightSquareCoordinateHex:"#779952"}},pieces:{assets:ei.a4},sound:{assets:{capture:{webm:"https://www.chess.com/sounds/_WEBM_/default/capture.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/capture.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/capture.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/capture.wav"},castle:{webm:"https://www.chess.com/sounds/_WEBM_/default/castle.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/castle.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/castle.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/castle.wav"},gameEnd:{webm:"https://www.chess.com/sounds/_WEBM_/default/game-end.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/game-end.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/game-end.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/game-end.wav"},gameStart:{webm:"https://www.chess.com/sounds/_WEBM_/default/game-start.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/game-start.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/game-start.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/game-start.wav"},illegal:{webm:"https://www.chess.com/sounds/_WEBM_/default/illegal.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/illegal.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/illegal.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/illegal.wav"},moveCheck:{webm:"https://www.chess.com/sounds/_WEBM_/default/move-check.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/move-check.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/move-check.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/move-check.wav"},moveOpponent:{webm:"https://www.chess.com/sounds/_WEBM_/default/move-opponent.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/move-opponent.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/move-opponent.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/move-opponent.wav"},moveSelf:{webm:"https://www.chess.com/sounds/_WEBM_/default/move-self.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/move-self.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/move-self.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/move-self.wav"},notify:{webm:"https://www.chess.com/sounds/_WEBM_/default/notify.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/notify.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/notify.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/notify.wav"},premove:{webm:"https://www.chess.com/sounds/_WEBM_/default/premove.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/premove.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/premove.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/premove.wav"},promote:{webm:"https://www.chess.com/sounds/_WEBM_/default/promote.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/promote.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/promote.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/promote.wav"},tenSeconds:{webm:"https://www.chess.com/sounds/_WEBM_/default/tenseconds.webm",mp3:"https://www.chess.com/sounds/_MP3_/default/tenseconds.mp3",ogg:"https://www.chess.com/sounds/_OGG_/default/tenseconds.ogg",wav:"https://www.chess.com/sounds/_WAV_/default/tenseconds.wav"}}}};function Fd(a){return positionChangeEvents.includes(a.type)}function Ou(a){const u=Object.keys(ei.bq).sort((_,A)=>A.length-_.length),c=new Set(ei.br);let p=a;return u.forEach(_=>{var A,V;const ue=_==="N",re=`[^=]\\${(A=ei.bs[_])!=null?A:_}`,wt=ue?re:`\\${(V=ei.bs[_])!=null?V:_}`,On=c.has(_)||ue?` ${ei.bq[_]}`:ei.bq[_];p=p.replace(new RegExp(wt,"gm"),On)}),p}function Yh(a){if(!a)return"";const u=a.lastIndexOf('"]')+2,c=a.slice(0,u).trim(),p=a.slice(u).trim();return`${c}

${Ou(p)}`}function Xh(a,u){const c=Object.values(a).map(p=>p.name);return u.reduce((p,_)=>{const A=c.indexOf(_.name);return A>-1?p.splice(A,1,_):p.push(_),p},a)}var Ud={getDefaultOptions:()=>({allowMarkings:!0,animationType:ei.B.Animation.Types.Default,autoPromote:!1,boardStyle:"green",captureKeyStrokes:!0,coordinates:ei.B.CoordinatesPositions.Inside,darkMode:Yc,diagramStyle:!0,enabled:!0,highlightColor:"#f8f893",highlightLegalMoves:!1,highlightMoves:!0,highlightOpacity:.5,isWhiteOnBottom:!1,legalPositionCheck:"full",moveMethod:ei.B.MoveMethods.Drag,overlayInAnalysisMode:!0,pieceStyle:"neo",playSounds:!0,premoveHighlightColor:"#f42a32",premoveHighlightOpacity:.5,real3D:!1,rounded:!0,soundTheme:"default",showTimestamps:!1}),getOptions:()=>cd(),getStyles:()=>Ri().get(Mi.generate(hd.getStyles)).then(a=>a.data),updateOption:(a,u)=>(window.chesscom.features.includes("settings_service_data_sync")&&Su(ol({[a]:u})),fd(a,u))};const bl={arrows:[],squares:[],customItems:[],board:{files:8,ranks:8,size:0,squareSize:0,boardBg:null,pieceBaseBg:null,highlightColor:null},busy:!1,busyFlagTimeout:null,draggingPiece:null,drawingArrow:!1,drawingArrowFrom:null,movedPiece:null,gameSettings:{},legalMoves:[],isCheck:!1,isCheckmate:!1,markedSquareColors:{alt:"#0098c8",default:"#f42a32",shift:"#75bb37",ctrl:"#75bb37"},markedSquareOpacity:.9,options:Ud.getDefaultOptions(),pieces:[],previousPieces:[],premoves:[],preselectedPiece:null,promotion:{from:null,piece:null,to:null},selectedNode:void 0,selectedPiece:null,analysisMode:!1,sideToMove:1,playingAs:null,preventNextSelect:!1},Nu=({dispatch:a,state:u})=>{const{busy:c,busyFlagTimeout:p,movedPiece:_,promotion:A}=bl;u=Object.assign(u,{busy:c,busyFlagTimeout:p,movedPiece:_,promotion:{...A}}),a(Zt.DESELECT_PIECE),a(Zt.DROP_PIECE)};let yl;const Hd=({dispatch:a,emit:u},c)=>{clearTimeout(yl),a(Zt.SET_BOARD_DIMENSIONS,c),yl=setTimeout(()=>{u(z.UPDATE_BOARD_IMAGE),u(z.UPDATE_PIECE_IMAGES)},300)},Gd=({dispatch:a,emit:u,state:c},p)=>{if(!c.options.enabled)return null;if(c.draggingPiece){c.busyFlagTimeout=setTimeout(()=>{c.busyFlagTimeout=null,a(Zt.SET_BUSY_FLAG,!1)},100),u(k.PIECE_DROPPED,{state:c,draggingPiece:c.draggingPiece,fileRank:{file:c.draggingPiece.file,rank:c.draggingPiece.rank}}),c.draggingPiece=null;return}if(c.selectedPiece&&c.promotion.from!==null)return ur({emit:u,state:c}),null;if(c.gameSettings.premoves&&c.premoves.length)return u(k.CANCEL_PREMOVES),null;if(c.gameSettings.GTM&&c.premoves.length)return u(k.CANCEL_GTM),null;if(!It(p,c.board.files,c.board.ranks))return null;if(c.options.allowMarkings){const _={file:p.file,rank:p.rank,color:c.markedSquareColors[p.key],opacity:c.markedSquareOpacity,userGenerated:!0};c.squares&&c.squares.find(A=>je(A,_))?a(Zt.CLEAR_SQUARE,_):a(Zt.MARK_SQUARE,_)}return!0},Vd=({emit:a,state:u,dispatch:c},p)=>{const _=p.piece;if(!It(_,u.board.files,u.board.ranks))return null;u.selectedPiece={..._},c(Zt.UPDATE_SELECTED_PIECE_SQUARE),u.options.highlightLegalMoves&&a(z.ADD_LEGAL_MOVES,u.legalMoves.filter(A=>A.from===ln(_)).map(A=>v(A.to))),a(k.PIECE_SELECTED,p)},zd=({dispatch:a,emit:u,state:c},p)=>{if(!Et(p))return null;if(c.promotion.piece=p,c.promotion.from){const _=c.pieces.findIndex(A=>A.key===c.promotion.from.key);c.pieces.splice(_,1)}u(z.CLOSE_PROMOTION_MENU),u(z.REMOVE_LEGAL_MOVES),a(Zt.MAKE_MOVE,c.promotion.to)},ns=({dispatch:a,emit:u,state:c},{height:p,width:_,aspectRatio:A=1})=>{const V=_/A<p,ue=V?_:p*A,re=V?_/A:p,wt=Math.min(ue,re),On=Math.floor(wt/c.board.files),vn=A>1?_:On*c.board.files;c.board={...c.board,size:vn,squareSize:On},a(Zt.UPDATE_BOARD_IMAGE_STATE),u(z.UPDATE_BOARD_SIZE),u(z.UPDATE_PIECE_SIZES),u(z.UPDATE_PROMOTION_MENU_SIZE),u(k.BOARD_DIMENSIONS_SET)},jd=({emit:a,state:u},c)=>{c!==u.busy&&(u.busy=c,a(k.BUSY_FLAG,u.busy))},Is=({emit:a,state:u},c)=>{const p=(c||[]).filter(_=>_).map(_=>({id:ae(),file:_.file,rank:_.rank,color:_.isPremove?u.options.premoveHighlightColor:_.color||u.options.highlightColor,opacity:_.isPremove?u.options.premoveHighlightOpacity:u.options.highlightOpacity,playerColor:u.sideToMove===1?2:1}));a(z.REMOVE_SQUARES,{type:ve.MOVE}),a(z.ADD_SQUARES,{moveSquares:p,type:ve.MOVE})},qd=a=>a==null||Fe[a]==null?Fe.default:Fe[a],El=a=>w[a]?w[a]:{imgPath:a,imgFormat:".png"},so=()=>window.devicePixelRatio>1,jo=new Array(76).join().split(",").map((a,u)=>u*2).slice(22),Rs=a=>{const u=so()?a*2:a;return jo.reduceRight((c,p)=>p===u||p>u?p:c)},Wd=(a,u)=>{const c=qd(a),p=Rs(u);return`${Ge.paths.boards}/${c[2]}/${p}${c[3]}`},Qh=(a,u)=>{const c=El(a),p=Rs(u);return`${config.paths.pieces}/${c.imgPath}/${p}/`},Kd=(a,u)=>{const c=El(a!=="real3d"?a:"neo"),p=Rs(u);return`${Ge.paths.pieces}/${c.imgPath}/${p}/`},Gi=a=>{const u="/threecheck/",c=[null,"check_wht","check_blk"];return`${config.paths.variants}/${u}${c[a]}.png`},Jh=a=>`${config.paths.webglData}/${a}/`,e1=a=>{const u=p=>new Promise((_,A)=>{const V=new Image;V.onload=()=>{_(V)},V.onerror=()=>{A(p)},V.onabort=V.onerror,V.src=p}),c=[];return a.forEach(p=>c.push(u(p))),Promise.all(c)},$d=({state:a})=>{a.board={...a.board,boardBg:Wd(a.options.boardStyle,a.board.squareSize),pieceBaseBg:Kd(a.options.pieceStyle,a.board.squareSize)}},t1=({dispatch:a,emit:u,state:c},p)=>{c.gameSettings={...c.gameSettings,...p},a(Zt.UPDATE_BOARD_IMAGE_STATE),u(z.UPDATE_BOARD_IMAGE)},Zd=({emit:a,state:u},{legalMoves:c})=>{if(!Array.isArray(c))return null;u.legalMoves=[...c],a(k.LEGAL_MOVES_UPDATED,u.legalMoves)},Al=({emit:a,dispatch:u,state:c},p)=>{c.arrows=p.arrows?[...p.arrows]:[],c.squares=p.squares?[...p.squares]:[],c.effects=p.effects?[...p.effects]:[],(p.blinkingSquares||[]).forEach(A=>a(z.BLINK_SQUARE,A));const _=c.options.highlightMoves?C(c.selectedNode,c.premoves,c.squares):C({},c.premoves,c.squares);u(Zt.SET_MOVE_SQUARES,_),u(Zt.UPDATE_SELECTED_PIECE_SQUARE),a(z.SET_ARROWS,c.arrows),a(z.SET_EFFECTS,c.effects),a(z.SET_SQUARES,c.squares)},Os=(a,u)=>{const c={};return Object.keys(a).filter(p=>a[p]!==u[p]).forEach(p=>{c[p]=a[p]}),c},qo={addCustomItem:Ie,cancelPromotion:ur,changePosition:en,clearArrow:qt,clearMarkings:Rn,clearSquare:$e,click:yn,deselectPiece:F,droppableDragStart:he,droppableDragEnd:we,dragCancel:Oe,dragMove:y,dragStart:T,dragStop:x,dropPiece:H,keyDown:Gr,makeMove:Ai,markArrow:Ki,markEffect:oo,markSquare:Qr,pointerdown:fi,pointerup:$i,removeCustomItem:ya,resetBoardState:Nu,resizeBoard:Hd,rightClick:Gd,selectPiece:Vd,selectPromotionPiece:zd,setBoardDimensions:ns,setBusyFlag:jd,setMoveSquares:Is,updateBoardImageState:$d,updateGameSettings:t1,updateLegalMoves:Zd,updateMarkings:Al,updateOptions:({dispatch:a,emit:u,state:c},p)=>{const _=Os(p,c.options);if(c.options={...c.options,...p},_.highlightColor?c.options.highlightColor=_.highlightColor:Fe[c.options.boardStyle]&&Fe[c.options.boardStyle].length>=5&&(c.options.highlightColor=Fe[c.options.boardStyle][4]),typeof _.highlightMoves<"u"||typeof _.boardStyle<"u"||typeof _.highlightColor<"u"){const A=c.options.highlightMoves?C(c.selectedNode,c.premoves,c.squares):C({},c.premoves,c.squares);a(Zt.SET_MOVE_SQUARES,A),a(Zt.UPDATE_SELECTED_PIECE_SQUARE)}typeof _.overlayInAnalysisMode<"u"&&u(z.UPDATE_BOARD_IMAGE),typeof _.boardStyle<"u"&&(a(Zt.UPDATE_BOARD_IMAGE_STATE),u(z.UPDATE_BOARD_IMAGE)),typeof _.pieceStyle<"u"&&(a(Zt.UPDATE_BOARD_IMAGE_STATE),u(z.UPDATE_PIECE_IMAGES)),(typeof _.enabled<"u"||typeof _.flipBoard<"u"||typeof _.rounded<"u")&&u(z.UPDATE_BOARD_CLASSES,p),typeof _.flipBoard<"u"&&u(z.FLIP_BOARD),c.options.autoPromote===!0&&c.promotion.piece!==null&&c.promotion.piece!=="q"&&a(Zt.SELECT_PROMOTION_PIECE,"q"),u(k.OPTIONS_CHANGED,_)},updateSelectedPieceSquare:Gn},Zt={ADD_CUSTOM_ITEM:"addCustomItem",CANCEL_PROMOTION:"cancelPromotion",CHANGE_POSITION:"changePosition",CLEAR_ARROW:"clearArrow",CLEAR_MARKINGS:"clearMarkings",CLEAR_SQUARE:"clearSquare",CLICK:"click",DESELECT_PIECE:"deselectPiece",DROPPABLE_DRAG_START:"droppableDragStart",DROPPABLE_DRAG_END:"droppableDragEnd",DRAG_CANCEL:"dragCancel",DRAG_MOVE:"dragMove",DRAG_START:"dragStart",DRAG_STOP:"dragStop",DROP_PIECE:"dropPiece",JUMP_TO_POSITION:"jumpToPosition",KEY_DOWN:"keyDown",MAKE_MOVE:"makeMove",MARK_ARROW:"markArrow",MARK_EFFECT:"markEffect",MARK_SQUARE:"markSquare",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",REMOVE_CUSTOM_ITEM:"removeCustomItem",RESET_BOARD_STATE:"resetBoardState",RESIZE_BOARD:"resizeBoard",RIGHT_CLICK:"rightClick",SELECT_PIECE:"selectPiece",SELECT_PROMOTION_PIECE:"selectPromotionPiece",SET_BOARD_DIMENSIONS:"setBoardDimensions",SET_BUSY_FLAG:"setBusyFlag",SET_FROM_FILE_RANK:"setFromFileRank",SET_MOVE_SQUARES:"setMoveSquares",UPDATE_BOARD_IMAGE_STATE:"updateBoardImageState",UPDATE_LEGAL_MOVES:"updateLegalMoves",UPDATE_MARKINGS:"updateMarkings",UPDATE_OPTIONS:"updateOptions",UPDATE_GAME_SETTINGS:"updateGameSettings",UPDATE_SELECTED_PIECE_SQUARE:"updateSelectedPieceSquare"},Lu=(a,u)=>Object.assign(a.parentNode.getBoundingClientRect(),{aspectRatio:u}),Yd=(a,u,c,p)=>{const _=Y.getId(),A={id:_,interval:u,times:c,...p};return a.markings.blinkingSquares.push(A),setTimeout(()=>{const V=a.markings.blinkingSquares.findIndex(ue=>ue.id===_);a.markings.blinkingSquares.splice(V,1)},0),a};var Xd=sr(3527),lo=sr.n(Xd),uo=lo(),Xn=sr(26734);const jr=(a,u)=>{const c=[];return(a.tree.lines||sr(25494).Z.state.lines)[0].some((_,A)=>typeof u=="number"&&A>=u?!0:(c.push(_.san),!1)),c},Ji=a=>{const u=[a.setup.fen];return(a.tree.lines||sr(25494).Z.state.lines)[0].forEach(p=>{u.push(p.fen)}),u},Ta=a=>{const u=Yr.getTcn(a);return u.substr(u.length-2)},rs={},r1=a=>{var u,c;return((c=(u=window.chesscom)==null?void 0:u.features)==null?void 0:c.includes(a))?!0:!!rs[a]},Qd=({feature:a,hasAccess:u})=>{rs[a]=u},i1=a=>{const u=a.dataset,c=Object.keys(u),p="feature";c.forEach(_=>{_.indexOf(p)===0&&Qd({feature:_.substring(p.length).split(/(?=[A-Z])/).join("_").toLowerCase(),hasAccess:!!u[_]})})},Jn={createJce:a=>{const u=Object.assign({},a,{analysis:!0});return uo.createGame(u)||null},updateIdsFromJce:a=>!a||!a.jce?null:(a.tree.selected=a.jce.ids(),a),getSelectedIds:a=>a.jce.ids(),getPositionInfo:a=>{const u=uo.getPositionInfo({game:a.jce},{skipValidation:!0,getLegalMoves:!0});return a.settings.premoves?u.legalPremoves=Jn.getLegalPremoves(a):u.legalPremoves=[],u},getPositionDetails:a=>Object.assign(uo.getPositionDetails({game:a.jce,kings:!1,skipValidation:!0}),{hand:Jn.getHand(a)}),addExtraCastlingMoves:a=>{a.setup.legalMoves.forEach(u=>{(u.flags===16||u.flags===32)&&(a.variant==="chess960"?Jn.addCastlingMoves960(a,u):Jn.addCastlingMoves(a,u))})},addCastlingMoves:(a,u)=>{const c=u.color===1?1:8;(u.flags===16?[8]:[1,2]).forEach(_=>{a.setup.legalMoves.push({color:u.color,flags:u.flags,piece:"k",from:u.from,san:u.flags===16?"O-O":"O-O-O",to:Y.getSanFromFileRank({file:_,rank:c})})})},addCastlingMoves960:(a,u)=>{const p=Y.getFileRankFromSan(u.from).rank;let _=1,A=0;for(;A<2;){const V=Y.getPieceAt(a,{file:_,rank:p});typeof V<"u"&&V.type==="r"&&A++,(A===1&&u.flags===32||A===2&&u.flags===16)&&a.setup.legalMoves.push({color:u.color,flags:u.flags,piece:"k",from:u.from,san:u.flags===16?"O-O":"O-O-O",to:Y.getSanFromFileRank({file:_,rank:p})})}_++},getHeaders:a=>a.jce.header(),getFen:a=>a.jce.fen(),getPgn:(a,u)=>a.jce.pgn(u),getPremoves:a=>a.jce.premove.queue.map(u=>({move:u,pieces:a.jce.premove.getPieces()})),getHand:a=>a.jce.hand(),getChecks:a=>a.jce.checks(),getLegalPremoves:a=>a.jce.premove.moves(),load:(a,u)=>(a.jce.load(u)&&Jn.updateIdsFromJce(a),a),loadPgn:(a,u)=>(a.jce.loadPgn(u)&&Jn.updateIdsFromJce(a),a),loadPgnSoft(a,u){if(!a.jce.loadPgn(u)){const c=uo.createGame({variant:"detect",pgn:u});c&&(u=c.pgn())}return a.jce.loadPgn(u)||Jn.updateIdsFromJce(a),a},createVariation:a=>(a.jce.createVariation()&&(a.jce.reorderLines(),Jn.updateIdsFromJce(a)),a),getJCEMove:(a,u)=>{let c=u;return Jn.isValidMoveObject(u)?(c.san?c=uo.sanToObj(c.san,Jn.getFen(a),a.variant):c.tcn&&(c=uo.decodeTCN(c.tcn)[0]),c):null},move:(a,u,c=!0)=>{if(!u)return null;let p=!1;if(c===!1){const _=u.from?a.jce.get(u.from):null,A=u.to?a.jce.get(u.to):null;if(_&&A&&A.type==="k")return null;a.jce.remove(u.to),a.jce.remove(u.from);const V=u.drop||u.put;p=a.jce.put(_||{type:V.toLowerCase(),color:V&&V.toUpperCase()===V?1:2},u.to),u.from&&_&&u.to===null&&(p=!0)}else u.drop&&(u.drop=u.drop.toLowerCase()),p=a.jce.move(u);return p&&Jn.updateIdsFromJce(a),p},selectLine:(a,u)=>{const c=Xn.x.getLine(a.tree.lines,u);return c&&(a.jce.selectLine(u),a.tree.selected={line:u,move:c.length-1}),a},selectNode:(a,u={line:0,move:0})=>(a.jce.selectPosition(u.move,u.line),a),updateHeaders:(a,u)=>a.jce.header(u),clear:a=>a.jce.clear(a.variant),isFileRankEqual:(a,u)=>a.file&&u.file&&a.rank&&u.rank&&a.file===u.file&&a.rank===u.rank,isValidMoveObject:a=>typeof a.from=="string"&&typeof a.to=="string"||typeof a.san=="string"||typeof a.tcn=="string"||!a.from&&typeof a.to=="string"&&typeof a.drop=="string"||a.to===null&&typeof a.from=="string"||!a.from&&typeof a.to=="string"&&typeof a.put=="string",movesMatch:(a,u)=>a.from===u.from&&a.to===u.to&&(!a.promotion||a.promotion===u.promotion)&&(!a.drop||a.drop===u.drop),getMoveNumber:(a,u)=>a===1?Math.ceil(u/2+1):Math.floor(u/2+1),isUserTurn:a=>a.setup.playingAs===a.setup.sideToMove,getFens:Ji,getLastTcn:Ta,getSanMoves:jr};let wl={};const Jd={q:9,r:5,b:3,n:3,p:1,k:0},mr={getInitialSettings:()=>({variations:!1,analysis:!1,mainLineIsImmutable:!1,rules:!0,premoves:!1,GTM:!1}),getInitialSetup:()=>({ranks:8,files:8}),getInitialTree:()=>({initialMarkings:{arrows:[],effects:[],squares:[]}}),getInitialMarkings:()=>({arrows:[],blinkingSquares:[],effects:[],squares:[]}),clearState:a=>(a.setup=mr.getInitialSetup(),a),updateState:a=>{a.setup=Object.assign({},a.setup,Jn.getPositionInfo(a),Jn.getPositionDetails(a)),Jn.addExtraCastlingMoves(a),a.tree.lines=Xn.x.getLinesFromJce(a),a.tree.selected=a.jce.ids(),a.tree.selectedNode=Xn.x.getSelectedNode(a),a.setup.capturedPieces=mr.getCapturedPieces(a.setup),a.setup.capturedScores=mr.getCapturedScores(a.setup),a.setup.result=mr.getResult(a),a.premoves=Jn.getPremoves(a),a.variant=Jn.getHeaders(a).Variant||a.variant,a.startingMoveNumber=a.setup.moveNumber;const u=Xn.x.getNode(a.tree.lines,Jn.getSelectedIds(a))||a.tree.initialMarkings;return u&&(a.markings.squares=u.squares?u.squares.map(c=>({...c})):[],a.markings.arrows=u.arrows?u.arrows.map(c=>({...c})):[],a.setup.effects?a.markings.effects=a.setup.effects:u.effects?a.markings.effects=u.effects.map(c=>({...c})):a.markings.effects=[]),wl[a.id]=!0,a.sibling&&!wl[a.sibling.id]&&(a.sibling=mr.updateState(a.sibling)),wl={},a},getCapturedPieces:a=>a.pieces.reduce((u,c)=>{if(c.type==="k")return u;const p=c.promoted?"p":c.type;return u[c.color-1][p]-=1,u},[{p:8,n:2,b:2,r:2,q:1},{p:8,n:2,b:2,r:2,q:1}]),getCapturedScores:a=>a.pieces.reduce((u,c)=>(u[c.color-1]+=Jd[c.type],u),[0,0]),getResult:a=>{const u=Jn.getHeaders(a).Result;return u!=="*"?u:a.setup.insufficient||a.setup.stalemate?"1/2-1/2":a.setup.gameOver&&!a.setup.draw?a.setup.sideToMove===1?"0-1":"1-0":"*"}},Oi=(a,u={},c=0,p=!0)=>{const _=Xn.x.findNode(a.jce._lines(),u,c,p),{line:A,move:V}={...a.tree.selected};if(!_)return a;let ue={};return u.move+c<0&&u.line===_.ids.line?ue={line:0,move:-1}:ue=_.ids,Jn.selectNode(a,ue),de.add(a.history,R.JUMP_TO_POSITION,{from:{line:A,move:V},to:ue}),mr.updateState(a)},Du=(a,u,c={})=>{const p={...a.tree.selected};if(!a.settings.variations)return null;typeof c.line<"u"&&typeof c.move<"u"?Jn.selectNode(a,c):c=a.tree.selected;const _=Xn.x.getNode(a.jce._lines(),{line:c.line,move:c.move}).san;return Jn.createVariation(a),u&&Jn.move(a,_),de.add(a.history,R.JUMP_TO_POSITION,{from:p,to:c}),mr.updateState(a)},Bu=a=>a.tree.selected.move!==-1&&a.settings.mainLineIsImmutable&&Xn.x.isMainLine(a.tree.selected.line),Fu=(a,u)=>uo.getPositionDetails({fen:Jn.getFen(a),variant:Jn.getHeaders(a).Variant||"Chess"},u)!==null,Oo=(a,u,c=!1)=>{const p=Jn.getJCEMove(a,u);if(p===null)return de.add(a.history,R.ILLEGAL_MOVE),a;const _=a.settings.analysis||c;if(Xn.x.isHead(a.jce._lines(),a.tree.selected)){if(!_&&!Jn.isUserTurn(a))return de.add(a.history,R.ILLEGAL_MOVE),a;if(_&&a.settings.variations&&Bu(a)&&Fu(a,p)){const A=Xn.x.getNextMatchingNode(a.jce._lines(),a.tree.selected,p);return A?Oi(a,A.ids):(Du(a,!0),mr.updateState(a),Oo(a,p))}}else{if(!_)return Oi(a,Xn.x.getHeadIds(a.jce._lines(),a.tree.selected.line));const A=Xn.x.getNextMatchingNode(a.jce._lines(),a.tree.selected,p);if(A)return Oi(a,A.ids);if(Fu(a,p)){if(de.add(a.history,R.TREE_AMENDED),a.settings.variations)return Jn.selectNode(a,{line:a.tree.selected.line,move:a.tree.selected.move+1}),Jn.createVariation(a),mr.updateState(a),Oo(a,p);if(!a.settings.mainLineIsImmutable)return Xn.x.prune(a.jce._lines(),a.tree.selected),Oo(a,p)}return de.add(a.history,R.ILLEGAL_MOVE),a}return!Bu(a)&&Jn.move(a,p,a.settings.rules)?(de.add(a.history,R.MAKE_MOVE,p),mr.updateState(a)):(de.add(a.history,R.ILLEGAL_MOVE),a)},Ns=(a,u)=>([1,2].indexOf(u)>=0&&(a.setup.playingAs=u),a),Uu=(a,u)=>(Ns(a,3-a.setup.playingAs),Oo(a,u),Ns(a,3-a.setup.playingAs),mr.updateState(a)),aa=(a,u)=>{let c=!1;if(!a.settings.rules)return!0;for(let p=0;p<a.setup.legalMoves.length;p++){const _=a.setup.legalMoves[p];if(_.from===u.from&&_.to===u.to){c=!0;break}}return c},Sr=(a,u)=>(u&&(Oi(a,{line:0,move:0}),u.match(/.{2}/g).forEach(p=>Oo(a,{tcn:p},!0))),a),Hu=(a,u=1)=>{if(a.tree.selected.line===0&&a.tree.selected.move-u<-1)return!1;const c=a.tree.lines||sr(25494).Z.state.lines;return Xn.x.findNode(c,a.tree.selected,u*-1,!1)!==null},ef=(a,u=1)=>{const c=a.tree.lines||sr(25494).Z.state.lines;return Xn.x.findNode(c,a.tree.selected,u,!1)!==null},o1={premove:(a,u)=>{let c=!1;return a.settings.premoves&&!a.settings.analysis&&a.jce.premove.queue.length<8&&(c=a.jce.premove.move(u)),c},cancelPremoves:a=>a.jce.premove.queue.length?(a.jce.premove.cancel(),!0):!1,consumePremove:a=>(a.jce.premove.consume(),!0)},tf=(a,u)=>{const c=Game.getJCEMove(a,u);if(c===null)return History.add(a.history,Events.ILLEGAL_MOVE),a;if(!Line.isHead(a.jce._lines(),a.tree.selected)&&!a.settings.analysis)return selectNode(a,Line.getHeadIds(a.jce._lines(),a.tree.selected.line));if(!a.settings.analysis)return GamePremoves.premove(a,c)?(History.add(a.history,Events.PREMOVE),State.updateState(a)):History.add(a.history,Events.ILLEGAL_MOVE),a},nf=a=>(o1.cancelPremoves(a)&&(de.add(a.history,R.CANCEL_PREMOVES),mr.updateState(a)),a),a1=a=>(a.premoves.length&&(GamePremoves.consumePremove(a)?(History.add(a.history,Events.MAKE_MOVE),State.updateState(a)):cancelPremoves(a)),a),Gu=(a,u)=>{const c=Object.prototype.hasOwnProperty.call(u,"premoves")&&a.settings.premoves!==u.premoves;return a.settings=Object.assign(a.settings,u),a.settings.premoves||nf(a),de.add(a.history,R.SETTINGS_CHANGE),c&&mr.updateState(a),a},Vu=a=>{const u=Yr.resetToMainLine(a),c=Xn.x.clearAnalysis(u.jce._lines());return u.jce.saveLines(c),de.add(u.history,R.TREE_CHANGE),mr.updateState(a)},Sl=(a,u,c)=>{const p=Xn.x.getNode(a.jce._lines(),c)||Xn.x.getNode(a.jce._lines(),Jn.getSelectedIds(a))||a.tree.initialMarkings;p.arrows||(p.arrows=[]);const _=p.arrows.findIndex(A=>Jn.isFileRankEqual(A.fromFileRank,u.fromFileRank)&&Jn.isFileRankEqual(A.toFileRank,u.toFileRank));return _!==-1&&(p.arrows.splice(_,1),mr.updateState(a),de.add(a.history,R.TREE_CHANGE)),a},rf=(a,u)=>(a.markings.blinkingSquares[u]&&delete a.markings.blinkingSquares[u],a),co=(a,u)=>u?(Xn.x.clearAllMarkings(a.jce._lines()),Jn.load(a,u),de.add(a.history,R.LOAD),mr.updateState(a)):null,fo=a=>(Gu(a,{rules:!1}),co(a,"8/8/8/8/8/8/8/8 w - - 0 1"),de.add(a.history,R.LOAD),mr.updateState(a)),of=(a,u,c)=>{const p=Xn.x.getNode(a.jce._lines(),c)||Xn.x.getNode(a.jce._lines(),Jn.getSelectedIds(a))||a.tree.initialMarkings;p.effects||(p.effects=[]);const _=p.effects.findIndex(A=>Jn.isFileRankEqual(A.square,u.square));return _!==-1&&(p.effects.splice(_,1),mr.updateState(a),de.add(a.history,R.TREE_CHANGE)),a},xr=(a,u,c)=>{const p=Xn.x.getNode(a.jce._lines(),c)||Xn.x.getNode(a.jce._lines(),Jn.getSelectedIds(a))||a.tree.initialMarkings;p.squares||(p.squares=[]);const _=p.squares.findIndex(A=>Jn.isFileRankEqual(A,u));return _!==-1&&(p.squares.splice(_,1),mr.updateState(a),de.add(a.history,R.TREE_CHANGE)),a},xi=(a,u,c=!0)=>{const p=Xn.x.getNode(a.jce._lines(),u)||Xn.x.getNode(a.jce._lines(),Jn.getSelectedIds(a))||a.tree.initialMarkings;return(p.arrows&&p.arrows.length||p.squares&&p.squares.length||p.effects&&p.effects.length)&&(p.arrows=[],p.squares=[],p.effects=[],c&&(mr.updateState(a),de.add(a.history,R.TREE_CHANGE))),a},Ma=(a,u={})=>{const c=a.jce._lines();if(!c)return a;if(typeof u.line>"u"&&typeof u.move>"u")return c.forEach(p=>{p.forEach((_,A)=>Xn.x.clearNode(c,{line:_.ids.line,move:A}))}),de.add(a.history,R.TREE_CHANGE),a;if(typeof u.move>"u"){const p=Xn.x.getLine(a.jce._lines(),u.line);return p&&(p.forEach((_,A)=>Xn.x.clearNode(c,{line:p.id,move:A})),de.add(a.history,R.TREE_CHANGE)),a}return Xn.x.getNode(c,u)&&(Xn.x.clearNode(c,u),de.add(a.history,R.TREE_CHANGE)),a},zu=(a="")=>a.charCodeAt(0)-97+1,Cl=(a=[])=>({fromFileRank:{file:zu(a[0]),rank:Number(a[1])},toFileRank:{file:zu(a[2]),rank:Number(a[3])}}),ju=(a={})=>{const u={id:Y.getId(),variant:a.variant||"chess",settings:Object.assign(mr.getInitialSettings(),a.settings),setup:Object.assign(mr.getInitialSetup(),a.setup),tree:Object.assign(mr.getInitialTree(),a.tree),history:de.getInitialHistory(),markings:Object.assign(mr.getInitialMarkings(),a.markings),premoves:[]};return Ns(u,a.player||1),Object.defineProperty(u,"jce",{writable:!1,enumerable:!1,configurable:!1,value:Jn.createJce(a)}),Jn.updateIdsFromJce(u),de.add(u.history,R.INIT),u.jce.siblingGame&&!u.sibling&&(u.sibling={id:Y.getId(),variant:u.variant||"chess",sibling:u,settings:u.settings,setup:mr.getInitialSetup(),tree:mr.getInitialTree(),history:de.getInitialHistory(),markings:Object.assign(mr.getInitialMarkings(),a.markings),premoves:[]},Object.defineProperty(u.sibling,"jce",{writable:!1,enumerable:!1,configurable:!1,value:Jn.createJce({game:u.jce.siblingGame})}),Jn.updateIdsFromJce(u.sibling)),mr.updateState(u),u},af=(a,u)=>a.jce.deletePosition(-1,u)?(de.add(a.history,R.TREE_CHANGE),mr.updateState(a),a):null,s1=a=>a&&!Object.keys(a).length;function l1(a,u){return u.every(c=>a[c])}function u1(a,u){return u.some(c=>a[c])}const sf=(a={},u)=>Object.prototype.hasOwnProperty.call(a,u),c1=(a,u=[])=>Object.keys(a).filter(c=>!u.includes(c)).reduce((c,p)=>({...c,[p]:a[p]}),{}),lf=a=>Object.keys(a).reduce((u,c)=>({...u,[a[c]]:c}),{}),d1=(a,u)=>Object.prototype.hasOwnProperty.call(a,u),f1=a=>Object.keys(a).reduce((u,c)=>{let p=a[c];return typeof p=="boolean"&&(p=p?"1":"0"),u[c]=p,u},{}),uf=a=>{const u={};for(const c in a)if(sf(a,c)){const p=typeof a[c]=="object"?uf(a[c]):a[c];u[camelCase(c)]=p}return u};function h1(a={},u={}){if(Object.keys(a).length!==Object.keys(u).length)return!0;for(const c in a)if(a[c]!==u[c])return!0;return!1}function p1(a,u){return Object.entries(a).reduce((c,[p,_])=>(u.includes(p)&&(c[p]=_),c),{})}const m1=()=>({begin:{},focus:{},end:{}}),v1={BLACK:2,WHITE:1},Kr={$1:"!",$2:"?",$3:"!!",$4:"??",$5:"!?",$6:"?!",$9:"\u2612",$10:"=",$11:"=",$12:"=",$13:"\u221E",$14:"\u2A72",$15:"\u2A71",$16:"\xB1",$17:"\u2213",$18:"+-",$19:"-+",$22:"\u2A00",$23:"\u2A00",$32:"\u27F3",$33:"\u27F3",$36:"\u2192",$37:"\u2192",$40:"\u2191",$41:"\u2191",$44:"\u221E/=",$45:"=/\u221E",$132:"\u21C6",$133:"\u21C6",$146:"N"},kl=lf(Kr),g1={DIAGRAM_EDITOR:"diagram-editor-container"},_1={defaultCharLength:7,defaultCharWidth:6},Ls={AFTER:"after",BEFORE:"before"},fr={ADD_ANNOTATION:"addAnnotation",ADD_EVAL_NOTATION:"addEvalNotation",CLEAR_ANALYSIS:"clearAnalysis",CREATE_CONTINUATION:"createContinuation",CREATE_VARIATION:"createVariation",DELETE_COMMENT:"deleteComment",DELETE_LINE:"deleteLine",DELETE_MOVE:"deleteMove",INSERT_COMMENT:"insertComment",MOVE_VARIATION_DOWN:"moveVariationDown",MOVE_VARIATION:"moveVariation",PROMOTE_VARIATION:"promoteVariation",REMOVE_ANNOTATION:"removeAnnotation",REMOVE_BEGIN:"removeBegin",REMOVE_END:"removeEnd",REMOVE_EVAL_ANNOTATION:"removeEvalAnnotation",REMOVE_FOCUS:"removeFocus",SET_BEGIN:"setBegin",SET_END:"setEnd",SET_FOCUS:"setFocus",UPDATE_COMMENT:"updateComment"},b1={CLEAR_ANALYSIS:"clear-analysis-on-confirm"},cf=[{code:"$1",display:Kr.$1,meaning:pt.trans("Good move"),action:fr.ADD_ANNOTATION},{code:"$2",display:Kr.$2,meaning:pt.trans("Bad move"),action:fr.ADD_ANNOTATION},{code:"$3",display:Kr.$3,meaning:pt.trans("Excellent move"),action:fr.ADD_ANNOTATION},{code:"$4",display:Kr.$4,meaning:pt.trans("Blunder"),action:fr.ADD_ANNOTATION},{code:"$5",display:Kr.$5,meaning:pt.trans("Speculative move"),action:fr.ADD_ANNOTATION},{code:"$6",display:Kr.$6,meaning:pt.trans("Dubious move"),action:fr.ADD_ANNOTATION},{code:"$10",display:Kr.$10,meaning:pt.trans("Drawish"),action:fr.ADD_EVAL_NOTATION},{code:"$13",display:Kr.$13,meaning:pt.trans("Unclear"),action:fr.ADD_EVAL_NOTATION},{code:"$14",display:Kr.$14,meaning:pt.trans("White has a slight advantage"),action:fr.ADD_EVAL_NOTATION},{code:"$15",display:Kr.$15,meaning:pt.trans("Black has a slight advantage"),action:fr.ADD_EVAL_NOTATION},{code:"$16",display:Kr.$16,meaning:pt.trans("White has a moderate advantage"),action:fr.ADD_EVAL_NOTATION},{code:"$17",display:Kr.$17,meaning:pt.trans("Black has a moderate advantage"),action:fr.ADD_EVAL_NOTATION},{code:"$18",display:Kr.$18,meaning:pt.trans("White has a decisive advantage"),action:fr.ADD_EVAL_NOTATION},{code:"$19",display:Kr.$19,meaning:pt.trans("Black has a decisive advantage"),action:fr.ADD_EVAL_NOTATION},{code:"$22",display:Kr.$22,meaning:pt.trans("The position is in zugzwang"),action:fr.ADD_EVAL_NOTATION},{code:"$146",display:Kr.$146,meaning:pt.trans("Novelty"),action:fr.ADD_EVAL_NOTATION}],y1={CLEAR_ALL_ANALYSIS:{name:pt.trans("Clear All Analysis"),action:fr.CLEAR_ANALYSIS},CREATE_CONTINUATION:{name:pt.trans("Insert Continuation"),action:fr.CREATE_CONTINUATION},CREATE_VARIATION:{name:pt.trans("Insert Alternate Line"),action:fr.CREATE_VARIATION},DELETE_COMMENT_AFTER:{name:pt.trans("Delete Comment After"),action:fr.DELETE_COMMENT,position:Ls.AFTER},DELETE_COMMENT_BEFORE:{name:pt.trans("Delete Comment Before"),action:fr.DELETE_COMMENT,position:Ls.BEFORE},DELETE_LINE:{name:pt.trans("Delete Entire Variation"),action:fr.DELETE_LINE},DELETE_MOVE:{name:pt.trans("Delete Move"),action:fr.DELETE_MOVE},INSERT_COMMENT_AFTER:{name:pt.trans("Comment After"),action:fr.INSERT_COMMENT,position:Ls.AFTER},INSERT_COMMENT_BEFORE:{name:pt.trans("Comment Before"),action:fr.INSERT_COMMENT,position:Ls.BEFORE},MOVE_VARIATION_DOWN:{name:pt.trans("Move Variation Down"),action:fr.MOVE_VARIATION_DOWN},MOVE_VARIATION_UP:{name:pt.trans("Move Variation Up"),action:fr.MOVE_VARIATION},PROMOTE_VARIATION:{name:pt.trans("Promote"),action:fr.PROMOTE_VARIATION},REMOVE_ANNOTATION:{name:pt.trans("Remove Annotation"),action:fr.REMOVE_ANNOTATION},REMOVE_BEGIN:{name:pt.trans("Remove Begin"),action:fr.REMOVE_BEGIN},REMOVE_END:{name:pt.trans("Remove End"),action:fr.REMOVE_END},REMOVE_EVAL_ANNOTATION:{name:pt.trans("Remove Evaluation Annotation"),action:fr.REMOVE_EVAL_ANNOTATION},REMOVE_FOCUS:{name:pt.trans("Remove Focus"),action:fr.REMOVE_FOCUS},SET_BEGIN:{name:pt.trans("Set Begin"),action:fr.SET_BEGIN},SET_END:{name:pt.trans("Set End"),action:fr.SET_END},SET_FOCUS:{name:pt.trans("Set Focus"),action:fr.SET_FOCUS}},E1=[fr.SET_BEGIN,fr.SET_END,fr.SET_FOCUS,fr.REMOVE_BEGIN,fr.REMOVE_END,fr.REMOVE_FOCUS],xa={BEGIN:"begin",END:"end",FOCUS:"focus"},A1={SET:{[fr.SET_BEGIN]:xa.BEGIN,[fr.SET_END]:xa.END,[fr.SET_FOCUS]:xa.FOCUS},REMOVE:{[fr.REMOVE_BEGIN]:xa.BEGIN,[fr.REMOVE_END]:xa.END,[fr.REMOVE_FOCUS]:xa.FOCUS}},w1=(()=>{const a=[];return cf.forEach(u=>{const c=a[a.length-1]||null;!c||c.length===4?a.push([u]):c.push(u)}),a})(),ho=a=>!Object.prototype.hasOwnProperty.call(Kr,a)&&!Object.prototype.hasOwnProperty.call(kl,a)?a||"":qu(a)?Kr[a]:ho(kl[a]),df=(a,u)=>a.additionalAnnotation&&Array.isArray(a.additionalAnnotation)&&ho(a.additionalAnnotation[0])===ho(u),ff=(a,u)=>ho(a.annotation)===ho(u),qu=a=>a&&a.charAt(0)==="$",S1=a=>a.additionalAnnotation&&a.additionalAnnotation[0],C1=a=>Object.prototype.hasOwnProperty.call(a,"annotation"),k1=a=>!!(a&&typeof a.comment=="string"),P1=a=>!!(a&&typeof a.commentBefore=="string"),T1=a=>!!(a&&a.lines&&a.lines.length),M1=a=>a.flags===4,lv=(a,u)=>a.ids.line===u.lines[0],An=(a,u)=>a.ids.move===u.lines[a.ids.line].length-1,sa=(a={})=>a.move===0&&a.line===0,ii=(a,u)=>a.ids.line===u.lines[u.lines.length-1],oi=a=>Line.isMainLine(a.ids.line),hi=(a,u,c)=>Object.prototype.hasOwnProperty.call(a,c)&&Object.prototype.hasOwnProperty.call(a[c],"ids")&&a[c].ids.move===u.ids.move&&a[c].ids.line===u.ids.line,ai=(a,u)=>{const c=a[nodeLimitTypes.END];return c&&Object.prototype.hasOwnProperty.call(c,"ids")?u.ids.line>c.ids.line||u.ids.line===c.ids.line&&u.ids.move>c.ids.move:!1},x1=(a,u)=>{const c=a[nodeLimitTypes.BEGIN];return c&&Object.prototype.hasOwnProperty.call(c,"ids")?u.ids.line<a.begin.ids.line||u.ids.line===a.begin.ids.line&&u.ids.move<a.begin.ids.move:!1},I1=(a,u)=>!(u&&oi(a)),R1=a=>{var u,c;let p="";return a.annotation&&(p=`${p}${ho(a.annotation)}`),((u=a.additionalAnnotation)==null?void 0:u.length)===1&&(p=`${p}&nbsp;${ho(a.additionalAnnotation[0])}`),((c=a.additionalAnnotation)==null?void 0:c.length)>1&&(p=`${p}&nbsp;${ho(a.additionalAnnotation.join(""))}`),p},O1=a=>a.ids.move===0,hf=a=>!!(a.isWhite||a.isFirstNodeOnLine||a.previousHasComment||a.previousHasLines),pf=a=>!!(!a.isWhite&&(a.previousHasComment||a.previousHasLines||a.isFirstNodeOnLine));function N1(a,u){let c="";return hf(a)&&(c+=`${a.nodeMoveNumber+(u-1)}.`,pf(a)&&(c+=".."),c+="&nbsp;"),c}const Pl=a=>{let u=Xn.x.getSelectedLine(a),c=0;const p={...a.tree.selected};a.tree.selected.move===0&&typeof u.parentId<"u"?(Jn.selectLine(a,u.parentId),u=Xn.x.getSelectedLine(a)):Xn.x.isMainLine(u.id)&&(c=-1);const _={line:u.id,move:c};return Jn.selectNode(a,_),de.add(a.history,R.JUMP_TO_POSITION,{from:p,to:_}),mr.updateState(a)},mf=a=>(Xn.x.isMainLine(a.tree.selected.line)||Jn.selectLine(a,0),Pl(a),mr.updateState(a)),Wu=(a,u={})=>{const c=Object.assign(a.tree.selected,u);return c.line>0&&(c.move<=0||Xn.x.isFirstVisibleNode(a.jce._lines(),c))&&(c.move=-1),a.jce.deletePosition(c.move,c.line),de.add(a.history,R.TREE_CHANGE),mr.updateState(a),a},Tl=(a,u={})=>{const c=Object.assign(a.tree.selected,u);return Wu(a,{move:c.move+1,line:c.line})},vf=a=>{const u=a.jce._history().length-a.jce.ids().move-1,c=a.jce.history(!0);return u===0?c:c.slice(0,-u)},Ml=(a,u)=>Jn.getPgn(a,u),gf=a=>Jn.getHeaders(a),_f=a=>Xn.x.getSelectedNode(a),xl=(a,u)=>{const c=a.jce&&a.jce._lines()||sr(25494).Z.state.lines;return uo.encodeTCN(Xn.x.getLine(c,u)||c[0])},bf=(a,u,c,p)=>{const _=u.map(A=>uo.encodeTCN({from:A.slice(0,2),to:A.slice(2,4),promotion:A.slice(4,5)||void 0})).join("");return Yr.loadFromTcn(a,_,c,p)},L1=a=>!!(a&&a.tree&&a.tree.lines),yf=a=>(Object.keys(Kr).forEach(function(u){a=a.replace(new RegExp(`\\${u}\\b`,"gm"),ho(u))}),a),D1=a=>{var u;return(u=a?.[0])==null?void 0:u.length},B1=({moveIds:a,moveList:u,scrollEl:c})=>{if(!a||!u||!c)return;const p=u.getComponentRefByLineMove(a.line,a.move);if(!p)return;const _=c.getBoundingClientRect(),A=p.$el?p.$el.getBoundingClientRect():p.getBoundingClientRect(),V=c.scrollTop,re=_.top+Math.floor(_.height/2)-A.top;c.scrollTop=V-re},Ef=(a,u,c,p=!1)=>{if(!u)return a;const _=yf(u);return p&&!a.jce.loadPgn(_)?Jn.loadPgnSoft(a,_):Jn.loadPgn(a,_),mr.updateState(a),c?Oi(a,a.tree.selected,c):(de.add(a.history,R.LOAD),a)},Af=(a,u,c,p)=>!u||!u.length?null:(c&&Jn.load(a,c),u.forEach(_=>Oo(a,{san:_},!0)),mr.updateState(a),p?Oi(a,a.tree.selected,-1):(de.add(a.history,R.LOAD),a)),wf={p:1,n:32,b:256,r:2048,q:16384},Ku=(a,u,c)=>(a.jce._hand[u]=c.split("").reduce((p,_)=>p+wf[_],0),a.setup.hand=a.jce.hand(),a),Ds=(a,u,c=Y.getInitialFen(),p)=>{co(a,c);const _=uo.decodeTCN(u);return _?(_.forEach(A=>{(a.variant==="Crazyhouse"||a.variant==="Bughouse")&&A.drop&&Ku(a,a.setup.sideToMove,A.drop),Oo(a,A,!0)}),mr.updateState(a),p?Oi(a,a.tree.selected,-1):(de.add(a.history,R.LOAD),a)):null},No=(a,u,c,p=!0)=>{const _=Xn.x.getNode(a.jce._lines(),c)||Xn.x.getNode(a.jce._lines(),Jn.getSelectedIds(a))||a.tree.initialMarkings;return _.arrows||(_.arrows=[]),_.arrows.find(A=>Jn.isFileRankEqual(A.fromFileRank,u.fromFileRank)&&Jn.isFileRankEqual(A.toFileRank,u.toFileRank))||(_.arrows.push(u),p&&(mr.updateState(a),de.add(a.history,R.TREE_CHANGE))),a},Il=({game:a,effect:u,ids:c,persist:p,updateState:_=!0})=>{if(p)return a.setup.effects=u?[u]:null,mr.updateState(a),a;const A=Xn.x.getNode(a.jce._lines(),c)||Xn.x.getNode(a.jce._lines(),Jn.getSelectedIds(a))||a.tree.initialMarkings;return A.effects||(A.effects=[]),A.effects.find(V=>Jn.isFileRankEqual(V.square,u.square))||(A.effects.push(u),_&&(mr.updateState(a),de.add(a.history,R.TREE_CHANGE))),a},$u=(a,u,c,p=!0)=>{const _=Xn.x.getNode(a.jce._lines(),c)||Xn.x.getNode(a.jce._lines(),Jn.getSelectedIds(a))||a.tree.initialMarkings;return _.squares||(_.squares=[]),_.squares.find(A=>Jn.isFileRankEqual(A,u))||(_.squares.push(u),p&&(mr.updateState(a),de.add(a.history,R.TREE_CHANGE))),a},Rl=(a,u)=>{const c=ju({variant:a.variant,fen:Y.getFirstFen(a)});return Ds(c,u,c.setup.fen),xl(c)},Zu=(a,u,c)=>{if(typeof u!="string"||a.settings.mainLineIsImmutable)return null;if(u==="")return Pl(a),Ds(a,"",a.setup.fen);const p={...a.tree.selected};let _=xl(a),A=u;const V=a.history.length-1;if(!_.includes(A)&&!A.includes(_)&&(_=Rl(a,_),A=Rl(a,A),!_.includes(A)&&!A.includes(_)))return Ds(a,A);if(A.length<_.length)Oi(a,{line:0,move:A.length/2-1}),Tl(a);else if(A.length>_.length){Oi(a,{line:0,move:_.length/2-1});let ue;if(A.slice(_.length).match(/.{2}/g).forEach(re=>{ue=uo.decodeTCN(re)[0],(a.variant==="Crazyhouse"||a.variant==="Bughouse")&&ue.drop&&Ku(a,a.setup.sideToMove,ue.drop),Oo(a,ue,!0)}),a.history.slice(V+1).some(re=>re&&re.type===R.ILLEGAL_MOVE))return Oi(a,p),Tl(a),a.history=a.history.slice(0,V),Zu(a,Rl(a,A))}else return a;if(c)return Oi(a,a.tree.selected,-1);if(p.line!==a.tree.selected.line||p.move!==a.tree.selected.move){const ue=Xn.x.getNode(a.jce._lines(),p)?p:a.tree.selected;return Oi(a,ue)}return a},Sf=(a,u=1)=>Oi(a,a.tree.selected,u*-1,!1),Cf=(a,u=1)=>Oi(a,a.tree.selected,u,!1),Ol=(a,u=a.tree.selected.line)=>{const c=Xn.x.getLine(a.jce._lines(),u).length-1,p={...a.tree.selected};if(a.tree.selected.move!==c||u!==a.tree.selected.line){const _={line:u,move:c};return Jn.selectNode(a,_),de.add(a.history,R.JUMP_TO_POSITION,{from:p,to:_}),mr.updateState(a)}return a},Yr={addBlinkingSquare:Yd,addVariant:Sr,canMoveBackward:Hu,canMoveForward:ef,changeSettings:Gu,clearAnalysis:Vu,clearArrow:Sl,clearBlinkingSquare:rf,clearBoard:fo,clearEffect:of,clearMarkedSquare:xr,clearMarkings:xi,clearNodes:Ma,convertLanToFileRanks:Cl,createGame:ju,createVariation:Du,deleteLine:af,deleteNode:Wu,deleteRemainingNodes:Tl,getCurrentFullLine:vf,getPgn:Ml,getPgnHeaders:gf,getSelectedNode:_f,getTcn:xl,isMoveLegal:aa,loadFromFen:co,loadFromLan:bf,loadFromPgn:Ef,loadFromSanMoves:Af,loadFromTcn:Ds,makeMove:Oo,makeOpponentMove:Uu,markArrow:No,markEffect:Il,markSquare:$u,mergeTcn:Zu,moveBackward:Sf,moveForward:Cf,moveToEnd:a=>(Xn.x.isMainLine(a.tree.selected.line)||Jn.selectLine(a,0),Ol(a),mr.updateState(a)),moveToStart:mf,moveVariation:(a,u,c=!0)=>{const p=Xn.x.getLine(a.jce._lines(),u);if(p&&typeof p.parentId<"u"){const _=Xn.x.getLine(a.jce._lines(),p.parentId)[p.atMoveNode];let A=-1;if(_.lines.forEach((V,ue)=>{u===V&&(A=ue)}),A>-1){let V=null;c&&A>0?(V=_.lines[A-1],_.lines[A-1]=u,_.lines[A]=V):!c&&A<_.lines.length-1&&(V=_.lines[A+1],_.lines[A+1]=u,_.lines[A]=V)}de.add(a.history,R.TREE_CHANGE)}return a},promoteVariation:(a,u)=>{let c=u;typeof c>"u"&&(c=a.tree.selected);let p=Xn.x.getLine(a.jce._lines(),c.line);if(p&&typeof p.parentId<"u"){let _=c.move;for(;typeof p.parentId<"u"&&!(a.settings.mainLineIsImmutable&&Xn.x.isMainLine(p.parentId));){const A=Xn.x.getLine(a.jce._lines(),p.parentId),V=Xn.x.isContinuation(a.jce._lines(),p.id)?1:0,ue=p[V]&&p[V].commentBefore,re=p.atMoveNode,wt=p.slice(0);p.length=0,ue&&A[re-1]&&(A[re-1].comment?(A[re-1].comment.substr(-1)!==" "&&(A[re-1].comment+=" "),A[re-1].comment+=ue):A[re-1].comment=ue,delete wt[V].commentBefore,delete p.initComment);const On=A.slice(re),vn=On[0].lines.map(qn=>qn);delete On[0].lines,On.forEach((qn,wn)=>{qn.lines&&qn.lines.length&&qn.lines.forEach(Bt=>{const Rr=Xn.x.getLine(a.jce._lines(),Bt);Rr.parentId=p.id,Rr.atMoveNode=wn})}),A.length=re,wt.forEach(qn=>{qn.ids={line:A.id,move:A.length},qn.lines&&qn.lines.length&&qn.lines.forEach(wn=>{const Bt=Xn.x.getLine(a.jce._lines(),wn);Bt.parentId=A.id,Bt.atMoveNode=A.length}),A.push(qn)}),On.forEach((qn,wn)=>{qn.ids={line:p.id,move:wn},p.push(qn)}),A[re].lines=vn,A[re].lines.forEach(qn=>{const wn=Xn.x.getLine(a.jce._lines(),qn);wn.parentId=A.id}),Jn.selectNode(a,{line:A.id,move:re+_}),p=Xn.x.getLine(a.jce._lines(),p.parentId),_=re+_}}return a.jce.saveLines(a.tree.lines),de.add(a.history,R.TREE_CHANGE),mr.updateState(a)},resetToMainLine:a=>{const u={...a.tree.selected};Xn.x.isMainLine(a.tree.selected.line)||Jn.selectLine(a,0),Ol(a);const c=a.tree.selected;return a.tree.lines.length=1,a.tree.lines=Xn.x.rebuildIds(a.tree.lines),a.jce.saveLines(a.tree.lines),de.add(a.history,R.JUMP_TO_POSITION,{from:u,to:c}),mr.updateState(a)},selectLineEnd:Ol,selectLineStart:Pl,selectNode:Oi,setPlayingAs:Ns,updateMarkings:({arrow:a,effect:u,game:c,ids:p,square:_,resetFirst:A=!0})=>(A&&xi(c,p,!1),a&&No(c,a,p,!1),u&&Il({game:c,effect:u,ids:p,updateState:!1}),_&&$u(c,_,p,!1),mr.updateState(c),de.add(c.history,R.TREE_CHANGE),c),updateNode:(a,u={},c)=>{const p=a.jce._lines(),_=Xn.x.findNode(p,u);if(!_||!c||c.commentBefore&&!Xn.x.isFirstVisibleNode(p,u))return null;const A=Xn.x.getLine(p,u.line);if(c.commentBefore===void 0&&Xn.x.isFirstVisibleNode(p,u)?delete A.initComment:c.commentBefore&&(A.initComment=c.commentBefore),c.insertCommentAfterLastNode&&A.length){const V=A[A.length-1];V&&(V.comment=c.insertCommentAfterLastNode,delete c.insertCommentAfterLastNode)}if(c.annotation&&(c.annotation=ff(_,c.annotation)?"":ho(c.annotation)),c.additionalAnnotation){if(!qu(c.additionalAnnotation))return null;df(_,c.additionalAnnotation)&&(c.additionalAnnotation=[]),c.additionalAnnotation=[].concat(ho(c.additionalAnnotation))}return Object.assign(_,c),de.add(a.history,R.UPDATE_NODE,{line:u.line,move:u.move}),mr.updateState(a)},updatePgnHeaders:(a,u)=>{if(!u)return null;const c=Object.keys(u).reduce((p,_)=>(_==="Date"&&typeof u[_]=="number"&&(u[_]=Y.formatJSTimestampForPgn(u[_])),p.push(_),p.push(u[_]),p),[]);return Jn.updateHeaders(a,c),de.add(a.history,R.PGN_HEADERS_UPDATED),a.setup.result=mr.getResult(a),a}},Bs=(a,u)=>{let c=a.setup.legalMoves;!a.settings.analysis&&a.setup.sideToMove!==a.setup.playingAs&&(c=a.settings.premoves&&a.premoves&&a.premoves.length<8&&a.setup.legalPremoves&&a.setup.legalPremoves.length>0?a.setup.legalPremoves:[]);const p=[R.INIT,R.LOAD].indexOf(a.history?a.history[a.history.length-1].type:null)!==-1;return{animate:!p,isCheck:a.setup.check,isCheckmate:a.setup.checkmate,loaded:p,legalMoves:c,markings:a.markings,pieces:a.premoves&&a.premoves.length&&Xn.x.isHead(a.tree.lines||u,a.tree.selected)?a.premoves.slice(-1)[0].pieces:a.setup.pieces,premoves:a.premoves.map(_=>_.move),previousPieces:[],playingAs:a.setup.playingAs,playSound:!p,selectedNode:a.tree.selectedNode,sideToMove:a.setup.sideToMove}},Fs=(a,u)=>({...u,premoves:a.settings.premoves?a.premoves:null}),Nl=a=>(u,c,p)=>{const _=a(u,c,p),A=b(u,c),V=se(A,_.file,_.rank,p.board.files,p.board.ranks,p.board.isFlipped);return{altKey:u.altKey,..._,...A,...V}},Yu=a=>a.altKey?"alt":a.shiftKey?"shift":a.ctrlKey?"ctrl":"default",Ia=a=>(u,c,p)=>({...a(u,c,p),key:Yu(u)}),Xu=(a,u,c)=>{const p=b(a,u);return Ht(p,c.board.files,c.board.ranks)},Tf=a=>(u,c,p)=>{const _=a(u,c,p),A=b(u,c);if(!It(_,p.board.files,p.board.ranks))return null;const V=se(A,_.file,_.rank,p.board.files,p.board.ranks,p.board.isFlipped);return{..._,...A,...V,isRightClick:u.isRightClick}},Mf=a=>(u,c,p)=>({...a(u,c,p),altKey:u.altKey,isRightClick:u.isRightClick}),xf=(a,u)=>{const c=a.keyCode;return(c===38||c===40)&&u&&a.preventDefault(),c},If=a=>(u,c,p)=>{const _=a(u,c,p);if(!It(_,p.board.files,p.board.ranks))return null;const A=b(u,c);return{..._,...A,isRightClick:u.isRightClick,altKey:u.altKey}},Ll=a=>(u,c,p)=>{const _=a(u,c,p),A=b(u,c);return{..._,...A,isRightClick:u.isRightClick}},Rf=a=>({click:Nl(a),rightClick:Ia(a),dragMove:Xu,dragStart:Tf(a),dragStop:Mf(a),keydown:xf,pointerdown:If(a),pointerup:Ll(a)});var Of={props:{boardId:{type:String,default:Y.getId()},extensions:{type:Object,default:()=>({})},game:{type:Object,required:!0},options:{type:Object,default:()=>({})},resizeModifier:{type:Object,default:()=>({x:0,y:0})},handleWindowResize:{type:Boolean,default:!0}},data(){return{arrows:[],customItems:[],effects:[],initialized:!1,squareSize:0,moveList:$.Z.state,actionsQueue:[]}},mounted(){this.createChessboard().then(a=>{this.initialized=!0,Object.defineProperty(this,"chessboard",{value:a,writable:!0,enumerable:!0,configurable:!1}),this.actionsQueue.forEach(({action:Bt,params:Rr})=>{this.chessboard.dispatch(Bt,Rr)}),this.actionsQueue.length=0,this.chessboard.dispatch(Zt.UPDATE_GAME_SETTINGS,this.game.settings),this.chessboard.dispatch(Zt.UPDATE_OPTIONS,this.options),this.chessboard.dispatch(Zt.RESIZE_BOARD,this.getBoardParentBoundingRect()),this.chessboard.dispatch(Zt.CHANGE_POSITION,Bs(this.game,this.moveList.lines)),this.squareSize=this.chessboard.state.board.squareSize,this.$emit("chessboard-boardInitialized",!0),this.$emit("chessboard-mounted"),this.chessboard.on(k.CLICKED,Bt=>{this.$emit("chessboard-clickOnFileRank",{file:Bt.file,rank:Bt.rank})}),this.chessboard.on(k.ARROW_CLEARED,Bt=>{this.$emit("chessboard-clearArrow",Bt)}),this.chessboard.on(k.ARROW_MARKED,Bt=>{this.$emit("chessboard-markArrow",Bt)}),this.chessboard.on(k.BOARD_DIMENSIONS_SET,()=>{this.squareSize=this.chessboard.state.board.squareSize,this.$emit("chessboard-resized",this.squareSize)}),this.chessboard.on(k.BUSY_FLAG,Bt=>{this.$emit("chessboard-busyFlag",Bt)}),this.chessboard.on(k.CANCEL_PREMOVES,()=>{this.$emit("chessboard-cancelPremoves")}),this.chessboard.on(k.CANCEL_GTM,()=>{this.$emit("chessboard-cancelGuessTheMove")}),this.chessboard.on(k.EFFECT_CLEARED,Bt=>{this.$emit("chessboard-clearEffect",Bt)}),this.chessboard.on(k.EFFECT_MARKED,Bt=>{this.$emit("chessboard-markEffect",Bt)}),this.chessboard.on(k.MARKINGS_CLEARED,()=>{this.$emit("chessboard-clearMarkings")}),this.chessboard.on(k.MOVE_MADE,Bt=>{this.$emit("chessboard-makeMove",Bt)}),this.chessboard.on(z.SET_ARROWS,Bt=>{this.arrows=[...Bt]}),this.chessboard.on(z.SET_EFFECTS,Bt=>{this.effects=[...Bt]}),this.chessboard.on(z.SET_CUSTOM_ITEMS,Bt=>{this.customItems=[...Bt]}),this.chessboard.on(k.SQUARE_CLEARED,Bt=>{this.$emit("chessboard-clearSquare",Bt)}),this.chessboard.on(k.SQUARE_MARKED,Bt=>{this.$emit("chessboard-markSquare",Bt)}),this.chessboard.on(k.MOVE_BACKWARD,()=>{this.$emit("chessboard-moveBackward")}),this.chessboard.on(k.MOVE_FORWARD,()=>{this.$emit("chessboard-moveForward")}),this.chessboard.on(k.MOVE_TO_END,()=>{this.$emit("chessboard-moveToEnd")}),this.chessboard.on(k.MOVE_TO_START,()=>{this.$emit("chessboard-moveToStart")}),this.chessboard.on(k.KEY_PRESS,Bt=>{Bt===88&&this.$emit("chessboard-flipBoard")});let u;this.options.playSounds&&(u=new fn(this.options.soundTheme)),this.chessboard.on(k.OPTIONS_CHANGED,Bt=>{typeof Bt.soundTheme<"u"&&(u&&u.removeAll(),u=new fn(Bt.soundTheme))}),this.chessboard.on(z.PLAY_SOUND,Bt=>{Bt!==null&&u&&u.play(Bt)});const c=this.getDomFormatters(),p=new Jo(this.$el),_=Bt=>(document.activeElement!==this.$el&&this.$el.focus(),this.chessboard.dispatch(Zt.CLICK,c.click(Bt,this.$el,this.chessboard.state))),A=()=>this.chessboard.dispatch(Zt.DRAG_CANCEL),V=Bt=>this.chessboard.dispatch(Zt.DRAG_MOVE,c.dragMove(Bt,this.$el,this.chessboard.state)),ue=Bt=>this.chessboard.dispatch(Zt.DRAG_START,c.dragStart(Bt,this.$el,this.chessboard.state)),re=Bt=>this.chessboard.dispatch(Zt.DRAG_STOP,c.dragStop(Bt,this.$el,this.chessboard.state)),wt=Bt=>this.chessboard.dispatch(Zt.POINTERDOWN,c.pointerdown(Bt,this.$el,this.chessboard.state)),On=Bt=>this.chessboard.dispatch(Zt.POINTERUP,c.pointerup(Bt,this.$el,this.chessboard.state)),vn=Bt=>this.chessboard.dispatch(Zt.RIGHT_CLICK,c.rightClick(Bt,this.$el,this.chessboard.state));p.observe({click:_,dragcancel:A,dragmove:V,dragstart:ue,dragstop:re,pointerdown:wt,pointerup:On,rightclick:vn});const qn=()=>document.removeEventListener("keydown",this.onKeydown),wn=()=>document.addEventListener("keydown",this.onKeydown);window.addEventListener("message",({data:Bt})=>{Bt===k.ANOTHER_CHESSBOARD_ONBLUR?wn():Bt===k.ANOTHER_CHESSBOARD_ONFOCUS&&qn()}),wn(),this.chessboard.on("destroy",qn),this.handleWindowResize&&(window.addEventListener("resize",this.resizeBoard),this.chessboard.on("destroy",()=>{window.removeEventListener("resize",this.resizeBoard)}))})},destroy(){this.chessboard&&this.chessboard.emit("destroy")},computed:{historyLength(){return this.game.history.length},positionChanged(){return{fen:this.game.setup.fen,isPremove:this.game.premoves.length,check:this.game.setup.check,checkmate:this.game.setup.checkmate,sideToMove:this.game.setup.sideToMove,playingAs:this.game.setup.playingAs}},legalMovesChanged(){return{legalMoves:this.game.setup.legalMoves,legalPremoves:this.game.setup.legalPremoves}}},watch:{"game.id":function(){this.dispatch(Zt.CHANGE_POSITION,Bs(this.game,this.moveList.lines))},historyLength:function(){this.chessboard&&this.chessboard.emit(W.HISTORY_CHANGE,this.game.history)},positionChanged:function(u,c){de.getLastItem(this.game.history).type===R.LOAD&&this.dispatch(Zt.RESET_BOARD_STATE),!(u.fen===c.fen&&u.isPremove===c.isPremove&&u.check===c.check&&u.checkmate===c.checkmate&&u.markingSquares===c.markingSquares&&u.markingArrows===c.markingArrows&&u.sideToMove===c.sideToMove&&u.playingAs===c.playingAs)&&this.dispatch(Zt.CHANGE_POSITION,Bs(this.game,this.moveList.lines))},legalMovesChanged:function(){this.dispatch(Zt.UPDATE_LEGAL_MOVES,Bs(this.game,this.moveList.lines))},"game.markings.arrows":function(){this.dispatch(Zt.UPDATE_MARKINGS,Fs(this.game,this.game.markings))},"game.markings.effects":function(){this.dispatch(Zt.UPDATE_MARKINGS,Fs(this.game,this.game.markings))},"game.markings.squares":function(){this.dispatch(Zt.UPDATE_MARKINGS,Fs(this.game,this.game.markings))},"game.markings.blinkingSquares":function(){this.dispatch(Zt.UPDATE_MARKINGS,Fs(this.game,this.game.markings))},"options.maxWidth":function(){this.dispatch(Zt.SET_BOARD_DIMENSIONS,Lu(this.$el,this.aspectRatio))},"game.settings":{handler:function(){this.dispatch(Zt.UPDATE_GAME_SETTINGS,this.game.settings)},deep:!0},options:{handler:function(u){this.dispatch(Zt.UPDATE_OPTIONS,u)},deep:!0}},methods:{createChessboard(){throw new Error('You must override the "createChessboard" method in child component!')},dispatch(a,u){this.initialized?this.chessboard.dispatch(a,u):this.actionsQueue.push({action:a,params:u})},getDomFormatters(){throw new Error('You must override the "getDomFormatters" method in child component!')},getBoardParentBoundingRect(){const{height:a,width:u}=this.$el.parentNode.getBoundingClientRect();return{aspectRatio:this.aspectRatio,width:u-(this.resizeModifier.x||0),height:a-(this.resizeModifier.y||0)}},onKeydown(a){const u=this.getDomFormatters();return this.chessboard.dispatch(Zt.KEY_DOWN,u.keydown(a,this.options.enabled&&this.options.captureKeyStrokes))},resizeBoard(){this.$el&&this.$el.parentNode&&this.chessboard.dispatch(Zt.RESIZE_BOARD,this.getBoardParentBoundingRect())}}};const Qu=()=>{const a={};return{emit:(A,V)=>{(a[A]||[]).forEach(ue=>ue.handler(V))},fire:(A,V)=>a[A]&&a[A].length?[].concat(a[A]).reduce((ue,re)=>ue.then(()=>re.handler(V)),Promise.resolve()):[],on:(A,V)=>{const ue={type:A,handler:V};return a[A]=a[A]||[],a[A].push(ue),ue},off:A=>{const V=a[A.type].findIndex(ue=>A.type===ue.type&&A.handler===ue.handler);V!==-1&&a[A.type].splice(V,1)},subscriptions:a}},Nf=a=>{const{emit:u,off:c,on:p,subscriptions:_}=Qu(),A={...bl},V=(ue,re)=>{try{return u(`action-${ue}`,re),qo[ue]({dispatch:V,emit:u,state:A},re)}catch(wt){throw Ts({chessboardState:A,chessboardDispatchErrorOn:{data:re,type:ue}}),wt}};return Object.keys(a||{}).forEach(ue=>{if(typeof a[ue]=="function")return a[ue]({dispatch:V,emit:u,off:c,on:p,state:A});Object.entries(a[ue]).forEach(re=>p(re[0],re[1]))}),{dispatch:V,emit:u,extensions:a,off:c,on:p,state:A,subscriptions:_}},Lf=a=>a===1?"w":"b",Ju=a=>a.replace("url(","").replace(")","").replace(/"/g,"").slice(-6,-4),Df=a=>{let u=a.replace("#","");return a.length===3&&(u=`${u[0]}${u[0]}${u[1]}${u[1]}${u[2]}${u[2]}`),parseInt(u,16)},ec=(a,u)=>`
  url('${u}${Lf(a.color)}${a.type}.png')
`,os=a=>{if(!a)return null;const u=`0${a.file}`.slice(-2),c=`0${a.rank}`.slice(-2);return`square-${u}${c}`},tc=(a,u,c)=>{const p={x:(a.file-1)*100,y:-(a.rank-1)*100},_=c.indexOf("3d")>=0;if(u&&(p.x*=-1,p.y*=-1),_){const ue=23.90808096180187;u?p.y=(a.rank-1)*100-a.rank*ue:p.y=-(a.rank-1)*(100/1.3142)}return p},Bf=(a,u)=>{const c=document.createElement("div"),p=document.createElement("div");return c.id=a,c.className=`legal-move-hint ${u}`,p.classList.add("legal-move-hint-inner"),c.appendChild(p),c},Ff=(a,u,c)=>{const p=c.map(V=>({id:`legal-move-hint-${V.file}${V.rank}`,fileRank:V})),_=Array.from(a.getElementsByClassName("legal-move-hint"));_.forEach(V=>{V.style.display=""}),_.filter(V=>p.findIndex(ue=>ue.id===V.id)===-1).forEach(V=>V.parentNode.removeChild(V));const A=p.filter(V=>_.findIndex(ue=>ue.id===V.id)===-1).map(V=>Bf(V.id,os(V.fileRank)));if(A.length>0){const V=document.createDocumentFragment();A.forEach(ue=>V.appendChild(ue)),a.appendChild(V)}},Uf={default:["#B58863","#F0D9B5",null,".png","#ffff33"],"8_bit":["#6a9b41","#f3f3f4","8_bit",".png","#ffff33"],bases:["#c26b38","#efcca1","bases",".jpg","#f5cc2a"],blue:["#4D6D92","#ECECD7","blue",".png","#00a5ff"],brown:["#B58863","#F0D9B5","brown",".png","#ffff33"],bubblegum:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],burled_wood:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],checkers:["#e3a6a9","#999999","checkers",".png","#fae18a"],dark_wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],dash:["#6b3a27","#bd9257","dash",".jpg","#eca722"],glass:["#282f3f","#667188","glass",".png","#5b91b3"],graffiti:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],green:["#779952","#edeed1","green",".png","#ffff33"],icy_sea:["#7a9db2","#c5d5dc","icy_sea",".jpg","#5ed7f1"],light:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],lolz:["#909898","#e0e9e9","lolz",".jpg","#a3becd"],marble:["#706b66","#c7bdaa","marble",".jpg","#f0db86"],metal:["#6e6e6e","#c9c9c9","metal",".jpg","#a3becd"],nature:["#8c976e","#c3d1a4","translucent",".png","#eef396"],neon:["#636363","#b9b9b9","neon",".png","#6d90a6"],newspaper:["#5a5956","#5a5956","newspaper",".jpg","#99976e"],orange:["#D08B18","#FCE4B2","orange",".png","#ffff33"],overlay:["#789ebd","#4878a0","overlay",".png","#0d9acf"],parchment:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],purple:["#8877B7","#EFEFEF","purple",".png","#7dacc9"],red:["#BA5546","#F0D8BF","red",".png","#f8f893"],sand:["#b8a590","#e5d3c4","sand",".jpg","#e2bc87"],sky:["#c2d7e2","#efefef","sky",".png","#65daf7"],stone:["#666463","#c8c3bd","stone",".jpg","#36525f"],tan:["#D08B18","#FCE4B2","tan",".png","#f7d84a"],tournament:["#316549","#ebece8","tournament",".jpg","#a4c25b"],translucent:["#667188","#282f3f","translucent",".png","#5b91b3"],walnut:["#835f42","#c0a684","walnut",".jpg","#d1a52d"],wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],grey:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],pink:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],natural:["#D08B18","#FCE4B2","tan",".png","#f0e464"],winboard:["#316549","#ebece8","tournament",".jpg","#a4c25b"],blackwhite:["#667188","#282f3f","translucent",".png","#5b91b3"],marbleblue:["#c2d7e2","#efefef","marbleblue",".jpg","#65daf7"],marblebrown:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],marblegreen:["#706b66","#c7bdaa","marblegreen",".jpg","#f0db86"],wooddark:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],woodlight:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],woodmid:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],woodolive:["#6e6e6e","#c9c9c9","woodolive",".jpg","#a3becd"]},nc={modern2:{imgPath:"modern",imgFormat:".png"},lines:{imgPath:"alpha",imgFormat:".png"},luca:{imgPath:"luca",imgFormat:".png"},"3dwood":{imgPath:"3d_wood",imgFormat:".png"},"3dplastic":{imgPath:"3d_plastic",imgFormat:".png"},"3dchesskid":{imgPath:"3d_chesskid",imgFormat:".png"}},Hf=a=>Uf[a],rc=a=>nc[a]?nc[a]:{imgPath:a,imgFormat:".png"},Gf=()=>window.devicePixelRatio>1,V1=new Array(76).join().split(",").map((a,u)=>u*2).slice(22),la=a=>{const u=Gf()?a*2:a;return V1.reduceRight((c,p)=>p===u||p>u?p:c)},Dl=(a,u)=>{const c=Hf(a),p=la(u);return`${Ge.paths.boards}/${c[2]}/${p}${c[3]}`},Vf=(a,u)=>{const c=rc(a),p=la(u);return`${config.paths.pieces}/${c.imgPath}/${p}/`},Us=(a,u)=>{const c=rc(a!=="real3d"?a:"neo"),p=la(u);return`${Ge.paths.pieces}/${c.imgPath}/${p}/`},z1=a=>`${Ge.paths.webglData}/${a}/`,Bl=a=>{const u=p=>new Promise((_,A)=>{const V=new Image;V.onload=()=>{_(V)},V.onerror=()=>{A(p)},V.onabort=V.onerror,V.src=p}),c=[];return a.forEach(p=>c.push(u(p))),Promise.all(c)},zf="webkitTransform"in document.body.style?"webkitTransform":"transform";var Wo={PIECE_ADDED:"DOM_PIECE_ADDED",PIECE_DROPPED:"DOM_PIECE_DROPPED",PIECE_MOVED:"DOM_PIECE_MOVED",PIECE_PICKED_UP:"DOM_PIECE_PICKED_UP",PIECE_REMOVED:"DOM_PIECE_REMOVED"},jf=({color:a,type:u})=>`chessboard-piece-${a===1?u.toUpperCase():u.toLowerCase()}`;const Fl=(a,u,c,p)=>{const _=Array.from(a.getElementsByClassName("piece")),A=p.pieces.filter(V=>_.findIndex(ue=>ue.id===V.id)===-1).map(V=>{const ue=c.test?jf(V):void 0;return Zf(V.type,V.key,os(V),ec(V,Us(c.options.pieceStyle,150)),ue)});if(A.length>0){const V=document.createDocumentFragment(),ue=c.options.pieceStyle.indexOf("3d")>=0;A.forEach(re=>{ue&&re.setAttribute("piece-style","pseudo3d"),p.fadeTime?(re.style.opacity="0",re.style.transition=`opacity ${p.fadeTime}s`,V.appendChild(re),requestAnimationFrame(()=>{re.style.opacity="1"})):V.appendChild(re),u(Wo.PIECE_ADDED,{id:re.id})}),a.querySelector(".pieces").appendChild(V)}},Ul=(a,u,c,p,_)=>{const A=document.createElement("div");return A.id=a,A.className=`square ${u}`,c!==void 0&&(A.style.backgroundColor=c),p!==void 0&&(A.style.opacity=p),_&&A.setAttribute("data-test",_),A};var qf=a=>`chessboard-square-${a}`;const Hl=(a,u,c,p)=>{const _=p.map(A=>{const V=u.test?qf(c):void 0;return Ul(A.id,`${os({file:A.file,rank:A.rank})} ${c}-square`,A.color,A.opacity,V)});if(_.length>0){const A=document.createDocumentFragment();_.forEach(V=>A.appendChild(V)),a.insertBefore(A,a.firstChild)}},Wf=(a,u)=>{const c=Ul(u.id,`${os({file:u.file,rank:u.rank})}`,u.color,.5);a.insertBefore(c,a.querySelector(".pieces"));let p,_=0;p=setInterval(()=>{_+1===u.times*2?(clearInterval(p),a.removeChild(c)):(c.style.opacity=_%2?.5:0,_+=1)},u.interval)},Kf=a=>{const u=document.getElementById("promotion-menu");u&&a.removeChild(u)},$f=a=>{if(!a.getElementsByClassName("pieces")[0]){const u=document.createElement("div");u.classList.add("pieces"),a.appendChild(u)}},Zf=(a,u,c,p,_)=>{const A=document.createElement("div");return A.id=u,A.className=`piece ${c}`,A.style.backgroundImage=p,_&&A.setAttribute("data-test",_),A},Lo={MouseDown:"mousedown",MouseMove:"mousemove",MouseUp:"mouseup",PointerDown:"pointerdown",PointerMove:"pointermove",PointerUp:"pointerup",TouchStart:"touchstart",TouchMove:"touchmove",TouchEnd:"touchend"},Yf=()=>{const a="onpointerdown"in window,u="ontouchstart"in window;let c,p,_;return a?(c=Lo.PointerDown,p=Lo.PointerMove,_=Lo.PointerUp):u?(c=Lo.TouchStart,p=Lo.TouchMove,_=Lo.TouchEnd):(c=Lo.MouseDown,p=Lo.MouseMove,_=Lo.MouseUp),{pointerdown:c,pointermove:p,pointerup:_}},{pointerdown:Xf,pointermove:j1,pointerup:q1}=Yf(),Qf=(a,u,c)=>{const p=ue=>{ue.preventDefault(),ue.stopPropagation();const re=ue.toElement||ue.relatedTarget||ue.target;return re.id==="promotion-close"?c.close():c.select(re.getAttribute("data-type"))},_=document.createDocumentFragment(),A=document.createElement("div");A.classList.add("promotion-menu"),A.id="promotion-menu",A.style.height=`${Math.round(4.3*u.board.squareSize)}px`,A.style.width=`${u.board.squareSize}px`,A.addEventListener(Xf,p);const V=document.createElement("i");V.className="icon-x close-button icon-font-chess x",V.id="promotion-close",V.style.order=4,A.appendChild(V),["q","n","r","b"].map((ue,re)=>{const wt=document.createElement("div");return wt.classList.add("promotion-piece"),wt.setAttribute("data-type",ue),wt.style.backgroundImage=ec({color:1,type:ue},Us(u.options.pieceStyle,150)),wt.style.order=re,wt.style.width=`${u.board.squareSize}px`,wt.style.height=`${u.board.squareSize}px`,wt}).forEach(ue=>A.appendChild(ue)),_.appendChild(A),a.appendChild(_)},Jf=({state:a,draggingPiece:u,coords:c})=>{if(!u)return;const p=document.getElementById(u.key);if(!p)return;const _=a.options.flipBoard?c.x+a.board.squareSize/2-a.board.size:c.x-a.board.squareSize/2,A=a.options.flipBoard?c.y-a.board.squareSize/2:c.y+a.board.squareSize/2-a.board.size;p.style[zf]=`translate3d(${_}px, ${A}px, 0)`},po=(a,u)=>{if(!a)return;const c=a instanceof Node?a:document.getElementById(a.key);if(!(c instanceof Node))return;const p=Array.from(c.classList).filter(_=>_.includes("square"))[0];c.classList.remove(p),c.classList.add(os(u)),c.style.transform="",c.style.zIndex=""},ic=(a,u)=>{if(!u.draggingPiece)return;const c=document.getElementById(u.draggingPiece.key);c&&(po(c,u.fileRank),a(Wo.PIECE_DROPPED,{id:c.id,to:u.fileRank}),c.classList.remove("dragging"))},e0=(a,u)=>{const c=a.getElementsByClassName("pieces")[0],p=u.options.fadeSetup;requestAnimationFrame(()=>{c.style.transition="opacity 0s",c.style.opacity="0",requestAnimationFrame(()=>{c.style.transition=`opacity ${p}s`,c.style.opacity="1"})})},t0=(a,u)=>{const c=a.querySelector("#promotion-menu");c&&(dc(a,u),c.classList.contains("top")?(c.classList.remove("top"),a.querySelector("#promotion-close").style.order=0):(c.classList.add("top"),a.querySelector("#promotion-close").style.order=5))},Gl=(a,u,c)=>{let p;typeof c>"u"?p=Array.from(a.getElementsByClassName(`${u}-square`)):p=Array.from(a.getElementsByClassName(`${u}-square`)).filter(_=>[].concat(c).findIndex(A=>_.id===A.id)!==-1),p.forEach(_=>_.parentNode.removeChild(_))},n0=(a,{state:u})=>{u.options.highlightLegalMoves&&Gl(a,"hover")},r0=a=>{Array.from(a.getElementsByClassName("legal-move-hint")).forEach(u=>{u.style.display="none"})},ua=[];function oc(a,u){Object.keys(a.fromValues).forEach(c=>{const p=a.fromValues[c],_=a.toValues[c];a.updatedValues[c]=(_-p)*u+p}),a.onUpdate&&a.onUpdate(a.updatedValues)}function ac(a){ua.forEach((u,c)=>{let p=0;u.startTime<0?(u.startTime=a,u.onStart&&u.onStart()):(p=(a-u.startTime)*u.durationRatio,p>1&&(p=1)),oc(u,p),p===1&&(u.onEnd&&u.onEnd(),ua.splice(c,1))}),ua.length&&requestAnimationFrame(ac)}class i0{constructor(u){this.fromValues=u.from||null,this.toValues=u.to||null,this.updatedValues={},this.startTime=-1,this.durationRatio=u.duration?1/(u.duration*1e3):0,this.onStart=u.onStart||null,this.onUpdate=u.onUpdate||null,this.onEnd=u.onEnd||null}start(){ua.push(this),ua.length===1&&requestAnimationFrame(ac)}static endAll(){ua.forEach(u=>{oc(u,1),u.onEnd&&u.onEnd()}),ua.length=0}}const sc=(a,u,c,p)=>{Array.from(a.getElementsByClassName("piece")).map(_=>{const A=p.pieces.findIndex(V=>V.key===_.id);return{domPiece:_,fromFileRank:Ne(_.className),toFileRank:A!==-1?{file:p.pieces[A].file,rank:p.pieces[A].rank}:null}}).filter(_=>_.toFileRank!==null).forEach(_=>{const A=tc(_.fromFileRank,c.options.flipBoard,c.options.pieceStyle),V=tc(_.toFileRank,c.options.flipBoard,c.options.pieceStyle);p.animationSpeed>0?new i0({duration:p.animationSpeed,from:{x:A.x,y:A.y},to:{x:V.x,y:V.y},onStart:()=>{_.domPiece.style.zIndex=3},onUpdate:re=>{_.domPiece.style.transform=`translate3d(${re.x}%, ${re.y}%, 0)`},onEnd:()=>{po(_.domPiece,_.toFileRank)}}).start():po(_.domPiece,_.toFileRank),u(Wo.PIECE_MOVED,{to:_.toFileRank,id:_.domPiece.id})})};var lc=a=>`chessboard-promotion-piece-${a}`;const uc=(a,u,c,p)=>{let _=document.getElementById("promotion-menu");_||(Qf(a,u,c),_=document.getElementById("promotion-menu"));const A=u.options.flipBoard?(u.board.files-p.toFileRank.file)*u.board.squareSize:(p.toFileRank.file-1)*u.board.squareSize;u.options.pieceStyle.indexOf("3d")>=0?_.classList.add("pseudo3d"):_.classList.remove("pseudo3d"),_.style.left=`${A}px`,_.setAttribute("data-file",p.toFileRank.file),p.top?_.classList.add("top"):_.classList.remove("top");const ue=p.top?["q","n","r","b"]:["b","r","n","q"];Array.from(_.getElementsByClassName("promotion-piece")).forEach(re=>{const wt=re.getAttribute("data-type"),On=u.test?lc(wt):void 0;On&&re.setAttribute("data-test",On),re.style.order=ue.indexOf(wt),re.style.backgroundImage=ec({color:p.piece.color,type:wt},Us(u.options.pieceStyle,150))}),document.getElementById("promotion-close").style.order=p.top?5:0},cc=(a,u)=>{if(!u)return;const c=document.getElementById(u.key);c&&(c.classList.add("dragging"),a(Wo.PIECE_PICKED_UP,{id:c.id}))},o0=(a,u,c)=>{Array.from(a.getElementsByClassName("piece")).filter(p=>c.pieces.findIndex(_=>_.key===p.id)!==-1).forEach(p=>{const _=p.id;c.fadeTime?(p.style.opacity=1,p.style.transition=`opacity ${c.fadeTime}s`,requestAnimationFrame(()=>{p.style.opacity=0,setTimeout(()=>{p&&p.parentNode&&p.parentNode.removeChild(p)},c.fadeTime*1e3)})):p.parentNode.removeChild(p),u(Wo.PIECE_REMOVED,{id:_})})},a0=(a,u,c,p)=>{i0.endAll();const _=Array.from(a.getElementsByClassName("piece")),A=p.filter(V=>_.findIndex(ue=>ue.id===V.key)===-1);Fl(a,u,c,{pieces:A,fadeTime:.3}),Array.from(a.getElementsByClassName("piece")).map(V=>{const ue=p.findIndex(re=>re.key===V.id);return ue===-1&&V.parentNode.removeChild(V),{domPiece:V,to:ue!==-1?p[ue]:null}}).filter(V=>V.to!==null).filter(V=>!(c.draggingPiece&&c.draggingPiece.key===V.domPiece.id)).forEach(V=>po(V.domPiece,{file:V.to.file,rank:V.to.rank}))},s0=(a,u,c)=>{const p=Array.from(a.getElementsByClassName(`${ve.MARKED}-square`)),_=c.filter(A=>p.findIndex(V=>V.id===A.id)===-1);p.filter(A=>c.findIndex(V=>V.id===A.id)===-1).forEach(A=>A.parentNode.removeChild(A)),Hl(a,u,ve.MARKED,_)},l0=(a,{state:u,coords:c})=>{if(u.options.highlightLegalMoves){const p=Ht(oe(c,a,u.board.files,u.board.ranks,u.options.flipBoard)),_={id:"hover-square",file:p.file,rank:p.rank};Gl(a,"hover"),Hl(a,u,"hover",[_])}},u0=(a,u)=>{let c=`url('${Dl(u.options.boardStyle,150)}') 0% 0% / 100% 100% no-repeat`;u.options.overlayInAnalysisMode&&u.gameSettings.analysis&&(c=`
      linear-gradient(rgba(255, 255, 255, 0.2),
      rgba(255, 255, 255, 0.2)) 0% 0% / 100% 100%,
      ${c}
    `),a.style.background=c},c0=(a,u)=>{a.style.width=`${u.board.size}px`,a.style.height=`${u.board.size}px`,a.style.backgroundSize=`${u.board.size}px ${u.board.size}px`},d0=(a,u)=>{const c=Us(u.options.pieceStyle,150),p=u.options.pieceStyle.indexOf("3d")>=0,_=Array.from(a.querySelectorAll(".piece")).forEach(A=>{const V=Ju(A.style.backgroundImage);p&&A.setAttribute("piece-style","pseudo3d"),A.style.backgroundImage=`url('${c}${V}.png')`})},dc=(a,u)=>{const c=a.querySelector("#promotion-menu");if(c){c.style.height=`${Math.round(4.3*u.board.squareSize)}px`,c.style.width=`${u.board.squareSize}px`;const p=parseInt(c.getAttribute("data-file"),10),_=u.options.flipBoard?(u.board.files-p)*u.board.squareSize:(p-1)*u.board.squareSize,A=u.options.pieceStyle.indexOf("3d")>=0;c.style.left=`${_}px`,Array.from(a.getElementsByClassName("promotion-piece")).forEach(V=>{V.style.width=`${u.board.squareSize}px`,V.style.height=`${u.board.squareSize}px`,A&&(V.style.backgroundSize=`${u.board.squareSize}px ${u.board.squareSize}px`)})}},f0=(a,u)=>{const c={disabled:!u.enabled,flipped:u.flipBoard,rounded:u.rounded};Object.keys(c).forEach(p=>c[p]?a.classList.add(p):a.classList.remove(p))};var h0=({on:a,state:u})=>{if(!window.Raven)return;const c=Date.now(),p=[];let _=0,A;Object.keys(k).forEach(ue=>{a(ue,re=>V(`Emit: ${ue}`,re))}),Object.values(Wo).forEach(ue=>{a(ue,re=>V(`DOM Event: ${ue}`,re))}),Object.keys(z).forEach(ue=>{a(ue,re=>V(`Command: ${ue}`,re))}),Object.values(Zt).forEach(ue=>{a(`action-${ue}`,re=>V(`Action: ${ue}`,re))}),a(W.HISTORY_CHANGE,ue=>{ue.slice(_).forEach(re=>V("API History Event",re)),_=ue.length-1}),a(k.OPTIONS_CHANGED,()=>{Ts({chessboardOptions:A})});function V(ue,re){p.unshift({timestamp:Date.now()-c,type:ue,data:re}),p.length>50&&p.pop(),Ts({chessboardEvents:p,chessboardState:u})}};const p0=(a,u)=>new Promise(c=>{const p=Nf({...u,usersnapLogger:h0}),_={close:()=>p.dispatch(Zt.CANCEL_PROMOTION),select:A=>p.dispatch(Zt.SELECT_PROMOTION_PIECE,A)};p.on(z.ADD_LEGAL_MOVES,A=>Ff(a,p.state,A)),p.on(z.ADD_PIECES,A=>Fl(a,p.emit,p.state,A)),p.on(z.ADD_SQUARES,A=>Hl(a,p.state,A.type,A.moveSquares)),p.on(z.BLINK_SQUARE,A=>Wf(a,A)),p.on(z.CLOSE_PROMOTION_MENU,()=>Kf(a)),p.on(z.DRAG_PIECE,A=>Jf(A)),p.on(z.DROP_PIECE,A=>ic(p.emit,A)),p.on(z.FADE_PIECES,()=>e0(a,p.state)),p.on(z.FLIP_BOARD,()=>t0(a,p.state)),p.on(z.MOVE_PIECES,A=>sc(a,p.emit,p.state,A)),p.on(z.OPEN_PROMOTION_MENU,A=>uc(a,p.state,_,A)),p.on(z.PICK_UP_PIECE,A=>cc(p.emit,A)),p.on(z.REMOVE_LEGAL_MOVES,()=>r0(a)),p.on(z.REMOVE_SQUARES,A=>Gl(a,A.type,A.squares)),p.on(z.REMOVE_PIECES,A=>o0(a,p.emit,A)),p.on(z.SET_PIECE,A=>po(A.piece,A.fileRank)),p.on(z.SET_PIECES,A=>a0(a,p.emit,p.state,A)),p.on(z.SET_SQUARES,A=>s0(a,p.state,A)),p.on(z.SHOW_HOVER_SQUARE,A=>l0(a,A)),p.on(z.HIDE_HOVER_SQUARE,A=>n0(a,A)),p.on(z.UPDATE_BOARD_CLASSES,A=>f0(a,A)),p.on(z.UPDATE_BOARD_IMAGE,()=>u0(a,p.state)),p.on(z.UPDATE_BOARD_SIZE,()=>c0(a,p.state)),p.on(z.UPDATE_PIECE_IMAGES,()=>d0(a,p.state)),p.on(z.UPDATE_PROMOTION_MENU_SIZE,()=>dc(a,p.state)),$f(a),c(p)});var m0={name:"ChessBoard",mixins:[Of],components:{CustomItem:Bn,Coordinates:De,MarkedArrow:pn,MarkedEffect:Tr},computed:{coordColors(){return{white:Fe[this.options.boardStyle][1],black:Fe[this.options.boardStyle][0]}}},methods:{createChessboard(){return p0(this.$el,this.extensions)},getDomFormatters(){return Rf(Te)}}},v0=m0,fc={};function g0(a){this.$style=fc.locals||fc}var _0=Ce(v0,lt,nn,!1,g0,null,null),hc=_0.exports;window.chesscom=window.chesscom||{},window.chesscom.chessBoard||(window.chesscom.chessBoard=hc),window.chesscom.defaultChessBoard=hc})()}();
